module fnet_ORRSL

! a = 0.00057239
! b = 0.038113

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.130415,0.170570,0.048789,0.087406,0.007585,-0.206924,-0.292745,-0.014874, &
            -0.060422,0.036962,0.008357,0.029695,0.021159,-0.120912,-0.009846,-0.038404, &
            -0.042923,0.058729,0.022228,0.024914,0.072500,-0.114181,-0.072859,-0.024098, &
            -0.040806,0.021163,0.017111,0.026071,0.092525,-0.108102,0.031623,-0.027762, &
            -0.068019,0.015442,0.021159,0.020020,0.104957,-0.170277,0.066738,-0.052562, &
            -0.065273,0.004274,0.024160,0.022262,0.100001,-0.189546,0.127504,-0.059286, &
            -0.075390,-0.047021,0.064589,0.039605,0.106516,-0.213965,0.118374,0.000322, &
            -0.113458,-0.061879,0.006567,0.059059,0.175239,-0.245914,0.190190,-0.077888, &
            -0.972552,0.221440,0.696371,0.656677,0.275513,-2.732486,0.197612,0.211595, &
            -0.432993,0.175256,0.873295,0.459402,-0.197493,-1.118745,-0.465666,0.722369, &
            -0.021703,0.078040,0.782718,0.187945,0.066755,-0.276991,-0.390380,0.638161, &
            0.012717,0.101108,0.813049,0.019050,0.128732,-0.168411,-0.167895,0.342097, &
            0.082553,-0.106759,0.321370,0.140345,-0.001733,0.176011,0.018692,0.324799, &
            -0.037619,0.040671,0.106225,0.055621,-0.150412,-0.070987,0.152033,0.049627, &
            -0.059245,0.040703,0.176779,-0.090904,-0.028177,-0.311775,0.109816,-0.080218, &
            -0.029419,-0.068975,-0.046931,0.165686,-0.127440,-0.068330,0.205902,0.069408, &
            0.031719,-0.106382,-0.222845,0.127597,-0.268504,0.237916,0.217725,0.002094, &
            -0.024833,0.045180,-0.395778,0.191847,-0.572768,0.172646,-0.156588,-0.012081, &
            0.067576,0.167583,-0.036054,0.248276,0.153268,-0.157577,-0.260206,0.125370, &
            0.054775,0.265907,-0.182330,0.158416,0.189420,0.057061,-0.154679,-0.148833, &
            0.065561,0.274678,0.062482,0.084737,-0.049677,0.084883,-0.253456,0.071588, &
            0.009522,0.229808,-0.000466,0.110302,-0.045332,-0.022010,-0.233655,-0.030407, &
            0.091238,0.183422,0.091041,0.144265,-0.200166,0.256673,-0.286691,0.152391, &
            0.034545,0.230405,0.101832,0.092746,-0.123463,0.059456,-0.427362,0.040783, &
            0.103050,0.377041,0.086592,0.104004,-0.322840,0.252811,-0.459732,0.038422, &
            0.156349,0.467328,0.136090,0.014721,-0.442800,0.466444,-0.476298,-0.044742, &
            0.710924,0.451400,0.870050,-0.161226,-1.589159,0.434623,-0.354363,-0.265316, &
            0.992950,0.013875,0.959973,0.282230,-0.891614,0.328139,0.125278,-0.015401, &
            0.676946,-0.562155,0.456887,0.138652,-0.858102,-0.102718,0.049014,0.120101, &
            0.348563,-0.213243,0.246075,0.257121,-0.773878,0.141812,0.350624,0.086478, &
            0.213621,-0.443139,0.265025,0.206809,-0.713866,0.323744,0.235372,0.376398, &
            0.363579,-0.220370,0.013836,0.059291,-0.034689,0.242301,0.051987,0.131667, &
            0.212669,-0.106768,-0.461182,0.167802,0.291084,0.288526,0.475846,-0.238719, &
            0.000287,-0.176891,0.293386,-0.140810,-0.250250,-0.177148,0.445943,-0.033943, &
            0.280883,-0.035625,0.014251,0.146557,-0.655999,0.269295,0.311778,0.389557, &
            0.110188,-0.254209,0.180253,-0.197283,0.216618,0.095947,0.400506,-0.055541, &
            -0.016269,0.841703,-0.530131,0.244450,-0.066324,-0.842876,-0.399869,-0.489989, &
            -0.086512,0.623901,-0.925267,-0.361581,-0.158717,-0.766946,-0.340501,-0.582326, &
            0.009018,0.819948,-1.254130,-0.386253,0.208939,-0.866858,-0.461825,-0.325498, &
            -0.259309,0.647296,-1.429958,-0.757879,0.240557,-0.629260,-0.536554,-0.678810, &
            -0.220143,0.497276,-2.077443,-1.068917,0.569599,-1.034368,-0.492962,-0.487621, &
            -0.242030,0.580976,-2.115798,-1.694321,0.690615,-1.626482,-0.260861,-0.738467, &
            -0.338844,0.592402,-2.561865,-2.249324,1.329717,-2.133403,-0.237028,-0.952490, &
            -0.514068,0.448160,-3.210971,-2.789734,2.104791,-3.021680,-0.543288,-0.369386, &
            -6.035918,1.181236,-6.354691,-7.077725,7.414415,-3.558268,-0.700681,1.658985, &
            -10.295644,1.225359,-7.898109,-9.619490,11.447777,-2.882528,-0.555867,1.727237, &
            -10.589419,0.623960,-6.372171,-8.107713,10.130008,-1.283767,-1.246172,0.700986, &
            -7.359101,0.162979,-4.049959,-6.329865,8.060874,0.115483,0.151083,-0.962509, &
            -4.614093,-0.124148,-2.288044,-5.098159,5.619521,0.443617,0.050641,-1.987766, &
            -2.641685,0.452923,-0.595302,-4.056082,4.786807,0.555453,-1.246348,-2.577524, &
            -1.711530,-0.169985,0.102806,-2.812892,3.455299,-0.084915,1.210285,-2.826889, &
            -1.718140,-0.229877,-0.356485,-1.932004,1.952501,0.745760,0.725276,-2.213627, &
            -1.239162,-0.391393,-1.191778,-2.684725,1.447846,-0.154323,0.920463,-1.947555, &
            -0.965990,-0.031978,-0.649575,-3.639653,1.815915,0.090458,0.393653,-2.327547, &
            -1.463239,0.144675,0.232270,0.001520,0.970081,-0.003979,0.533987,-1.286543, &
            -1.122883,-0.502633,0.150080,0.124438,0.796282,-0.862113,0.887077,-1.192877, &
            -0.839624,-0.526126,-0.350254,0.205541,1.080420,-0.815832,0.761280,-1.325580, &
            -0.666405,-0.644446,-0.174721,-0.027132,1.517543,-1.319951,0.587881,-1.256610, &
            -0.995534,-0.443159,-0.481676,-0.145822,1.601365,-1.456761,0.471593,-0.948656, &
            -1.128127,-0.715123,-0.679984,-0.087572,2.302779,-1.595252,0.455347,-1.069628, &
            -0.929236,-0.414316,-1.020728,-0.471757,2.714046,-1.757906,0.630772,-0.764644, &
            -1.245281,-0.494416,-0.963111,-0.389371,2.827771,-2.030771,0.479913,-0.601702, &
            -2.225409,0.536331,-1.723365,-1.008893,4.754941,-2.399885,1.014072,0.184923, &
            -2.956771,0.476291,-3.032664,-1.902172,5.301671,-2.252547,-0.103724,1.261343, &
            -3.084174,0.467287,-2.601273,-1.571730,3.925213,-0.824227,-1.075616,0.431786, &
            -1.897964,-0.019483,-1.781851,-0.638486,2.729340,-0.336511,0.843399,-0.280403, &
            -2.267615,-0.162206,-0.628833,0.865875,0.990408,1.086674,1.508456,-1.244953, &
            -1.876695,-0.415262,-0.546949,0.752179,0.017942,1.046531,1.856694,-1.108004, &
            -0.338899,-0.295196,-0.532916,0.739344,-0.503241,-0.020008,0.798641,-0.791379, &
            0.674628,0.589803,-1.169823,-0.129237,0.663385,-1.328240,-0.588861,-0.301252, &
            0.067503,0.754410,-0.392741,-0.121564,1.708942,-0.420275,-1.523424,-0.168672, &
            -0.291825,0.633395,-0.661510,0.131226,1.469235,-1.037098,-1.720354,-0.537160, &
            -0.104090,0.347792,-0.003682,0.149851,-0.222767,-0.530127,-0.013382,0.015117, &
            -0.078249,0.167286,0.116849,-0.031698,-0.155481,-0.200621,-0.173339,0.029319, &
            -0.053028,0.024621,0.099720,0.038010,-0.037870,-0.019109,-0.246627,0.134324, &
            0.013127,-0.044881,0.015992,-0.058634,0.075014,0.120036,0.015303,-0.027888, &
            -0.085169,0.103225,-0.012759,0.071864,-0.181959,-0.134669,-0.164719,0.035904, &
            -0.018128,-0.014358,-0.007612,0.022159,-0.101232,0.068979,-0.083791,0.065566, &
            -0.086825,0.096510,0.059656,0.082955,0.006918,-0.233393,-0.151022,0.079944, &
            -0.107356,0.034158,0.056133,0.116340,-0.141842,-0.274820,-0.111501,0.048748, &
            -0.214049,0.205987,-0.309611,0.777249,0.423199,-0.331970,-0.333416,0.292318, &
            -0.397350,0.272051,0.071654,0.439918,0.191524,-0.890047,0.026380,0.105984, &
            0.400648,0.321566,0.340077,0.256421,-0.156875,-0.348228,0.777007,-0.027278, &
            -0.025069,0.032994,0.240563,-0.084149,-0.339616,-0.062970,0.408407,-0.350283, &
            -0.324369,-0.605527,0.531554,-0.224763,-0.259467,-0.220488,0.792557,-0.505053, &
            -0.339729,-0.167318,0.287511,-0.536151,0.006139,0.074603,0.511605,-0.473909, &
            0.091277,-0.110033,-0.326517,-0.582487,0.370659,0.840165,0.372989,-0.562007, &
            0.162708,0.079916,-0.040606,-0.871071,0.941855,0.906590,0.198232,-0.411474, &
            0.336926,0.850846,0.207755,-0.587814,0.260881,0.231192,-0.283316,-0.041333, &
            0.603427,0.482834,-0.266959,-0.458192,0.372271,1.187758,-0.258011,0.052833, &
            -0.080550,0.169676,-0.042097,0.224353,0.350614,-0.382177,0.378767,-0.172658, &
            -0.043861,0.006037,-0.006866,-0.016713,-0.041552,-0.129655,0.520966,-0.139134, &
            -0.165539,-0.075806,0.182268,0.066587,-0.187413,-0.375635,0.522480,0.013180, &
            -0.111624,-0.042341,0.100052,0.200680,-0.075721,-0.311775,0.475684,0.013370, &
            -0.077823,-0.152392,0.107843,0.124216,-0.089826,-0.133249,0.269338,0.097544, &
            -0.051479,-0.130225,0.121102,0.175409,-0.195273,-0.135039,0.145281,0.240612, &
            0.071323,0.057798,-0.086410,0.225026,-0.139479,0.095061,0.093683,0.179027, &
            0.003121,0.082572,0.130370,0.068810,-0.201925,0.145978,-0.009372,0.152705, &
            0.862558,0.496036,-0.240156,0.475136,-1.061996,0.990048,0.244899,0.369194, &
            1.062777,0.462692,0.026299,0.595319,-2.123735,0.661372,0.349753,0.509943, &
            0.753000,-0.074712,0.141629,0.444620,-1.116960,0.492880,-0.561622,0.871415, &
            0.510387,-0.055164,-0.192934,0.021651,-0.891869,0.866536,-0.093382,0.321017, &
            0.577113,-0.172986,-0.208366,0.083448,-0.581478,0.852452,0.510809,0.410289, &
            0.579781,-0.274505,-0.153586,-0.043855,-0.407051,0.477175,0.217299,0.357663, &
            0.480825,0.176769,-0.156754,-0.167902,-0.803367,0.505610,-0.072743,0.143004, &
            0.224421,-0.098420,-0.407840,-0.008532,-0.401882,-0.039078,1.072215,0.037362, &
            0.602176,-0.260325,-0.475934,0.193348,0.015053,0.139967,0.418608,0.226270, &
            0.743284,-0.018012,-0.620565,0.538098,0.492087,1.073152,-0.202704,0.677867, &
            -0.072216,0.185513,-0.103604,0.067434,0.108228,-0.274606,-0.043700,-0.147675, &
            -0.129990,-0.058813,0.082004,-0.083830,-0.222687,-0.085572,0.030330,0.012454, &
            -0.402301,-0.182471,-0.037200,0.061338,-0.698398,-0.134460,0.199073,0.010523, &
            -0.009050,-0.122826,-0.010816,-0.008799,-0.126717,0.120769,0.094079,0.052526, &
            -0.012683,-0.017869,0.011149,-0.009035,-0.042992,0.021037,0.034758,0.001174, &
            -0.035590,0.081612,-0.006094,0.012471,-0.024626,-0.060451,-0.073860,-0.039123, &
            -0.029305,0.094494,0.025223,0.059720,-0.021147,-0.092199,-0.140942,0.042616, &
            -0.043606,0.043430,-0.002947,0.001627,-0.061689,-0.096610,-0.033948,-0.027138, &
            0.041989,-0.109823,-0.042631,0.011313,0.000385,0.057223,0.350314,-0.043581, &
            -0.005374,0.180922,-0.164150,0.103712,0.158942,-0.131645,0.094028,-0.112605, &
            -0.186869,0.376331,-0.062703,0.160861,-0.181244,-0.414601,-0.410937,-0.030790, &
            0.122548,-0.252683,0.097334,-0.172664,0.150997,0.287356,0.288997,0.016675, &
            0.012101,0.066366,-0.161842,-0.070351,0.129344,0.064207,0.020907,-0.188195, &
            -0.133426,0.048841,0.231520,0.023616,-0.009305,-0.168212,-0.059599,0.036917, &
            0.111900,-0.078460,0.124771,-0.068896,-0.127020,0.268018,-0.003357,0.171834, &
            0.000032,0.081900,-0.075174,0.002861,0.221758,-0.092775,0.002735,-0.126897, &
            -0.223470,0.358028,0.326195,0.076720,-0.059394,-0.561107,-0.493294,0.013440, &
            0.134389,-0.330270,-0.159911,-0.045240,0.195115,0.398235,0.485070,-0.020423 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/6.462371,1.166952, &
            -1.449584,0.956331, &
            4.553902,-0.935365, &
            5.206373,3.047517, &
            -1.935880,0.470096, &
            -1.498837,0.918464, &
            -0.778716,0.647351, &
            -2.920339,0.875732 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.949629,-0.67672/),(/1,2/))
real, dimension(8) :: bias1 = &
(/2.015078,-2.085593,1.671011,2.164785,-1.678816,-0.2774,-2.660312,-1.800633/)
real, dimension(2) :: bias2 = &
(/-0.158709,-1.080187/)
real, dimension(1) :: bias3 = &
(/0.575676/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
