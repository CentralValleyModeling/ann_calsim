module fnet_CCFB_intake

! a = 0.00076145
! b = 0.026005

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.028455,-1.205443,0.484660,-0.115586,-0.331217,-0.163895,-0.079171,0.012655, &
            0.142011,-0.620666,0.056170,-0.214311,-0.220161,-0.034456,0.068877,-0.233020, &
            -0.014745,-0.443316,-0.614243,-0.002247,-0.356359,0.027932,0.005143,-1.517901, &
            0.068557,-0.288556,-0.484057,0.050524,-0.546440,0.052235,0.080378,-1.246688, &
            0.042450,-0.029696,-0.208665,0.250963,-0.210381,-0.023021,0.265069,-0.573644, &
            0.042360,-0.009348,-0.059841,0.111359,-0.204787,-0.022081,0.081004,-0.431351, &
            0.011459,-0.137175,-0.280350,0.255060,-0.193957,-0.081796,0.114828,-0.426236, &
            0.015582,-0.202747,-0.073090,0.132838,-0.123488,-0.051647,0.108397,0.034058, &
            -0.126231,-0.342480,-0.546053,0.259335,-0.206601,-0.301925,-0.173998,2.329210, &
            -0.196465,-0.485754,-0.672735,-0.116202,-0.203361,-0.044549,-0.300073,0.894944, &
            -0.177364,0.547046,0.278767,-0.370194,0.138398,0.157044,-0.257325,0.651533, &
            0.259658,0.467321,0.191250,-0.395102,-0.348944,0.161085,0.059102,0.470426, &
            -0.026424,-0.233466,0.599073,-0.172051,0.058679,0.086550,0.348008,0.149453, &
            0.226190,0.062991,0.561658,-0.360715,0.060101,0.140177,0.540215,0.229188, &
            0.090753,0.024675,0.118512,-0.119856,-0.004765,0.088646,0.152021,0.413754, &
            -0.173044,-0.644672,0.341292,-0.319537,-0.161008,0.180151,-0.210294,0.218038, &
            0.113932,-0.930205,0.350335,-0.261159,-0.006514,-0.007516,0.212934,1.477757, &
            -0.245429,-0.233128,-0.294343,-0.471959,0.379579,0.315237,-0.316244,1.335117, &
            -0.417018,-0.124750,0.669427,-0.215400,-0.172553,0.252487,0.115444,-1.079882, &
            -0.284542,-0.010245,0.408810,-0.415737,-0.608213,0.418437,0.323714,-2.074447, &
            -0.042766,0.144461,0.082345,-0.027260,-0.088176,0.108247,-0.036747,-0.833279, &
            0.332808,0.110488,-0.079159,-0.199631,0.092373,-0.022888,0.084654,-0.240843, &
            0.156715,0.155328,-0.032733,-0.041071,0.179830,-0.076824,0.006637,-0.374642, &
            0.112556,0.167016,-0.019886,-0.126669,-0.081936,0.071795,0.134170,-0.421933, &
            0.076764,0.247585,0.053560,-0.039477,-0.165956,0.024575,-0.039947,-0.703846, &
            0.160796,0.677804,-0.075583,0.011091,-0.303688,0.115678,0.222941,-1.033677, &
            0.147288,2.321858,-0.097933,-0.135842,-0.414627,0.772217,0.155555,-1.550235, &
            0.295165,1.485905,-0.479919,-0.067294,-0.621513,0.983544,0.174898,-1.919605, &
            0.618819,-0.126746,0.321444,-0.340269,0.084577,0.574263,0.492312,-1.249198, &
            0.072616,-0.406073,-0.040368,0.071642,-0.245163,0.430120,0.156299,-1.595986, &
            -0.140139,0.785420,-0.923968,0.124196,-0.288088,0.478474,-0.463542,0.060982, &
            -0.002245,0.601761,-0.941572,-0.375045,0.268816,0.385068,-0.259991,0.288901, &
            0.020298,0.070333,-0.055784,0.036354,-0.026322,0.048305,0.032016,1.550871, &
            0.342493,-0.694072,0.518734,0.037850,-0.619206,-0.101521,0.505842,1.477668, &
            0.283196,0.726647,-0.505755,-0.058792,-0.062898,0.066605,0.254082,0.882720, &
            0.089439,0.337282,-0.897361,0.355580,-0.124812,-0.233104,-0.300758,-0.913783, &
            0.152702,1.739845,-0.103267,1.073269,0.917150,0.016860,0.654117,-1.599876, &
            0.215404,1.978410,0.699123,0.227140,0.433202,-0.374217,1.603834,-1.884160, &
            0.260111,1.249113,-0.038463,0.453679,-0.124858,-0.321742,1.014716,-0.232949, &
            0.110468,1.176825,-0.255483,0.732442,0.058714,-0.365014,0.439147,0.954460, &
            0.114624,0.886177,-0.198462,0.738181,0.100933,-0.343472,0.451326,0.958391, &
            0.071751,0.851034,-0.074287,0.955904,0.377232,-0.556445,0.337557,0.817563, &
            0.154668,0.877437,-0.243626,0.957709,0.356902,-1.105645,0.362514,0.974731, &
            0.026319,0.667280,0.037799,0.820580,0.636290,-1.494512,0.650717,0.848611, &
            0.181905,0.735304,-0.251539,0.210942,0.815047,-5.418370,1.007802,0.348007, &
            0.110782,-0.160136,0.918221,0.522020,0.425092,-9.494700,1.094217,0.710104, &
            0.445042,-1.026992,1.592855,-0.495520,-0.132470,-9.761892,1.619069,1.519568, &
            0.165473,-0.616939,0.232861,-1.083401,0.696012,-7.203591,0.451245,0.589463, &
            0.634141,-0.183082,-0.582455,-0.295377,-0.277210,-5.628901,0.960613,0.849021, &
            0.343137,-0.007707,1.183179,0.424813,0.295227,-3.182294,1.016057,-0.700756, &
            0.410234,-0.006936,-0.250491,0.251176,0.079208,-1.973979,0.938261,-0.933282, &
            0.388911,-0.677362,-0.035541,1.109985,-0.176180,-0.928127,0.717725,-0.647831, &
            -0.092644,-0.361289,0.519471,0.910967,-0.026343,-0.704133,0.213392,0.079272, &
            -0.258504,-0.425828,1.390998,1.242702,0.636009,-0.942166,0.111704,0.296664, &
            -0.888100,-0.011662,0.820930,2.528878,-1.242526,-0.920565,0.668548,-0.975255, &
            -1.468680,0.273768,0.030961,2.198692,-2.064612,-0.956581,0.894641,-1.053381, &
            -0.970054,0.156991,0.058671,2.359360,-1.728744,-0.888327,0.620266,-0.376798, &
            -0.397921,-0.013972,0.231609,2.428061,-1.055447,-0.746538,-0.176111,-0.098810, &
            -0.497042,0.030892,0.116745,2.774963,-0.972504,-0.825820,-0.705774,-0.268284, &
            -0.301852,-0.238864,0.215226,2.673545,-0.649745,-1.052177,-0.745002,-0.089783, &
            -0.077149,0.043979,0.214431,2.983760,-0.447726,-1.159682,-1.078130,-0.402776, &
            -0.496329,-0.138142,-0.057062,3.022646,-0.180195,-0.908133,-0.928467,-0.679162, &
            -0.433993,0.111554,0.080511,2.553716,-0.135136,-1.710606,-1.294135,-1.136805, &
            -0.727462,0.656874,-0.824026,1.046416,-0.464932,-2.926400,-1.317022,-1.064076, &
            -0.695705,-0.344034,-2.568840,0.136536,-2.012726,-2.814046,-0.477696,-1.945015, &
            -0.223018,-0.653109,-0.809554,0.213582,-0.173577,-2.530112,-1.006078,-0.019869, &
            -0.320962,-0.890143,0.722997,0.590009,-0.391566,-1.445469,-0.657428,1.964862, &
            -0.164871,-0.475835,0.811208,0.795672,-0.425221,-0.947479,-0.048119,1.453092, &
            0.016285,-0.573908,0.213575,0.711343,-0.040926,-0.682625,-0.084907,0.767359, &
            -0.137290,0.315266,0.424181,0.859826,0.380643,-1.201533,0.469557,0.058665, &
            0.025863,-0.809933,0.240437,1.279527,0.443480,-0.539880,0.589711,0.659454, &
            0.143329,-2.511191,-0.560823,0.845386,0.080207,-1.068944,0.589496,-0.124677, &
            -0.298588,-0.135873,-0.260936,0.047694,0.122906,0.045212,-0.274497,-0.494691, &
            -0.003962,-0.204001,-0.187013,0.103671,0.069782,-0.065631,-0.003109,-0.051405, &
            0.095733,0.221012,-0.040894,-0.079466,0.017827,0.017724,0.032665,0.349293, &
            -0.138142,-0.047761,-0.041045,0.089378,-0.047817,0.019280,-0.017741,0.258004, &
            0.021791,-0.062703,-0.068362,-0.000752,-0.005117,-0.000031,-0.025084,-0.062283, &
            -0.113945,0.198108,0.113555,0.169994,-0.027077,0.010219,-0.010528,-0.130931, &
            -0.055121,-0.016361,-0.071948,-0.004288,0.147073,0.013464,-0.066749,0.063349, &
            -0.190393,0.261666,-0.337347,-0.014004,0.139468,0.071954,-0.170792,0.172073, &
            -1.006485,-0.287874,-0.314751,0.273570,0.279020,0.572093,-0.242429,1.618182, &
            -0.868933,0.523104,-0.417781,-0.026844,0.449375,0.735864,-0.499567,0.448665, &
            -0.207459,0.073267,-0.049163,-0.213049,0.353043,0.666101,-0.082357,0.868802, &
            0.035535,0.193591,-0.115076,-0.409442,0.331015,0.347663,-0.466227,1.051193, &
            0.291808,0.142654,0.103476,-0.904344,-0.053985,0.348437,-0.244565,0.356528, &
            0.186687,-1.358089,-0.168090,-0.832722,0.218826,-0.214499,-0.118580,0.237076, &
            0.286123,-1.142412,-0.036226,-0.282648,0.098122,-0.397711,0.547765,-1.065809, &
            0.427172,-1.179362,0.217017,-0.559012,0.135897,-0.400791,0.757827,-0.094070, &
            -0.020905,-0.913049,-0.518987,-0.199807,0.289737,-0.266788,0.406109,-1.136775, &
            0.320231,-1.064386,0.292592,-0.016542,0.109876,-0.258199,0.825683,-1.648572, &
            0.114246,0.274777,-0.816482,0.414147,-0.273269,-0.306968,0.115431,1.850943, &
            0.298484,0.393997,-2.540478,0.648768,-0.601461,-0.273355,-0.055658,2.269236, &
            0.224414,0.378832,-0.981815,0.352703,-0.550358,-0.170641,0.230751,0.705431, &
            -0.166539,0.567618,-0.605487,0.242682,-0.278764,-0.030865,0.030539,0.502077, &
            -0.030863,0.619953,-0.311211,0.202637,-0.358302,-0.009662,0.020208,0.235682, &
            0.117993,0.291772,-0.164330,0.009532,-0.230787,-0.023597,0.023987,0.151157, &
            0.262387,0.237719,-0.190950,-0.040607,-0.237557,0.009281,0.191070,0.236312, &
            0.235583,0.392926,-0.155383,-0.133686,-0.254814,-0.017412,0.237964,0.070872, &
            -0.127281,0.602514,-0.749801,-0.477142,-0.385680,0.671204,-0.196387,0.484153, &
            -0.186175,0.983684,-0.455626,-0.712004,-0.307771,1.124016,-0.042158,0.662739, &
            -0.654374,1.002151,0.173903,-0.675262,-0.386358,0.815078,0.020257,-0.321145, &
            0.064500,0.464591,-0.133100,-0.432714,0.005592,0.715644,-0.493275,0.070552, &
            -0.147352,0.297063,-1.020686,-0.528188,-0.527236,0.281161,-0.262445,-1.123611, &
            -0.150082,0.340436,-0.646033,-0.097655,0.059361,0.263285,-0.420986,0.429868, &
            -0.501688,-0.124334,0.232103,0.212712,0.170908,0.413675,-0.436473,0.617035, &
            -0.602716,-0.183350,-0.296085,-0.310897,0.811270,-0.147851,-0.344773,-0.214714, &
            -0.579196,-0.179959,-0.124454,-0.211440,0.511910,0.474447,-0.433246,-1.375229, &
            -0.584566,-0.404860,0.197353,-0.205843,0.717983,0.205358,-0.103287,-1.291379, &
            -0.233494,-0.305212,0.090580,0.002546,0.115331,-0.025391,-0.310834,-0.113477, &
            -0.296976,-0.011596,-0.173472,-0.036648,0.027261,0.033721,-0.534457,-1.034218, &
            -0.339742,0.090901,-0.597528,0.106641,-0.009337,-0.012528,-0.602303,0.284942, &
            -0.166548,0.006521,-0.159858,-0.010163,-0.066986,-0.006430,-0.384862,0.286433, &
            -0.181339,-0.001085,-0.048359,0.018540,-0.057929,-0.005557,-0.361871,-0.040122, &
            -0.186074,0.023236,-0.097054,-0.074826,0.019352,0.020600,-0.410375,0.015721, &
            -0.082251,0.053278,-0.014043,-0.050091,-0.040157,0.016008,-0.232969,-0.027964, &
            -0.048184,-0.097387,-0.044983,0.027231,-0.007205,-0.008547,-0.057070,0.323351, &
            0.040364,0.227062,-0.073039,-0.105995,-0.119937,0.068719,-0.072419,1.814204, &
            0.030322,-0.211884,0.016561,0.082973,0.032648,-0.024963,0.280735,1.603935, &
            0.145553,-0.116561,0.158889,-0.174827,-0.063085,0.047368,0.219985,6.617942, &
            0.010652,0.245060,0.051372,-0.061300,0.013383,0.020999,-0.027267,3.092593, &
            0.028078,-0.247016,0.103100,0.060591,-0.034405,-0.060204,0.166749,3.716642, &
            0.150383,-0.052428,0.052265,0.023526,-0.258213,-0.021061,0.106778,3.668111, &
            0.067782,0.067103,0.029166,0.032319,-0.033671,-0.011278,0.155012,2.892289, &
            0.008139,-0.079204,0.077826,-0.000992,0.091143,0.001848,0.086396,2.696531, &
            0.217223,0.129045,0.104773,-0.160596,-0.139667,0.096502,0.265009,2.522722, &
            -0.065840,0.194343,-0.377421,0.257366,0.014135,-0.123880,-0.083385,4.276219 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.214306,1.018900, &
            -0.501673,0.231987, &
            7.696880,0.461357, &
            -0.422146,-1.794596, &
            2.917197,1.791471, &
            6.245181,-3.631553, &
            -0.924891,0.144283, &
            -0.072930,-0.734167 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.723952,-2.294695/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.26453,-0.491234,1.924397,0.121242,2.331489,0.717318,-1.119109,-0.027675/)
real, dimension(2) :: bias2 = &
(/-1.002005,0.094708/)
real, dimension(1) :: bias3 = &
(/0.197305/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
