module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.260247,-0.113461,-0.075388,0.300437,-0.076404,-0.021509,-0.172746,-0.184749, &
            0.323615,-0.073261,0.017091,-0.043600,-0.067891,0.053307,-0.069061,-0.001788, &
            0.223780,-0.001150,-0.138204,0.100035,-0.038992,-0.044694,0.036048,-0.057251, &
            0.063681,-0.087468,0.004741,0.067186,-0.015145,-0.004035,-0.122307,0.017630, &
            -0.115123,-0.111525,-0.095833,0.137354,0.002914,-0.038271,-0.112871,-0.039116, &
            -0.138421,-0.099157,-0.006243,0.009339,-0.043912,-0.016282,-0.083360,0.093686, &
            -0.377847,-0.258958,-0.041670,0.120818,-0.003711,-0.038095,-0.303776,0.056197, &
            -0.648858,-0.363414,-0.022776,0.335590,-0.055074,-0.057922,-0.482580,0.088326, &
            1.110740,-0.973328,-0.239821,2.098889,0.598224,-0.511503,-1.471278,-0.559088, &
            0.919387,-0.443025,-0.139617,0.068673,0.591204,-0.147510,-0.622241,-0.380574, &
            -0.404470,-0.048477,0.015067,-0.363782,0.273925,0.027183,0.021386,-0.261790, &
            -1.205404,-0.216404,-0.002239,-0.101960,-0.048056,0.079046,-0.265255,-0.175944, &
            -0.442376,0.012917,0.115213,-0.302988,-0.289282,0.087134,0.137574,0.052024, &
            0.112906,-0.125953,0.195677,-0.476566,-0.097764,0.130496,0.088136,0.248549, &
            0.423279,0.006758,0.250576,-0.663983,0.076013,0.149601,-0.002503,0.235964, &
            0.038100,-0.144741,0.130221,-0.342390,0.358371,0.099071,-0.112816,0.111799, &
            0.284946,-0.166183,0.072717,-1.141669,0.431710,0.109297,-0.024382,0.193433, &
            -0.023935,0.304350,-0.002517,-2.184101,0.084173,0.185932,0.345240,-0.056982, &
            -0.743560,0.080475,-0.048495,0.231543,0.800718,0.067650,0.311778,-0.436823, &
            -0.475247,0.299412,0.110656,0.424484,0.014324,0.118806,0.396517,-0.527456, &
            -0.511211,0.085120,-0.080828,0.575450,-0.385893,0.061226,0.165414,-0.619430, &
            -0.358454,0.060583,-0.050196,0.608979,-0.415156,0.049060,0.144553,-0.465627, &
            -0.323377,0.110493,0.019957,0.579091,-0.521977,-0.036756,0.078960,-0.180117, &
            -0.103316,0.018912,0.123078,0.580649,-0.507350,-0.011829,-0.181785,-0.129819, &
            0.120301,-0.071348,0.139121,0.637848,-0.565695,0.047873,-0.168554,-0.135632, &
            0.393492,-0.204130,0.245955,0.544215,-0.944941,0.118124,-0.211932,0.011365, &
            0.056790,-0.663424,0.442141,0.345634,-3.929015,0.828802,-0.260242,0.278483, &
            0.377878,-0.213511,0.358164,-0.235225,-3.440065,1.118903,-0.234456,0.267025, &
            0.228552,-0.022507,0.160456,-0.303802,-0.395491,0.916149,0.203643,0.384200, &
            0.126488,-0.267172,0.161172,-0.927661,0.053850,0.700507,-0.007174,-0.086589, &
            0.123509,-0.131636,-0.158074,-0.023570,0.317317,0.495442,0.327639,-0.047880, &
            0.149739,0.213306,-0.148780,-0.409808,-0.525495,0.152853,0.186891,0.331549, &
            1.032575,0.069109,-0.017296,-0.117666,0.047325,-0.057294,-0.050115,-0.109173, &
            -0.518150,-0.002727,-0.214616,0.034151,-0.198703,0.037121,0.095722,-0.307994, &
            0.421875,0.012494,-0.193104,-0.103695,-0.657236,0.179899,-0.196887,-0.214127, &
            2.114369,-0.257516,-0.450037,-0.123108,1.038371,-0.215813,0.003500,-0.097197, &
            -0.144163,-0.015408,-0.040599,0.497604,-1.041379,-0.077956,0.638397,0.306106, &
            0.090065,0.088480,-0.269118,0.521243,-0.197200,0.020885,0.578019,0.192352, &
            -0.656713,0.017810,-0.303584,1.004728,0.320161,-0.295223,0.584674,-0.111409, &
            -0.715065,0.247721,-0.292109,1.733698,0.177735,-0.283129,0.719615,-0.504934, &
            -0.211039,-0.073077,-0.384830,2.060095,0.663101,-0.442765,0.742011,-0.249078, &
            0.079730,0.056496,-0.220865,2.299004,0.311231,-0.443203,0.280534,-0.263499, &
            0.312699,0.335396,-0.206292,2.667601,0.409133,-1.013914,0.197121,-0.020508, &
            0.173242,0.109400,-0.436706,2.903355,0.405902,-1.187208,-0.137906,0.026202, &
            0.459156,-1.055004,0.619262,1.295608,0.165263,-5.653713,-1.212549,-0.387050, &
            -1.082242,-0.772605,0.307663,-0.822467,-0.199841,-9.001840,-1.150599,-0.448225, &
            -2.672474,-0.448205,-0.061422,-1.890383,0.599722,-8.710915,-0.719954,-0.316231, &
            0.581496,-0.063398,0.735712,-1.192254,1.784468,-7.425362,0.162741,-0.647040, &
            0.491386,0.221979,0.308469,-0.746756,1.625386,-5.507800,-0.022446,-0.968228, &
            -1.000886,0.021241,-1.153012,-0.326553,-0.160143,-3.217157,-0.219609,-0.933142, &
            1.465311,0.152644,-1.204689,-0.653364,-1.071381,-1.782424,-0.070229,-0.747649, &
            2.024243,-0.186818,-0.743719,-0.669779,0.887887,-1.260979,-0.543860,-0.043077, &
            2.783520,-0.123182,-0.009766,-0.682252,1.613898,-0.439414,-0.280390,-0.678478, &
            0.740996,0.448461,-0.316394,-0.478677,0.037634,-0.881725,0.467945,-0.943695, &
            -0.067711,-1.064478,-3.255775,-1.290688,-0.062831,-1.709668,-0.060238,0.950124, &
            0.085455,-1.084245,-3.323155,-0.853631,0.306489,-1.424724,-0.270498,0.448239, &
            0.450671,-1.048113,-3.593620,-0.546438,0.067362,-1.403477,-0.316874,-0.073401, &
            0.409087,-0.990798,-3.644802,-0.264355,0.002265,-1.004387,0.171028,-0.327688, &
            0.400801,-0.782752,-3.620261,-0.157561,0.005962,-0.914273,0.226373,-0.166426, &
            0.068031,-0.215881,-3.761305,0.191917,-0.088416,-0.866714,0.300288,-0.267278, &
            0.302052,-0.287838,-3.707294,0.333547,-0.674196,-1.182768,0.041685,-0.066056, &
            -0.138015,-0.354906,-4.022772,0.206431,-0.572152,-1.044371,0.403778,0.150507, &
            -0.588210,-0.571804,-4.466853,0.112810,-1.360551,-1.549142,0.748676,0.673745, &
            -1.127548,-0.011219,-3.769874,-0.073072,-2.498269,-2.721007,0.780594,0.805127, &
            -1.182335,0.040355,-2.553533,-0.450640,-2.048996,-2.950307,1.429307,-1.022813, &
            0.557611,1.064220,-1.513065,-0.724800,-1.274155,-2.544055,0.965049,-1.849039, &
            -0.304110,0.261064,-1.167978,-0.750742,-1.388578,-1.784194,0.351544,-1.984525, &
            -0.648609,-0.100251,-1.480498,-0.475499,-2.225793,-1.197798,0.523012,-2.079114, &
            1.362776,0.424823,-1.447705,-0.005557,-1.685354,-1.043750,-0.031730,-1.201633, &
            2.214740,-0.123204,-1.398730,0.377370,-0.302473,-1.047260,-0.106534,-0.122893, &
            2.064243,-0.417665,-1.346260,0.343780,0.952973,-1.646011,-0.396890,-0.007847, &
            3.250254,-0.727564,-0.767628,0.082162,2.170997,-2.017182,-1.388556,-0.634301, &
            0.744132,0.199147,0.209394,0.260408,0.150593,0.022963,0.103943,0.010466, &
            0.264932,0.142692,0.043750,0.043577,0.138734,-0.012035,0.070203,0.009586, &
            0.077434,0.071224,0.138986,-0.124142,-0.138636,0.036771,0.150235,0.190585, &
            0.454067,-0.058687,-0.086062,0.027636,0.163086,-0.006881,0.032343,-0.030021, &
            0.256022,-0.029522,0.095789,0.096185,0.106575,0.131797,-0.068125,-0.138250, &
            0.362688,-0.010629,-0.048297,0.059033,-0.065195,0.062886,0.176169,0.085039, &
            0.344846,0.189739,0.041453,-0.062056,0.188858,-0.071079,0.071220,0.039225, &
            0.914571,0.200627,0.176504,0.093109,0.211242,0.165859,0.274830,0.010829, &
            3.174942,0.350294,0.276861,1.089128,0.728750,0.791930,1.050869,0.245293, &
            2.196587,0.260207,-0.050438,0.964026,0.668499,0.853581,1.484792,0.176765, &
            0.260815,0.505662,-0.157671,0.343974,0.394289,0.735993,0.924889,0.219071, &
            0.826163,0.598295,-0.103280,0.445358,0.210653,0.525922,1.060851,0.051775, &
            -0.839399,0.605649,-0.099098,-0.212044,0.286602,0.471617,0.938486,0.077745, &
            -0.313090,0.877319,0.563243,0.291833,0.637607,-0.435076,0.557756,-0.055536, &
            -0.481904,0.602243,0.607300,1.131339,0.501542,-0.528140,-0.134948,-0.206507, &
            -0.948825,0.357207,0.759999,1.025163,0.274511,-0.702334,-0.160951,-0.218367, &
            0.138633,0.486388,0.723747,1.033718,0.907922,-0.585359,-0.281322,-0.205019, &
            -0.048896,0.238453,0.656408,1.027204,0.132816,-0.413331,-0.434589,-0.347406, &
            0.104504,-0.553342,0.051137,1.409466,-0.190445,-0.156447,-0.631877,-0.292013, &
            -0.088021,-0.762648,0.175227,1.128646,-0.302261,0.062632,-0.627183,-0.178615, &
            0.820967,-0.654602,0.025653,0.778970,-0.333728,-0.017912,-0.589571,-0.229840, &
            1.063796,-0.480352,0.031437,0.317101,-0.446030,-0.053112,-0.640873,0.096431, &
            0.725645,-0.595702,-0.026473,0.185659,-0.547292,0.038269,-0.564828,0.157528, &
            0.421790,-0.392224,-0.006794,0.103849,-0.144892,0.006520,-0.596677,0.009299, &
            0.503561,-0.294946,0.088903,-0.063370,-0.237059,0.089683,-0.345061,0.058469, &
            0.752215,-0.351027,0.202329,-0.013473,-0.003673,0.144938,-0.281529,-0.092784, &
            1.828885,-0.324006,0.598078,-0.300761,-0.441912,0.907849,0.288862,-0.717395, &
            -0.002884,0.103076,0.500644,-1.104225,-0.441200,1.424751,0.821963,-0.879235, &
            -1.747584,0.073147,0.336354,-1.181032,-0.203315,1.289268,0.840526,-0.657125, &
            -1.473054,0.100513,0.450890,-1.740116,-0.628809,1.145168,0.979745,-0.202741, &
            -0.115374,0.218759,0.658459,-1.892691,-1.032021,0.880197,0.858855,0.480415, &
            0.855634,0.351834,0.252692,-1.495077,-0.755377,0.492816,0.689264,1.085093, &
            0.010850,0.517462,0.440843,-0.321721,-0.771744,0.178218,0.660038,1.004196, &
            2.081909,0.324916,0.333120,0.663468,-0.449752,0.148944,0.244836,0.605323, &
            1.610530,0.201602,0.310677,0.745307,0.226170,0.029432,-0.008556,0.353148, &
            1.051126,-0.124061,0.295665,0.699711,1.050177,0.542957,0.608750,0.772138, &
            -0.222278,-0.098083,0.017283,0.014866,0.165276,-0.000862,-0.017093,-0.054583, &
            -0.321343,-0.015185,-0.082101,0.108882,-0.036610,-0.015105,0.020557,-0.108054, &
            -0.315334,-0.041546,0.022970,0.026418,0.014634,0.010947,-0.068291,-0.034072, &
            -0.153927,-0.046535,-0.032842,0.001493,0.013317,0.013475,-0.011573,-0.066625, &
            0.025010,0.006989,-0.035134,0.068380,-0.015403,-0.019946,-0.025810,-0.060465, &
            0.020068,0.006167,0.084961,0.051840,0.030901,0.019463,-0.047975,-0.010590, &
            0.112455,-0.158167,-0.109683,0.082586,-0.071617,-0.015371,-0.162929,-0.037989, &
            0.033852,-0.131573,0.018860,0.300011,-0.024873,-0.010831,-0.210523,-0.034087, &
            -0.056010,-0.040322,0.263384,0.212078,-0.113317,0.078965,-0.093670,0.075352, &
            -0.678451,0.244757,0.155767,0.090877,0.004743,-0.043628,0.103867,0.062748, &
            -2.563228,0.034929,0.199700,0.588002,0.719138,0.057589,-0.004920,-0.433811, &
            -0.893096,-0.031057,0.286609,-0.105449,-0.308732,0.054308,0.002202,0.400620, &
            -0.110711,-0.154322,0.200392,0.696658,-0.357844,-0.135433,-0.497869,0.200587, &
            -0.113373,-0.305249,-0.182580,0.213679,0.209227,0.011170,-0.327702,-0.365392, &
            -0.305220,0.016623,-0.010254,0.108044,-0.270385,-0.008773,0.045348,0.104398, &
            -0.102348,0.134729,-0.084000,0.316516,0.058729,-0.128306,0.139249,-0.015015, &
            -0.306698,0.065808,-0.186898,0.158531,0.231801,-0.054735,0.082327,-0.462709, &
            0.457212,0.095071,0.036562,0.372805,0.002498,-0.065588,0.072670,0.062474 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.257314,0.450196, &
            1.891785,0.169928, &
            -1.835592,-0.549035, &
            0.618454,-0.820891, &
            2.374156,-0.300412, &
            5.261495,-1.190140, &
            -1.189475,0.376067, &
            2.022126,1.718974 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.255574,-0.534363/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-2.063926,2.782832,0.367675,0.468049,0.672715,-0.371695,-1.450791,0.755879/)
real, dimension(2) :: bias2 = &
(/-0.534473,-0.220105/)
real, dimension(1) :: bias3 = &
(/0.232597/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
