module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.399316,0.608008,-1.776300,-0.010315,0.194026,0.178257,0.257083,0.371589, &
            -0.297338,0.584360,-0.416714,-0.061204,0.158452,-0.323249,-0.410969,-0.081487, &
            0.092902,0.412329,-0.681900,-0.135956,0.023944,-0.349334,-0.352533,0.050285, &
            0.785392,-1.163668,2.212407,0.344628,0.095238,2.598821,-2.224550,0.819878, &
            0.110806,0.001736,-0.631086,-0.047890,-0.731181,-0.139120,-0.151647,0.081434, &
            0.132224,1.092005,-0.185728,-0.095243,-0.080173,0.025497,0.162765,-0.336407, &
            -0.069976,0.469185,-0.319425,-0.119168,0.566393,-0.309496,-0.186352,-0.526599, &
            0.415936,-0.167928,-1.152075,-0.024570,0.418598,0.222302,0.382459,0.746596, &
            -0.310858,0.100938,-0.006507,0.030774,0.285576,-0.274343,0.097889,0.161291, &
            0.482695,0.297093,-0.574007,-0.053035,0.133308,-0.014826,-0.152408,-0.246778, &
            0.758137,0.004707,1.228731,0.660122,-0.042445,2.066728,-0.930673,0.867884, &
            0.114073,-0.100299,-0.012994,-0.111867,-0.181784,-0.080812,-0.138625,-0.101320, &
            -0.168676,0.773741,-0.185089,-0.086287,0.080280,-0.020498,-0.171512,0.082790, &
            -0.084769,0.284996,-0.040576,-0.017092,0.674704,-0.124933,-0.022274,-0.288562, &
            0.218171,-0.172639,-0.878729,0.022297,0.280415,0.152198,0.331492,0.331486, &
            -0.347832,0.192551,0.134738,-0.068918,-0.127921,-0.483092,0.304702,0.232008, &
            0.039820,0.243355,-0.485421,-0.108717,0.712609,-0.112857,-0.416946,-0.293749, &
            0.328970,0.887264,0.109373,0.907122,-0.055584,1.591016,-0.644061,1.159606, &
            -0.022951,0.045072,-0.030711,0.005701,-0.167672,0.042259,0.017045,0.106281, &
            0.016021,0.468396,0.004701,-0.062913,-0.432756,0.279051,-0.098099,0.332584, &
            0.018443,0.120793,-0.044828,0.031242,0.398312,0.075952,0.029421,-0.146715, &
            0.126594,0.096332,-0.642827,0.002227,0.186041,0.055555,0.190999,0.136302, &
            -0.438344,0.269605,0.398355,-0.032030,-0.232195,-0.439059,0.105879,0.278822, &
            -0.011159,0.823093,-0.704011,-0.190095,0.460225,-0.202633,-0.570404,-0.395046, &
            0.356070,0.612281,0.068235,0.217629,0.401321,0.872460,-0.453286,1.144303, &
            -0.049560,0.015865,-0.135854,0.034917,-0.271620,0.020841,-0.061285,-0.109353, &
            -0.084615,0.133442,0.004708,0.024444,-0.584458,0.144383,0.004331,0.284022, &
            0.016168,0.113721,0.033833,0.001283,0.557089,0.056663,-0.056153,0.027517, &
            0.110197,0.162201,-0.423027,0.032374,0.056212,0.095296,0.137245,0.088149, &
            -0.355237,0.305422,0.690178,-0.004026,-0.029073,-0.187890,0.036772,0.046664, &
            0.181304,0.773285,-0.293975,-0.471901,0.418120,0.113440,-0.602275,0.071267, &
            0.136104,-0.166883,0.494902,0.238543,0.605554,0.228919,-0.929709,0.966725, &
            0.045515,0.179767,-0.289992,-0.005753,-0.151742,-0.088051,-0.207195,0.155295, &
            0.010597,-0.276249,-0.001054,-0.116498,-0.463401,0.108075,-0.094623,0.309515, &
            0.044718,0.252741,0.032741,-0.016962,0.689823,-0.003202,0.042111,-0.103047, &
            0.101112,0.340915,-0.373719,0.001871,0.078424,0.001377,0.215539,0.045296, &
            -0.342518,0.226289,0.996089,-0.020815,-0.406866,-0.117260,0.215215,0.096723, &
            -0.124411,0.724569,-0.053845,-0.473478,-0.279899,0.062812,-0.857555,-0.044574, &
            -0.118755,-0.289728,0.553520,0.122573,0.951181,0.319326,-0.839201,0.949911, &
            0.035972,0.189653,-0.057209,-0.025421,-0.337637,-0.053785,0.025228,-0.009084, &
            -0.146505,-0.287484,0.040058,-0.003272,-0.605886,0.082615,-0.127014,0.205711, &
            0.082318,0.151267,-0.036566,-0.042238,0.754240,-0.032816,0.083784,-0.077718, &
            0.152344,0.247497,-0.324023,-0.071870,0.018857,-0.047525,0.206122,0.133621, &
            -0.508816,0.166917,1.211418,0.115137,-0.424245,0.023599,0.393861,-0.120735, &
            -0.098919,0.142885,-0.084449,-1.081975,-0.637014,-0.228011,-0.373020,-0.184906, &
            -0.365750,-0.624105,0.342017,0.390501,0.566171,0.133390,-0.930453,1.217495, &
            0.175105,-0.033486,-0.161797,0.002640,-0.263921,0.097544,0.044862,0.154336, &
            -0.194515,-0.366232,0.327681,0.069856,-0.497292,0.190139,0.188062,0.156893, &
            -0.020524,0.154386,-0.100714,0.012226,0.656344,-0.000929,-0.086374,-0.159185, &
            0.136940,0.379686,-0.428763,-0.004168,0.060605,-0.069112,0.263906,0.103201, &
            -0.461900,0.140154,1.576499,0.136071,-0.714705,0.146505,0.660400,0.096283, &
            -0.108239,0.193111,0.258131,-0.733220,-0.538802,-0.222022,-0.256189,-0.016588, &
            -0.474016,-0.579750,0.210556,1.401993,0.445724,0.436954,-0.881608,1.272443, &
            0.091402,-0.152343,-0.520819,-0.029036,-0.735021,-0.167818,-0.382679,0.106856, &
            -0.034232,-0.681895,0.011508,-0.042466,-0.806005,0.196799,0.136783,0.427375, &
            0.067612,0.268735,-0.055578,-0.003713,0.836587,0.081410,0.054083,-0.223989, &
            0.472783,0.247916,-1.239783,-0.597605,-0.291532,0.019254,-0.598181,1.612814, &
            -1.524586,-0.864375,3.119127,1.131375,-0.917046,0.187846,1.152373,1.092327, &
            -0.308331,0.759476,-0.149298,-9.025250,-0.342340,0.279663,0.436653,-0.176796, &
            -1.598607,-3.658951,0.673633,0.512506,0.023385,-0.187219,-2.763133,1.571862, &
            0.757853,0.597415,-2.023802,-0.116316,-3.009612,-0.616451,-1.729640,1.556289, &
            0.049632,-0.540010,-0.347927,0.805044,-1.691937,0.450392,0.953210,1.235720, &
            0.003422,0.147399,0.163428,0.076594,0.745695,-0.018377,0.491111,0.006433, &
            -0.235118,0.314393,-0.384550,-0.278743,-0.069298,-0.118003,-0.560089,-0.192881, &
            -0.859630,-0.866533,2.568262,2.034613,-0.114491,-0.023747,1.290035,0.842573, &
            -0.079799,0.150508,-0.387432,-21.402134,-0.121093,0.053170,1.092453,-0.262316, &
            -1.539928,-3.344167,0.282209,-6.281007,-1.976874,0.393503,-2.676394,0.551282, &
            0.519479,0.590671,-1.583362,-0.114150,-3.339058,-0.431536,-2.274321,1.475421, &
            0.094384,-0.463246,0.764482,1.084236,-0.437804,0.604221,1.087920,0.599692, &
            0.048652,0.073678,-0.113666,0.028785,1.344013,0.154928,0.080970,0.003345, &
            -0.349994,-1.138145,-0.033817,-0.049759,-1.342055,0.086379,-0.519718,1.010769, &
            -0.315291,-0.143477,0.963469,2.195071,0.016491,0.523874,-0.324695,0.450079, &
            -0.487770,-1.271061,-1.351220,-26.607069,2.152946,0.841165,1.116838,-1.921599, &
            0.320261,-2.542288,-1.825791,-9.201544,-4.993781,1.138097,-0.957386,-0.508541, &
            0.416448,-0.528031,-0.387894,0.248098,-1.871844,-0.461733,-1.375180,0.616945, &
            -0.550081,-0.566346,1.025895,0.889802,0.582966,0.157825,0.321586,0.595614, &
            -0.105934,0.717712,-0.146905,-0.138131,1.037635,-0.289100,0.083258,-0.646314, &
            0.184057,-0.239481,0.030778,-0.065527,0.379504,-0.002404,0.643406,-0.329558, &
            -0.163356,-0.213647,0.509108,1.190312,0.248444,0.011873,0.304102,0.202431, &
            0.135923,-0.708232,-0.331860,-19.237190,0.793527,1.854325,1.299160,-1.471619, &
            0.991470,-2.335071,0.177184,-7.630205,-2.423512,-0.760536,-0.288504,0.469277, &
            0.390026,-0.940891,-0.754025,-0.205030,-1.546840,-0.658230,-1.817172,0.690865, &
            -0.597488,-0.870746,0.466680,1.059524,-0.071170,0.124930,0.446960,0.468938, &
            -0.330617,-0.007556,0.056808,-0.038097,0.110205,-0.290159,-0.283025,-0.100530, &
            0.385077,0.258616,-0.294437,-0.056856,-0.153272,0.493812,-0.475084,0.068429, &
            -0.293439,-0.161984,0.671984,0.986160,-0.513303,0.107446,-0.035987,-0.164358, &
            0.333124,1.406227,-1.356764,-12.718768,0.191656,0.987838,0.101286,-1.615621, &
            -1.366452,-0.966402,-0.924191,-3.791191,0.250052,-1.476778,1.211821,1.544111, &
            0.093941,-1.336318,0.036014,-0.161768,-0.747590,-0.523587,-1.233114,0.358984, &
            -0.547691,-1.947083,0.656374,0.713850,-0.460779,0.455089,1.086235,0.549321, &
            -0.109329,0.738263,0.006094,-0.123524,0.299673,-0.225801,0.067049,-0.582845, &
            -0.058567,-0.820975,-0.185264,0.019635,0.538009,0.226889,-0.282167,0.967750, &
            0.005994,0.290433,0.658421,0.497942,-0.787085,0.208777,0.468268,-0.924110, &
            0.786238,5.357288,0.253187,-6.200846,-1.871040,0.399555,-0.995272,-0.897370, &
            -2.077759,-2.075825,-0.116200,-0.668972,-0.476387,-2.076309,1.040099,0.847249, &
            -0.153725,-0.244459,-1.173229,-0.846481,-0.348298,-0.646188,-0.859062,-1.087709, &
            -0.141501,-1.440406,1.170128,0.465921,-0.313021,0.407814,0.857659,-0.276931, &
            -0.157584,0.797234,0.228701,-0.092340,-0.024089,-0.249058,0.310216,-0.610356, &
            0.073488,-0.453793,0.260763,0.119987,1.010318,0.154887,0.443617,0.471142, &
            0.626350,-0.338866,0.219680,-0.089072,-0.974093,0.224434,0.718318,0.143956, &
            0.655630,4.535933,0.980638,-4.043435,-0.626063,0.563233,-0.067336,-0.056499, &
            -1.042084,-2.978169,1.381257,0.425333,0.553044,-1.501180,-0.217525,-1.135854, &
            -0.136970,0.630397,-1.214400,-0.880035,0.052279,-0.904301,-0.600013,-1.085126, &
            0.244571,-0.182922,0.709638,0.409403,-0.931732,-0.008058,0.466549,-0.177654, &
            -0.052158,-0.051946,-0.080757,0.110618,-0.182793,0.054564,-0.377610,0.160933, &
            0.019269,-0.087043,-0.082678,0.095028,0.605592,0.358995,-0.377334,0.295802, &
            0.090927,-1.022568,-0.143840,-0.009062,-0.000771,0.029610,0.243169,0.287587, &
            0.813455,8.136598,-1.079352,-3.090925,2.230626,0.770707,0.459689,-0.840877, &
            -1.071217,-2.696656,1.220290,-1.803318,-0.635842,-0.646832,-2.744772,1.043250, &
            -0.335073,1.325981,-1.231277,-1.101785,0.480041,-0.780759,-0.386310,-1.195389, &
            0.638681,0.305230,-0.354273,-0.417628,-1.644519,0.268734,0.895681,-0.592305, &
            0.143042,-0.226191,0.024987,-0.048450,0.353662,0.166137,-0.095433,0.227858, &
            -0.115700,-0.390798,-0.205904,0.041220,0.938151,0.329540,-0.440335,0.308605, &
            0.489719,-1.205629,0.270607,-0.198129,0.314092,-0.321183,0.853514,0.990261, &
            1.403096,7.657483,-4.423922,0.095295,-0.268702,1.397557,5.148219,-0.472727, &
            1.175255,-0.106871,1.738222,-0.342405,-0.710335,0.930941,-4.054084,0.988929, &
            -0.052127,1.412260,-1.592187,-0.917446,-0.670098,-0.921048,-0.322669,-1.247632, &
            0.794922,-0.055737,-0.453206,-0.005485,-1.081771,0.040393,0.704364,0.142981, &
            -0.315668,0.340341,0.154286,0.099756,0.374938,-0.060511,0.092971,-0.540598, &
            -0.087394,-1.069253,-0.234323,0.267565,-0.184800,0.282544,-0.125904,0.390475, &
            1.419258,-0.494078,-0.031791,-0.503970,0.427847,-0.045200,1.601734,0.934436, &
            1.497574,6.322227,-3.280139,-0.671449,0.394500,2.126964,6.601788,-0.442047, &
            3.917757,4.616243,-3.112313,-2.335942,4.056140,2.061962,3.311763,-0.318317, &
            -0.311405,1.130737,-1.106263,-0.571786,0.453885,-0.739653,-0.082452,-1.123318, &
            0.008057,-0.353341,-0.580460,-0.002398,-0.782841,0.020712,-1.031007,-0.002581, &
            0.169680,-0.106648,-0.414414,-0.093255,-0.217118,-0.107508,-0.105480,0.273082 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.590618,0.508464, &
            -1.931771,0.055621, &
            1.825630,-0.101808, &
            0.795224,4.650774, &
            2.969512,0.861007, &
            -2.994267,-0.674949, &
            -2.164568,0.669207, &
            -1.872035,-0.585642 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.662695,0.927551/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.224384,0.797745,-0.484606,-2.52178,1.342227,-2.207815,-0.391041,-1.563604/)
real, dimension(2) :: bias2 = &
(/-0.439523,-0.515505/)
real, dimension(1) :: bias3 = &
(/-0.229544/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
