module fnet_X2

! a = 0.015276
! b = -0.57708

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/-0.00236344,0.10339987,-0.19946644,0.2139483,-0.030128961,0.15317921,0.016348833,0.09222416,&
			0.09359648,-0.090866,-0.0773873,0.0874523,0.09961418,0.03436028,0.05392377,0.01877275,&
			0.007451453,0.055440195,0.085436,-0.07744798,-0.07414683,-0.10617603,0.06515189,-0.034436334,&
			-0.21735199,0.005648271,-0.08199749,0.05902164,-0.10644491,-0.05480073,-0.012551692,0.03125256,&
			-0.2675608,-0.006460821,-0.055492967,-0.034806814,-0.2664096,-0.09985002,0.015030344,0.15517478,&
			-0.08010302,-0.049725417,-0.033756096,0.034489647,0.08470103,-0.2226404,-0.06721579,-0.10870146,&
			-0.036375836,0.0871214,0.17113218,-0.1763174,-0.117469884,-0.020566396,0.041496284,0.08452252,&
			-0.16110584,0.07794019,0.002176553,0.13813278,-0.1771196,0.16651447,0.103733175,0.23217386,&
			-0.16165793,-0.28960246,-0.3361225,-0.2517249,0.18911555,1.6502348,-0.05626993,0.3179317,&
			-0.07481152,-0.17747408,0.096303776,-0.37011018,0.4546728,0.68600976,-0.34253868,0.30303872,&
			-0.40076163,-0.13628483,0.19002815,-0.6439374,0.030472638,0.31475478,-0.13806236,-0.17304637,&
			-0.38605264,-0.24112509,0.005873262,0.13364229,-0.2162053,-0.29045135,0.002501905,0.12139273,&
			-0.1282765,-0.20189473,-0.16811125,0.33388725,-0.010830322,0.026138447,-0.039676268,0.5304634,&
			-0.03477089,0.12465108,0.01454509,0.13737732,-0.098021254,0.104838915,0.10226043,0.14409584,&
			-0.10242274,-0.13738714,0.08946471,0.48644817,0.32381794,0.07838552,0.09103071,0.18849401,&
			-0.10636498,-0.33583817,0.17965864,-0.055378962,0.17445664,-0.04623155,-0.10036243,0.32018617,&
			-0.009779724,-0.34214112,0.33807617,-0.049013335,0.43279484,-0.57848364,-0.26098356,0.29825568,&
			-0.13887155,0.06535787,-0.14035502,0.078441754,0.14488617,-0.14198528,-0.15033056,-0.22832674,&
			-0.01442674,0.09344133,0.027764518,0.08318142,0.12136384,-0.004614071,-0.030171221,-0.021402849,&
			0.12496892,-0.005403914,0.19589421,-0.12760815,0.2763262,-0.15594837,0.10008255,-0.08914311,&
			0.034587294,-0.036013573,0.10535003,-0.12594125,-0.023874031,0.025651466,0.058972836,0.30653107,&
			0.16317329,-0.030473368,-0.102153026,-0.08569405,0.20810921,0.36173433,0.121703655,-0.08810835,&
			-0.16920866,0.07843541,0.030913064,-0.007608146,-0.028445737,0.18810081,0.23933461,0.13556537,&
			-0.09766405,0.16624537,-0.2140117,0.034743536,0.12691583,0.15729403,0.019241944,0.12652391,&
			-0.16633466,0.1002079,-0.040371027,-0.11207502,0.10209097,-0.0100681,0.08391176,0.12318336,&
			-0.30412567,0.065810405,-0.21928485,-0.19665387,0.20659678,0.03320436,-0.010293609,0.122016236,&
			-0.40754429,-0.019674797,-0.3251074,-0.1810008,0.067545064,-0.5380319,0.30135205,0.001997189,&
			-0.45239475,0.26377413,-0.43086225,-0.22055121,0.069519244,0.03863388,0.19293438,0.14591962,&
			-0.39654782,0.19581632,0.007900119,-0.1724248,-0.13878587,-0.5058172,0.3039624,0.043340076,&
			-0.044235054,-0.034336705,-0.39633957,-0.2885356,0.16504313,0.24770336,-0.051472563,-0.08335006,&
			0.06568389,0.14554387,-0.21736638,0.09287693,0.05953467,0.7019397,0.12194776,0.044880383,&
			0.31720045,0.47449696,-0.06063993,0.3640679,0.098240666,-0.055430986,0.03710428,0.14950038,&
			0.37456596,0.1876326,-0.045073748,0.29128993,0.12374082,0.36418632,0.31384692,-0.24387214,&
			0.8840982,0.47753125,-0.12143088,0.32201692,0.06696981,-0.025421534,0.2859319,-0.28615373,&
			0.37560305,0.5171175,-0.37931985,-0.02862479,0.20040537,-0.18815477,-0.22128955,-0.55360335,&
			0.99222296,0.48813787,-0.72096103,0.278486,0.16389826,1.1023599,-0.12947634,0.12962343,&
			2.5306838,-2.5137768,1.8340473,1.9144781,-2.0094142,1.5760306,-1.765861,-1.8029583,&
			2.3107388,-2.2303047,1.7060641,1.7979109,-1.8286315,1.7436569,-1.6585349,-2.1178582,&
			2.3047595,-2.4188578,1.4125698,1.668164,-1.5753179,1.7051647,-1.5374223,-1.6757679,&
			2.1569922,-2.0868452,1.5939822,1.6115712,-1.7076018,1.5033834,-1.8684558,-1.8535912,&
			2.2155056,-2.1724257,1.6537081,1.692557,-1.5946708,1.7578201,-1.6668782,-1.7759053,&
			2.188301,-2.378962,1.6407508,1.6644975,-1.4578569,1.9609058,-2.0136445,-1.8271978,&
			2.2603765,-2.548659,1.9812533,2.1069255,-1.9186785,1.9536012,-2.2764387,-2.1993155,&
			2.6083066,-2.401914,2.251035,2.295505,-1.9255297,2.125932,-2.4392095,-2.12378,&
			3.9191577,-3.7937317,3.9610615,3.8448327,-3.7473462,3.9886606,-3.9752052,-3.6462,&
			4.2792964,-3.8764992,3.7952867,3.6548827,-3.6707444,3.2631044,-3.674269,-3.6795611,&
			3.5265746,-4.043685,3.0253024,2.481687,-3.1889257,1.9339372,-2.7295275,-3.126525,&
			2.2792792,-2.8821046,1.0943778,0.7502207,-1.9754497,0.699501,-0.9470931,-1.7241651,&
			1.3834513,-1.9404261,0.52334553,0.43162608,-1.3846797,0.547391,-0.34357005,-1.0171018,&
			0.8777956,-0.9405254,0.5569404,0.18435809,-1.1878648,0.49194607,0.2189303,-0.6373193,&
			0.3626319,-0.17128822,0.1830947,-0.09421582,-0.6111866,0.24435435,0.32595438,-0.3946591,&
			0.3099984,-0.11182595,0.07950002,-0.16791713,-0.7992357,0.24714908,0.124325626,-0.57464224,&
			0.22034411,-0.08330455,-0.07207798,-0.16962838,-0.65141946,0.12656765,-0.06403358,-0.53752995,&
			0.19733053,0.079003625,-0.3406645,0.059709825,-0.12904827,0.005446377,-0.081919886,0.103291504,&
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.6575983,-1.4676905,&
			-4.5135727,1.9811615,&
			0.7159135,-1.8264372,&
			0.24233775,-1.5389671,&
			-2.8931937,2.7457592,&
			0.90245855,-1.1183532,&
			-0.86101234,3.4614055,&
			-2.5538857,2.7616847 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.27665,-0.71171/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/6.691,7.3433,7.3953,-5.5031,-6.4324,3.5878,-16.0856,-11.3193/)
real, dimension(2) :: bias2 = &
  (/3.4521,10.7268/)
real, dimension(1) :: bias3 = &
  (/0.68252/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 54
  !  inarray2(i) = inarray(55-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
