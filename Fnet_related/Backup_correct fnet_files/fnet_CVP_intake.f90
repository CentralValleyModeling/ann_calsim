module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.378394,0.481386,0.428095,-0.089424,-0.110587,-0.248038,0.707902,1.546947, &
            0.080961,0.093409,0.228903,-0.297544,0.205549,-0.284509,0.121652,0.883037, &
            0.094781,0.125116,0.371774,0.155107,-0.078857,-0.256416,-0.025925,0.792230, &
            -0.076763,-0.007901,0.211683,0.056152,-0.017503,-0.047829,-0.113052,0.633375, &
            -0.151729,-0.004095,0.134178,0.071722,-0.056023,0.104680,-0.186132,0.280949, &
            -0.069693,0.021398,0.236901,0.093516,-0.089881,0.053933,-0.076619,0.018684, &
            0.064349,0.117556,-0.092135,0.043172,-0.129211,-0.062783,-0.047218,0.224032, &
            -0.109791,-0.087209,-0.028521,0.084695,0.119076,0.069637,-0.134230,0.348589, &
            0.254549,-0.106051,-0.036649,-0.199597,-0.121478,-0.182849,0.096422,0.328809, &
            0.135384,-0.311752,0.217464,0.195888,0.146700,-0.046396,0.114485,0.371451, &
            -0.062805,-1.079971,-0.463256,0.876764,-0.296571,0.138303,0.049255,-0.383993, &
            -0.085706,0.293484,0.181552,0.733840,-0.509490,0.546605,0.185527,-0.429137, &
            -0.352958,0.016747,-0.225253,-0.006658,-0.312083,1.079437,0.460983,-0.776623, &
            -0.129486,-0.141031,-0.901837,-0.012272,0.030470,1.059147,0.308336,-0.671256, &
            0.035592,-0.136960,-0.567868,0.130108,0.326084,0.343192,0.154131,0.154217, &
            -0.173936,-0.414706,-0.559548,-0.115741,0.397928,0.123991,0.550046,0.485361, &
            -0.000809,0.003493,-0.866913,-0.367933,0.389616,0.263909,0.753762,0.713128, &
            -0.476126,-0.387262,-0.751360,-0.723016,1.727178,0.477859,-0.546672,0.796631, &
            0.138181,-0.660980,0.132376,0.385260,-0.041043,0.104754,0.817492,-0.183913, &
            -0.261157,-0.910780,0.573967,0.344238,-0.057032,0.228421,0.620578,0.100738, &
            -0.357092,-0.305126,0.753833,0.276007,-0.245300,0.404968,0.620371,-0.094032, &
            -0.179003,0.289595,0.588385,0.075209,-0.195724,0.116634,0.174170,-0.280855, &
            0.025509,0.264529,0.409135,0.050752,0.101881,0.232405,0.018342,-0.586248, &
            -0.085206,0.347286,0.666761,0.098888,-0.199558,0.131744,-0.060285,-0.468463, &
            -0.129231,0.077573,0.845240,0.259721,-0.194548,0.023986,-0.052904,-0.436740, &
            -0.165031,0.087222,0.855890,0.244268,-0.123066,0.058372,-0.125119,-0.300896, &
            -0.547822,-0.446009,0.780522,0.600753,0.096163,-0.370424,0.013041,-0.503150, &
            -1.164133,-0.459335,0.557481,0.647973,-0.127032,-0.456704,-0.550831,-0.068326, &
            -0.736618,0.581199,-0.092531,0.044358,-0.158572,-0.390960,-1.004229,0.366339, &
            -0.813177,0.156516,0.141679,0.398680,-0.389494,0.244085,0.111226,-0.404878, &
            -0.425329,-0.003570,0.818256,0.786390,-0.468788,0.044524,-0.289151,-0.767207, &
            -0.047127,0.362421,0.847512,1.001972,-0.387113,-0.217763,-0.297984,-0.039858, &
            -0.150465,0.147767,-0.100637,0.539003,-0.383592,-0.098385,-0.078576,0.025622, &
            0.350866,0.263104,0.338425,0.627986,-0.367467,-0.097179,0.627933,0.616696, &
            -0.171691,0.055842,-0.567816,-0.158941,0.073102,-0.048085,-0.309925,0.593740, &
            0.069905,-0.510253,-2.535964,-0.475118,0.591418,0.005455,-0.730624,-0.243072, &
            -0.125451,0.142103,-0.869477,0.155599,-0.384331,0.369671,-0.476657,-1.130041, &
            0.665511,0.833869,-0.072697,-0.180860,-1.093388,0.812446,0.198009,-1.068467, &
            0.518289,0.596535,0.221701,-0.612256,-1.114830,0.743306,-0.110393,-0.642857, &
            0.343022,0.446046,-0.069345,-0.984324,-1.026278,0.188541,-0.343380,-0.801719, &
            0.124316,0.016809,-0.458143,-0.935136,-0.586121,0.048985,-0.559180,-1.052415, &
            0.727057,-0.027329,-0.722080,-1.487581,-0.402675,-0.071447,-0.525532,-0.995627, &
            1.078067,-0.208987,-0.882714,-1.500866,-0.263532,0.119425,-0.262846,-0.831522, &
            1.987278,-0.055775,-0.785161,-1.969848,-0.008892,0.187894,-0.357307,-0.654504, &
            6.163328,0.071052,-0.639694,-3.774583,-0.225163,0.530215,-0.178661,-0.389868, &
            10.188111,0.386918,0.155608,-5.412187,-0.389827,0.955592,0.915859,-0.356035, &
            10.463194,1.544111,2.581019,-4.974865,-0.809853,1.959264,1.460297,0.796769, &
            8.191234,0.849014,1.907040,-2.510665,0.138193,1.254317,0.043640,0.485744, &
            6.208030,0.483899,1.624151,-0.909095,-0.080757,1.052053,-0.443913,-0.160442, &
            4.577859,0.275255,1.360910,0.337246,0.002121,1.287013,0.938888,-1.002493, &
            3.701484,0.402293,1.047623,0.348591,0.201143,1.475199,0.814925,0.307429, &
            2.096953,0.662288,1.026353,0.011677,0.426045,0.883093,-0.430466,2.237077, &
            1.451511,-0.024261,-0.024357,-0.131294,0.307996,-0.125323,-0.565044,1.679631, &
            1.454273,-0.319797,-0.273287,-0.267402,0.601330,-0.264932,-0.124553,0.570524, &
            -0.282921,0.343342,0.082557,-0.537776,-0.934210,0.314899,0.865353,0.660632, &
            -0.176536,-0.467338,0.687717,-0.777535,-1.556888,0.802532,0.743026,1.406442, &
            -0.364221,-0.440965,0.944455,-0.819921,-1.936338,0.857456,0.210616,1.708484, &
            -0.461594,-0.447732,0.905661,-0.496727,-1.303837,0.384080,0.503165,1.107256, &
            -0.623457,-0.395544,0.725919,-0.693635,-0.745045,0.147882,0.525305,0.728801, &
            -0.539331,-0.259293,0.290451,-0.507561,-0.126277,-0.354603,0.457371,0.426201, &
            -0.767277,-0.074526,0.333146,-0.720362,0.215171,-0.507652,0.120315,0.241316, &
            -0.571942,-0.357755,0.036642,-0.378807,0.167837,-0.583821,0.230920,-0.015626, &
            0.315987,-0.534151,-0.967529,-0.377508,1.091261,-1.280569,0.059429,-0.431182, &
            2.009847,-1.269163,-0.803133,-0.622714,1.224246,-1.542438,-1.014444,-0.233336, &
            2.619159,-1.968124,0.782970,-0.119034,0.596531,-1.244271,-2.695859,1.332244, &
            3.007083,-0.453882,1.214238,-0.157914,0.597392,-1.381413,-1.448559,1.411978, &
            2.794041,-0.121501,1.312372,-0.624611,-0.370099,-1.262634,0.926009,1.107244, &
            1.994490,-0.345717,0.942603,-0.259778,-0.302874,-1.208901,1.402709,0.450710, &
            1.670214,-0.771647,-0.065508,0.135000,0.153924,-0.854932,0.521901,-0.108827, &
            2.193429,-0.779910,0.101865,-0.043361,0.245501,-1.189844,-0.387387,-0.547229, &
            2.209779,0.051732,0.255588,0.374589,-0.377471,-1.823215,-0.287351,-0.465280, &
            2.797554,0.885379,1.132032,-0.138473,-0.075874,-1.394752,-0.782801,0.530945, &
            -0.126008,-0.424501,-0.069794,-0.317638,0.326336,-0.203851,-0.108073,0.042985, &
            0.022504,-0.211111,-0.057210,-0.319522,0.304036,-0.251939,-0.013164,0.063963, &
            -0.090750,0.031296,-0.133154,0.016652,0.083845,-0.007788,-0.233447,0.137147, &
            0.033103,-0.138542,-0.065422,0.047834,-0.039091,-0.072545,0.165044,0.024268, &
            -0.052367,-0.189558,-0.032527,0.070918,-0.036161,-0.106683,0.162646,-0.092058, &
            0.092201,-0.105003,-0.165097,0.106023,0.061485,-0.132760,-0.049681,-0.054132, &
            -0.146196,-0.093690,0.037276,-0.222803,0.142190,-0.235316,-0.070348,0.134396, &
            -0.129571,-0.535097,-0.362021,-0.379509,0.402719,-0.126052,-0.113730,-0.045568, &
            -1.095988,-1.674495,-1.080066,-1.038386,0.347204,-0.744568,0.172939,0.098274, &
            -0.886176,-1.721430,-0.989360,-0.773552,0.552333,-0.757777,0.615095,-0.244201, &
            -0.461998,-0.477189,-0.106830,-0.588175,0.398267,-0.087956,0.194521,0.189522, &
            -0.049876,-0.375330,-0.067404,-0.864141,0.787486,-0.227826,0.254726,-0.222660, &
            0.329246,0.123485,0.169538,-0.638849,0.352273,0.303811,0.279531,-0.062153, &
            0.590768,0.550266,0.392855,-0.746117,0.521854,0.105576,0.027688,0.474656, &
            0.372992,0.880093,0.724908,-0.579419,-0.134234,0.255242,-0.342565,0.373312, &
            0.286684,1.380700,0.899100,-0.000803,-0.514106,0.302779,-0.252659,0.359384, &
            -0.050255,0.709790,0.629823,-0.371225,-0.069783,-0.059265,-0.675159,0.710817, &
            0.031113,0.836676,0.445298,0.246734,-0.461846,-0.087363,-0.474529,0.320778, &
            0.163813,0.251265,0.663399,-0.316342,-0.139626,-0.077545,-0.675937,0.038996, &
            -0.013690,0.004543,0.254732,-0.090547,-0.011364,-0.393490,-1.365371,-0.051706, &
            0.080668,-0.209759,0.010748,0.032947,-0.022462,-0.398858,-0.943314,0.293736, &
            0.156022,-0.442396,0.132789,0.069916,0.074840,-0.420039,-0.350216,0.219568, &
            -0.027118,-0.256552,0.332995,0.147082,-0.200185,-0.495998,-0.346016,0.018803, &
            0.182730,-0.092394,0.344449,0.238925,-0.125826,-0.424843,-0.159104,0.174202, &
            0.004135,-0.210644,0.097126,0.080657,-0.033641,-0.277514,-0.154839,0.197897, &
            0.050982,-0.063370,0.447947,0.235633,-0.019242,-0.218131,-0.351595,0.092904, &
            -0.622393,-0.198880,-0.022292,0.434368,0.323849,-0.295737,-0.589489,0.288426, &
            -1.233214,-0.382907,-0.038239,0.989503,0.563973,0.134380,-0.636787,-0.005111, &
            -1.058892,-1.176566,0.036287,0.739903,0.244236,0.422366,-0.481930,-0.431741, &
            -1.017605,-0.077856,-0.427395,0.585172,0.493721,-0.030977,-0.664299,-0.834237, &
            -0.394508,-0.425531,-0.884956,-0.077454,0.324653,0.026080,-1.157266,-0.354258, &
            -0.203931,-0.031054,-0.816022,-0.168093,0.231617,-0.183259,-0.651589,-0.155107, &
            -0.356334,-0.152307,-0.325587,-0.186786,0.080151,-0.168101,0.193639,-0.024021, &
            -0.041598,0.151108,0.117612,-0.759650,0.290011,0.523608,-0.183117,0.482977, &
            -0.794537,0.246569,-0.108913,-0.480325,-0.008191,0.276247,-0.153018,0.992901, &
            -0.882525,0.138506,-0.230360,-0.777090,0.083592,0.588764,0.104719,0.766205, &
            0.106020,-0.092889,-0.259400,-0.099992,0.039892,-0.052227,0.242573,0.147263, &
            -0.042618,0.154319,0.141996,0.059138,-0.202403,-0.022513,-0.179407,-0.082426, &
            -0.094910,0.059416,0.302328,0.043995,-0.166863,-0.064871,-0.246560,-0.024223, &
            -0.001330,0.028718,-0.026581,0.143455,-0.106778,0.053054,-0.053628,-0.044983, &
            0.020656,-0.011859,0.005860,0.007687,0.007411,-0.025357,-0.024041,-0.032691, &
            0.007131,0.042975,0.161310,-0.059753,-0.033567,-0.083888,0.062114,0.104300, &
            0.016710,0.027433,0.082625,0.117941,-0.087787,0.034693,0.002630,-0.132525, &
            0.065047,-0.099158,-0.059048,-0.039706,0.055292,-0.132391,0.075863,0.114223, &
            -0.092644,-0.093216,-0.208341,0.060181,-0.009618,0.216536,0.196082,0.054261, &
            -0.085581,0.049654,-0.178122,-0.220162,0.157244,0.147497,0.029675,0.104856, &
            0.203169,-0.077639,-0.068724,0.070407,0.142426,-0.225318,-0.016829,0.052369, &
            0.005127,-0.096354,0.252908,0.093347,0.010527,0.048109,0.260594,-0.049431, &
            0.003449,0.208712,0.073808,0.198305,-0.413936,0.016788,-0.208522,-0.274470, &
            0.082226,-0.011150,0.177736,0.077270,-0.204197,-0.175423,0.059280,-0.083192, &
            0.058485,-0.024730,-0.179255,0.029969,-0.078670,-0.053650,-0.076555,0.080522, &
            -0.063292,0.242436,0.122272,-0.005540,-0.186400,0.157624,0.019587,0.010005, &
            0.009478,0.009095,0.218845,0.206902,-0.077957,0.030287,0.152974,-0.116186, &
            0.095154,-0.057593,-0.731518,-0.079276,0.015202,-0.005904,-0.053741,0.360183 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.699410,-2.033915, &
            0.800820,2.045487, &
            0.159472,-0.628787, &
            0.702066,1.621417, &
            0.478442,1.408096, &
            -1.496539,-0.974200, &
            1.830060,4.666045, &
            -0.449508,-1.049878 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.81215,2.653732/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.666367,1.433014,-0.655781,0.305381,1.418324,-1.018513,1.102348,-1.217072/)
real, dimension(2) :: bias2 = &
(/0.011908,0.169973/)
real, dimension(1) :: bias3 = &
(/-0.162231/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
