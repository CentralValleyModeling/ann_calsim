module fnet_JP

! a = 0.0002308
! b = 0.06699

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.178623,-0.167727,0.148814,-0.248150,0.226973,0.030660,-0.183054,-0.132318 &
			,0.038124,0.023275,-0.059261,0.029234,-0.039802,0.045065,-0.131164,-0.005269 &
			,-0.049035,-0.017665,-0.074676,-0.075032,-0.059933,0.055699,0.031561,0.004662 &
			,0.061202,-0.020897,-0.006000,-0.059236,0.094686,-0.041077,-0.070656,-0.013886 &
			,0.018593,0.051487,-0.013866,-0.055029,-0.078464,-0.036735,-0.096683,-0.121044 &
			,-0.154694,-0.106138,-0.039732,-0.055585,0.118689,0.063786,-0.137101,-0.058785 &
			,0.000507,0.003274,-0.050199,-0.021500,0.168388,-0.014730,-0.072405,0.035874 &
			,-0.025790,-0.103842,-0.105664,-0.038086,0.048728,-0.012271,-0.056088,-0.107123 &
			,0.045378,-0.407568,0.251097,-0.059443,0.216593,-0.040481,-0.354538,-0.444767 &
			,0.141313,-0.691291,0.433246,-0.185758,0.372050,0.202414,-0.161125,-0.163375 &
			,0.797995,-0.516094,0.836183,-0.286249,0.343354,0.241701,-0.178435,-0.091803 &
			,-0.162587,-0.037260,0.149702,0.193403,0.104739,0.234820,-0.075496,0.470470 &
			,0.379750,-0.024209,0.330193,0.134593,0.154948,0.032023,-0.213270,0.055293 &
			,0.011037,-0.230765,-0.100452,-0.081035,0.184718,-0.103269,-0.009233,-0.294532 &
			,-0.009616,-0.347564,-0.353451,-0.086814,0.246522,0.194679,0.219007,-0.009060 &
			,-0.339920,-0.457752,-0.102280,-0.363473,0.271860,0.073957,0.096316,-0.383343 &
			,-0.753006,-0.541358,0.128072,-0.007387,0.127013,0.092191,-0.367694,-0.834564 &
			,-0.674601,-0.192940,0.098274,0.428874,-0.440338,0.214438,-0.239730,-0.733557 &
			,-0.538769,0.017277,-0.014881,0.059171,-0.093192,0.415007,0.065039,0.605877 &
			,-0.460881,-0.066218,0.008862,0.314391,0.042120,0.345354,0.115360,0.233383 &
			,-0.567667,-0.093567,0.067363,0.437525,0.009502,0.204110,0.120909,0.256295 &
			,-0.069074,-0.040085,-0.075853,0.209488,-0.126540,0.158066,0.366292,0.128661 &
			,0.217484,0.040096,-0.006749,0.117032,0.071714,0.126736,0.139214,0.094273 &
			,-0.017703,-0.195395,-0.057733,0.280455,0.049367,0.077264,0.360680,0.053454 &
			,0.219831,-0.215040,0.097322,0.260550,0.090939,0.022972,0.368089,0.104142 &
			,0.204757,-0.041830,0.203898,0.124729,0.192905,-0.155718,0.402937,-0.184902 &
			,0.468783,0.194572,0.207203,-0.272394,0.465353,0.321230,0.397572,-0.251025 &
			,-0.092525,0.120177,0.285003,-0.192092,0.563084,0.329299,0.145189,-0.163284 &
			,0.467751,-0.246876,-0.031364,0.196259,0.147098,0.744413,0.272561,-0.349512 &
			,0.988353,-0.349753,0.296215,0.089859,-0.421149,0.401830,0.471596,-0.654799 &
			,1.108640,-0.394750,0.870052,-0.092042,-0.042373,0.097397,0.141095,-0.521779 &
			,-0.264076,-0.350636,0.578356,0.044891,0.291933,0.142469,-0.194829,-0.058349 &
			,-0.497393,-0.208735,0.479221,0.067056,0.124751,-0.042559,-0.080411,-0.017376 &
			,-0.039375,0.290779,0.303901,0.206573,-0.326702,0.018124,0.047553,0.192125 &
			,0.240749,0.225727,0.475997,0.109197,-0.313940,-0.412030,0.129304,-0.197650 &
			,0.528800,0.609221,0.004299,0.227160,-0.116457,-0.653420,-0.046740,-0.142750 &
			,0.433637,2.798963,0.290255,-0.351923,-1.334628,-0.849510,-0.491842,-0.054590 &
			,0.759087,2.329566,-0.200691,-1.086145,-1.529338,-1.205522,-1.259041,0.475552 &
			,0.565999,2.681611,0.029004,-1.427221,-1.579616,-1.176264,-1.758813,0.848574 &
			,0.823599,2.819777,0.446952,-1.614650,-1.592320,-1.077544,-1.903127,0.633834 &
			,0.871591,2.701446,0.645544,-1.870886,-1.639879,-1.383401,-2.181033,0.392483 &
			,1.008824,2.826373,0.953277,-1.970216,-1.556515,-1.338150,-2.602091,0.822778 &
			,1.425988,2.629058,0.693116,-2.415582,-1.985354,-1.787938,-2.750518,0.933760 &
			,1.859306,2.281609,0.167235,-3.343453,-2.235885,-2.284750,-3.383527,1.220180 &
			,4.933144,0.210235,-2.526564,-5.890630,-4.060768,-4.676067,-6.074329,4.248429 &
			,4.070095,0.606442,-2.781858,-6.571020,-4.271400,-4.763150,-6.360529,4.413502 &
			,2.229420,1.396163,-3.651358,-5.695156,-4.302621,-4.080912,-4.310010,3.935829 &
			,1.309305,1.371511,-3.111053,-4.205411,-3.157176,-3.086911,-1.999735,3.397358 &
			,1.944104,1.545932,-2.620099,-3.469815,-2.136372,-2.207090,-0.478765,3.504975 &
			,1.963066,1.991001,-1.716268,-2.365739,-0.913649,-1.529528,0.126572,3.130307 &
			,1.287359,2.186250,-1.101978,-1.552434,-0.353918,-0.641524,-0.025322,2.289868 &
			,1.051917,1.740766,-0.487368,-1.106306,-0.185105,-0.164647,-0.237930,1.793067 &
			,0.901484,1.642901,-0.917019,-1.336095,-0.525334,-0.317481,-0.040284,1.791421 &
			,0.741566,1.710333,-1.089575,-1.971397,-0.444036,-0.618471,-0.636193,1.618658 &
			,0.515814,1.135080,-0.361851,-0.481794,-0.121628,-0.193194,-0.731560,0.549289 &
			,0.484018,1.228904,-0.495017,-0.744846,0.075710,-0.150584,-0.954146,0.472936 &
			,0.054937,1.186507,-0.331098,-0.601729,-0.187593,-0.178068,-1.032697,0.398659 &
			,-0.154980,0.969346,-0.262971,-0.809426,-0.101249,-0.329367,-1.110456,0.715241 &
			,-0.045475,0.761187,-0.289523,-0.607752,-0.280486,-0.338790,-1.081360,0.612975 &
			,-0.125253,0.860948,-0.409320,-0.792393,-0.236029,-0.615462,-1.002460,0.739399 &
			,0.110393,0.754911,-0.594404,-0.554147,-0.248431,-0.685618,-1.148929,0.675998 &
			,0.035495,0.596280,-0.359388,-0.807601,-0.416959,-0.684621,-1.400319,0.525403 &
			,-0.202893,-0.063831,-0.562531,-0.854274,-0.420441,-1.042653,-1.811530,1.010249 &
			,0.753576,-0.513698,-1.502941,-1.255620,-1.491688,-2.009057,-1.936252,1.764695 &
			,-0.181825,0.077761,-1.086028,-0.417145,-0.970910,-1.420427,-1.287885,0.700101 &
			,-0.872296,0.466436,-1.038903,-0.218685,-0.452131,-0.911965,-0.515444,0.056807 &
			,-0.641596,0.823527,-0.664561,0.298691,-0.198629,-0.200028,-0.390266,-0.098259 &
			,0.318499,0.692498,-0.866318,-0.097957,0.073930,-0.243133,-0.423322,0.146931 &
			,0.142254,0.648569,-0.871598,-0.186080,0.094420,-0.446254,-0.157464,-0.118853 &
			,0.144595,0.366671,-1.020534,-0.089726,-0.171248,-0.466131,-0.450888,0.060249 &
			,0.199343,0.588179,-0.623252,0.150470,0.001819,-0.282637,-0.220589,0.201973 &
			,0.587758,0.470984,-0.925182,0.073793,-0.200204,0.282917,-0.151537,0.076413 &
			,-0.888503,-0.241475,0.149985,0.338168,0.057806,-0.098576,-0.196902,-0.415999 &
			,-0.336685,-0.123915,0.106669,0.015459,0.172653,-0.019475,-0.097772,-0.017079 &
			,-0.310886,-0.044846,-0.114640,0.001990,0.093119,0.007608,0.027374,-0.044311 &
			,-0.228260,0.047126,-0.189097,0.047586,0.158109,-0.041584,-0.072680,0.057584 &
			,-0.038552,-0.045395,0.028671,0.070203,0.046203,-0.093976,-0.003685,-0.121265 &
			,-0.035724,-0.116104,0.005360,-0.181544,0.093447,-0.031605,-0.008846,-0.121646 &
			,-0.153111,0.057307,-0.052152,0.176929,-0.148424,0.044532,-0.150719,-0.079665 &
			,-0.692148,-0.007464,0.132835,0.205775,-0.116553,-0.143359,-0.385220,-0.232195 &
			,-1.137763,0.017175,0.391153,0.651499,0.177878,0.178934,-0.405361,-0.434859 &
			,0.118037,-0.292730,0.398364,0.294144,-0.149460,0.013889,-0.236819,0.453133 &
			,0.627611,-0.093948,0.459517,-0.106158,0.119116,0.356180,0.258627,0.341736 &
			,2.129865,-0.158511,0.566036,-0.087622,0.037988,0.224148,-0.010871,0.351696 &
			,2.202740,0.261284,0.380395,-0.418626,0.463827,0.506166,0.428914,0.400096 &
			,0.746577,-0.041364,0.422499,-0.051634,0.131601,0.136824,0.089198,0.587076 &
			,0.581257,-0.008754,0.625903,-0.093148,0.640072,0.216699,-0.229409,0.021421 &
			,0.420723,-0.199493,-0.081381,-0.404969,0.637464,-0.147746,-0.556226,0.684267 &
			,-0.803973,0.154280,0.165600,-0.144102,-0.223207,-0.195190,-0.666631,0.291851 &
			,-0.136100,0.020983,0.007671,-0.321024,-0.095152,-0.297695,-0.569099,0.128972 &
			,-0.424681,-0.027388,-0.300488,0.067908,0.001686,-0.069340,0.088777,0.338309 &
			,-0.167792,0.252572,-0.349791,0.071161,0.136078,-0.090538,0.161561,0.071108 &
			,-0.279099,0.217530,-0.359200,0.196458,-0.067422,0.002039,0.101639,0.188877 &
			,-0.336522,0.024694,-0.342727,0.031427,-0.086705,0.099458,0.230935,0.099797 &
			,0.054098,-0.005481,-0.378472,0.379671,-0.072769,-0.031877,0.128837,-0.002386 &
			,-0.095055,0.006979,-0.628093,0.128227,-0.059911,0.114308,0.252220,-0.035239 &
			,-0.036045,0.010794,-0.744688,0.296692,0.038946,0.178364,0.320920,0.080052 &
			,-0.203909,-0.148769,-0.373798,0.382653,0.069805,0.043888,0.281882,-0.064851 &
			,0.209131,-0.311730,-0.156319,0.523043,-0.128262,0.332586,1.032377,-0.700711 &
			,1.168954,-0.635116,0.026741,0.655180,0.234073,0.472861,0.925156,-0.546889 &
			,1.972559,-1.233278,0.269121,0.137278,0.262747,0.370895,0.490580,-0.053221 &
			,1.227298,-0.818563,0.449148,0.174053,0.256848,0.207016,0.292225,0.207187 &
			,0.511880,-0.768381,0.492627,0.319567,-0.021954,-0.033713,0.507472,-0.341552 &
			,-0.415800,-0.532100,0.544956,0.386660,-0.031698,-0.149582,0.299020,-0.188524 &
			,-0.370781,-0.185490,0.535695,0.141517,-0.309594,-0.098920,0.378034,-0.066484 &
			,-0.586469,-0.201083,0.099880,0.047659,-0.400366,0.103677,0.009960,-0.383805 &
			,-1.673440,-0.270115,0.057512,0.368799,-0.201398,0.027411,0.099710,-0.750299 &
			,-1.685760,-0.085920,-0.436454,0.244175,-0.422500,-0.542120,0.029280,-0.604071 &
			,0.277245,0.045788,-0.158921,0.081640,0.043664,0.060746,-0.080929,0.024735 &
			,0.064109,-0.001053,0.004001,0.205117,-0.012091,0.098085,-0.079301,0.178057 &
			,-0.108902,0.028477,-0.126772,0.118708,-0.019051,0.040383,0.013588,0.090302 &
			,-0.049310,0.090606,-0.233197,0.032196,-0.110964,0.215697,-0.027570,0.027172 &
			,0.031794,-0.050650,-0.098704,0.044915,-0.002084,0.088856,-0.040418,-0.080874 &
			,0.117631,-0.029955,-0.124349,-0.052771,0.015881,0.121422,-0.071718,-0.094106 &
			,-0.090988,-0.033111,-0.105738,0.012837,0.006399,0.025270,0.077086,0.026163 &
			,-0.013774,-0.051927,-0.101609,-0.058552,0.000955,0.147214,-0.072063,-0.079557 &
			,-0.019188,0.082604,-0.189021,0.034329,-0.119847,0.041830,-0.221899,-0.363338 &
			,0.101627,0.131350,-0.282017,-0.143870,-0.184727,0.064801,0.077588,-0.246066 &
			,0.358230,0.196361,-0.384327,0.260678,-0.132610,0.002658,0.145643,-0.053711 &
			,0.479135,0.063003,-0.267866,-0.248319,-0.001229,-0.012524,-0.041385,-0.469724 &
			,0.354331,0.085429,-0.412531,0.007297,0.251886,-0.315742,0.124557,-0.221491 &
			,0.424374,0.074503,-0.164271,0.451655,0.273487,-0.634000,0.066667,-0.312634 &
			,-0.390007,0.067181,0.156981,0.126190,-0.331548,0.021844,-0.171425,-0.122864 &
			,-0.035710,0.156559,-0.339612,0.070252,0.093182,0.030821,0.132374,0.212681 &
			,0.196701,0.240503,-0.072585,0.146770,0.135012,0.019584,0.078602,0.481431 &
			,-0.034617,0.073125,0.032625,-0.167657,-0.068199,0.281142,-0.022072,0.326791 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.644080,-0.779222 &
			,0.518663,2.079904 &
			,-2.059436,-0.163710 &
			,-4.305090,-1.483912 &
			,-3.742731,0.933307 &
			,-3.450041,0.417927 &
			,-4.863144,1.333277 &
			,1.984414,-0.188303 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.200621,1.457336/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.32391,0.985056,1.187034,1.125567,0.761719,0.75595,0.970665,-0.90145/)
real, dimension(2) :: bias2 = &
(/0.287173,0.035056/)
real, dimension(1) :: bias3 = &
(/0.200062/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
