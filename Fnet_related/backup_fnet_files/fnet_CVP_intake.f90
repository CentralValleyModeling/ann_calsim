module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.144715,0.064147,0.148492,0.124978,-0.507890,0.225178,0.494826,0.783860 &
			,-0.103495,0.140168,-0.015740,-0.000871,-0.262350,0.102935,0.432781,0.338961 &
			,-0.064205,0.226464,0.014503,0.033332,-0.301252,0.164055,0.309663,0.458553 &
			,-0.041015,0.016401,0.207236,0.072140,-0.202101,0.109610,0.188367,0.144512 &
			,-0.045234,-0.072717,0.138968,-0.033501,-0.141225,0.028042,0.206126,0.156648 &
			,-0.030942,-0.019793,-0.024183,0.234410,-0.019101,0.068036,0.429826,0.453964 &
			,-0.093135,0.048663,-0.048274,0.031325,-0.069706,0.023985,0.156909,0.432961 &
			,-0.144677,-0.021606,0.033503,0.024558,-0.304376,0.107570,0.431815,0.387931 &
			,-0.252626,0.043742,-0.205038,-0.169500,-1.008035,0.236567,-0.186678,0.427884 &
			,-0.289831,-0.355171,-0.580268,0.008423,-0.583602,0.258270,-0.581180,1.577444 &
			,0.039352,-0.657396,-0.440952,-0.028072,-0.375099,0.085534,-0.391307,2.462020 &
			,-0.276411,-0.167985,-0.902583,0.486181,0.121465,0.148414,-0.751253,2.495368 &
			,0.279773,-0.091625,-0.511862,0.286017,0.182771,0.063110,-0.530460,1.319776 &
			,0.160863,-0.160105,0.153894,0.201177,-0.075220,0.066542,-0.218381,0.628188 &
			,0.393930,-0.595231,0.191316,0.665910,0.226973,0.327991,-0.315887,0.279317 &
			,0.206219,-0.568554,-0.205294,0.752854,0.464356,0.371197,0.094516,0.561643 &
			,0.597825,-0.538171,0.230007,0.736981,0.663112,0.370259,-0.037144,-0.249828 &
			,0.208252,0.191987,0.227399,1.054561,0.850113,0.341237,-0.114344,-0.321160 &
			,0.003884,-0.779533,-0.130503,-0.026118,-0.708727,-0.060343,0.708234,-0.229326 &
			,0.184562,-0.728830,-0.199913,-0.057786,-0.700352,0.178950,0.622545,-0.225375 &
			,0.253759,-0.646321,-0.260623,-0.034473,-0.299819,0.207945,0.451163,-0.386032 &
			,0.173535,-0.940479,-0.005612,-0.398085,-0.201851,0.025640,0.635402,0.001727 &
			,-0.031954,-0.673179,0.066069,-0.053970,-0.150707,-0.078784,0.344855,-0.007173 &
			,-0.113785,-0.822472,-0.080610,-0.080178,-0.198940,0.108707,0.323174,-0.045152 &
			,0.030884,-0.491737,-0.075531,-0.281833,-0.198863,-0.172298,0.261041,-0.245738 &
			,0.086171,-0.399528,-0.067400,0.125114,-0.072718,0.070457,0.156716,-0.014847 &
			,0.070796,-0.307920,-0.297715,-0.088603,-0.170311,0.319113,0.253529,-0.518565 &
			,-0.031906,0.253511,-0.037632,0.099367,0.060418,0.589826,-0.215611,-0.425793 &
			,0.155644,0.507868,0.061937,0.239015,0.106689,0.487372,-0.110521,0.111699 &
			,-0.191966,0.331125,0.042122,0.396645,0.060314,0.343682,0.010165,-0.185637 &
			,-0.212214,0.275747,0.320534,0.118397,-0.099618,0.371273,0.346542,-0.240782 &
			,-0.244224,0.340865,0.251138,-0.126924,-0.052103,0.073604,0.740600,-0.146286 &
			,-0.274609,0.275868,0.042047,0.021598,-0.004832,0.112435,1.219298,-0.061863 &
			,-0.435210,1.314961,-0.411339,0.128433,0.122985,0.083126,0.785111,0.213281 &
			,-0.151077,1.543220,-0.212599,-0.082525,-0.101929,0.208027,0.857085,0.334466 &
			,-0.364236,1.892345,-0.294281,-0.084370,-0.235895,-0.043686,1.034924,0.253755 &
			,-0.162968,-0.347237,0.130618,-0.231305,0.071239,-0.166747,0.291471,0.948819 &
			,-0.161527,-0.176482,-0.320109,-0.148099,-0.298007,-0.599893,0.552358,1.099012 &
			,-0.166775,0.055639,-0.279807,0.088821,-0.478019,-0.547136,0.349948,0.821096 &
			,-0.044965,-0.097673,-0.160948,0.186661,-0.062246,-0.943426,0.321367,0.896719 &
			,-0.103523,-0.322754,-0.269822,-0.170835,-0.091133,-0.806895,0.387426,1.110379 &
			,-0.220618,-0.291887,-0.267100,-0.147344,-0.044841,-1.102872,0.398046,0.864947 &
			,-0.186311,-0.032522,-0.207592,0.090314,0.077675,-1.429186,0.340933,0.726169 &
			,-0.222074,-0.251196,-0.234171,0.087483,-0.222539,-2.012774,0.218438,0.677518 &
			,-0.553645,0.132258,-0.245763,0.401397,-0.297230,-3.530505,-0.021368,0.578487 &
			,-1.054066,-0.019539,-0.511159,0.324844,-0.548694,-4.089943,-0.391884,0.385714 &
			,-1.262914,-0.213847,-0.291382,0.420965,-0.568342,-4.127031,-0.465814,0.400973 &
			,-0.737862,-0.217711,-0.102636,0.779909,-0.033069,-3.718056,-0.445413,0.243721 &
			,-0.494093,-0.210209,0.207326,0.904892,0.078530,-3.280061,0.219500,0.281697 &
			,-0.567404,-0.179149,0.452494,0.827704,0.207790,-2.440918,0.290671,0.532435 &
			,-0.516750,0.101536,0.314738,0.733317,-0.018301,-1.664982,0.294651,0.401270 &
			,-0.588809,1.183750,0.420765,0.717760,-0.727711,-1.061243,0.222070,0.475459 &
			,-0.719483,1.074744,0.162196,0.665498,-0.434094,-0.863402,0.397903,0.586742 &
			,-0.998228,0.643450,-0.267509,0.649248,-0.424021,-0.899591,0.301463,0.766432 &
			,1.087588,-0.049103,-0.005826,1.102533,-0.938175,0.027492,0.682763,1.362209 &
			,1.102101,-0.066110,0.056431,1.191551,-1.200717,0.036074,0.555724,1.156170 &
			,0.785926,-0.024777,0.087696,1.132965,-1.382172,0.022117,0.607781,1.296915 &
			,0.511611,-0.159104,0.177960,0.678169,-1.175210,-0.158266,0.578158,1.391196 &
			,0.425089,-0.601885,0.495179,0.681531,-0.734230,-0.091940,0.724275,1.239710 &
			,0.122290,-0.744791,0.525636,0.524512,-0.504193,0.130893,0.733842,1.433670 &
			,-0.071996,-0.888429,0.394695,0.250876,-0.308918,0.008036,0.627479,1.395484 &
			,-0.234344,-0.899599,0.731191,0.270378,-0.317803,-0.184345,0.658850,1.595507 &
			,-0.338407,-1.120967,0.589565,0.112142,-0.027212,-0.524152,0.581971,1.441769 &
			,-0.164114,-0.453933,0.370756,0.443322,-0.591762,-0.929378,0.268964,0.581640 &
			,-0.273975,0.775017,-0.157275,0.669377,-0.537516,-0.484981,0.185792,-0.080506 &
			,0.046649,0.669792,-0.085303,0.429348,0.122010,-0.721824,0.248073,0.246471 &
			,-0.021947,0.147257,0.048061,0.033687,0.598633,-0.088811,-0.042497,0.502124 &
			,-0.113373,0.249484,-0.453775,-0.059133,0.332222,-0.127099,0.051230,0.034236 &
			,-0.045334,0.243210,-0.364050,-0.156950,0.252642,-0.087311,0.164003,-0.189336 &
			,-0.143516,0.005416,-0.337072,-0.560931,-0.075953,-0.333353,0.051683,0.233957 &
			,-0.531324,0.073443,-0.683690,-0.560194,-0.235847,-0.786641,0.463241,0.157239 &
			,-0.667998,0.622623,-0.275454,-0.578360,-0.604026,-0.917809,0.356896,0.390386 &
			,0.229688,-0.049679,-0.113180,-0.102034,0.168614,-0.003867,0.373962,-0.533723 &
			,0.200198,-0.074747,0.061850,0.116143,-0.056378,-0.018744,-0.029738,-0.226868 &
			,-0.193278,0.114461,0.003175,-0.103408,0.027901,0.051818,0.004915,0.058857 &
			,-0.081540,-0.198685,-0.084491,0.039481,-0.088975,0.033997,-0.052978,-0.075231 &
			,-0.049038,-0.161207,-0.183867,0.001978,0.190351,0.052756,-0.006347,-0.036091 &
			,0.015659,-0.006706,-0.033695,-0.060036,0.039788,-0.032574,0.002143,-0.132669 &
			,0.010660,-0.137932,-0.123071,-0.212434,-0.048604,0.000441,-0.030413,-0.067619 &
			,0.433765,0.242726,-0.058189,0.090865,0.199495,0.124072,0.077732,-0.531991 &
			,0.573584,0.005666,-0.354579,-0.292075,0.506208,0.275194,0.194744,-1.226778 &
			,0.634356,-0.398523,-0.512484,-0.169364,0.708032,0.450998,0.044234,-1.092750 &
			,0.145999,-0.141452,-0.049483,-0.301869,0.621941,-0.033004,0.212381,-0.198718 &
			,0.320676,-0.199960,0.019031,-0.216879,0.984523,-0.223930,-0.168145,-0.610945 &
			,-0.007929,0.011072,-0.178750,-0.188601,0.672103,-0.310625,-0.177243,-0.216096 &
			,0.116065,0.009679,-0.078312,-0.140248,0.582871,-0.717803,0.074921,-0.403721 &
			,-0.274445,-0.045476,-0.161187,-0.215697,0.386742,-0.874195,-0.426496,0.156915 &
			,-0.408868,-0.050462,0.149501,0.121595,0.422128,-0.750763,-0.104738,0.269394 &
			,0.048449,0.260206,0.097284,-0.073070,0.472221,-0.647886,-0.151230,-0.144183 &
			,-0.156437,-0.055901,0.070180,-0.079374,0.287959,-0.594004,-0.260633,-0.032134 &
			,-0.286829,1.022831,0.254181,0.037666,-0.320312,-0.467004,0.263164,-0.002790 &
			,-0.419536,0.656375,0.204191,-0.258174,-0.484617,-0.387885,0.270376,-0.133807 &
			,-0.192142,0.964528,0.090930,-0.218105,-0.528107,-0.216038,0.077440,-0.306537 &
			,0.130571,1.002013,0.096306,-0.323086,-0.514868,-0.209959,0.139367,-0.149601 &
			,-0.130047,0.781578,0.178852,0.049498,-0.275728,-0.168422,0.237064,-0.070919 &
			,-0.038839,0.948783,0.117058,-0.008567,-0.184671,0.009531,0.247202,-0.319165 &
			,-0.066935,0.869412,0.008897,-0.306748,-0.237404,0.085373,0.332244,-0.328245 &
			,0.170208,0.848045,0.091616,-0.181831,-0.433315,0.112151,0.228309,-0.134737 &
			,0.363947,0.296490,0.072127,-0.460312,-0.255904,0.594319,0.222467,-0.106543 &
			,0.674486,0.319887,-0.095823,-0.469081,-0.158195,0.695747,0.360361,-0.409585 &
			,1.108831,0.010306,-0.064959,-0.131544,-0.525625,0.642789,-0.056828,-0.572712 &
			,0.710112,0.156077,0.021745,-0.258580,0.055709,0.741542,-0.212403,0.042739 &
			,0.373123,0.215161,-0.100141,-0.406498,0.153064,0.303362,-0.037761,0.281658 &
			,0.290599,0.338701,-0.030657,-0.317617,0.051827,0.081781,-0.358558,0.537911 &
			,0.316488,0.140814,-0.093944,-0.053366,0.374517,0.116783,-0.116972,-0.069566 &
			,0.245702,0.095987,-0.232793,-0.178154,0.052262,-0.317465,-0.332323,-0.197013 &
			,0.592120,0.102230,-0.203159,0.021228,0.331001,-0.228659,-0.447258,-0.423936 &
			,0.518303,-0.363881,-0.178138,-0.220120,0.427789,0.048524,-0.355910,-0.234145 &
			,0.024716,-0.123326,-0.197988,-0.093080,-0.086924,-0.045622,0.809135,0.181906 &
			,-0.280194,0.011543,0.072594,0.124294,-0.064270,0.027693,0.653131,0.072706 &
			,-0.190779,-0.051366,-0.021610,0.173248,-0.126744,0.068532,0.672775,0.038791 &
			,-0.152002,0.145663,-0.105232,0.032874,-0.197322,0.067691,0.766690,0.228656 &
			,-0.142827,0.162861,-0.039604,0.103031,-0.011239,0.039957,0.505937,0.022986 &
			,-0.136459,-0.037509,0.073232,0.055978,-0.032446,-0.024400,0.226736,0.050109 &
			,0.132503,-0.026338,0.118490,0.104304,0.088301,0.007240,0.235137,-0.164764 &
			,0.100954,-0.080538,-0.006889,-0.058963,-0.074900,0.019060,-0.108853,-0.012628 &
			,0.191874,0.128923,-0.117403,-0.094524,-0.000356,0.006510,0.332766,-0.035214 &
			,0.080794,0.213275,-0.265817,-0.139517,0.189777,-0.048602,0.150443,0.096163 &
			,0.163725,-0.191584,-0.240667,-0.071910,-0.028768,-0.062308,-0.280673,-0.020468 &
			,-0.061962,-0.046759,-0.293074,-0.120272,0.049547,-0.014210,-0.415283,0.113569 &
			,0.008859,0.034517,-0.244901,0.016031,0.100742,-0.047169,-0.562158,0.075934 &
			,0.049181,0.111990,-0.096482,-0.016123,-0.018704,0.036489,-0.602401,0.044605 &
			,0.049923,0.029335,0.143646,0.090853,0.077044,-0.020000,-0.301882,-0.047741 &
			,0.532473,-0.100278,0.121475,0.006665,0.221111,-0.006864,-0.145543,0.033192 &
			,0.280790,-0.081436,0.002678,-0.017964,0.198072,-0.094048,-0.035292,-0.007348 &
			,-0.229508,0.542213,-0.059265,0.052242,-0.106950,0.056458,-0.195366,-0.145604 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.756224,1.028737 &
			,-1.147693,1.041114 &
			,-0.965625,-1.102158 &
			,0.795748,1.048456 &
			,-2.039636,-1.508459 &
			,-1.398689,-3.837340 &
			,-0.875328,-0.299365 &
			,-0.197510,-0.758828 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.098913,-1.21504/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.794272,-0.626765,0.34556,-1.007147,1.397793,0.419045,-0.093222,0.133712/)
real, dimension(2) :: bias2 = &
(/-0.401064,0.026125/)
real, dimension(1) :: bias3 = &
(/1.146058/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
