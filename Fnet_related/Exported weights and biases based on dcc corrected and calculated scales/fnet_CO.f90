module fnet_CO

! a = 5.569e-005
! b = 0.090701

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.085621,-0.012090,0.174076,-0.013354,0.030837,0.069065,0.092938,0.063490, &
            0.013675,0.075047,0.000596,0.067371,-0.062496,0.009062,-0.016363,0.057986, &
            0.114115,0.145143,-0.112594,-0.042504,-0.085839,0.010992,-0.002253,0.049849, &
            -0.005215,0.088687,-0.084848,-0.104164,-0.166958,0.240740,0.107307,0.008176, &
            -0.106156,0.004102,-0.005003,0.099756,0.013574,0.185926,0.174288,0.057421, &
            -0.070273,-0.006446,-0.048422,0.001693,0.072576,0.059866,0.074907,0.009927, &
            -0.009936,-0.307813,-0.132727,0.013849,0.024116,-0.102746,-0.090018,-0.181338, &
            0.031070,-0.000033,0.072942,0.020959,0.079693,-0.230907,-0.091289,-0.047627, &
            -0.161818,-0.080882,-0.305925,0.297556,-0.113111,-0.074857,-0.298178,-0.165112, &
            0.244104,-0.275425,-0.028126,0.174158,0.085261,-0.091628,0.314398,0.092497, &
            0.364274,0.324682,-0.238918,0.195175,0.014795,-0.090670,0.282677,0.244081, &
            -0.082059,-0.339455,0.022130,0.701321,-0.195009,-0.000509,-0.331239,0.203038, &
            0.122192,0.225996,0.127273,0.192376,-0.042334,0.090871,0.259828,0.322357, &
            0.077746,0.192781,-0.227171,-0.097699,0.054034,0.372367,0.600331,0.087468, &
            -0.022554,-0.052117,0.174547,0.131319,-0.047469,-0.102942,0.027759,0.016225, &
            -0.240862,-0.221250,0.044201,0.284223,0.069007,-0.185594,-0.491597,-0.010148, &
            -0.245515,-0.195500,-0.525309,0.662320,0.650701,-0.482228,-0.053843,0.015822, &
            -0.095441,0.140870,-0.008264,0.321856,0.101623,-0.197169,-0.550502,0.209064, &
            -0.478988,-0.070447,-0.231614,0.148889,0.042923,0.115082,-0.481919,-0.153058, &
            -0.452157,-0.012433,-0.221378,0.019065,-0.117284,0.000620,0.029908,-0.145166, &
            -0.185947,-0.012160,-0.345340,0.137801,-0.187893,-0.081018,0.013412,-0.094372, &
            0.036137,-0.004348,-0.483156,0.092903,-0.210055,-0.062339,0.104416,-0.086422, &
            -0.071361,-0.153153,-0.318219,0.054960,-0.423256,0.122062,0.238960,-0.165166, &
            -0.066279,-0.027499,-0.450369,-0.024751,-0.017980,-0.035841,0.144072,-0.002578, &
            0.009421,0.112062,-0.371039,-0.148355,-0.175128,0.060212,0.065514,0.025013, &
            -0.264741,0.067352,-0.252729,-0.287813,0.033381,-0.056304,-0.009912,0.150229, &
            -0.067921,0.052124,-0.453363,-0.506607,-0.567994,-0.288388,0.812430,0.068260, &
            0.116359,-0.273166,-0.161030,-0.270978,-0.418411,-0.278390,0.593134,0.224196, &
            0.492295,-0.460022,0.560870,-0.017026,-0.798066,-0.133349,0.326254,0.212620, &
            -0.027376,-0.012134,0.216739,0.272952,-0.402901,0.029415,0.036055,0.202464, &
            -0.276721,-0.139643,-0.023690,0.270910,-0.149036,0.589465,-0.046932,0.254201, &
            -0.232916,-0.169626,-0.176878,-0.115317,0.092059,0.284358,0.228927,-0.069549, &
            0.174086,0.078384,-0.101077,-0.065467,-0.155873,0.251552,0.000347,0.127061, &
            0.055054,0.413193,0.171572,-0.051006,0.056649,-0.043691,-0.065814,0.262837, &
            0.166443,-0.313942,0.498927,-0.128838,-0.169072,-0.094595,0.252355,0.005057, &
            -0.132578,-0.165077,0.571877,-0.193119,-0.175490,-0.021598,-0.587894,0.028627, &
            0.883270,1.001848,0.984490,0.429637,1.238643,0.712310,-1.155693,-1.006647, &
            1.873352,1.635920,1.813156,1.472858,2.153948,1.813378,-2.352730,-1.613290, &
            1.166916,1.379350,1.761012,1.313523,2.032658,1.203577,-2.035117,-1.487597, &
            1.088611,1.210521,1.612745,1.310271,1.631331,1.242155,-1.608063,-1.010520, &
            0.863909,1.454101,1.310218,1.331498,1.480101,1.029103,-1.854676,-1.159479, &
            1.023022,1.323172,1.524601,1.726457,1.580339,1.406313,-1.771724,-1.362055, &
            1.524396,1.626813,2.114312,1.777519,2.181132,1.670832,-2.529703,-1.575468, &
            2.036331,2.072518,2.430914,2.219541,2.573715,2.180956,-3.222466,-2.282012, &
            5.438661,5.037706,5.610577,5.535802,5.563160,5.410836,-6.190901,-5.699892, &
            3.785295,5.023656,5.451196,3.704607,3.345950,3.458379,-2.736187,-4.686187, &
            1.365172,3.845385,3.951826,1.796181,0.586802,1.202429,0.157727,-3.234647, &
            -0.177515,2.778572,2.522531,0.741766,-0.330649,-0.027415,1.164669,-1.607784, &
            -0.524308,2.232021,1.683332,0.199636,-0.097486,0.702081,0.316138,-1.369917, &
            -0.652907,1.352758,1.013635,-0.288534,-0.273148,0.468612,0.057053,-0.567855, &
            -0.143354,0.509778,0.256542,-0.229320,-0.018279,0.281831,-0.399995,-0.155097, &
            -0.291296,0.329553,0.481945,-0.156301,-0.262969,0.110221,-0.097711,-0.411019, &
            0.004147,-0.023936,0.083418,-0.016221,-0.049625,0.011989,0.016124,-0.117517, &
            0.004153,0.359916,0.302672,0.483818,-0.490911,-0.307264,0.219245,-0.629483, &
            -0.288105,0.001644,-0.160590,-0.132932,0.016438,-0.022569,-0.289405,-0.183268, &
            -0.136316,0.323184,-0.047884,0.276717,0.259908,0.103800,-0.555261,-0.604725, &
            0.066372,0.351807,0.290026,0.309952,0.485870,0.483426,-0.827442,-0.552023, &
            -0.085567,0.541448,0.116760,0.061049,0.748576,0.106634,-0.838130,-0.265565, &
            0.243601,0.260279,0.075599,0.360026,0.439075,0.552353,-0.984578,-0.547555, &
            0.104269,0.288211,0.234766,0.413468,0.880764,0.286410,-1.115276,-0.349509, &
            0.300516,0.443598,0.170355,0.227444,0.640098,0.429501,-0.904415,-0.790397, &
            0.411102,0.183915,0.244646,0.197239,1.149703,0.680005,-1.444950,-0.687620, &
            0.723375,0.471582,0.554930,0.629160,1.331180,0.822965,-1.880362,-0.952349, &
            0.338192,0.609200,0.650910,0.135612,0.758275,0.534039,-1.480553,-1.187893, &
            -0.297291,0.529951,0.517150,-0.016620,0.159004,0.328612,-0.808094,-1.033392, &
            -0.563206,0.529898,0.271522,0.249217,-0.108710,0.026062,-0.588865,-0.608136, &
            -0.364758,0.117092,0.054034,0.169225,0.002132,0.147329,-0.475820,-0.661147, &
            -0.667311,-0.515499,-0.207822,-0.044259,0.136934,-0.202017,-0.235001,-0.244394, &
            -0.154367,-0.477325,-0.295077,0.146792,0.384151,-0.263587,-0.360333,-0.219443, &
            -0.407087,-0.589272,-0.423188,0.517874,0.538944,-0.196168,-0.560980,-0.266429, &
            -0.506886,-0.430593,-0.096793,0.306478,0.267176,0.017174,-0.118274,0.021846, &
            -0.339393,-0.254539,-0.272662,1.041321,-0.052633,-0.028677,0.345132,-0.390796, &
            -0.305181,0.485270,0.103410,-0.021355,-0.087865,-0.287995,0.259737,0.138608, &
            -0.206470,0.349223,0.378579,0.322888,-0.138830,-0.126152,-0.100609,0.219484, &
            -0.169365,-0.056889,0.193876,-0.032381,-0.016167,-0.126452,-0.211844,-0.056147, &
            -0.096302,-0.032926,0.113569,-0.012970,-0.314950,0.029937,-0.418901,-0.165064, &
            0.005780,-0.213545,0.037627,-0.070873,-0.083127,-0.062052,-0.048064,-0.102841, &
            -0.168402,-0.056818,0.284820,-0.007271,-0.090552,0.045272,-0.111105,-0.064072, &
            0.012680,-0.164546,0.023540,0.124620,0.190649,-0.119871,0.071543,0.020944, &
            -0.156674,0.148529,0.164887,0.391398,0.085282,0.047285,0.317880,0.013748, &
            -0.155564,0.078872,0.028915,0.012528,0.256959,-0.027837,0.773863,0.359126, &
            0.658544,0.624899,0.666176,0.220283,0.190218,0.248207,-0.058135,-0.122171, &
            0.064820,0.040146,0.274778,0.201574,-0.476754,-0.313859,0.317916,0.500806, &
            0.436760,-0.106830,0.446464,0.216499,-0.293548,0.225860,0.410050,-0.002187, &
            0.523647,0.424737,-0.104658,-0.587541,-0.528639,-0.391864,0.221968,0.184461, &
            0.538809,-0.196247,0.167926,0.020498,-0.176664,0.260059,0.448887,0.005012, &
            0.001098,-0.560764,-0.384732,-0.349563,-0.535068,-0.166082,0.220259,0.412665, &
            0.422752,0.145640,0.137965,-0.288590,-0.101061,0.447093,-0.836300,0.099010, &
            0.547123,-0.242439,-0.499478,-0.270363,0.313116,0.190448,0.019832,0.025372, &
            0.317886,-0.035566,-0.257016,-0.263071,0.432295,0.304044,-0.350745,-0.052365, &
            0.229828,0.073322,0.106285,-0.288040,-0.051905,-0.020585,0.098110,-0.020516, &
            0.088424,0.102680,-0.141734,-0.084918,-0.200558,-0.057103,0.168885,0.075315, &
            0.165284,0.069035,-0.071212,-0.227853,-0.248215,0.039579,0.266946,-0.051551, &
            0.099079,-0.122495,0.006030,-0.222521,0.127759,-0.097962,0.082831,0.055795, &
            0.140910,-0.132876,0.191072,-0.455791,-0.080221,-0.043112,0.012520,0.062399, &
            0.003802,-0.073388,0.177875,-0.448999,-0.250763,0.271514,0.133234,-0.042107, &
            0.233615,-0.129025,-0.102160,-0.317839,-0.136253,-0.022712,0.103407,-0.051645, &
            -0.104158,-0.173857,-0.032234,-0.327013,0.172380,-0.101827,0.020396,0.031310, &
            -0.383897,0.022282,-0.355166,-0.382399,-0.241274,-0.075719,0.911397,0.529566, &
            0.002264,-0.111943,-0.412944,0.172301,0.103920,0.157964,0.690339,0.443876, &
            0.257044,-0.206684,-0.438969,0.167300,0.103644,0.300783,0.702230,0.315355, &
            -0.167950,-0.275638,-0.227388,0.058662,0.083975,0.171799,0.729179,0.002116, &
            0.255928,-0.211741,-0.352919,0.342195,0.285385,0.009123,0.301916,0.192945, &
            -0.041461,0.017597,-0.253251,-0.117691,0.352650,-0.067315,0.619799,0.073470, &
            0.098399,-0.368962,-0.211709,-0.241484,0.164931,0.158610,0.252709,-0.066604, &
            -0.050554,-0.097881,-0.043196,-0.157332,0.347277,0.084434,0.093744,-0.193385, &
            -0.262916,0.101244,-0.266774,-0.177591,0.287873,-0.040019,0.330750,0.077228, &
            -0.243624,0.093270,-0.679816,0.073214,0.624654,-0.012241,0.491898,-0.170815, &
            -0.052134,-0.035542,0.021566,0.306650,-0.016819,-0.362351,-0.392926,-0.101100, &
            0.054482,-0.150620,0.076161,0.115078,-0.115506,-0.252362,-0.177040,-0.197835, &
            0.163198,-0.185718,0.261274,0.002618,-0.119510,-0.245152,-0.187367,-0.079232, &
            0.153726,-0.197119,0.262115,-0.068183,-0.083296,-0.203426,-0.026280,-0.061785, &
            0.063394,-0.387684,0.212048,0.060492,-0.213196,-0.165696,-0.000817,-0.222329, &
            -0.035829,-0.175151,0.305352,-0.133683,-0.160342,-0.054351,-0.203963,-0.121838, &
            -0.038830,-0.187188,0.389347,-0.119346,-0.198510,-0.037915,-0.136556,-0.112610, &
            -0.036885,-0.030958,0.124344,0.032039,-0.106351,0.037775,-0.260739,-0.029819, &
            0.170269,0.166157,-0.436483,0.370125,0.247833,-0.041665,0.274908,0.157125, &
            0.001499,-0.022210,0.050763,0.110896,-0.002818,0.061995,0.013984,0.081894, &
            0.096314,-0.113459,0.175236,-0.289836,-0.105323,0.200219,-0.121349,0.009116, &
            -0.134392,0.037185,-0.068497,0.048682,0.062655,0.220679,0.440920,0.013602, &
            0.049959,0.186677,0.124930,-0.083556,0.129714,-0.203165,-0.268876,0.126361, &
            0.031557,0.135736,-0.085942,0.032079,-0.184189,0.068737,-0.390649,0.038760, &
            -0.100863,0.236301,0.041361,0.123950,0.046350,-0.132350,-0.154696,0.111158, &
            0.253720,-0.046790,-0.006473,-0.189159,0.079906,-0.126392,-0.004471,0.000668, &
            0.097258,-0.096775,-0.009451,-0.046392,0.125695,-0.056606,0.119148,0.010447, &
            -0.191677,0.020202,-0.367247,0.411905,0.218593,0.083787,0.426827,-0.036762 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.543122,-1.594631, &
            3.217521,-1.103118, &
            1.511614,-1.133818, &
            1.399323,-1.204129, &
            0.368437,-1.472651, &
            -0.265592,-1.423813, &
            -2.302178,2.020039, &
            -3.059840,2.310168 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.351682,2.841916/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.899358,-2.086282,-1.944242,-2.214928,-1.85485,-2.094904,2.131029,2.175987/)
real, dimension(2) :: bias2 = &
(/-0.770891,1.13834/)
real, dimension(1) :: bias3 = &
(/-0.25267/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
