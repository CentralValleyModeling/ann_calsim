module fnet_Beldan

! a = 4.5804e-005
! b = 0.091868

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.503593,0.116951,-0.074871,-0.482558,0.049818,0.005636,-0.129812,0.098826, &
            -0.538229,0.041589,-0.150652,-0.538310,-0.062816,-0.054017,-0.081360,0.012788, &
            -0.779470,-0.138460,-0.004694,-0.747903,-0.218617,-0.189662,0.050434,0.144221, &
            -0.409277,0.186259,-0.057484,-0.713807,-0.217655,0.067798,0.151060,0.244434, &
            -0.178752,-0.111694,0.077630,-0.262324,-0.040779,-0.071908,0.014797,0.296683, &
            -0.057168,-0.307737,0.150006,-0.147282,0.050516,-0.080518,-0.130779,0.147485, &
            -0.016066,-0.060161,0.041325,-0.204617,0.005018,0.038730,0.027118,0.304603, &
            0.222089,-0.243270,-0.019163,-0.104864,-0.064360,-0.017707,0.086706,0.092868, &
            0.484653,0.367074,0.035283,0.092023,0.300166,0.146499,-0.335432,0.612122, &
            0.128425,-0.126805,-0.529195,0.455897,0.708591,0.122294,-0.261386,0.181225, &
            0.107651,-0.250596,-0.197745,0.157006,0.513567,0.154019,-0.226341,-0.631131, &
            0.418794,-0.261168,0.698842,0.676181,-0.069944,-0.055413,0.087883,-0.043158, &
            -0.239603,-0.669258,0.868291,0.899973,0.100014,-0.093291,0.127392,-0.308770, &
            0.010090,-0.586533,1.073088,0.982414,0.298392,0.181560,0.151619,0.049912, &
            0.507733,-0.460809,0.935431,0.473784,0.055634,-0.048496,-0.058778,0.589141, &
            -0.252059,-0.059635,0.308198,0.740990,0.714064,0.631193,-0.223665,1.099712, &
            0.143677,-0.302169,0.395084,0.558903,0.514279,0.228717,-0.161543,0.753732, &
            0.407235,-0.629548,0.277684,0.151975,-0.099177,-0.113133,0.257891,-0.804922, &
            0.001850,0.250234,-0.460929,-0.505059,0.065784,0.242537,0.167875,-0.188517, &
            -0.169250,0.111990,-0.415063,-0.690972,-0.167584,-0.062257,0.328437,-0.143023, &
            -0.147420,0.070964,-0.534844,-0.540073,-0.075870,0.009914,0.420244,-0.097443, &
            -0.337539,0.125215,-0.180037,-0.261862,-0.073743,-0.181331,0.226935,-0.200906, &
            -0.014406,0.131552,-0.304779,-0.401694,-0.140476,-0.186119,0.121955,-0.060106, &
            -0.343559,0.030530,-0.094786,-0.424092,-0.150113,-0.279862,0.149324,-0.089732, &
            -0.253416,0.024974,-0.361325,-0.187505,0.116133,-0.242327,0.037625,0.031466, &
            -0.082041,0.294613,-0.254013,-0.064728,0.123395,-0.190179,0.198924,-0.093080, &
            0.032616,0.632486,-1.075293,-0.168822,0.425799,-0.389494,0.117822,0.234386, &
            0.116527,0.580306,-1.169300,-0.772768,0.135048,-0.422222,-0.042237,-0.186784, &
            -0.197102,0.750709,-0.739084,-2.145259,0.103303,-0.044754,-0.178680,-1.625188, &
            -0.575638,0.707708,-0.449340,0.346420,0.321429,0.043545,-0.178769,0.460663, &
            -0.730296,0.941287,0.395549,1.079804,0.461592,0.098234,-0.236497,0.904661, &
            -1.129986,0.955740,0.467262,0.820437,0.222283,-0.248152,-0.226092,0.877107, &
            -1.001198,0.807040,0.106723,-0.087684,-0.074635,-0.124991,-0.130387,0.959224, &
            -0.476197,0.712295,0.160403,0.770076,0.021456,0.186492,0.234218,1.417628, &
            -0.484143,0.937948,-0.628588,0.069202,0.486498,0.214590,-0.043629,1.228022, &
            -0.152962,0.422275,-1.411869,-0.766922,0.735101,0.016057,-0.617894,1.542254, &
            -0.719543,1.818551,-1.414846,-2.604087,-0.325314,1.752075,-1.329497,-1.806766, &
            -0.902804,1.734921,-1.397083,-2.178803,-0.970432,2.025877,-1.776880,-1.533899, &
            -0.937206,1.098050,-1.623652,-2.040706,-1.185980,2.315852,-2.462592,-1.186110, &
            -1.286172,1.287552,-1.121897,-1.552885,-1.437672,2.751780,-2.712751,-1.119377, &
            -1.049981,0.865770,-0.999197,-1.709523,-2.025754,2.864412,-2.681574,-1.097030, &
            -0.999350,1.030020,-0.729866,-1.562436,-2.121139,3.092743,-2.826956,-1.098924, &
            -0.945313,0.626849,-0.528722,-1.088043,-2.639371,3.285038,-3.052692,-0.901211, &
            -1.202044,0.470203,-0.398916,-0.854718,-2.808595,3.466412,-3.397691,-0.660899, &
            -2.626127,-1.397281,-0.292653,1.214303,-5.436156,5.522361,-4.363860,0.851921, &
            -1.985974,-1.692768,0.922290,0.151868,-5.362219,6.263366,-3.064287,-0.713945, &
            -0.104535,-0.458334,1.753831,-2.281208,-3.596278,4.927731,-0.907303,-2.953583, &
            -0.260197,0.832059,0.572399,-2.351235,-1.452576,3.614020,-0.087768,-2.719283, &
            -0.683895,1.659572,-0.197904,-2.276268,-0.350465,2.548293,-0.056766,-2.586967, &
            -1.407759,1.742416,-0.824807,-1.616836,-0.151597,1.702803,0.032213,-1.600549, &
            -1.073243,1.667365,-1.041477,-1.330898,-0.005912,1.186703,0.545264,-1.452619, &
            -1.020509,1.312831,-1.063527,-1.297562,-0.217233,0.836240,0.641240,-1.850569, &
            -1.124241,0.994132,-0.572641,-0.735102,-0.200495,0.762782,0.606984,-0.399831, &
            -0.056223,1.446444,0.327393,-0.531733,0.523800,0.453191,0.741383,0.806218, &
            -0.102651,1.149928,-0.813045,-0.542296,0.201481,0.929600,0.002672,-0.272633, &
            -0.031662,0.903865,-0.735690,-0.459517,0.192094,0.720683,-0.168624,-0.079382, &
            -0.300777,0.987497,-0.581513,-0.246935,0.132207,0.892163,0.058041,-0.059157, &
            -0.353585,0.932962,-0.870833,-0.019617,-0.023089,0.879208,-0.174188,-0.276838, &
            -0.257659,0.957557,-0.814442,-0.124025,-0.239154,1.183673,-0.224975,-0.044714, &
            -0.418653,0.773987,-0.826378,-0.028037,0.101827,0.988024,-0.319720,-0.141604, &
            -0.267808,0.471514,-0.612670,0.250701,-0.206610,1.132639,-0.285337,-0.028800, &
            -0.317691,0.663581,-0.775254,0.027350,-0.405663,1.093965,-0.312504,-0.088305, &
            -0.733851,-0.031996,-0.690119,0.212999,-0.649159,1.416422,-0.828638,0.194184, &
            -0.997973,-0.260598,-0.379154,0.570907,-1.159733,1.684334,-1.394968,0.444947, &
            -0.554476,0.163871,-0.504401,0.602702,-0.680453,1.383142,-1.361880,0.843805, &
            -0.745998,0.406747,-0.455257,0.346547,-0.334341,1.123831,-0.610729,0.309362, &
            -0.147158,1.334671,-0.213466,-0.316049,0.187814,0.793804,0.000254,-0.006642, &
            0.389822,1.330098,-0.035492,-0.597526,0.130542,0.736038,-0.201969,-0.279285, &
            0.377706,1.456707,0.068612,0.645647,0.019038,0.502661,-1.100257,-0.079440, &
            -0.221361,1.032265,0.351800,1.265543,-0.306582,0.684449,-1.553645,0.113330, &
            -0.319287,1.118561,0.872602,1.001863,-0.149958,0.991387,-0.917892,0.580102, &
            0.060785,1.473532,1.588240,0.476926,0.332621,0.784755,0.418522,1.542134, &
            0.588483,0.130093,-0.321449,-0.240591,0.035740,-0.082430,-0.100743,-0.224287, &
            0.383466,0.084741,-0.003067,0.013430,0.029388,0.008282,0.037225,0.015676, &
            0.235557,-0.081779,-0.021885,-0.065321,0.019736,0.056918,0.044548,0.181263, &
            -0.084988,0.023002,0.163865,0.110583,0.006652,-0.073625,0.173371,-0.013132, &
            0.019682,-0.204634,0.033226,-0.061513,-0.011351,-0.052163,0.114285,-0.054731, &
            0.299346,-0.121794,0.141607,-0.119178,0.062495,0.008615,0.063616,-0.040185, &
            0.203126,0.131323,-0.188299,0.000488,-0.043392,-0.062451,0.027988,0.077349, &
            0.647196,-0.070074,-0.196962,-0.040471,-0.021461,0.013476,-0.057804,-0.172545, &
            1.132280,-0.026792,-0.613707,-0.393004,-0.077117,-0.219170,0.392108,-0.322517, &
            0.759342,-0.007877,-0.517387,-0.048870,-0.156861,-0.097005,0.018417,0.091342, &
            0.308017,0.002955,-0.332335,0.129900,-0.124910,-0.216007,-0.341218,-0.265980, &
            0.304484,-0.296649,-0.457899,0.080488,-0.203101,-0.113566,-0.102793,-0.022750, &
            -0.278696,-0.162931,-0.478064,0.198463,-0.405684,-0.005209,-0.124436,-0.017893, &
            -0.058028,-0.403077,-0.211920,-0.195893,-0.176003,-0.383231,0.327908,-0.277347, &
            -0.402079,-0.120718,-0.060350,-0.019267,-0.114838,-0.398957,-0.014972,-0.145346, &
            -0.348365,0.243578,-0.220439,0.249218,0.040354,-0.214365,-0.328283,-0.167597, &
            0.477725,-0.064646,-0.089543,0.044570,-0.032409,-0.214154,-0.380734,-0.374338, &
            0.231980,-0.324424,0.530386,0.166102,0.153853,-0.163380,0.215373,-0.296590, &
            -0.099518,-0.457948,0.268978,0.037341,-0.284825,-0.421544,-0.190939,-0.104874, &
            -0.012260,-0.282949,0.440554,0.263223,-0.037402,-0.536362,0.012333,-0.356898, &
            -0.190469,-0.610629,0.196967,0.108724,0.096086,-0.532357,0.338836,-0.279558, &
            -0.046924,-0.442646,0.021168,0.090724,-0.036052,-0.540651,0.283275,-0.183238, &
            -0.160029,-0.748365,0.131000,0.076599,0.073523,-0.352447,0.213169,0.067720, &
            -0.404178,-0.350559,-0.104712,0.096535,-0.170225,-0.452055,0.428227,0.032629, &
            -0.391703,-0.436540,-0.044331,0.202341,-0.106800,-0.318416,0.333019,-0.006117, &
            -0.191122,-0.636837,-0.159870,0.229854,0.139473,-0.365624,0.486238,-0.076982, &
            0.149020,-0.409051,-0.473732,-0.308913,0.768085,-0.578952,0.697441,-0.242690, &
            -0.275904,-0.324530,-1.317271,-0.374304,0.674149,-0.231825,0.617319,-0.275960, &
            -0.480787,-0.617885,-0.839382,-0.335186,0.513997,-0.040913,0.486349,-0.808485, &
            0.040261,-0.478660,0.036983,-0.021109,0.368381,-0.125966,-0.002499,-0.387491, &
            0.504021,-0.153611,1.089026,-0.099955,-0.033650,-0.136169,-0.070374,-0.374953, &
            0.358582,-0.382167,1.314766,-0.126601,-0.255994,-0.114730,0.108835,-0.341720, &
            0.183312,-0.153938,0.687511,0.233403,-0.279209,-0.178866,0.279950,-0.103061, &
            -0.335634,-0.545951,0.268683,0.678966,-0.316267,-0.069570,-0.306103,0.041977, &
            -0.077405,-0.305596,0.287449,0.664462,-0.022926,0.005928,0.189243,-0.011477, &
            0.333856,-0.388528,0.810670,0.270888,0.248316,-0.199488,0.273219,-0.162539, &
            0.049774,0.245933,-0.451312,-0.008049,0.092721,0.113560,-0.110270,0.635538, &
            -0.067077,0.428956,-0.433424,-0.696407,0.170221,-0.086713,-0.471625,0.506158, &
            0.044373,0.219855,-0.324194,-0.531537,0.338316,-0.052733,-0.565412,0.855404, &
            0.083935,0.362794,-0.375247,-0.282735,0.091951,-0.022739,-0.287526,0.384267, &
            0.124328,0.105286,-0.077477,-0.146176,0.084310,-0.041034,-0.285953,0.286292, &
            0.154831,0.145152,-0.076925,-0.008681,-0.048339,0.010493,0.026460,0.066624, &
            0.059680,0.038632,-0.118980,0.007189,0.165789,-0.005168,-0.246842,0.113335, &
            0.038262,0.291197,-0.227154,-0.052043,-0.041208,-0.014866,-0.121003,-0.194150, &
            -0.108300,0.462770,-0.105085,0.278406,0.182246,-0.355597,-0.674062,-0.264166, &
            -0.093688,-0.269861,0.462509,0.533696,0.102275,-0.509190,-0.390715,-0.111072, &
            0.061002,-0.431599,1.018036,0.888488,-0.169272,-0.263334,0.105442,-0.209001, &
            -0.079634,-0.232866,0.566550,0.130806,-0.116900,-0.137640,-0.091191,-0.373644, &
            0.334858,-0.007175,-0.008779,0.029855,-0.103146,0.039443,-0.029069,-0.612122, &
            0.300831,-0.067959,-0.213049,0.132192,-0.199903,-0.098153,0.084600,-0.615967, &
            0.412578,-0.137409,-0.162770,0.146304,-0.068404,-0.029134,0.018289,-0.659669, &
            0.096416,0.047143,-0.003959,0.066665,0.014733,0.096686,0.028120,-0.204611, &
            0.518759,0.186581,0.088080,0.182135,-0.087072,0.041583,0.060037,0.446490, &
            0.077740,-0.470910,0.383461,0.282304,0.017012,-0.023612,-0.086010,-1.092043 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.638683,0.304367, &
            0.712665,-0.737854, &
            2.065633,0.458897, &
            -0.238478,1.535020, &
            0.771340,-2.328539, &
            -1.320941,3.204489, &
            0.246704,-3.876429, &
            0.105395,1.401818 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.034776,-1.732634/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.762328,0.213768,0.148498,-0.323125,0.287268,-0.75419,0.515468,-0.216608/)
real, dimension(2) :: bias2 = &
(/0.114471,-0.306125/)
real, dimension(1) :: bias3 = &
(/1.264969/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
