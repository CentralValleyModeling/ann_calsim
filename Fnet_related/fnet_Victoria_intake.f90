module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.303128,-0.016047,0.448907,-0.442685,0.339163,0.187470,-0.125016,0.006777, &
            -0.384497,-0.009537,0.610614,-0.217454,0.026117,0.350456,-0.227218,0.060926, &
            0.095250,0.103043,0.399492,-0.041302,0.159265,0.298815,-0.079359,0.066048, &
            0.028427,-0.000233,0.294769,-0.185237,0.145357,0.224756,0.122703,-0.008781, &
            0.074628,0.075237,0.156247,-0.001819,0.143466,0.058163,0.048028,-0.235393, &
            0.021347,-0.097504,0.106991,-0.221761,0.127667,0.044886,0.247613,-0.063676, &
            0.059176,-0.036583,0.293877,-0.180017,0.167823,0.174183,0.169759,-0.122260, &
            0.188231,-0.028578,0.309144,-0.135985,0.076675,0.257568,0.503790,0.024738, &
            0.096468,0.312420,0.628460,-0.288294,0.154630,0.543119,0.442221,0.213549, &
            0.229278,-0.122271,0.281620,-0.290362,0.226416,0.139122,0.170011,0.450793, &
            0.370466,-0.473364,0.411313,-0.146632,0.012572,-0.188951,-0.021345,-0.372227, &
            -0.225241,-0.276038,0.159321,-0.119927,0.065528,-0.068921,-0.737773,-1.063110, &
            0.012395,-0.007763,0.491412,0.003371,0.254618,-0.132302,-0.041913,0.867221, &
            -0.025079,0.081355,-0.105635,0.002092,0.274179,-0.444104,0.154102,-0.503982, &
            -0.219067,-0.239066,-0.387074,0.055149,-0.134043,-0.346285,-0.401654,-0.470872, &
            -0.565223,-0.253631,0.095128,-0.155351,-0.058293,-0.162252,0.340779,1.907937, &
            -0.676758,-0.120229,-0.071526,-0.170844,-0.006484,-0.234040,-0.049988,-0.031405, &
            -0.009456,-0.347428,-0.870462,0.043596,-0.359810,-0.413624,0.326675,0.525663, &
            -0.103910,-0.146866,-0.042597,0.018226,-0.230607,-0.181339,0.396581,-0.026385, &
            -0.289481,-0.123070,-0.034997,-0.070473,-0.046987,-0.153392,-0.587051,-0.164129, &
            -0.232195,-0.197106,-0.287338,0.001469,-0.383462,-0.151677,-0.887571,-0.140591, &
            0.001246,-0.198152,-0.295376,-0.007280,-0.052865,-0.281584,-1.093434,0.192774, &
            -0.143287,-0.072780,-0.214689,-0.094122,-0.094336,-0.027947,-0.996499,-0.119075, &
            0.130810,-0.026834,-0.141315,0.118240,-0.038076,-0.168041,-0.674747,-0.065065, &
            0.143783,-0.131803,-0.292292,-0.020385,0.006984,-0.187265,-0.524407,0.297141, &
            0.235181,-0.145421,-0.187638,0.021893,-0.009715,-0.149105,-0.871890,0.298892, &
            0.377417,-0.393285,0.396603,0.528319,-0.344570,-0.257948,-1.800497,0.160882, &
            0.258391,-0.920084,0.378925,0.522531,-0.686184,0.241920,-1.305084,-0.254054, &
            0.716880,-0.699014,0.307029,0.748417,-0.639137,0.224947,-0.087564,-1.343573, &
            0.319559,-0.323111,0.256187,0.584981,-0.371019,0.066096,0.246165,-1.690245, &
            0.521069,-0.220235,0.154336,0.516253,0.071546,-0.228796,0.466903,-2.315264, &
            0.508083,-0.128139,-0.096149,0.277323,-0.039503,0.024225,0.380748,-1.834094, &
            0.137062,0.072881,0.143439,0.045589,0.194693,0.202654,0.006282,-0.450650, &
            0.526618,-0.011381,0.669447,0.066176,0.267921,0.307868,-0.276002,-1.747462, &
            0.790013,-0.288734,-0.001589,0.130601,-0.057117,0.124524,0.090519,-1.418888, &
            0.067868,0.329885,0.363758,0.050688,0.340810,0.175673,0.387956,1.457815, &
            -0.395395,0.028075,-0.078146,0.063049,0.170886,-0.242237,-0.383341,-0.102208, &
            -0.031319,-0.047219,-0.082404,0.032028,0.207939,-0.000622,-0.005691,-0.122803, &
            0.023652,0.056063,-0.334462,0.037554,0.122306,-0.438822,0.430041,-0.728925, &
            0.341874,0.202098,0.015347,0.093050,0.226321,-0.163278,0.377150,-0.413778, &
            0.291028,0.530119,-0.127577,0.206569,0.231860,-0.063819,0.502201,0.050713, &
            0.509487,0.870303,-0.092200,0.016931,0.536143,0.004613,0.465696,0.002842, &
            0.738501,1.332984,-0.345091,0.010703,0.875271,-0.264532,0.679959,-0.179307, &
            0.477417,1.899044,-0.261939,-0.200872,0.820236,-0.264701,0.557063,-0.082316, &
            0.714012,5.337124,-0.769935,-1.833181,1.652504,-1.091199,0.821763,-0.670316, &
            -0.023471,8.334061,-1.070174,-3.769524,2.782608,-1.185523,-0.579545,-1.130535, &
            0.766589,7.545844,-1.605599,-5.645639,2.838834,-0.967872,0.478989,-1.816445, &
            0.594719,5.163053,-1.547595,-5.862688,2.301053,-0.599635,0.374752,0.661827, &
            1.050903,3.064900,-0.598522,-4.238296,2.478642,-0.414620,0.381084,0.497109, &
            1.195561,1.449381,-0.272283,-2.895174,2.593165,0.053297,0.013810,-0.705197, &
            0.656348,0.820501,-0.587731,-3.047302,1.845525,-0.040076,-0.144673,0.605047, &
            1.134277,0.652699,-0.111735,-3.441658,1.553560,0.072345,1.282199,0.929956, &
            0.364671,-0.348294,0.377237,-2.642554,0.960183,0.466589,0.346637,1.879614, &
            -0.503400,0.005812,0.611065,-1.461045,0.295776,0.547177,-0.762441,-0.364602, &
            -0.034412,0.079266,1.970783,-1.273957,1.641487,0.523849,0.879682,-0.002807, &
            0.214199,0.037716,1.848384,-1.060377,1.794326,0.649289,0.931494,-0.093479, &
            0.576357,-0.151161,1.675696,-1.156743,1.534456,0.434815,0.628951,-0.061617, &
            0.302102,0.079969,1.531049,-0.988347,1.584544,0.365676,0.512007,0.025706, &
            0.006776,0.140765,1.533702,-0.784700,1.873656,0.377343,0.288999,-0.091707, &
            0.046696,0.166208,1.252295,-0.377310,2.018983,0.246178,0.163320,0.030161, &
            -0.531727,0.041749,0.900560,-0.446877,2.215204,0.273425,0.074593,0.207813, &
            -0.371606,0.419508,1.121701,-0.118710,2.269705,0.355495,-0.006172,-0.106379, &
            -1.887824,1.105847,0.806500,0.395206,3.657707,0.275950,-0.119997,0.407644, &
            -2.133678,2.748899,0.503193,-0.030159,4.049589,0.225115,-1.225789,1.835957, &
            0.105061,2.403941,0.619526,-1.335730,3.456371,-0.540557,-2.294049,3.578799, &
            -0.102991,2.119693,0.002353,-2.103958,1.931020,0.094858,-2.205481,4.013174, &
            -0.357481,1.638062,0.125297,-2.439376,1.434937,-0.053637,-3.027876,1.631814, &
            -0.155414,0.702391,0.061216,-1.812394,1.274949,-0.242025,-4.121247,0.892869, &
            -0.035377,0.508271,-0.261064,-1.146497,1.507372,-0.019069,-3.261071,1.077094, &
            -0.015436,0.722785,-0.376520,-0.977201,1.720334,-0.408951,-1.085838,-0.395414, &
            0.006814,1.198162,-0.005880,-0.667672,2.055107,0.244559,0.860777,-2.259619, &
            0.733337,1.680282,-0.154531,-1.643389,2.340755,0.194607,2.184614,-3.034635, &
            -0.353244,-0.255138,0.012928,-0.056374,-0.392082,-0.024331,0.116291,0.583608, &
            -0.231345,0.045554,-0.137029,0.076631,-0.083091,-0.099107,0.021651,0.179734, &
            0.010321,-0.010218,0.180235,0.007759,-0.035261,0.038553,-0.040669,0.167615, &
            -0.055188,-0.071701,-0.058564,-0.026447,-0.157312,0.064714,-0.019564,0.289756, &
            0.113877,-0.097673,0.084473,0.099670,0.007382,-0.079279,-0.018686,0.362757, &
            -0.082422,-0.065872,0.033663,-0.012920,-0.198146,0.104905,0.052874,0.391328, &
            -0.127952,-0.010151,0.050709,0.036245,-0.040212,-0.038649,0.122678,0.363978, &
            -0.391568,-0.244799,-0.069681,0.102090,-0.428309,-0.119364,0.161948,0.643596, &
            -0.999916,-0.583883,-0.023141,0.771462,-1.273731,-0.167260,-0.021330,2.346273, &
            -0.763205,-0.458849,-0.344288,0.958747,-1.129889,-0.410118,0.222976,2.627222, &
            -0.413980,-0.250277,-0.812993,0.773269,-0.361938,-0.318489,0.041756,1.126192, &
            -0.549976,-0.259924,-0.874023,0.523469,-0.493473,-0.296912,-0.016366,1.615661, &
            -0.180021,0.050910,-0.944332,0.475169,-0.058452,-0.332935,0.247940,0.718457, &
            0.169437,0.120120,-1.304672,-0.388325,-0.145251,-0.374201,0.614273,0.682871, &
            0.160513,0.246397,-1.133846,-0.437185,-0.092192,-0.147888,0.157037,0.128252, &
            0.174053,0.233274,-0.620648,-0.699269,-0.176676,-0.068131,0.138107,-1.213585, &
            -0.300614,0.008473,-0.276888,-0.562961,-0.325207,-0.009372,0.030044,-0.244802, &
            0.166994,-0.097581,-0.282261,-0.594107,-0.093534,0.037610,-0.213010,-1.327707, &
            0.456105,-0.083076,0.405341,-0.153387,0.029599,0.139043,0.165578,0.001508, &
            0.643184,0.081425,0.466912,0.030843,0.056716,0.182831,-0.090687,0.142646, &
            0.523315,0.116332,0.154832,-0.035614,-0.035225,0.106864,0.091752,0.978474, &
            0.436478,-0.040374,0.470412,-0.011553,0.209458,-0.084418,-0.008586,0.735780, &
            0.354793,0.096012,0.278882,-0.035911,0.035374,0.152464,0.064116,0.384102, &
            0.284442,-0.009290,0.086752,-0.001907,0.088215,-0.061354,-0.059055,0.268668, &
            0.347469,-0.088223,0.134812,0.081536,-0.191428,0.130540,-0.039693,0.428945, &
            0.164765,-0.037140,0.304250,0.004475,-0.131788,-0.041499,-0.193433,0.353394, &
            0.894563,-0.832665,0.177830,0.386940,-0.665807,-0.174228,-0.773825,1.310312, &
            0.704760,-1.121420,-0.264606,0.636897,-1.047659,-0.120607,-0.649766,0.448403, &
            0.616663,-1.199928,-0.098021,0.578110,-1.152443,-0.325352,-0.247088,0.171219, &
            0.044443,-0.865305,-0.058409,0.528404,-0.747382,-0.047381,-0.414259,0.769051, &
            0.349020,-0.056388,-0.224927,0.512931,-0.531961,-0.237146,-0.474922,1.898824, &
            -0.055207,0.157922,-0.176757,0.554629,-0.413434,0.088682,-0.068062,2.420844, &
            -0.441164,0.121697,0.504268,0.319437,-0.420535,0.467833,-0.339756,1.218103, &
            -0.319684,0.643290,0.247327,0.216527,-0.345962,0.293808,-0.267028,0.761030, &
            -0.443501,0.371334,0.162099,0.583799,-0.437210,0.431889,0.067338,0.178977, &
            -0.621113,0.249687,0.343270,0.481155,-0.637591,-0.019385,0.452769,-0.331296, &
            -0.137829,0.054853,-0.101764,-0.017010,-0.057426,0.008362,-0.056825,0.298780, &
            -0.097169,-0.020695,-0.120976,-0.015186,-0.065233,-0.042333,0.046286,0.123521, &
            -0.010435,-0.002418,-0.066303,0.021460,-0.096268,0.020422,0.021664,0.128308, &
            0.073759,-0.030350,0.114347,0.008240,0.017688,-0.016365,0.174862,0.281505, &
            -0.000245,0.004779,0.080335,0.003959,-0.065893,0.103773,-0.059067,0.111960, &
            0.102618,0.019811,-0.009578,0.011777,-0.002251,0.066017,-0.076201,0.073556, &
            -0.088552,-0.014280,-0.039668,-0.008569,0.035155,-0.099420,-0.027863,-0.302002, &
            -0.053133,-0.038313,0.092259,-0.031877,0.078785,-0.057422,-0.102976,-0.042008, &
            0.088913,-0.146702,0.228579,-0.005270,0.063589,-0.052180,-0.108987,0.127088, &
            -0.047107,-0.009432,0.031113,-0.002796,0.064826,-0.132939,-0.032777,-0.321567, &
            -0.228935,-0.034553,0.143862,-0.066807,0.079896,-0.079876,-0.253178,-0.360919, &
            -0.136093,-0.030719,0.203804,-0.020523,-0.124033,0.085648,-0.037096,-0.066456, &
            -0.074396,0.090802,0.090909,-0.026973,-0.023857,0.125325,0.005871,0.263170, &
            0.137009,0.037980,-0.073829,0.006321,0.325405,-0.144531,-0.434621,-0.657403, &
            0.083427,-0.074956,0.072531,-0.018758,0.091198,-0.107242,0.210250,-0.476275, &
            0.029149,0.020385,-0.167607,-0.015335,0.030899,-0.130743,0.214123,-0.025558, &
            -0.087685,-0.133799,-0.095860,-0.057535,0.044736,-0.077736,-0.269156,-0.426057, &
            0.178460,0.064154,-0.196936,0.083600,-0.153419,0.013895,0.308591,0.932592 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.620985,-0.912525, &
            -1.942998,-0.727746, &
            0.128301,-1.491715, &
            4.306072,2.329467, &
            0.161286,1.930026, &
            0.750223,0.927303, &
            -0.019304,3.061873, &
            -0.804613,-1.795800 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.759963,2.247298/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.930026,0.216951,-2.395116,-0.001494,-0.407928,1.143825,0.628245,-3.19948/)
real, dimension(2) :: bias2 = &
(/0.38816,-0.11081/)
real, dimension(1) :: bias3 = &
(/-0.315629/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
