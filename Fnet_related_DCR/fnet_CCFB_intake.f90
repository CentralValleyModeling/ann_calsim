module fnet_CCFB_intake

! a = 0.00076145
! b = 0.026005

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.177958,-0.147229,0.108762,0.248188,0.152156,-0.100196,0.524746,0.624411, &
            -0.012333,-0.154024,0.072564,0.270724,0.057231,0.023676,0.129789,1.286442, &
            -0.129602,-0.022030,0.033396,0.292723,-0.006589,-0.047924,0.118939,1.809266, &
            -0.098112,0.055298,-0.009360,0.149566,-0.011742,0.018967,0.033576,1.358593, &
            -0.143152,0.028129,-0.004260,0.216759,-0.007984,-0.025062,0.060837,0.875645, &
            -0.219158,0.041671,0.006511,0.318973,0.024216,0.083433,0.101062,0.463530, &
            -0.289332,0.038377,0.006619,0.332154,-0.004399,0.071781,0.063977,0.432650, &
            -0.296773,0.036794,-0.000970,0.610642,0.085709,0.108105,0.192076,0.871461, &
            -1.371062,0.138975,0.131375,2.436423,0.378875,-0.371747,1.840895,-0.857495, &
            -1.309834,-0.154032,0.170390,3.489827,-0.168030,-0.974463,0.602963,-0.007933, &
            -0.685394,-0.278773,0.032126,1.286841,0.148495,-0.654210,0.326300,1.008891, &
            -0.495185,-0.831313,0.073266,1.538945,0.109625,-1.140670,-0.152840,2.544198, &
            0.027870,-0.484886,0.022613,0.300171,-0.130319,-0.409572,-0.310081,1.284030, &
            0.169843,-0.301913,0.051547,0.236587,-0.077176,0.077189,-0.032509,0.489335, &
            0.142054,-0.076625,0.148062,-0.137127,-0.364730,-0.003199,-0.316616,0.318222, &
            -0.242567,-0.284732,0.160980,0.375449,-0.113993,-0.278795,-0.486467,0.857915, &
            -0.109980,-0.319891,0.143381,0.172216,-0.308457,-0.335032,-0.540003,1.028968, &
            -0.120384,-0.390828,0.244180,-0.146123,0.006310,0.403704,-0.618485,0.370987, &
            0.210353,0.447804,-0.056281,-0.976146,-0.819608,-0.494540,0.500622,-0.703753, &
            0.077475,0.156347,0.182638,-1.038782,-0.758238,-0.483344,0.413324,-0.851074, &
            0.027121,0.408054,0.102441,-0.404783,-0.633240,-0.336999,0.028850,-0.716879, &
            0.324843,0.117057,-0.022662,-0.301408,-0.523173,-0.548416,-0.457515,-0.343310, &
            0.277703,0.275639,-0.104758,-0.228398,-0.373498,-0.291949,-0.208404,-0.524982, &
            0.077407,0.136690,0.039955,-0.023118,-0.180146,-0.037338,0.044086,-0.607166, &
            0.213911,0.002673,0.137386,-0.228055,-0.253457,0.114736,0.032095,-0.675174, &
            0.249796,-0.136764,0.143678,-0.111553,-0.109937,0.054856,0.216060,-0.737773, &
            0.631705,0.119788,0.592476,-0.542145,-0.294656,0.110852,0.324142,-1.507334, &
            0.258262,-0.173552,1.101289,-0.347856,-0.104898,0.194066,0.273861,-0.867299, &
            0.605270,-0.292730,0.816232,0.704026,-0.413459,0.029995,-0.159531,-0.097469, &
            0.358650,-0.236923,0.576919,-0.116747,-0.164556,0.027736,-0.027591,-0.726354, &
            0.189290,-0.452931,0.526105,-0.497726,0.671833,0.701805,-0.111902,0.449805, &
            0.180667,-0.067720,0.130420,-0.530934,0.628964,0.837428,-0.085028,0.505323, &
            -0.090220,0.009776,-0.050995,0.080581,0.467941,0.488768,0.189376,-0.535866, &
            -0.509223,0.068192,0.032737,-0.230109,0.306456,0.362623,-0.015689,-0.327562, &
            -0.133528,-0.017000,0.009155,-0.075859,0.456741,-0.203917,0.396097,-0.479066, &
            -0.557568,-0.073574,-0.070668,1.399024,1.151841,0.310997,0.873126,-0.864431, &
            0.580780,-0.098251,-0.012122,0.929432,0.173055,-0.261121,-0.222064,-0.033411, &
            -0.223288,-0.726333,-0.146436,0.555701,0.095453,-0.733663,0.134171,-0.270616, &
            0.139167,-0.774275,-0.151932,0.616556,0.132993,-0.206435,-0.187966,-0.062545, &
            0.453406,-0.363123,-0.080131,0.430103,-0.123461,-0.083587,0.121490,0.358662, &
            0.663918,-0.764625,-0.213743,0.712737,-0.010352,-0.162547,0.131785,0.296049, &
            0.710528,-0.474715,-0.526595,0.508003,-0.268824,-0.249584,0.080763,0.205746, &
            0.741364,-0.643416,-0.717449,0.431591,-0.183419,-0.286913,0.202713,0.450053, &
            0.678079,-0.583565,-1.533211,0.647126,-0.255642,-0.601073,0.001039,0.436915, &
            0.093685,-1.206958,-6.429654,1.126705,-0.287505,0.102811,-0.062374,1.531763, &
            0.657026,-0.965150,-9.374871,1.302733,-0.150707,-0.624617,0.113596,2.548405, &
            0.467880,-1.071206,-8.811802,1.733288,0.588387,2.293946,0.180487,1.650657, &
            0.374695,-1.011944,-7.776850,-0.148198,-0.070456,1.295181,-0.452513,2.166742, &
            0.477465,-1.025845,-6.608346,0.413426,-0.396693,0.814019,-0.634013,1.087151, &
            -0.187746,-0.825021,-4.318067,0.498190,-0.175716,-0.446543,-0.823064,0.201191, &
            0.071522,-0.777902,-1.980841,-1.182197,0.705693,-0.606131,-0.131525,0.107907, &
            -0.074785,-0.847605,-0.173241,-0.962675,1.393425,0.210545,0.614117,-0.851787, &
            -0.436827,-1.069781,-0.390435,0.314541,1.294340,0.078585,-0.261346,-0.542879, &
            -0.141468,-0.856971,-1.910377,0.712594,0.724865,-0.545393,0.017835,0.992354, &
            -0.976355,-0.507078,-0.013056,3.673283,-1.200552,0.853313,1.644644,-1.863126, &
            -1.089920,-0.605614,0.062083,3.500360,-1.633766,0.938094,2.096202,-1.850843, &
            -0.466013,-0.119991,0.161136,3.664709,-1.090618,0.714532,1.741564,-1.561922, &
            -0.128364,0.250130,0.337672,3.916808,-0.693950,0.407673,1.455195,-0.922840, &
            0.294560,0.585643,0.051021,4.227292,-0.663558,0.017346,0.877256,-0.999022, &
            0.279438,0.651298,0.146973,4.318684,-0.541388,0.036428,0.784404,-0.842296, &
            0.610049,0.847001,0.421969,4.156307,-0.413821,0.015121,0.701338,-0.998412, &
            0.579011,1.086717,0.337095,4.343923,-0.583827,-0.599508,0.582117,-1.055419, &
            0.956643,1.157515,-0.781371,4.241045,-0.236248,-1.380892,0.077914,-0.954549, &
            0.385878,-0.113321,-2.773198,2.039256,-0.229865,-0.464129,1.219692,-0.572703, &
            -0.429943,-0.736825,-2.498809,-0.301346,0.730638,1.949606,2.591807,-2.299168, &
            -0.163930,0.190581,-1.650117,-0.022376,0.845277,0.582898,0.779836,-0.291063, &
            -0.385570,0.634952,-0.600660,0.714962,0.368273,-0.641473,-0.205288,0.364252, &
            -1.112985,-0.020922,-0.629737,0.551650,-0.393078,-0.769223,-0.640497,0.890642, &
            -0.966117,0.260949,-0.248301,0.348050,-0.076593,0.245964,-0.137998,0.863865, &
            -0.012483,0.875988,-0.796554,-0.184163,-0.162882,0.793349,-0.277445,1.176207, &
            -0.946518,0.571502,-0.822471,0.423311,0.033979,1.290345,-0.379470,0.257535, &
            -1.027067,0.680423,-0.835778,-0.149124,0.981286,1.260018,0.661439,0.075653, &
            -0.068386,0.097240,0.057203,-0.074712,0.052366,0.403272,0.014936,-0.121375, &
            -0.118795,0.134714,-0.100881,-0.037102,0.017864,0.049666,-0.073402,-0.054934, &
            -0.015387,-0.088270,0.029047,-0.143248,0.085310,-0.113199,0.006698,0.162102, &
            -0.177116,0.123382,-0.072479,-0.002487,-0.020433,-0.076166,-0.060886,-0.256574, &
            0.086652,-0.018284,0.087549,-0.036257,0.011555,-0.063115,0.099494,-0.173159, &
            0.124317,-0.012401,-0.062601,-0.138615,0.047900,-0.023730,-0.088258,-0.153247, &
            0.033714,0.014411,0.033108,-0.055716,-0.107716,0.083574,-0.097411,-0.170372, &
            0.126320,-0.004880,0.085391,-0.302766,-0.026042,0.302540,-0.024356,-0.271718, &
            -0.079351,0.306213,0.149150,-1.305284,-0.268447,0.198011,-0.431645,-0.250215, &
            0.189861,0.186987,0.135380,-1.577760,-0.776789,-0.319496,-0.741656,-0.973078, &
            0.283286,0.078715,0.141357,-0.626073,-0.460914,-0.322705,-1.059601,-1.107779, &
            0.325634,0.143352,-0.097345,-0.932097,-0.448682,-0.611537,-1.148811,-1.492815, &
            -0.021949,0.066788,-0.116781,-0.680638,-0.517604,-0.414330,-1.095856,-1.759059, &
            -0.279406,0.087406,-0.413089,-0.650348,-0.207970,0.249553,-1.025981,-1.461191, &
            0.004215,0.216273,-0.424225,-0.192795,-0.188775,0.111103,-0.843301,-1.419047, &
            0.208519,0.232386,-0.448970,-0.570648,-0.472681,0.242272,-0.689315,-0.878941, &
            0.035748,0.214014,-0.294219,-0.652213,-0.187455,0.721766,-0.668529,-0.394059, &
            0.102208,0.360665,-0.286095,-0.446529,0.079270,0.386685,-0.239348,-0.089213, &
            -0.431723,0.393471,-0.294166,-0.155710,-0.045226,0.582680,0.242871,0.466249, &
            -0.268270,-0.006440,-0.125180,-0.093576,0.245136,0.651739,0.196286,0.068424, &
            -0.412015,0.043812,-0.057550,-0.131088,0.173265,0.752393,0.392671,-0.082272, &
            -0.573501,0.255717,0.048583,-0.420471,0.095090,0.632822,0.419953,0.357172, &
            -0.482354,0.153683,0.023591,-0.082957,0.093865,0.640663,0.013987,0.381321, &
            -0.467506,0.209275,-0.062868,0.003104,0.086696,0.456162,0.091467,0.622986, &
            -0.336524,-0.004673,0.110688,0.036534,0.167578,0.703270,0.013803,0.258595, &
            -0.746606,0.176293,0.050876,0.161483,-0.030277,0.522139,-0.040573,0.512716, &
            -0.475013,-0.088068,0.659525,-0.027998,-0.306455,0.521709,0.099614,1.126407, &
            -0.192917,0.155009,1.176295,-0.476832,-0.249340,0.161637,0.295239,0.408916, &
            0.020637,-0.090920,0.743058,-0.911580,-0.257371,-0.960071,1.252434,0.588391, &
            0.550660,0.058349,0.726446,-0.319757,-0.030105,-0.568623,0.489897,-0.223201, &
            -0.155654,-0.201297,0.517256,0.227808,0.130732,0.126444,0.003805,-0.456190, &
            -0.072844,-0.483930,0.267904,0.341105,0.108679,0.971276,0.155443,0.273841, &
            0.249782,0.205653,0.247679,-0.195713,-0.076010,0.628383,0.077825,1.038575, &
            -0.217198,-0.082229,-0.066880,-0.355583,-0.089708,0.842732,0.380369,0.959661, &
            -0.094819,0.005565,0.246320,-0.116572,0.014267,0.993640,0.293693,0.407034, &
            0.116739,0.348496,0.287214,0.382360,-0.406956,1.053856,0.024693,0.351422, &
            -0.027616,0.018129,-0.106689,-0.459400,0.204678,-0.223340,0.157350,1.045661, &
            -0.032585,-0.082614,0.030250,-0.310702,0.227948,0.353800,0.154010,0.776487, &
            -0.204551,0.025173,0.021619,-0.020936,0.100057,0.203231,0.126740,0.620697, &
            -0.175661,-0.057002,0.001448,0.121434,0.054072,0.007214,-0.050986,0.365174, &
            -0.090559,0.094170,-0.002095,-0.086537,-0.000669,0.003661,0.126546,0.322069, &
            -0.107428,-0.002937,-0.018104,-0.090192,0.002034,-0.067654,-0.055972,0.289015, &
            0.063217,-0.039184,0.026521,-0.073491,-0.130454,-0.068443,-0.023715,0.107940, &
            -0.194731,0.145785,-0.051115,-0.149541,0.050468,-0.074091,0.027180,-0.112739, &
            0.230157,-0.085227,0.029231,-0.348167,-0.029981,-0.005391,0.022696,0.768640, &
            -0.310754,0.138273,-0.043124,0.384781,0.103754,-0.104167,0.101730,0.127422, &
            -0.726019,0.072240,-0.199126,0.059257,0.250735,-0.828917,0.145015,0.797500, &
            0.056053,-0.129060,-0.053300,-0.142876,0.203143,-0.492972,0.061240,1.077600, &
            0.003228,-0.418514,0.064514,0.260355,0.398770,0.034026,0.273167,0.554029, &
            0.129467,-0.176415,-0.063231,0.237538,0.247020,-0.242343,0.251103,-0.504623, &
            0.332370,-0.059570,0.142261,0.036207,-0.052575,0.266660,0.059306,-0.889712, &
            0.218333,-0.243655,0.030352,-0.144638,-0.235278,-0.400373,-0.247379,0.486967, &
            -0.041522,-0.039406,-0.078673,0.209813,-0.041930,-0.427112,0.003297,-0.218416, &
            0.054486,0.052487,0.074761,-0.271559,-0.077954,0.553319,-0.110490,-0.404082 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.447292,-0.080278, &
            -0.119501,2.533466, &
            -6.274252,-0.940547, &
            -0.917444,0.191379, &
            -1.090370,0.402075, &
            1.640820,-0.374720, &
            2.302668,1.960139, &
            -0.407003,0.190961 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.499441,1.171699/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.17879,1.474013,0.572378,0.302743,1.081303,-1.125854,-2.57311,0.126815/)
real, dimension(2) :: bias2 = &
(/0.411088,-0.537356/)
real, dimension(1) :: bias3 = &
(/0.503081/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
