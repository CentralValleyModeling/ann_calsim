module fnet_Beldan

! a = 4.5804e-005
! b = 0.091868

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.409925,-0.236792,-0.200800,-0.132808,-0.126015,-0.025528,-1.378399,0.320200 &
			,0.093135,-0.057230,0.102502,0.022369,-0.007399,0.024630,-1.251541,0.287194 &
			,0.194862,0.009297,-0.047128,0.002993,-0.047683,0.037005,-1.266254,-0.001995 &
			,0.058183,-0.048509,0.007828,-0.002722,0.033755,0.016106,-0.976927,0.026877 &
			,0.134629,-0.022127,0.023743,0.000057,0.015643,0.037137,-1.110877,0.044375 &
			,0.096596,0.017737,-0.068909,0.031025,-0.104722,-0.000076,-1.308092,0.000297 &
			,0.055590,-0.045109,-0.015242,-0.001993,0.011232,-0.002143,-1.249941,-0.001829 &
			,0.209704,-0.095937,0.014357,-0.010615,0.011491,-0.006218,-1.530922,0.085668 &
			,-0.020072,-0.424935,-0.197931,-0.119130,0.228461,-0.182901,-2.763591,-0.257363 &
			,-0.453453,-0.263693,0.070442,-0.037918,0.390091,-0.097245,-1.013506,-0.612981 &
			,-0.933079,-0.062479,0.046595,-0.051258,0.417798,-0.105424,-0.232541,-0.968242 &
			,-0.414801,-0.209889,-0.200107,-0.012758,0.063344,-0.356531,0.521736,-0.846295 &
			,-0.029423,-0.044254,-0.138389,-0.205265,0.239600,0.072647,0.275519,-0.338701 &
			,-0.494825,-0.087825,0.032624,-0.160848,0.471542,0.173627,-0.454014,-0.544738 &
			,-0.154326,0.074733,0.005277,-0.479976,0.658182,0.056471,-0.020225,-0.705048 &
			,0.240265,0.021560,-0.047058,-0.418530,0.798244,0.727540,-0.460283,-0.020126 &
			,0.429633,-0.081599,-0.040947,0.254912,0.218971,0.118799,0.461053,0.029726 &
			,-0.679391,0.479451,-0.123788,0.621104,-0.242090,0.144617,0.966392,-0.068538 &
			,0.552974,0.133224,-0.311035,0.111227,-0.123184,0.340649,-1.097308,0.458421 &
			,0.424323,-0.182959,-0.118624,0.210089,0.028078,0.237836,-1.298842,0.659912 &
			,0.451277,-0.062335,-0.167909,0.198877,-0.174578,0.033849,-0.817629,0.364993 &
			,0.540274,-0.020047,-0.119621,-0.103715,-0.113002,-0.062276,-0.593737,0.298893 &
			,0.410594,-0.193306,-0.341679,-0.090033,-0.129181,-0.111101,-0.720536,0.078840 &
			,0.540563,-0.297426,-0.222656,-0.046572,-0.230130,-0.281032,-0.595672,0.174234 &
			,0.386156,-0.184393,-0.307919,-0.264473,0.002696,-0.096518,-0.071890,0.268107 &
			,0.549578,-0.057428,-0.223404,-0.076339,0.005274,-0.098408,-0.121639,0.023550 &
			,0.412791,0.115607,-0.181587,-0.333575,0.036684,-0.232965,-0.186993,0.262489 &
			,0.642350,0.607508,-0.221540,-0.139319,0.123626,0.091229,-0.202167,0.545700 &
			,0.912644,1.083084,-0.239091,-0.720291,-0.024672,0.290335,-0.054896,1.333284 &
			,0.606713,0.224711,-0.125931,0.028201,0.037495,0.523801,0.293170,-0.482368 &
			,0.276684,0.394583,-0.791636,0.075516,-0.458080,0.094502,1.485822,-0.637364 &
			,0.531840,0.565036,-0.768233,0.642934,-0.336036,-0.158989,2.067642,-0.578992 &
			,-0.067382,0.505574,-0.069103,0.227731,-0.475474,0.172784,0.518553,-1.006085 &
			,-0.444262,0.231698,-0.174028,-0.109694,0.103881,-0.148127,0.778142,-0.800675 &
			,-0.498518,0.287932,-0.076687,0.057153,0.111256,-0.421386,0.250523,-0.760601 &
			,-0.922742,0.037992,0.310942,-0.228991,-0.186621,-0.499266,0.385722,-0.336227 &
			,1.410984,0.276275,-0.127577,-0.824501,0.119915,1.322016,0.915193,2.598655 &
			,1.410977,0.027624,0.637766,-1.260583,-0.348914,1.444113,0.482314,2.558536 &
			,1.243772,-0.216979,0.969868,-1.889134,-0.435648,1.792664,0.408560,2.202808 &
			,1.014396,-0.310245,1.016596,-2.108193,-0.777716,1.985978,0.068781,2.300808 &
			,1.049687,-0.204328,1.277756,-1.915591,-0.868470,2.170784,0.169289,2.547883 &
			,1.026770,-0.252288,1.338899,-2.151413,-0.926211,2.084075,-0.203562,2.462545 &
			,1.120853,-0.500186,1.649354,-2.210186,-1.471699,2.263669,-0.604422,2.117293 &
			,0.850038,-1.138413,2.246303,-2.118952,-1.895666,2.644156,-0.686707,1.833809 &
			,-1.333088,-4.491282,4.647669,-2.870131,-4.560864,5.075280,-0.370781,-0.286458 &
			,-0.628874,-4.943164,5.007851,-1.538242,-5.443071,5.354747,-1.793803,-1.142263 &
			,1.475423,-2.927525,3.122257,0.781853,-3.184540,3.939561,-3.683318,0.689761 &
			,2.202616,-1.168322,1.804541,0.990102,-1.390421,2.382870,-3.751997,1.163862 &
			,2.481102,-0.206361,0.185363,0.811724,-0.296530,1.253533,-2.981348,1.945957 &
			,1.833137,-0.240566,-0.335441,0.834117,0.192233,0.745551,-2.129738,1.791588 &
			,1.089169,-0.025613,-0.221410,0.301712,0.139892,0.657680,-2.765755,1.101840 &
			,0.660720,-0.026557,-0.590924,0.249265,0.240005,0.838826,-3.164588,0.795588 &
			,0.192258,-0.349876,-0.626304,0.074619,0.182379,0.476819,-2.934116,-0.033963 &
			,-0.640028,-0.520132,-0.758317,2.023637,0.710875,0.583098,-2.511022,-1.309867 &
			,0.065658,-0.180195,-0.251190,0.232922,0.003866,0.233023,0.219768,0.366880 &
			,0.094060,-0.218611,-0.028799,0.327457,0.152838,0.219329,0.111001,0.457600 &
			,0.335245,-0.365793,0.118242,0.354236,-0.185669,0.057683,0.162337,0.486519 &
			,0.090620,-0.581805,0.048762,0.202522,-0.195810,0.269862,-0.043785,0.430873 &
			,0.352206,-0.533443,0.256192,0.156069,-0.401110,0.371179,-0.368356,0.175959 &
			,0.295777,-0.743933,0.292638,-0.020903,-0.374775,0.412052,-0.138715,0.202036 &
			,0.180247,-0.701029,0.317725,0.084545,-0.129955,0.450736,-0.579700,0.135677 &
			,0.146036,-0.688437,0.206102,0.070182,-0.433470,0.472639,-0.202453,0.278692 &
			,-0.245073,-1.210190,0.845668,0.037412,-0.783656,0.467140,-0.446275,0.200581 &
			,-0.176818,-0.972700,0.656886,-0.479346,-0.630736,0.769973,0.160423,0.182154 &
			,-0.658178,-1.437169,0.904121,-0.790227,-0.431622,1.155722,0.540393,-0.309429 &
			,-0.429078,-0.295765,0.002056,-0.742083,0.382566,0.415092,0.171705,0.061187 &
			,-0.028552,0.269745,-0.329109,-0.607542,0.528846,0.792052,-0.526838,-0.004272 &
			,-0.161344,0.033858,-0.117923,-1.488136,0.185031,0.473654,-0.227843,-0.406248 &
			,-0.489129,-0.401411,0.276615,-1.923282,0.336263,0.160389,0.846866,-0.214970 &
			,-0.606008,-0.709633,-0.044010,-1.453558,0.097016,-0.473961,1.140069,-0.609645 &
			,-0.151783,-0.710841,-0.317976,-0.248260,0.410602,-0.459297,0.817659,-1.640078 &
			,-0.050253,-0.931176,-0.453314,1.358910,1.073243,-0.268529,0.227487,-2.577905 &
			,-0.370843,0.067781,0.070980,0.255029,-0.120863,-0.003493,-0.992220,-0.048842 &
			,-0.263617,-0.026119,-0.050984,0.120069,0.000609,-0.047901,-0.339982,-0.038803 &
			,0.005302,-0.167491,-0.005055,0.196540,-0.050653,-0.042242,0.033578,-0.017681 &
			,-0.119846,0.109433,0.066015,0.075811,0.013125,0.087282,-0.166237,0.000585 &
			,0.021756,-0.154001,-0.021090,0.152623,-0.099246,-0.046897,-0.188042,-0.066628 &
			,-0.151959,-0.044793,-0.022028,0.171994,0.026630,0.130259,-0.130012,0.053051 &
			,-0.200799,-0.028615,0.148955,0.224130,-0.169319,-0.144111,-0.267043,0.044792 &
			,-0.583330,0.043060,0.049261,0.347054,-0.281791,-0.074287,-0.918236,-0.004304 &
			,-1.003023,-0.220730,0.499928,0.646428,-0.635706,0.142149,-1.419055,0.019240 &
			,-0.748029,-0.350645,0.436571,0.301387,-0.759121,0.118987,-0.387352,-0.030373 &
			,0.071296,-0.009286,0.071026,-0.171330,-0.203597,-0.152968,1.534753,0.109116 &
			,-0.048183,0.160149,0.090586,-0.030284,-0.273312,-0.215856,1.669312,0.676888 &
			,0.283903,0.026827,-0.385336,-0.299608,-0.184191,-0.333417,2.681470,0.197023 &
			,0.255500,0.312030,-0.395136,0.196322,-0.298933,-0.252999,2.514795,0.533497 &
			,0.139275,0.323687,-0.157919,-0.454334,-0.117449,-0.093232,2.108322,0.766467 &
			,0.100788,0.040027,-0.240818,-0.972297,-0.038630,-0.046794,1.340968,0.275003 &
			,-0.166882,-0.051079,0.259603,0.093738,-0.287927,0.249493,0.010246,0.693137 &
			,0.242970,-0.029114,0.020551,-0.008540,-0.115255,0.213480,-0.500873,0.714763 &
			,-0.200602,-0.281489,0.401527,-0.048919,-0.105419,-0.508155,-1.213810,0.258414 &
			,-0.268041,-0.233828,0.097788,-0.087321,0.121661,-0.156360,-1.018026,0.376901 &
			,-0.310881,-0.357546,0.177861,0.044267,0.314305,-0.118526,-0.977639,0.028235 &
			,-0.178001,-0.106523,0.241903,0.427883,-0.053488,-0.130240,-0.995011,0.169271 &
			,-0.195629,-0.342754,0.233364,0.409620,0.006535,-0.156187,-0.935455,0.165664 &
			,-0.422384,-0.187829,0.171036,0.239051,0.278451,-0.305149,-0.502633,-0.181856 &
			,-0.413173,-0.429104,0.054049,0.191804,0.241783,-0.131434,-0.466119,-0.127196 &
			,-0.484246,-0.104477,0.026628,0.097542,0.158594,-0.107018,-0.558599,-0.060398 &
			,0.002427,0.268119,-0.253917,0.295780,0.479417,-0.377613,-0.238776,0.108690 &
			,-0.413683,0.058975,-0.177999,0.360181,0.401217,-0.474901,0.481489,-0.488765 &
			,-0.217261,0.409656,-0.287310,-0.136593,0.472511,-0.188879,0.475149,0.076136 &
			,-0.448024,-0.038959,0.237502,-0.275614,0.235837,-0.003850,0.626711,-0.686279 &
			,-0.065945,0.070327,-0.364841,0.095081,0.118933,-0.285206,0.823591,0.226446 &
			,0.223715,0.301159,-0.502822,0.337035,0.161802,-0.228712,1.206241,0.670274 &
			,-0.332235,0.081705,0.278073,0.070400,0.033319,-0.065978,0.652988,-0.176834 &
			,-0.422173,-0.011101,0.027052,0.086628,-0.144172,-0.187322,0.232309,-0.042372 &
			,-0.220466,-0.048960,0.119924,0.445021,0.227051,0.061496,-0.151668,0.011858 &
			,0.069713,-0.090334,0.657772,-0.067410,0.259172,-0.082445,-0.686382,0.175516 &
			,0.038538,0.029626,0.049815,0.029757,-0.041560,-0.152100,0.528262,-0.740611 &
			,0.430818,0.326889,0.034842,-0.225234,0.031740,-0.170368,0.367884,-0.413872 &
			,0.518099,0.433695,-0.016469,-0.540432,0.022288,-0.358278,0.132845,-0.658291 &
			,0.460247,0.360752,-0.094387,-0.542993,-0.261803,-0.385285,0.136497,-0.278443 &
			,0.580446,0.230822,-0.034017,-0.296021,-0.101210,-0.107228,0.201387,-0.272019 &
			,0.565828,0.348277,0.046973,-0.422926,-0.203321,-0.236704,0.305757,-0.159963 &
			,0.379565,0.275952,-0.012636,0.034900,-0.263672,-0.022482,0.328665,0.012286 &
			,0.400855,0.071298,0.059063,-0.196690,0.006417,-0.080762,0.042768,-0.129854 &
			,-0.111015,0.319843,0.165593,-0.316279,-0.018648,-0.263807,0.133694,0.137583 &
			,-0.697048,-0.244485,0.199905,-0.194354,0.296162,-0.266432,-0.296257,-0.056864 &
			,-0.256162,-0.224447,0.040587,-0.240312,0.418250,0.164573,-0.400042,0.039043 &
			,-0.080209,0.028686,0.157959,-0.376314,0.410398,-0.038407,-0.275985,0.232292 &
			,-0.455289,-0.004034,0.089164,-0.075655,0.214343,-0.044739,0.445344,-0.026056 &
			,-0.677237,-0.210683,0.612684,0.436778,0.257900,-0.023552,-0.444428,0.330972 &
			,0.087288,0.084131,0.003027,-0.168702,-0.034836,0.115211,-0.602213,0.629350 &
			,0.462611,-0.214234,0.174822,-0.068038,0.081164,0.011066,-0.231281,-0.164338 &
			,0.606329,-0.113629,0.021344,0.140140,-0.255929,-0.048379,0.154082,-0.209049 &
			,-0.243377,0.178782,-0.363889,-0.107221,-0.384757,-0.035346,0.495069,0.567071 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.441477,0.550753 &
			,0.114740,2.864816 &
			,0.545830,-2.481766 &
			,0.223003,2.336952 &
			,-0.207960,1.957834 &
			,0.099818,-2.671472 &
			,-0.606039,-3.180525 &
			,-0.745321,0.812736 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.866044,1.985445/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.216893,0.273177,-0.229313,0.489291,0.391273,-0.552696,-0.681136,0.516331/)
real, dimension(2) :: bias2 = &
(/-0.175608,0.310487/)
real, dimension(1) :: bias3 = &
(/0.331208/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
