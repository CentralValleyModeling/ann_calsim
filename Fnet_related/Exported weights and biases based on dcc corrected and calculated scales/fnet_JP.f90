module fnet_JP

! a = 0.0002308
! b = 0.06699

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.253057,-0.118246,-0.051229,0.008107,0.015776,-0.032902,-0.001186,0.193795, &
            0.050138,-0.084344,0.031756,-0.026749,-0.064874,0.008480,-0.033818,0.032593, &
            0.172862,-0.010926,-0.018240,-0.091389,0.019409,-0.180118,-0.109946,0.061713, &
            0.094268,0.082828,-0.010453,-0.062923,0.056204,-0.035255,-0.037379,0.067053, &
            0.019440,0.025803,-0.053397,-0.032730,0.028011,-0.038368,-0.025712,0.036545, &
            0.070535,0.254157,-0.016936,0.057863,0.027186,0.043014,0.060512,0.018981, &
            0.071613,0.021497,0.082189,-0.012796,-0.062258,0.034537,0.047963,0.017846, &
            0.147111,0.264632,0.175246,-0.066543,-0.055674,0.115819,0.119908,0.049927, &
            -0.079354,0.271434,-0.046367,-0.311995,0.078514,0.176427,0.535184,-0.203044, &
            0.043746,0.573299,0.085933,-0.140801,0.085869,0.103420,0.286135,-0.020071, &
            -0.192512,0.369342,-0.164287,-0.148656,0.008796,-0.256513,-0.026762,-0.145280, &
            0.052898,0.013227,0.006813,-0.040604,0.150180,-0.042694,-0.007852,-0.227146, &
            -0.176560,0.229034,-0.042808,-0.104247,-0.112593,-0.328479,-0.172743,-0.160978, &
            0.163056,-0.015994,0.034032,0.120801,-0.154587,-0.078155,-0.011858,0.094865, &
            -0.093930,-0.165851,0.004397,-0.060144,0.074697,0.086492,-0.056817,0.072434, &
            0.126405,-0.058031,-0.112361,-0.011314,0.047893,-0.014598,0.451701,-0.205259, &
            -0.260249,-0.466404,0.059496,0.093521,-0.690149,-0.254968,0.656440,-0.503073, &
            0.013306,-0.371381,0.137433,-0.106932,-0.164566,-0.138598,0.204294,-0.162139, &
            -0.353421,0.326856,-0.100533,0.430644,0.350170,0.408194,-0.191241,-0.238252, &
            -0.083588,-0.038588,0.111961,0.214970,0.280082,0.110923,0.218223,-0.407304, &
            -0.270583,0.183307,0.106412,0.303591,0.206528,0.245008,0.125497,-0.148655, &
            -0.499792,0.271049,0.251177,-0.078467,0.191817,0.311447,0.174726,-0.271206, &
            -0.220344,0.079013,0.178360,-0.203216,0.338890,0.008695,-0.021453,-0.165137, &
            -0.492373,0.270339,0.254032,0.010674,0.083228,0.069295,0.131865,-0.365720, &
            -0.302332,-0.012731,-0.063741,-0.086033,0.438279,-0.097873,0.099138,-0.362345, &
            -0.378496,-0.120726,0.126428,0.206588,0.166391,-0.157151,0.021065,-0.120326, &
            -0.255228,0.184536,0.494400,0.337383,0.489895,-0.399316,0.209020,0.563912, &
            -0.117496,0.288992,0.512872,0.500090,0.079521,-0.257099,0.497838,0.502551, &
            -0.709658,0.834259,0.587228,-0.223279,0.069785,-0.072221,0.004376,0.260274, &
            -0.555139,1.082239,0.132741,-0.076144,-0.054901,-0.305233,-0.287172,0.236663, &
            -0.425513,0.731687,-0.286570,-0.194658,0.064054,-0.572522,-0.001299,-0.114693, &
            0.183913,0.141128,-0.372084,0.011838,0.294066,-0.348204,0.269972,-0.143546, &
            -0.003510,-0.213375,-0.259633,-0.217391,0.211018,-0.179725,-0.080849,0.113662, &
            -0.255561,-0.147040,-0.238881,-0.173783,0.009988,-0.336751,-0.098768,0.139955, &
            0.057185,0.021811,0.223267,-0.148688,-0.161213,-0.368304,0.005548,-0.401247, &
            0.167236,-0.373660,0.023281,-0.300284,0.130897,-0.223412,-0.152783,0.041043, &
            0.314171,-0.880335,-0.945090,0.718031,-1.087578,0.080396,-0.335017,3.555530, &
            0.848314,-0.205705,-1.933843,-0.013195,-1.736031,0.754222,-0.612096,3.364085, &
            0.701415,-0.167345,-2.025486,0.041599,-2.170255,0.632441,-0.361408,3.428716, &
            0.602645,-0.813844,-2.407653,0.492611,-2.196890,0.808891,-0.263929,3.444362, &
            0.839020,-1.093183,-2.799736,0.402489,-2.216269,0.721945,-0.299898,3.453696, &
            0.723332,-0.898571,-2.857109,0.102554,-2.597909,0.943880,-0.390481,3.448862, &
            1.271185,-0.611502,-3.319750,-0.109155,-2.983985,1.570088,-0.788567,3.174212, &
            2.142473,-0.573264,-3.704188,-1.080381,-3.452947,1.818092,-1.292955,3.028406, &
            6.005595,2.390846,-6.736403,-5.561472,-6.484003,5.836530,-4.716532,-0.080175, &
            6.024979,1.397603,-6.497557,-5.373405,-6.116758,6.511188,-3.997349,0.579883, &
            3.789859,-0.049848,-3.878850,-2.845121,-3.895470,4.867804,-2.463836,2.257889, &
            1.768671,-0.241148,-1.708788,-0.595818,-1.742543,3.009330,-1.367636,2.633264, &
            1.185407,-0.385447,-1.245298,0.070860,-0.851547,1.982138,-1.227404,2.224572, &
            0.652113,-0.315504,-1.153553,0.027612,-0.407459,1.388908,-0.890248,2.448021, &
            0.234040,0.034252,-0.879926,0.421863,0.003096,0.806273,-0.268043,2.141310, &
            -0.028648,0.861644,-0.899327,0.071382,-0.253103,0.471162,-0.596085,1.592704, &
            -0.482201,1.101222,-0.597999,0.171302,-0.321983,0.105036,-0.557613,1.392819, &
            -0.194554,1.058325,-0.266103,-0.627786,-0.561817,0.369185,-0.646564,1.719220, &
            0.400598,0.448111,-0.469577,-0.406021,-0.109014,0.739852,-0.482434,1.324434, &
            0.494594,0.372237,-0.603370,-0.269544,-0.388613,0.701665,-0.293230,1.075019, &
            0.461331,0.098291,-0.526804,-0.400660,-0.543971,0.844843,-0.175996,0.994263, &
            0.732172,0.313737,-0.667962,-0.348834,-0.528757,0.500447,-0.418652,1.029289, &
            0.884247,0.218311,-0.770539,-0.246846,-0.271637,0.931392,-0.361658,0.790659, &
            0.641877,-0.000550,-0.529845,-0.048299,-0.574064,0.660517,-0.466766,0.878083, &
            0.731359,0.033926,-0.784386,-0.033891,-0.665285,0.992019,-0.556426,0.972380, &
            0.861623,0.383125,-0.691764,-0.093715,-0.817671,0.949933,-0.534250,0.827512, &
            1.647126,0.665476,-0.696513,-0.424147,-1.001768,1.541384,-1.141477,0.109794, &
            1.666876,0.760954,-0.867223,-0.324169,-1.142718,1.976143,-1.705541,-0.204251, &
            1.202689,0.494721,-0.596374,-0.411056,-0.609952,1.349293,-1.034694,0.122515, &
            0.614632,0.679656,-0.349798,-0.015158,-0.291259,1.114933,-0.701463,0.229864, &
            -0.031987,0.368854,0.047802,0.261290,0.211440,0.771377,-0.472915,0.426676, &
            -0.226344,0.697373,0.409025,0.344184,0.187760,0.274672,-0.190902,0.221264, &
            0.323292,0.663806,0.219322,0.300300,0.102179,0.445462,-0.150720,0.173758, &
            0.446282,0.816906,-0.378014,0.421185,-0.154745,0.390362,0.221550,0.198527, &
            0.230180,0.260896,-0.564990,0.342718,0.050142,0.329758,0.556354,-0.075957, &
            -0.411823,0.159148,-0.563964,-0.232676,-0.274776,-0.085921,1.072734,-0.004338, &
            0.228747,-0.306681,0.071540,0.424990,-0.107923,-0.004430,0.139802,-0.197784, &
            0.072200,-0.029509,0.200147,0.163646,-0.108532,0.090649,0.078750,-0.041389, &
            0.021785,-0.083498,0.093459,-0.061912,0.028424,-0.084628,-0.026857,-0.070845, &
            0.128441,0.068153,-0.036157,0.047899,0.018906,-0.000788,0.051582,0.061079, &
            0.238491,-0.111295,-0.034207,0.105260,0.015568,-0.096151,0.093464,-0.052646, &
            0.130606,0.115165,0.064342,0.059472,0.008003,0.107876,0.031295,0.065645, &
            -0.095580,0.140897,-0.165605,-0.011342,-0.058979,-0.141816,0.114032,-0.042914, &
            -0.043610,0.014485,0.180915,0.394810,-0.426038,0.228342,0.026498,-0.047832, &
            -0.439109,0.205326,0.091473,1.057023,0.068494,-0.135445,0.101531,-0.579018, &
            -0.133105,-0.206635,-0.077358,0.263004,-0.313755,-0.067920,-0.496902,-0.294144, &
            0.058336,-0.063642,0.418998,-0.272247,0.320352,-0.020539,-0.295817,0.017867, &
            -0.215890,-0.536356,0.179938,-0.691032,0.152993,-0.137888,-0.624482,-0.054213, &
            -0.035017,-0.647636,0.458295,-0.735361,0.493681,-0.234871,-0.929709,0.716628, &
            -0.214892,-0.027387,0.368207,-0.722916,0.133950,0.035320,-0.498685,-0.003355, &
            0.293883,-0.797059,0.243616,-0.417232,0.532812,-0.606542,-0.296811,-0.142797, &
            0.776459,-0.123449,-0.051667,-0.772875,0.251418,-0.176658,-0.071753,-0.191293, &
            0.039487,-0.404076,-0.193446,-0.131420,-0.275614,-0.040511,-0.113531,-0.157366, &
            0.299305,-0.151244,-0.264263,-0.257118,-0.261640,-0.476202,-0.022528,-0.500261, &
            0.024931,-0.209941,-0.033674,-0.133541,0.077819,0.147973,-0.024172,0.134781, &
            0.006519,-0.238943,0.061654,0.146851,0.159381,-0.008428,-0.323453,-0.037176, &
            0.120115,-0.051226,0.076611,-0.031295,0.046878,-0.113267,-0.213512,0.044895, &
            0.117084,-0.101455,0.290587,-0.087721,0.097288,0.052793,-0.045776,-0.181912, &
            0.093007,-0.197148,0.248076,-0.062918,0.134955,0.105803,-0.109037,-0.174084, &
            0.136536,0.121467,0.365942,-0.236699,0.376915,0.147480,-0.160673,-0.117584, &
            -0.049618,0.111218,0.302888,-0.071594,0.132262,0.199288,-0.026524,-0.197570, &
            -0.144192,0.211234,0.304011,-0.104570,0.343373,0.199803,0.081990,-0.530543, &
            -0.587236,-0.089944,0.434186,0.219457,0.614723,-0.498726,0.429188,-0.359967, &
            -0.761692,0.076439,0.334845,-0.131826,0.357560,-0.654305,0.421415,-0.654873, &
            -0.745079,0.127079,-0.140381,-0.685773,0.351247,-0.675593,-0.435537,-1.071927, &
            -0.413937,-0.061000,-0.055268,0.024506,0.324878,-0.492829,-0.073072,-0.553125, &
            -0.102917,-0.094696,-0.085664,0.106110,0.079820,-0.619163,-0.224204,-0.689049, &
            0.105949,-0.107136,-0.077739,0.148405,0.137097,-0.384872,-0.008126,-0.634554, &
            -0.119445,-0.311320,0.173759,0.330388,0.206516,-0.179912,0.030769,-0.560787, &
            0.300676,0.205384,0.174582,0.066926,0.081658,0.092839,-0.019759,-0.679484, &
            0.177631,0.148953,0.293734,0.546330,-0.083903,0.104714,0.313911,-0.687934, &
            0.353966,-0.074858,0.028707,0.729313,-0.111820,-0.106107,0.204412,-0.782617, &
            -0.024886,0.007759,0.079997,-0.226782,-0.273640,-0.115183,0.027617,0.321610, &
            -0.052654,-0.072098,0.173549,-0.198749,-0.257025,-0.010611,-0.004780,0.257041, &
            -0.020872,-0.037041,0.160464,-0.155049,0.022262,0.151200,0.004846,0.052157, &
            0.009877,-0.155444,0.168213,-0.136920,-0.096345,0.055226,0.023752,0.122126, &
            -0.121888,-0.302340,0.084665,-0.031623,-0.025632,0.081392,-0.085628,-0.040009, &
            -0.138484,-0.304151,0.040199,-0.036010,0.033028,0.138617,-0.003348,-0.136754, &
            -0.110946,-0.279721,0.067445,-0.039018,0.081674,0.153383,-0.018284,-0.179383, &
            -0.035578,-0.150249,-0.038759,-0.051785,0.052789,0.172084,0.186217,-0.030701, &
            -0.013115,0.127547,0.010776,0.017323,0.114920,0.145988,-0.015177,-0.125003, &
            0.037126,-0.222458,0.075357,-0.021130,-0.038152,0.087226,0.034399,-0.087801, &
            0.075087,-0.024188,-0.268053,-0.168716,0.173533,-0.389611,-0.101833,-0.257662, &
            0.366949,-0.354661,-0.257587,-0.139825,0.133247,-0.330038,-0.054068,0.148279, &
            0.142180,-0.157254,0.095247,0.155909,-0.153728,-0.137224,-0.127573,-0.143255, &
            -0.080089,-0.081565,-0.052024,-0.125273,0.110248,0.072564,0.078071,-0.042778, &
            -0.038209,-0.101755,-0.018094,-0.027894,-0.171256,-0.056427,0.080038,0.128385, &
            0.097592,0.526830,0.168699,0.026344,-0.115652,-0.021622,0.099181,-0.166545, &
            0.144763,0.338065,-0.147840,-0.207461,0.072144,-0.368982,-0.055073,0.044069, &
            0.000167,0.417348,-0.009775,0.176747,-0.145809,0.123150,0.239987,0.042459 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.167885,-1.952591, &
            0.126851,-0.326159, &
            1.037097,4.278845, &
            -0.615986,3.132528, &
            0.936072,3.042882, &
            -1.411080,-2.968605, &
            -1.542058,2.704586, &
            -2.058403,0.005989 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.288929,2.855771/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.930928,-1.490185,1.216693,0.875616,1.115952,-1.019966,0.793569,0.631587/)
real, dimension(2) :: bias2 = &
(/-0.112897,-0.429411/)
real, dimension(1) :: bias3 = &
(/0.147355/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
