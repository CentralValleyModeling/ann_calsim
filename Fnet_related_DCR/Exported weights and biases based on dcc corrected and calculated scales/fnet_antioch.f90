module fnet_antioch

! a = 8.5267e-005
! b = 0.087541

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.157365,0.060611,-0.005953,-0.127094,0.046317,0.048133,-0.223808,0.013083, &
            -0.050312,-0.007334,-0.025272,-0.062414,-0.005675,-0.089223,0.107478,0.005821, &
            0.051097,0.051047,0.032447,-0.120275,-0.053808,0.061739,0.143373,-0.029462, &
            0.002330,0.000424,0.012429,-0.018243,0.202825,0.108161,-0.056513,-0.146009, &
            0.116486,-0.156094,0.022944,0.052151,0.085420,0.084616,-0.292118,-0.110541, &
            -0.041226,-0.037568,-0.009984,0.108707,0.101618,-0.004974,-0.105358,0.041842, &
            -0.020177,-0.138369,-0.158427,0.152428,0.044378,0.015599,-0.129896,0.056479, &
            -0.036312,-0.075901,-0.179647,0.116068,-0.056252,-0.087222,0.100486,0.051860, &
            -0.010244,-0.437375,-0.452332,0.444347,0.062183,-0.612000,-0.178125,-0.015810, &
            -0.089472,-0.009745,-0.394005,0.365082,-0.050006,-0.418592,0.330147,0.044420, &
            -0.237932,0.280696,0.151429,0.137404,0.228868,-0.964187,0.419115,-0.216796, &
            0.107015,0.096843,0.085216,0.125511,-0.027672,0.018347,0.655443,0.094573, &
            0.027675,0.247437,0.333706,-0.122739,-0.029223,-0.244892,-0.175485,-0.186232, &
            0.001205,0.066482,0.219290,-0.026527,-0.057993,0.221529,-0.563921,0.007088, &
            0.124844,-0.133735,-0.168317,0.061354,0.084406,0.225903,0.129451,-0.043216, &
            -0.140160,-0.228114,-0.047255,0.168957,0.161688,-0.300348,-0.167200,0.233281, &
            -0.044638,-0.071450,-0.060703,0.250947,-0.463093,-0.828690,-0.233889,0.377547, &
            0.093425,-0.032441,-0.170370,0.216513,-0.240835,-0.167944,-0.451024,-0.006520, &
            0.179582,-0.169897,0.249634,0.131760,0.162791,0.425718,0.063951,0.365245, &
            0.387201,-0.053493,0.055391,0.342369,0.213280,0.262728,0.123796,0.064786, &
            0.037086,-0.179786,-0.272539,0.294389,0.322488,-0.177639,0.088061,0.214112, &
            0.254020,0.004999,-0.177104,0.162056,0.186446,0.037080,-0.014325,-0.212942, &
            0.232325,0.103684,-0.205021,0.207409,0.023803,-0.020549,0.067855,0.028609, &
            0.181017,0.011837,-0.088202,0.019014,0.140409,-0.263854,-0.464041,-0.200230, &
            0.102088,0.338741,0.043028,0.146792,0.062041,-0.266568,-0.249075,0.002897, &
            0.116641,0.218326,-0.183187,0.110649,0.105328,-0.402148,-0.382974,0.270955, &
            0.179386,0.432088,-0.666904,-0.822475,0.174964,-0.400662,0.532143,0.130191, &
            0.236071,0.609258,-0.128563,-0.332148,0.085059,-0.197413,-0.117239,0.274200, &
            0.460494,0.127546,-0.449496,0.208106,0.088273,-0.167090,0.329184,-0.531632, &
            0.275442,-0.135017,0.025678,-0.175588,0.190412,0.135378,-0.753299,-0.191950, &
            0.333990,-0.290047,0.146508,0.236882,0.184636,0.028425,-0.443343,-0.183353, &
            0.078202,-0.175894,0.104485,0.263660,0.188738,-0.163811,0.087437,0.264396, &
            -0.136941,0.030311,0.160776,-0.169058,0.206123,-0.371111,0.353713,-0.019646, &
            0.319731,-0.026674,0.177018,0.064700,-0.021798,-0.128121,-0.268120,-0.518888, &
            0.153934,0.100548,-0.242652,0.246947,-0.124641,0.263346,-0.565361,-0.297668, &
            -0.046275,-0.067013,-0.059578,0.089291,0.208970,-0.068460,-0.721006,-0.302997, &
            -0.971225,-0.968958,1.305737,-4.135245,-0.327859,-0.001961,0.147528,1.215236, &
            -1.735371,-1.735948,2.100733,-3.389435,-1.260148,0.073729,0.754815,0.455138, &
            -2.211834,-2.029722,2.373750,-3.392268,-1.486561,0.208556,1.378088,0.282834, &
            -2.509159,-2.378607,2.586020,-3.401075,-1.346144,0.320724,1.384338,0.120936, &
            -2.483823,-2.517401,2.654527,-3.179997,-1.702251,0.213713,1.486349,-0.040958, &
            -2.981406,-2.603121,2.800779,-2.804226,-1.980812,0.777750,1.736376,-0.615015, &
            -3.243558,-3.219190,3.467338,-2.664096,-2.162088,0.956989,2.401425,-1.220614, &
            -3.841797,-3.567653,3.785779,-2.164311,-2.761659,1.804011,2.799611,-1.664783, &
            -6.523639,-6.228112,6.073041,0.435492,-5.556396,4.975905,5.389458,-5.228591, &
            -5.563521,-5.562368,4.803850,-2.044503,-4.299162,4.224343,3.825863,-4.056519, &
            -3.550677,-3.890864,2.282464,-4.119741,-2.112615,3.372941,2.008013,-1.539031, &
            -1.586114,-1.749172,1.007292,-3.719278,-1.051200,2.135042,0.694445,-0.196011, &
            -1.418308,-0.836822,0.580001,-2.349124,-0.388657,1.902788,0.876734,-0.084933, &
            -0.731047,-0.393634,-0.002097,-1.723514,-0.241123,0.808462,0.904752,0.247835, &
            -0.371855,0.152041,0.072923,-0.508160,0.030971,0.623020,0.673323,0.437108, &
            -0.282785,-0.020551,-0.165550,-0.691160,-0.229456,0.800964,0.698037,0.103903, &
            -0.199032,0.246794,-0.221502,-0.634056,-0.441885,0.830510,0.846422,-0.165376, &
            -0.277813,0.071836,-0.228673,-1.519357,-0.586967,0.593768,0.753772,-0.622538, &
            -0.261155,0.033366,0.716050,-1.018475,-0.074281,0.870596,0.529305,-0.033852, &
            -0.569973,-0.169440,0.846069,-0.783875,-0.222815,0.793512,0.428526,-0.107338, &
            -0.385360,-0.306710,0.728523,-0.761965,-0.205475,0.673685,0.520847,0.031656, &
            -0.478565,-0.592640,0.924729,-0.726621,-0.365859,0.508441,0.398359,-0.053867, &
            -0.467062,-0.597663,1.032319,-0.488125,-0.651501,0.842848,0.596362,0.262471, &
            -0.744283,-0.512525,0.978726,-0.384465,-0.672990,0.702676,0.583822,-0.044147, &
            -0.764036,-0.500526,0.817001,-0.408630,-0.787213,0.822937,0.473581,-0.107040, &
            -0.589460,-0.631162,1.043926,0.005303,-0.647347,1.010363,0.644093,-0.227656, &
            -0.828063,-0.491009,1.084285,0.353994,-1.249988,1.556513,0.575375,-0.369286, &
            -0.992995,-0.850753,0.948775,-0.198928,-0.854477,1.705812,1.044975,-0.370570, &
            -0.701254,-0.836923,0.221427,-0.857234,-0.351874,1.377974,0.646813,-0.048290, &
            -0.103763,-0.360170,0.026297,-0.888640,-0.291575,1.197152,0.601535,-0.215890, &
            0.075203,-0.233944,0.052557,-0.517195,-0.119231,0.550934,0.249547,0.075520, &
            0.218900,0.105145,-0.191896,-0.191832,-0.223176,0.272147,-0.006634,0.152311, &
            0.076693,-0.046544,-0.130898,0.147525,-0.083786,0.212758,-0.005297,0.195351, &
            -0.069246,-0.043686,0.451950,0.193248,-0.366323,-0.130886,-0.320364,0.004723, &
            0.022505,-0.212696,0.309100,-0.146436,0.107657,-0.423953,-0.563030,0.095949, &
            0.282280,-0.854259,0.370554,0.111845,-0.179031,-0.729273,-0.634925,-0.172853, &
            -0.016498,0.143315,-0.100610,-0.269211,0.048505,0.300348,-0.265377,0.305219, &
            -0.159060,0.075207,-0.007489,-0.220995,0.185481,0.157551,0.153363,0.152953, &
            0.045412,0.051201,-0.144890,-0.062509,-0.050089,0.197921,-0.204118,-0.091031, &
            -0.126570,0.084158,-0.076705,0.063381,0.155642,0.065519,-0.242350,-0.182184, &
            -0.241896,0.302948,-0.055721,0.052790,-0.080450,-0.075323,-0.423530,0.007725, &
            -0.044638,0.112104,-0.019093,0.181504,-0.096260,0.233057,-0.267531,0.032353, &
            -0.109002,-0.069850,0.087864,-0.064594,0.171780,-0.142382,0.088553,0.079920, &
            0.161079,-0.354757,0.039830,-0.130769,-0.133273,0.200824,0.300670,0.268426, &
            0.437859,0.109932,0.133192,0.078161,0.030238,0.254628,0.136263,0.835191, &
            -0.052282,0.144630,0.616216,-0.052968,-0.483365,0.557074,0.608157,-0.129575, &
            0.340726,0.087205,-0.064284,-0.017559,0.355582,-0.349607,0.636331,-0.225123, &
            -0.017425,0.290330,-0.147717,0.040939,0.133548,-0.112769,0.422377,-0.976716, &
            0.148375,0.350958,-0.017998,-0.422452,0.197876,-0.117536,1.026840,-0.515750, &
            0.114476,0.260116,-0.258333,0.015301,-0.208837,0.413667,0.787557,-0.622256, &
            0.322629,0.619753,-0.294675,0.218722,0.419191,-0.229416,-0.373738,-0.609005, &
            -0.152615,-0.085552,-0.084304,0.681468,0.023937,-0.026267,0.379438,-0.443039, &
            -0.266421,0.110496,0.234451,0.815966,-0.208321,0.283789,-0.165129,0.046522, &
            -0.230645,0.446044,0.083156,0.260487,-0.152044,0.181477,0.154748,-0.235446, &
            0.032166,-0.207079,-0.253992,-0.017270,-0.149902,0.185736,0.112046,0.080777, &
            0.190860,0.111444,-0.204712,0.031968,-0.083949,0.354737,0.141277,-0.069605, &
            -0.007887,0.109006,-0.151710,0.071173,0.090628,0.248559,0.010688,-0.049511, &
            -0.087280,0.130456,-0.343643,0.179300,0.193722,0.487780,-0.046019,-0.124436, &
            0.037499,-0.053244,-0.296242,0.155464,0.230737,0.199314,0.078744,-0.049797, &
            0.258107,0.009791,-0.281641,0.156589,0.045357,0.509555,0.125715,-0.213421, &
            0.168343,-0.089039,-0.390136,0.402030,0.164263,0.270112,-0.012758,-0.010836, &
            0.058787,0.062375,-0.229822,0.320323,0.301652,0.109493,-0.378549,0.011359, &
            0.298162,0.297355,-0.209265,-0.031437,0.351473,-0.323749,-0.655884,0.502958, &
            0.659459,0.076500,-0.317246,0.826786,0.195229,-0.519024,-0.549493,-0.224199, &
            0.250474,0.240387,0.220622,1.162528,-0.001181,-0.594077,0.134682,-0.243024, &
            0.311667,0.359273,0.383217,0.386886,0.169589,-0.546783,0.171253,-0.118088, &
            0.122445,0.244055,0.092021,0.520322,0.072911,-0.372940,-0.235636,-0.340944, &
            -0.027413,0.199953,0.228257,0.300071,0.151480,0.080953,-0.480923,-0.189251, &
            0.282400,0.214481,0.196358,0.206421,-0.060794,-0.052106,-0.164043,0.140409, &
            -0.078226,-0.038092,-0.127158,0.480197,-0.200339,0.208799,-0.128223,0.039516, &
            -0.022187,0.240590,-0.044135,0.260004,-0.285773,0.172548,-0.343773,0.459527, &
            -0.265912,0.205423,-0.008188,0.154809,-0.188375,0.333242,-0.173291,0.571524, &
            0.035046,-0.167598,-0.321899,0.216126,-0.110932,-0.070509,-0.053203,-0.064016, &
            -0.047760,0.037642,-0.077252,-0.049697,-0.049972,0.012403,-0.016628,-0.056542, &
            0.076646,-0.046084,-0.269614,0.129193,-0.145656,0.039315,0.335619,-0.012331, &
            -0.031812,0.167382,-0.060920,-0.077188,-0.087665,0.052291,0.186105,-0.081778, &
            0.092791,-0.046115,-0.001495,0.031660,-0.032230,0.161967,-0.042919,-0.001786, &
            0.060975,-0.024428,0.018940,-0.029248,-0.016070,0.027142,0.097526,-0.065629, &
            -0.187092,0.133523,-0.097995,-0.140813,0.088556,0.004059,-0.046295,-0.166078, &
            -0.007095,0.035744,0.086890,-0.012163,0.006361,-0.144044,0.010935,-0.180443, &
            0.002835,0.155131,0.113818,-0.123526,-0.136621,-0.209080,0.230334,-0.174773, &
            0.122288,-0.119514,0.041432,0.206662,-0.066531,-0.060338,0.523475,0.173936, &
            -0.028128,-0.024385,0.093343,0.277654,0.129176,-0.039423,-0.049729,-0.023690, &
            -0.156370,0.023084,0.019795,-0.113955,0.171433,-0.055854,-0.129945,-0.024183, &
            0.097652,0.086374,0.120894,-0.031926,-0.209075,-0.019190,0.285174,0.129064, &
            -0.090854,0.043336,0.189969,0.201053,0.184062,-0.172179,-0.210697,-0.117956, &
            -0.051390,-0.092664,-0.144980,-0.294423,-0.148346,-0.119105,-0.484329,-0.025183, &
            0.029827,-0.008086,-0.340779,0.291939,-0.197642,0.069684,0.136172,0.029866, &
            0.002828,0.088475,-0.091229,0.018933,-0.251495,-0.071593,-0.182335,-0.054638, &
            -0.043989,-0.012016,0.289527,-0.214451,0.034948,-0.036362,-0.084915,0.164283 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/5.265828,-0.046880, &
            2.847916,-0.809217, &
            -2.346236,-0.712534, &
            0.055178,-1.661414, &
            3.151403,0.754743, &
            -1.293950,-0.966033, &
            -0.839100,-0.188192, &
            3.250678,-0.463406 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.055213,1.588526/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.158355,1.43713,-1.200381,-0.664237,1.029939,-0.97281,-0.746389,1.109364/)
real, dimension(2) :: bias2 = &
(/-0.124758,0.171228/)
real, dimension(1) :: bias3 = &
(/-0.160871/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
