module fnet_antioch

! a = 8.5267e-005
! b = 0.087541

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.005636,-0.279628,-0.076980,0.062657,-0.087331,0.032411,0.033373,-0.150692, &
            0.008711,-0.027074,-0.191937,-0.090523,-0.078331,-0.110029,-0.035228,-0.048779, &
            0.125207,0.021469,0.041365,-0.076739,-0.050764,-0.041131,0.087328,-0.007112, &
            0.198328,0.040580,0.121254,-0.082996,0.034305,0.099649,0.017991,-0.125614, &
            -0.037700,0.144695,-0.029229,-0.025575,0.018685,-0.037318,-0.157875,-0.011904, &
            0.016676,0.088707,0.181421,0.027263,-0.034162,-0.221286,-0.034530,-0.042612, &
            -0.006233,-0.015079,0.189275,0.012760,-0.007639,-0.004703,-0.154352,-0.011381, &
            -0.002231,0.123427,0.094941,-0.054678,0.035188,-0.011571,0.054051,0.103872, &
            0.314275,0.047487,0.367266,0.022453,0.196567,-0.195355,0.460713,-0.315792, &
            0.043322,-0.112182,0.518640,0.269404,-0.050805,-0.147786,0.178895,-0.072254, &
            -0.187559,-0.130304,-0.501325,0.099183,-0.062922,-0.300159,-0.347797,-0.345833, &
            -0.267954,0.064386,-0.223399,0.116163,-0.158972,-0.561196,-0.044696,0.094309, &
            -0.129805,-0.028554,-0.135152,0.055044,0.146085,-0.098652,-0.245513,-0.242942, &
            -0.100456,0.120758,0.165087,-0.023542,0.264369,0.172818,-0.138073,-0.056345, &
            0.223492,0.099871,0.086641,-0.135186,0.112261,0.035040,0.350160,0.030723, &
            0.150639,-0.048233,0.177428,-0.167003,0.071070,-0.142001,0.013653,-0.040237, &
            -0.109857,-0.736784,0.182559,-0.548665,0.073970,-0.790609,0.095944,-0.034202, &
            -0.023047,0.002198,-0.181823,-0.422969,0.103074,-0.293018,-0.125211,0.135741, &
            0.042495,-0.130135,0.313100,-0.040695,-0.156433,-0.480293,0.381934,0.099514, &
            0.229742,-0.076622,0.205132,-0.094298,-0.043640,-0.446958,0.074436,0.146654, &
            0.083265,0.185101,0.166382,-0.046550,0.154963,-0.273600,0.000877,0.243758, &
            0.174684,0.126011,-0.053420,0.050026,0.049027,-0.243365,-0.020377,0.065692, &
            0.022508,0.105381,-0.063009,0.188958,0.061140,0.097218,-0.239771,0.238492, &
            0.088235,0.012717,-0.219292,0.155712,0.086316,-0.125029,0.003067,0.032206, &
            0.100147,-0.135610,-0.055971,0.200212,0.143534,0.158314,-0.105157,0.050856, &
            0.089043,-0.251833,-0.013154,0.495811,0.045468,-0.024978,-0.089204,0.110961, &
            0.560811,-0.173026,-0.805572,0.539736,0.105838,-0.105103,-0.149659,0.198084, &
            0.106042,-0.209503,-0.651180,0.254819,0.321787,-0.339702,-0.301447,0.121543, &
            0.343115,0.378012,-0.288285,-0.073703,0.386423,-0.275089,0.201092,0.280039, &
            0.311489,0.137372,0.454505,0.271338,0.358696,0.373971,0.177198,-0.092172, &
            0.117611,-0.242211,0.674547,-0.087894,0.528188,0.101156,0.048890,-0.390017, &
            -0.006997,-0.258715,0.429310,0.115132,0.075926,-0.020452,-0.220487,-0.091136, &
            -0.042459,-0.262110,0.225335,-0.252991,0.113966,-0.104415,-0.589349,-0.318671, &
            -0.090684,-0.037293,0.067833,-0.322846,0.283933,0.374795,-0.128978,0.226786, &
            -0.121130,0.054583,0.089752,0.221561,0.103391,0.364407,-0.383710,0.043456, &
            -0.275405,0.314987,0.330771,0.396151,0.275284,0.439264,-0.246797,0.022645, &
            -1.372415,-1.172594,-3.024605,-1.056568,0.355731,0.713677,0.954117,0.006762, &
            -1.901329,-0.659649,-2.791073,-1.756091,-0.144888,1.006098,1.709227,-1.039225, &
            -2.353264,-0.291961,-2.605447,-1.931900,-0.446591,1.222997,1.998279,-1.370285, &
            -2.229481,-0.295281,-2.652915,-2.255390,-0.478815,1.473565,1.980080,-1.392802, &
            -2.636025,-0.583454,-2.578601,-2.219006,-0.586814,1.523529,1.976982,-1.877714, &
            -2.969139,-0.057573,-2.205866,-2.331525,-0.932342,1.471872,2.169455,-2.333689, &
            -3.055110,0.356396,-1.940816,-2.673100,-1.393267,1.941841,2.871921,-2.827673, &
            -3.369241,1.412182,-1.094163,-3.002583,-2.106528,2.343155,3.168518,-3.217532, &
            -6.107592,5.296965,1.973226,-5.475982,-5.317686,5.060609,5.949622,-6.284083, &
            -4.569593,4.831286,-0.201849,-4.786538,-4.800607,5.550264,6.146533,-4.961289, &
            -2.099539,2.958579,-2.269446,-2.501060,-3.356743,4.698067,4.796273,-2.138470, &
            -0.459763,1.345480,-2.657080,-0.569581,-2.088273,3.538538,3.598748,-0.117417, &
            -0.251496,0.628454,-1.937927,0.296647,-2.125910,3.006648,2.749312,0.205319, &
            0.260872,0.561637,-2.145295,0.667653,-1.661591,1.699695,1.951632,-0.260361, &
            0.261941,0.653348,-1.822501,0.485800,-1.234198,0.970675,1.014592,-0.303662, &
            0.121400,0.817815,-0.990901,0.531608,-0.973567,0.997189,0.730324,-0.262122, &
            0.295079,0.502520,-0.934475,0.288969,-0.715481,0.766220,0.345640,-0.439321, &
            0.175394,-0.064766,-0.650847,0.462950,-0.061472,0.416571,0.569059,-0.535250, &
            -0.334737,0.260866,-0.369298,-0.227960,-0.420278,-0.475150,-0.389822,-0.368734, &
            -0.586935,0.265746,-0.388929,-0.284770,-0.177449,-0.351439,-0.024217,-0.724618, &
            -0.303581,0.434152,-0.161761,-0.668040,-0.559399,-0.347462,-0.256843,-0.425120, &
            -0.787940,0.220646,0.108961,-0.631110,-0.223765,0.073433,0.067334,-0.633285, &
            -0.712718,0.456337,0.191065,-0.815458,-0.447805,0.136699,0.034477,-0.962821, &
            -0.622528,0.268164,0.331030,-0.540009,-0.776163,-0.038420,-0.103079,-0.834083, &
            -0.612964,0.436619,0.514293,-0.569511,-0.660504,-0.094829,0.138427,-0.894377, &
            -0.870733,0.427155,0.564294,-0.722866,-0.588951,0.200206,0.163938,-1.139553, &
            -1.159560,0.355527,0.700303,-1.051278,-0.716376,0.131216,0.357844,-1.033254, &
            -1.024560,1.034832,0.966379,-0.945003,-1.631749,1.125264,0.986738,-1.140062, &
            -0.213154,0.102846,0.083021,-0.650276,-1.230280,0.778930,0.714069,-0.195659, &
            0.302186,0.163361,-0.625073,-0.401929,-1.184370,0.635618,0.442390,0.304382, &
            0.231204,-0.077668,-0.535291,0.000444,-0.813207,0.246299,-0.064896,0.443133, &
            0.166418,0.317287,-0.556340,-0.094375,-0.610567,0.352856,0.019657,0.482715, &
            -0.257249,-0.184321,-0.825193,-0.090884,-0.562325,0.260558,-0.127613,0.425956, &
            -0.179921,-0.062402,-0.947713,-0.142070,-0.506553,0.348171,-0.116666,0.180424, &
            -0.133342,-0.462582,-0.736722,-0.026339,0.014079,0.558751,-0.339573,0.357983, &
            -0.216763,-0.498746,-0.349214,-0.342608,0.125719,0.281730,-0.293274,0.197408, &
            0.110521,-0.601800,-0.060269,-0.123851,0.000449,0.029437,-0.064844,0.028675, &
            0.227026,-0.191518,-0.268659,0.012091,-0.082762,0.205607,0.052445,-0.126152, &
            0.096583,0.088270,-0.208462,0.076008,-0.128362,-0.012389,-0.179880,-0.122061, &
            0.136698,-0.090668,0.051460,-0.106598,-0.095187,0.098214,-0.128759,-0.105098, &
            -0.054954,-0.009122,0.031088,-0.061598,-0.028346,0.232024,-0.294541,0.144360, &
            0.121313,0.061266,0.071302,-0.062713,-0.126744,-0.057529,-0.211334,-0.228597, &
            0.076350,-0.137098,0.213986,-0.109107,-0.114092,0.011159,-0.174879,-0.122006, &
            -0.110893,-0.311673,0.100574,-0.252248,0.139398,-0.028903,0.481519,0.084533, &
            -0.085845,-0.371696,0.183819,-0.103545,-0.150200,-0.509054,-0.130837,0.274688, &
            -0.465305,0.246811,0.597378,-0.026559,-0.437318,0.481671,0.179720,0.022205, &
            0.113488,0.341708,-0.516071,0.569205,0.045277,-0.348027,0.277442,0.098880, &
            0.120988,0.585247,0.010195,0.332136,-0.188357,-0.103360,-0.448531,-0.428194, &
            0.143649,0.665438,-0.493883,0.551602,-0.250345,0.029023,-0.253244,0.380129, &
            -0.013756,0.679940,-0.066392,0.389723,-0.014923,-0.094342,0.200978,0.052035, &
            0.311020,0.183244,0.198463,0.775127,0.477242,0.047907,-0.363158,-0.344662, &
            0.023312,0.333674,0.192427,0.112380,-0.400977,-0.305612,-0.071991,-0.676368, &
            -0.277619,-0.155413,0.904446,-0.364202,-0.265444,-0.353676,-0.487311,-0.531721, &
            -0.191749,-0.129967,0.692903,-0.039835,-0.077073,-0.337932,-0.287862,-0.420430, &
            0.179136,0.091401,0.194426,0.119875,-0.191249,0.073933,0.189094,-0.061137, &
            0.077752,-0.070051,0.127696,0.107181,0.065327,0.206230,-0.181537,0.022191, &
            0.402341,-0.112957,-0.057753,0.100041,-0.328134,0.120877,0.006263,-0.014224, &
            0.195539,0.184998,0.332533,0.172699,-0.162243,0.018228,-0.107449,0.119357, &
            0.241553,0.236804,0.227832,-0.152754,-0.023225,0.165116,-0.001661,0.282828, &
            0.260183,0.502202,0.425694,0.091909,0.052246,0.191858,0.158737,0.270418, &
            0.274635,0.339532,0.155635,-0.151140,0.009287,-0.107570,0.280065,0.340640, &
            0.355507,0.055164,0.392309,-0.017844,0.011884,0.030754,0.142944,0.257390, &
            0.289061,-0.627192,-0.012010,0.041404,0.589012,0.124704,-0.045675,0.543443, &
            0.132727,-0.187889,0.857908,0.050319,0.435243,-0.029277,-0.475670,0.374687, &
            -0.189661,0.214123,1.032162,0.012582,0.234993,-0.369541,-0.444033,-0.173913, &
            -0.000117,0.110369,0.595800,0.143900,0.144265,-0.341184,-0.391432,0.099621, &
            -0.155726,0.193281,0.349166,0.193387,0.162929,-0.060261,-0.394742,-0.024365, &
            -0.176353,0.177037,0.161024,-0.006324,0.224843,0.055847,-0.085242,0.167538, &
            -0.097342,0.137152,0.163893,0.275746,0.150603,-0.088433,0.058157,0.092948, &
            -0.053200,0.249142,0.484048,-0.124941,0.128556,0.156626,-0.027153,-0.085099, &
            0.167733,-0.377436,0.072484,-0.174605,-0.082218,-0.126117,-0.151993,0.271357, &
            0.075630,-0.163859,0.130349,-0.186668,-0.218882,-0.169915,0.003423,0.296663, &
            -0.092578,0.352742,-0.254651,-0.061887,0.058118,-0.196161,-0.083843,0.038978, &
            0.040871,0.183693,-0.237184,-0.068230,-0.034367,-0.132531,-0.027300,-0.039678, &
            -0.127151,0.123563,-0.232851,0.088022,-0.097124,-0.134582,-0.003590,0.106559, &
            0.128074,0.103734,-0.132807,-0.089918,-0.008538,0.124107,-0.055470,-0.049779, &
            0.012928,0.132400,0.004260,-0.050345,0.048120,-0.056174,-0.063564,-0.080450, &
            0.106148,0.113787,-0.032381,-0.143066,0.046581,0.108756,-0.065143,0.009194, &
            0.100388,0.020324,0.023858,-0.056177,-0.106341,0.002628,-0.093575,-0.028099, &
            -0.029372,0.131682,0.157367,-0.010018,0.086832,-0.105790,0.164739,0.059829, &
            -0.110023,-0.387060,-0.038421,-0.006441,-0.201196,0.007625,-0.227286,-0.154495, &
            -0.192877,0.014384,0.037030,0.028700,0.061912,0.103505,-0.017213,0.206804, &
            -0.082748,0.182530,-0.471274,0.004773,-0.124565,-0.268005,-0.047728,-0.000494, &
            -0.004036,0.045819,-0.348320,0.062217,0.062775,0.001598,-0.001314,-0.210261, &
            -0.080903,-0.202336,0.416433,0.082714,0.025757,0.098336,-0.153693,0.007243, &
            0.020462,0.134869,-0.020050,0.186122,-0.062722,0.012803,-0.071256,-0.108534, &
            0.017269,-0.201188,-0.011470,-0.290058,0.017948,-0.024426,0.083253,0.134057, &
            0.067268,-0.033931,0.359477,0.070650,-0.016501,0.151987,0.132049,0.117269, &
            -0.016701,0.248850,0.178589,0.124877,0.068487,-0.014509,-0.193925,-0.097259, &
            -0.042991,-0.180914,-0.476799,-0.398415,-0.006767,-0.111966,-0.158595,-0.014841 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.305746,2.793138, &
            1.008914,-1.434520, &
            0.771713,-0.148199, &
            0.862753,3.409877, &
            0.115235,3.644258, &
            -1.823359,-1.983386, &
            -1.725050,-1.923126, &
            1.456732,3.841233 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.733847,2.510685/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.458476,-1.430716,-1.107527,1.455417,1.339922,-1.657867,-1.612496,1.615287/)
real, dimension(2) :: bias2 = &
(/-0.098541,0.194509/)
real, dimension(1) :: bias3 = &
(/0.149882/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
