module fnet_Beldan

! a = 4.5804e-005
! b = 0.091868

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.150009,-0.102283,-0.343496,-0.186876,-0.024373,-0.040669,-0.099169,0.017231, &
            -0.047891,0.002053,-0.101504,-0.180306,-0.036845,-0.017618,-0.042139,0.031971, &
            -0.032033,0.011553,-0.081656,-0.230192,-0.047310,-0.007983,-0.008215,0.010096, &
            -0.069640,-0.000807,-0.027175,-0.113890,-0.037253,-0.023897,-0.045586,0.064488, &
            0.013146,-0.010480,-0.071570,-0.077822,-0.005225,0.014095,-0.006816,-0.001139, &
            -0.130603,-0.070083,-0.110409,-0.018229,0.019555,0.003222,-0.085590,-0.037743, &
            -0.135127,-0.095559,-0.110335,-0.054099,0.038441,0.002572,-0.026203,-0.059543, &
            -0.093711,-0.119667,-0.054167,-0.139295,0.041731,0.012871,0.084927,0.008240, &
            -0.247917,-0.206501,-0.110528,-0.224613,0.041711,0.007288,0.133014,-0.008156, &
            0.118962,0.014349,0.041762,0.088570,-0.043555,-0.123160,0.086551,0.478021, &
            0.134793,0.144874,0.220190,0.249040,0.111027,0.002463,-0.684840,0.885113, &
            -0.273528,-0.240540,-0.348569,0.692948,0.334105,0.153072,-0.406236,-0.418562, &
            -0.008784,0.010953,0.031622,0.332375,0.164019,0.103444,-0.015497,-0.387994, &
            -0.166239,-0.090680,0.126406,-0.190420,0.090278,0.084596,0.204604,-0.375597, &
            -0.018925,-0.000861,0.118927,0.300586,-0.045058,-0.087962,0.088751,0.024278, &
            0.042931,0.048853,0.107258,-0.240279,0.004073,0.045444,-0.040486,0.279746, &
            0.235887,0.046301,-0.260665,-0.338325,-0.025695,0.139266,-0.096169,0.310027, &
            0.423157,-0.103009,-0.494870,-0.133786,0.175738,0.157430,0.176880,-0.002793, &
            0.166777,0.038074,-0.188938,0.056239,0.035209,0.129863,-0.081016,-0.033750, &
            0.004397,-0.060219,0.009400,0.213472,0.003415,0.033843,0.050722,0.078284, &
            -0.065713,-0.020965,0.128826,0.380975,-0.003557,-0.004869,0.091032,-0.086811, &
            -0.055095,-0.046225,0.002785,0.422802,0.030567,0.201522,-0.051478,-0.013394, &
            -0.127129,0.045095,0.016936,0.011966,-0.058361,0.158446,-0.032352,-0.011126, &
            0.032199,0.164028,0.043194,0.107706,-0.046183,0.186730,-0.056164,-0.190561, &
            -0.123353,0.138227,0.247822,0.058236,-0.002916,0.199290,-0.014099,-0.265373, &
            -0.046703,0.171860,0.229140,0.045206,-0.069254,0.212064,0.091033,0.011512, &
            -0.404752,0.575218,0.110451,0.276047,0.082508,0.125987,0.071049,0.232764, &
            -0.271063,0.414685,0.178477,0.430727,0.389066,0.315602,0.093762,0.092534, &
            -0.059744,0.203271,0.181133,0.400759,0.651875,0.081927,0.110380,-0.276603, &
            -0.157303,0.277002,0.218690,-0.343346,0.261244,0.130113,-0.264478,-0.006517, &
            0.382379,0.466848,0.344572,-0.430856,0.200543,0.168429,-0.467687,0.664221, &
            0.025927,0.205519,-0.135622,-0.070928,0.214224,0.075303,-0.675054,0.083726, &
            0.048777,-0.031878,-0.177185,-0.194432,0.160029,0.177131,0.102568,-0.204437, &
            -0.211717,-0.172690,-0.129407,0.344728,0.213749,0.146140,-0.219254,-0.375721, &
            0.131727,0.032873,0.064500,-0.087750,0.132509,-0.040514,0.328835,-0.206653, &
            0.450702,0.243749,0.384500,1.596653,-0.027615,0.181151,-0.043668,-0.521193, &
            0.617016,0.038063,-1.717573,0.005434,-0.275034,0.207318,-0.068934,-0.519882, &
            0.715431,-0.282666,-1.497402,0.068234,-0.195418,-0.551193,-0.685782,-0.623155, &
            1.054476,-0.501058,-1.488057,0.198223,-0.148927,-2.067536,-0.933387,-0.353347, &
            1.060148,-0.839160,-1.633550,0.788728,0.162126,-2.852031,-1.404515,-0.252473, &
            1.036321,-0.874179,-2.160505,1.260157,0.198051,-3.348582,-1.577449,-0.179875, &
            1.370997,-1.089357,-2.714680,1.763368,0.246995,-3.474690,-1.669106,0.468699, &
            1.464374,-1.335921,-2.761952,2.259186,0.281823,-3.674062,-1.898487,0.296075, &
            2.133220,-2.178381,-2.585191,2.042810,-0.313982,-4.501234,-2.616872,0.028519, &
            6.219215,-7.251973,0.414876,0.694805,-5.295132,-7.017005,-5.599831,-5.028891, &
            3.825240,-8.362872,-1.235757,4.213531,-8.043226,-6.098689,-0.536169,-6.420677, &
            0.769729,-5.804911,-2.308961,5.815270,-9.132406,-4.815027,3.094084,-6.100225, &
            0.206295,-2.518691,-2.470027,3.215659,-7.601929,-2.503654,2.136670,-2.373600, &
            -0.241814,-0.464165,-1.643874,1.212631,-7.002968,-1.609314,0.442893,-0.441287, &
            -0.347888,0.173440,-1.418930,0.299851,-5.621879,-1.100199,-0.263168,-0.305636, &
            -0.263050,0.333046,-1.745840,-0.638110,-3.323743,-0.849045,-0.795136,-0.458814, &
            -0.200001,0.202393,-1.758287,-0.148474,-2.244981,-0.904006,-0.781372,-0.615033, &
            -0.147969,-0.072915,-1.735585,-0.384321,-0.915903,-0.356500,-0.162873,-0.721815, &
            -0.237543,-0.113171,-1.627100,-0.607836,-0.151702,-0.402447,-0.229863,-1.337749, &
            -0.268206,-0.453836,-0.062822,0.064247,0.073034,0.069554,-0.741374,0.209341, &
            -0.133435,-0.200198,-0.407864,0.097451,0.176502,0.031577,-0.613018,0.075633, &
            0.015117,-0.100110,-0.461285,0.222613,0.135025,-0.042792,-0.616964,0.373887, &
            0.003820,-0.157121,-0.269786,0.337587,0.119958,-0.060694,-0.450360,0.273934, &
            0.151023,-0.432347,-0.321257,0.362522,0.078700,-0.173116,-0.676455,0.043476, &
            -0.016636,-0.479038,-0.552870,0.534865,-0.016902,-0.257667,-0.694367,0.145399, &
            0.138010,-0.360230,-0.516566,0.634461,-0.003554,-0.367548,-0.455591,-0.051720, &
            0.632487,-0.634275,-0.425930,0.571387,0.136184,-0.104144,-0.739517,0.029579, &
            1.455562,-1.468795,-0.521036,0.175733,-0.236885,-0.076703,-0.916025,-0.125253, &
            1.136994,-1.915700,-0.744094,0.659127,-1.444941,-1.057897,-0.672248,-1.428601, &
            -0.323304,-1.418601,-0.805706,1.263495,-2.242442,-0.859298,-0.130722,-1.336511, &
            -0.205450,-0.432751,-0.756529,0.536266,-2.061548,-1.083083,-0.705940,-0.683948, &
            -0.347393,-0.227799,-0.932536,0.695992,-1.774466,-0.266064,-0.202836,-0.149123, &
            0.183200,-0.454408,-0.994177,0.472022,-0.805589,-0.868364,0.154875,0.237971, &
            0.351160,-0.219957,-0.923173,0.093627,-0.278307,-0.708290,0.511091,0.572772, &
            -0.131027,-0.319087,-0.277120,-0.082736,0.036151,-0.415272,0.847647,0.253485, &
            -0.275340,-0.315755,-0.193198,-1.241937,-0.448246,-0.520076,0.802597,0.340516, &
            -0.950946,-0.080832,-0.122152,-2.061660,-0.438807,-0.398301,0.373592,0.345351, &
            0.026022,-0.167469,-0.010974,0.460046,0.180498,-0.033188,0.217785,-0.199128, &
            0.038044,0.144828,0.088326,0.155029,-0.116314,0.118732,-0.034367,-0.068328, &
            0.111778,0.049443,-0.151112,0.080100,-0.026866,0.218419,-0.167587,-0.069780, &
            -0.140981,-0.089585,0.007438,-0.060799,-0.082289,0.078921,0.030800,0.020991, &
            -0.101582,-0.125668,-0.009450,0.184938,0.003583,0.137730,-0.022847,-0.128047, &
            0.066545,-0.021120,0.043170,-0.121978,-0.012928,0.175924,0.069831,-0.118705, &
            -0.011011,-0.048152,0.080452,0.330292,-0.025204,0.128066,-0.049938,-0.013213, &
            0.063594,-0.098632,-0.028099,0.205929,-0.034231,-0.009943,0.164052,-0.020773, &
            -0.006287,-0.396367,0.284155,0.526382,-0.349112,0.441306,0.307050,-0.217519, &
            -0.054770,-0.419641,0.485245,0.679806,-0.509586,-0.049374,0.270698,-0.325736, &
            -0.603119,0.036775,-0.028713,0.106873,-0.115507,-0.956226,0.349408,0.299235, &
            -0.725933,-0.036834,0.052189,-0.197868,-0.244226,-0.218632,-0.199555,0.443871, &
            -0.734454,0.025754,0.255654,-0.166404,-0.323457,-0.523332,-0.152225,0.489044, &
            -0.443483,0.189013,0.233574,-0.651345,0.028620,0.399511,-0.545485,-0.191011, &
            -0.323846,0.103320,0.160019,-0.628904,0.040177,-0.170571,-0.404473,0.187047, &
            -0.401239,-0.011057,0.603840,-1.052561,-0.143038,-0.191101,-0.424912,0.280649, &
            0.229169,-0.072511,0.264268,-0.493855,0.153097,0.253542,-0.210760,-0.141314, &
            0.106622,0.146724,0.168542,-0.558778,0.132403,0.871909,-0.355718,-0.160217, &
            -0.370502,-0.153889,-0.104632,0.258772,-0.003077,-0.247250,-0.247514,0.168629, &
            -0.115654,-0.015091,-0.052880,0.090326,-0.001247,-0.183107,-0.076541,0.197406, &
            0.078493,0.127075,0.213754,-0.008950,0.044303,0.033675,-0.064087,-0.224512, &
            -0.073518,0.131534,0.201037,-0.134681,0.006774,0.081216,-0.053149,-0.109517, &
            -0.357343,-0.019241,0.303711,0.176252,-0.023028,0.123095,0.008141,-0.012837, &
            -0.230872,0.158247,0.510566,-0.096251,-0.042603,0.195349,-0.145577,0.113521, &
            0.058611,0.142103,0.428406,-0.366107,0.034376,0.186067,0.254876,-0.130044, &
            -0.296293,0.054568,0.668390,-0.319331,-0.050092,0.266640,0.103536,0.073070, &
            -0.217591,0.654176,0.844148,-0.680373,0.176610,0.449139,0.569737,0.292508, &
            0.111892,1.006192,1.136380,-1.414681,0.384902,0.202652,-0.193969,0.432801, &
            0.504474,0.806150,1.039453,-0.789363,0.524509,0.411212,-0.517500,0.652767, &
            0.296382,0.556780,0.660509,-0.557592,0.225722,0.357642,-0.228633,0.043666, &
            0.206802,0.071650,0.438424,-0.753530,0.579771,0.072341,0.218113,-0.234739, &
            -0.038409,0.094204,0.241144,-0.692707,0.266652,0.251509,-0.130433,-0.247750, &
            0.248350,0.109516,0.231360,-0.299023,0.095928,0.288003,0.404725,-0.145679, &
            0.203634,-0.041845,0.522145,-0.049101,0.259705,-0.287902,0.387926,-0.065561, &
            -0.049001,-0.101107,0.168077,0.008828,0.072311,0.538783,0.435568,-0.337924, &
            0.186291,0.001498,0.270268,0.135762,0.106377,-0.004488,0.287835,-0.098501, &
            0.102392,0.189070,-0.226031,-0.206757,-0.028444,-0.184435,-0.098160,0.262400, &
            0.068725,0.241105,-0.395884,-0.431878,0.151439,-0.296213,0.042605,0.204845, &
            -0.056918,0.159618,-0.675235,-0.677447,0.331932,-0.669874,-0.027462,0.315303, &
            0.134961,0.157223,-0.765165,-0.383611,0.522202,-0.970856,-0.121464,0.123656, &
            0.133267,0.102156,-0.427631,-0.131052,0.423908,-0.429162,-0.009015,-0.160766, &
            0.027319,0.023167,-0.166637,0.024229,0.297162,-0.226385,0.064053,-0.169781, &
            0.020572,0.002455,-0.126453,0.197883,0.111995,-0.085064,-0.000799,-0.092448, &
            0.052635,0.142455,0.081994,0.354932,0.181320,-0.159429,-0.083509,-0.160728, &
            -0.001519,0.201547,-0.082622,0.497895,0.498334,-0.440584,-0.042857,-0.311576, &
            -0.020599,0.211625,0.424579,0.131467,0.233912,-0.069663,0.053901,-0.323390, &
            0.236902,0.091961,0.099417,-0.170929,0.153186,-0.039416,0.123349,0.094582, &
            -0.161996,-0.104467,-0.242390,0.220503,-0.036015,-0.047059,0.048918,-0.318646, &
            0.011080,0.119902,0.309772,0.050458,-0.010049,-0.069516,-0.076135,0.323542, &
            0.019276,-0.011890,0.002691,0.049947,0.037749,0.050501,0.098929,-0.231795, &
            0.036817,-0.071175,-0.188822,0.103489,-0.019680,0.006298,0.000612,0.056798, &
            0.113388,0.114707,0.197244,-0.333732,0.053660,-0.013713,0.034028,0.135630, &
            0.093012,0.060812,0.157426,0.558939,0.011320,0.043959,-0.156680,0.000834, &
            -0.026286,-0.033095,-0.133487,-0.199006,-0.057050,0.031779,0.041502,-0.050054 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.841002,0.227526, &
            -3.397378,1.179493, &
            0.890297,0.677325, &
            0.399531,-2.167245, &
            -5.466197,-0.824556, &
            -3.449303,0.791268, &
            -2.662604,-0.057951, &
            -2.652183,0.297529 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.35574,-0.529431/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.607021,0.486089,-0.071452,0.7101,0.171977,2.233145,0.964309,0.57466/)
real, dimension(2) :: bias2 = &
(/0.974034,-0.506703/)
real, dimension(1) :: bias3 = &
(/1.452027/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
