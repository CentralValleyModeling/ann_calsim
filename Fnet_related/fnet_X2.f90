module fnet_X2

! a = 0.015276
! b = -0.57708

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/0.780037,-0.079845,1.137955,-1.328748,-1.150697,-1.351594,1.455088,2.453857 &
			,2.630052,-1.110505,0.683130,-2.185206,-0.492424,-2.556703,0.032210,1.767662 &
			,3.164042,-1.307678,-0.062651,-2.454282,0.167354,-2.042481,-0.045048,1.137053 &
			,3.019764,-0.787084,0.095098,-2.371298,0.276784,-0.699631,1.168363,1.563532 &
			,2.256572,0.171970,0.506446,-1.456622,0.289555,-0.267384,1.874023,1.698998 &
			,2.382396,0.313688,0.425957,-0.484373,0.937502,0.333006,2.679794,1.948301 &
			,2.072310,0.902514,-0.012739,0.020816,0.977863,0.926670,3.435389,2.510569 &
			,2.783742,0.012631,-1.719491,-0.579709,2.687854,0.740498,3.585389,1.664408 &
			,4.074572,-4.903270,-8.570946,-0.495885,9.432335,-0.553327,3.962165,-0.567705 &
			,-0.846046,-2.354971,-8.129944,0.877555,6.172866,-0.767780,-0.146340,4.242691 &
			,-1.428383,-3.317461,-5.440372,-0.080123,2.428024,-0.147108,-2.938318,6.301200 &
			,-0.784028,-5.781376,-2.286968,-0.905391,0.110858,0.901862,-1.857748,3.838059 &
			,-0.247568,-6.327978,-1.318964,-0.430505,-0.775022,0.936028,1.183736,0.045329 &
			,0.302510,-6.768027,0.334683,-0.050789,-0.653637,0.191263,-0.100638,-0.747739 &
			,0.389475,-6.241244,0.456849,-0.003764,-0.285792,0.812640,-0.003516,-0.350156 &
			,0.374602,-6.501439,0.418368,0.897199,-0.121171,-1.369175,0.583025,-1.301560 &
			,0.260900,-6.079585,0.292833,0.114858,-0.679097,-0.479723,-0.067028,-2.338158 &
			,-0.426060,-5.394899,-0.421436,-0.241819,-0.641290,-0.089944,0.150960,-2.037732 &
			,0.256473,-0.355701,0.046063,0.375598,-0.113962,0.323948,0.418368,-0.500337 &
			,-0.023685,-0.259377,0.308272,0.229721,0.345013,-0.184802,-0.151323,-0.343851 &
			,0.122355,-0.122440,-0.022490,0.160999,-0.115582,0.121208,-0.005928,-0.241841 &
			,0.087918,-0.034977,0.272303,-0.012423,0.212913,-0.162871,0.470836,0.072523 &
			,-0.086362,0.113826,-0.088274,-0.060839,-0.030388,-0.151031,-0.239005,-0.154351 &
			,0.097093,-0.054283,0.102234,0.138754,0.008515,-0.009750,-0.030847,-0.256095 &
			,0.069798,-0.183997,0.008074,0.005824,-0.118070,-0.327403,0.057499,0.058330 &
			,0.030289,-0.033251,-0.008972,0.143246,0.040375,-0.232775,-0.031115,-0.027368 &
			,-0.146441,0.256565,-0.124884,-0.063147,0.166481,-0.198104,0.191874,-0.049032 &
			,-0.025954,0.068638,-0.077112,-0.144484,-0.093595,0.459819,-0.178284,0.172178 &
			,0.263062,-0.525208,0.188465,0.494748,-0.128008,-0.570017,0.159422,-0.929595 &
			,-0.131471,0.066500,-0.207034,-0.200150,-0.128554,0.035791,0.177309,0.127313 &
			,-0.131466,0.029835,0.144904,-0.367384,0.129678,-0.181436,0.140296,0.306857 &
			,-0.135168,0.076897,-0.094700,-0.155702,0.231500,-0.141049,-0.002795,0.964637 &
			,-0.024012,0.226429,-0.051763,-0.008929,0.086915,-0.109101,-0.079711,0.238375 &
			,0.107021,-0.011232,0.033859,-0.069395,-0.029123,0.435819,0.316661,0.362462 &
			,-0.085134,-0.118050,-0.003687,-0.114600,0.107965,-0.025586,0.170963,0.340673 &
			,0.072595,0.225732,-0.005068,0.006343,-0.006615,-0.046681,0.052614,-0.039797 &
			,-0.573079,-0.048096,-0.561314,0.020851,-0.069873,0.748277,0.267961,0.107942 &
			,-0.057187,-0.054931,-0.117846,-0.137918,-0.178848,0.945165,-0.138876,-0.154946 &
			,-0.210578,0.227692,-0.146234,0.223583,0.267476,1.240874,-0.101497,-0.092224 &
			,0.088735,-0.043538,0.063641,-0.039906,-0.220544,0.538340,-0.269787,-0.238484 &
			,-0.099750,0.234920,-0.167717,0.221922,0.072833,0.000351,-0.123027,-0.192164 &
			,-0.172994,-0.096489,-0.174521,-0.107593,-0.118201,-0.191451,-0.511664,0.083584 &
			,0.072751,0.008889,-0.106123,-0.007643,-0.193848,0.257676,-0.429035,0.146195 &
			,-0.332664,0.054820,-0.179782,-0.397075,-0.017324,0.367453,-1.232188,0.629790 &
			,-0.566743,1.076392,-0.305599,-0.290649,-0.201835,0.475359,-0.356560,0.148930 &
			,-0.255799,0.749299,-0.536685,-0.510585,0.101165,-0.442950,-0.914823,0.090027 &
			,-0.252370,0.389703,0.207643,-0.404108,0.000837,0.574797,-1.211548,-0.237644 &
			,-0.097565,0.006489,-0.124250,-0.511822,0.263555,0.954422,-1.066052,-0.117937 &
			,-0.031697,0.516429,0.212169,-0.067819,0.204497,0.785156,-0.105044,0.033669 &
			,-0.314636,0.452553,-0.346009,-0.142610,0.489026,0.791911,-0.170420,-0.746347 &
			,-0.652778,0.426028,0.199296,-0.242576,0.125137,0.849069,0.251712,-0.528200 &
			,-0.097875,-0.308046,-0.027341,-0.379740,-0.122559,0.274686,-0.055450,-0.849862 &
			,0.050091,-0.070287,-0.068648,-0.257839,-0.463127,0.684111,-0.432596,-0.610711 &
			,0.010009,-0.088479,-0.203987,-0.181796,0.068084,-1.017850,0.500589,-0.539288 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.112925,-2.866650 &
			,0.003181,4.682058 &
			,0.634569,4.762561 &
			,-2.561721,1.115632 &
			,-0.301827,-2.535856 &
			,-0.300214,0.632198 &
			,-0.822216,-0.257147 &
			,-0.276113,0.643675 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.859729,1.034173/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.831885,1.668987,1.747986,0.980861,-2.122242,0.985974,0.140891,0.357821/)
real, dimension(2) :: bias2 = &
(/-0.00725,-0.033133/)
real, dimension(1) :: bias3 = &
(/0.465672/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 54
  !  inarray2(i) = inarray(55-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
