module fnet_CO

! a = 5.569e-005
! b = 0.090701

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.168523,0.299645,0.044770,0.013873,-0.181429,0.037526,0.169495,0.166555, &
            -0.014050,0.134787,0.076589,0.004752,-0.166496,-0.112315,0.040256,0.039594, &
            -0.075491,-0.181681,0.006935,-0.019336,-0.078304,-0.000299,-0.034206,-0.218785, &
            -0.222101,-0.087068,-0.154899,0.012377,0.047594,0.087448,0.160493,-0.102546, &
            0.004631,-0.096981,0.085655,-0.057755,0.092644,0.010002,0.058492,-0.110607, &
            -0.087979,0.054469,0.016248,-0.013608,0.002410,0.060683,0.091759,-0.030234, &
            0.038260,-0.053351,-0.094655,0.079700,0.099164,0.095111,0.003456,-0.018551, &
            0.057532,0.058724,0.037136,-0.067696,0.188191,0.104387,0.127031,0.114068, &
            0.144237,-0.011443,-0.138594,0.080706,0.188486,-0.819013,0.701489,0.389291, &
            -0.035849,0.004792,0.007524,0.253554,0.394708,-0.451724,0.043336,0.274056, &
            -0.128896,-0.386484,0.036330,-0.073337,0.140498,-0.708664,-0.417597,0.509721, &
            0.216553,-0.141727,0.085509,0.270168,-0.209526,-0.146809,-0.871960,0.067456, &
            0.446317,0.192964,0.058542,0.245463,0.009263,-0.042583,0.270951,-0.030089, &
            0.165998,0.154041,-0.219289,0.210135,-0.121874,0.385052,0.046865,0.002037, &
            -0.837688,0.045797,-0.216499,0.271814,0.192289,-0.016971,0.114216,-0.057044, &
            -0.785154,0.043642,-0.150632,0.346583,0.068077,-0.143234,0.246449,-0.081361, &
            -0.624688,0.002133,0.325946,0.467866,0.122418,-0.344472,-0.039420,-0.406943, &
            0.048811,-0.040282,0.320456,0.125236,0.112925,-0.134269,-0.291132,-0.212827, &
            -0.273787,0.031847,-0.210874,0.164838,0.142304,0.428208,-0.122141,0.072136, &
            -0.232021,-0.034724,0.059328,0.098892,-0.159796,0.242799,-0.099525,0.061350, &
            -0.440827,-0.101669,-0.045268,0.003567,0.017653,-0.087913,0.029398,0.323704, &
            -0.269190,0.005460,-0.167057,0.126973,-0.050358,0.092136,0.216552,0.167095, &
            -0.202930,-0.109052,-0.087491,0.045396,0.204913,0.180449,0.248731,0.169921, &
            -0.061523,-0.134363,0.212481,0.092412,0.138667,-0.041095,0.219621,-0.012544, &
            -0.153200,-0.080429,0.128254,0.029156,0.244443,-0.184108,0.234871,0.264554, &
            -0.324488,-0.173037,0.015148,0.167452,0.139602,0.112059,0.157355,0.201947, &
            0.096984,-0.253340,0.287877,0.343940,-0.356626,0.575658,0.438493,0.101383, &
            -0.188803,-0.222044,0.482767,0.138688,0.178237,0.414867,0.454536,0.287854, &
            -0.451561,-0.561323,0.075406,-0.167964,-0.077083,0.180318,0.022713,0.018371, &
            0.025798,0.184302,0.421727,0.152502,-0.019276,-0.131937,0.272147,0.184085, &
            -0.107296,0.315642,0.285497,-0.028406,0.075288,0.138178,-0.090352,0.310236, &
            -0.209196,0.482585,0.221048,0.241102,0.220529,0.356282,-0.512827,0.359630, &
            -0.303154,0.063745,-0.069979,-0.205131,0.084129,0.105773,0.030174,0.416616, &
            -0.075850,0.621845,0.175506,-0.254888,-0.060608,0.367414,0.266984,0.260582, &
            0.540488,0.538551,0.745917,-0.066167,-0.045442,0.017777,0.317109,-0.307501, &
            0.502529,0.525508,0.187055,-0.025857,0.049634,-0.337995,0.749695,0.249392, &
            0.905882,2.241887,-0.580327,-0.932016,-2.115970,-1.632082,-1.620997,-1.761056, &
            1.862574,2.952037,-1.390538,-1.353053,-1.443453,-2.791305,-2.445546,-2.418759, &
            1.582806,2.838687,-1.096777,-1.046107,-2.204956,-3.159197,-2.325956,-2.224524, &
            1.263248,2.950038,-0.799752,-0.924463,-2.680484,-2.997116,-2.445225,-2.128630, &
            1.408632,3.118440,-0.898043,-0.628463,-2.921147,-3.063645,-2.457459,-2.141148, &
            1.501525,3.054972,-1.153022,-0.797723,-2.763804,-3.221022,-2.596032,-2.199737, &
            1.764916,3.452103,-1.636333,-0.925350,-2.516848,-3.672277,-3.037239,-2.873099, &
            2.327518,4.059651,-1.865431,-1.683959,-2.527292,-4.289883,-3.635314,-3.353162, &
            5.562024,7.268825,-5.734087,-4.867891,-0.857985,-7.260681,-6.362600,-6.070699, &
            6.165981,5.878960,-6.203413,-5.662298,-4.083532,-5.525223,-3.661436,-5.546955, &
            5.479464,3.162907,-6.107813,-5.733437,-5.473299,-2.825440,-0.734864,-3.758328, &
            3.627337,0.878452,-4.154961,-3.314516,-4.210193,-1.144968,0.678234,-1.932787, &
            2.859399,0.357631,-3.503108,-3.001248,-2.294244,-0.377709,-0.183166,-0.709624, &
            2.038155,-0.302280,-2.445655,-2.096691,-1.389928,0.133993,-0.825812,0.013786, &
            0.461460,-0.696639,-1.064527,-1.045191,0.169677,0.283255,-0.747649,0.059751, &
            0.389842,-0.481840,-0.609737,-0.883922,0.400898,0.143044,-0.121770,0.086379, &
            0.825175,-0.366424,-0.444588,-0.234137,0.431978,-0.238451,0.417497,-0.140784, &
            1.521892,0.199125,-0.210082,0.391257,-0.497740,0.377637,0.185512,-0.200529, &
            0.250340,0.149035,0.055607,0.061641,-0.523891,-0.356949,-0.696397,-0.353658, &
            0.548644,0.584274,-0.141847,-0.355609,-0.171297,-0.620539,-0.856600,-0.382718, &
            0.384402,0.451452,-0.017827,-0.060615,-0.029956,-0.656367,-0.804721,-0.503327, &
            0.664392,0.591702,0.113597,-0.230748,-0.219726,-0.647650,-1.047777,-0.562198, &
            0.693734,0.574759,-0.075690,-0.151616,-0.320534,-0.631713,-0.780405,-0.640984, &
            0.542238,0.488016,0.018099,-0.347904,-0.104726,-0.912998,-0.941009,-0.423521, &
            0.491863,0.850730,0.024438,-0.142711,0.103708,-0.578589,-0.986049,-0.726967, &
            0.578192,1.047121,-0.091028,-0.306918,-0.047470,-0.627901,-0.946164,-0.610776, &
            0.419933,1.032095,-0.066719,-0.514938,0.432235,-0.945150,-1.591059,-1.489649, &
            0.855978,0.835166,-0.635684,-1.081919,-0.207092,-0.312308,-1.375606,-0.998346, &
            0.694264,-0.171500,-0.993606,-1.379868,-1.316668,0.354630,-0.726509,-0.310387, &
            0.337334,-0.137638,-1.394514,-1.422100,-0.794795,0.272545,-0.406811,-0.099182, &
            0.472471,0.054342,-1.725189,-1.576868,-0.546281,0.078116,-0.346228,-0.025099, &
            -0.206804,-0.389298,-0.890579,-0.437448,-0.401522,0.481010,0.390359,0.171969, &
            -0.512110,-0.066101,-0.173371,0.090756,0.326756,-0.131447,-0.014717,-0.197468, &
            -0.402296,0.142597,0.213864,0.142668,0.371982,0.228558,0.061548,0.184537, &
            -0.203319,0.127852,0.375022,0.455063,-0.217401,-0.026385,0.309237,-0.156194, &
            0.782549,0.855743,-0.160672,0.987188,-0.525575,0.104151,0.379044,-0.839808, &
            -0.342134,-0.464039,0.389437,-0.282829,-0.182443,-0.091142,-0.030374,0.005853, &
            0.223358,-0.093509,0.196921,0.042036,-0.194791,-0.215737,-0.028498,-0.102707, &
            -0.119918,-0.030732,-0.067422,0.005324,-0.132203,-0.022561,-0.056301,0.065578, &
            0.155949,0.113289,-0.086365,0.108763,-0.023240,0.018701,-0.237747,0.173854, &
            0.086537,0.026607,-0.027959,0.040186,0.185114,0.121950,0.132721,0.031229, &
            -0.151838,0.169274,0.001683,-0.111684,0.134962,0.151992,0.186450,-0.048862, &
            0.005575,-0.027203,0.182602,-0.049498,0.037770,-0.089252,-0.049545,-0.133589, &
            0.115185,0.054962,0.208592,-0.204607,-0.078473,-0.216336,-0.215331,-0.128473, &
            -0.249825,-0.396131,0.677962,-0.491922,0.819492,0.175033,0.167180,-0.134101, &
            0.610876,0.218532,0.195631,-0.887559,0.739999,-0.738014,-0.310867,-0.208520, &
            -0.094254,-0.623648,0.135340,0.019993,-0.399452,-0.242390,0.330042,0.738625, &
            0.231212,-0.243290,-0.162151,-0.640319,0.117079,-0.175727,0.257581,0.592744, &
            0.510185,-0.574973,0.069215,-0.575979,-0.646117,0.096711,0.345487,0.386797, &
            0.441848,-0.147248,0.175789,-0.577289,0.442366,-0.304173,0.008917,0.143345, &
            -0.162404,-0.464100,0.221786,0.086455,0.078292,0.393092,0.390394,0.458758, &
            -0.053002,-0.057288,-0.587620,0.097463,0.389199,-0.245649,-0.336439,-0.282398, &
            -0.000101,-0.061500,0.181529,-0.030318,0.866266,-0.178592,-0.457544,-0.227336, &
            -0.275839,-0.135932,-0.080204,-0.025122,0.847509,0.101623,-0.500955,-0.082907, &
            0.368606,0.009554,-0.030378,0.021384,-0.129989,-0.109398,-0.115434,-0.034413, &
            0.062969,-0.344217,0.003662,-0.098350,-0.415241,-0.254668,0.053706,0.117229, &
            0.382506,-0.028655,-0.004726,0.135893,-0.125571,0.008490,0.252306,-0.068765, &
            0.170054,-0.377856,-0.162112,-0.040571,-0.090931,-0.182898,-0.044158,0.140981, &
            0.016726,-0.321938,-0.095220,0.085474,0.055951,0.042195,-0.029047,-0.070460, &
            -0.066552,-0.064122,-0.310166,0.212216,0.271893,0.012947,0.260214,0.094380, &
            0.069351,-0.232545,-0.287848,0.163907,0.374523,0.187438,0.234893,0.016638, &
            -0.034328,-0.379523,-0.178191,0.141888,0.370760,0.164337,0.278421,-0.055085, &
            -0.306001,-0.591150,0.288119,0.392624,0.545453,0.678568,0.483735,0.361657, &
            -0.347289,-0.462752,0.219627,0.237758,0.948378,0.363920,0.203084,0.326139, &
            -0.488614,-0.421085,0.155453,0.059058,0.597422,-0.013606,-0.651035,0.206354, &
            0.183565,-0.144152,0.497215,0.187544,0.261448,0.221625,-0.420090,0.313500, &
            0.033204,0.055853,0.225226,-0.038797,0.126254,0.176957,-0.255897,0.015334, &
            0.369112,-0.123841,-0.223015,-0.164788,0.197281,0.207304,-0.344371,0.060201, &
            -0.159413,-0.105913,0.017742,0.118832,0.196909,0.640153,0.360268,-0.096243, &
            0.363179,-0.053367,0.003952,0.063677,0.541863,0.226238,0.032984,-0.304886, &
            -0.127401,-0.332252,0.118726,0.290489,0.378071,0.195267,-0.034269,-0.440216, &
            -0.238532,-0.309170,0.158875,-0.024285,0.288020,0.220120,0.061261,-0.301024, &
            0.026871,0.031758,-0.020947,0.071559,0.114410,-0.027895,0.043945,0.077599, &
            0.029940,0.031621,0.016305,-0.034968,0.058408,0.056633,0.052574,-0.013329, &
            0.168893,0.018285,-0.007855,0.078650,-0.087649,0.008189,-0.151039,0.016270, &
            0.211925,0.051911,0.015399,0.039853,-0.022067,0.049589,-0.011128,0.011566, &
            0.145304,-0.165621,0.045931,0.009360,0.062484,-0.114038,-0.074505,-0.036750, &
            0.067160,0.019639,-0.041517,0.069101,-0.059571,-0.054382,-0.060768,0.016953, &
            0.098733,-0.100058,-0.062185,0.007788,0.019446,0.000631,0.086491,-0.055140, &
            0.018459,0.026685,-0.040609,0.019699,0.044000,0.068929,0.193425,-0.080583, &
            -0.121596,0.062849,-0.004115,-0.013721,-0.129674,0.034467,0.025284,-0.082588, &
            -0.113145,0.064507,-0.088756,0.066084,-0.008697,0.060288,0.100450,-0.030211, &
            0.005487,0.113062,0.009843,0.145686,-0.026129,0.044049,-0.155511,0.013433, &
            -0.196113,0.124095,0.063502,-0.142651,-0.182993,-0.015120,-0.059161,0.000897, &
            -0.372124,-0.117611,-0.031945,-0.125307,0.092788,-0.016110,0.023116,-0.017366, &
            -0.581183,0.092899,-0.028957,-0.121144,0.071327,-0.052486,-0.113725,0.226829, &
            -0.064748,-0.032948,0.019439,-0.043550,-0.094818,-0.127114,-0.035193,-0.020673, &
            0.531738,0.134256,0.040637,0.136389,0.023867,0.060430,0.019621,0.126367, &
            0.009567,-0.048954,-0.101044,0.136790,0.030684,0.190993,-0.193382,-0.073131, &
            -0.452654,-0.146750,0.116160,-0.275898,0.091838,-0.137570,0.117029,-0.118191 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.308205,-1.720648, &
            -0.673430,-1.924799, &
            -0.817355,4.541112, &
            0.079251,4.799708, &
            -2.621466,-0.204558, &
            0.624923,5.274692, &
            3.221312,2.960041, &
            1.944410,3.536176 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.495361,1.271375/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.611132,-1.688627,1.646816,1.381823,-0.504037,1.527388,1.199492,1.332136/)
real, dimension(2) :: bias2 = &
(/-0.402838,-0.188382/)
real, dimension(1) :: bias3 = &
(/-0.051938/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
