module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.030850,-0.003958,0.023154,-0.235952,0.022010,-0.052617,0.007423,0.075108, &
            -0.207149,0.008176,0.029550,-0.047313,0.024529,-0.026203,0.007152,0.018331, &
            -0.487989,-0.022358,-0.016785,-0.011009,0.012507,-0.034542,0.021693,0.035842, &
            -0.447027,-0.006630,-0.047749,-0.071720,0.008095,0.027199,0.005272,-0.019147, &
            -0.364514,-0.031216,-0.074284,-0.002385,0.017803,-0.005905,0.003949,0.074743, &
            -0.150112,-0.022808,0.003647,-0.105048,-0.053489,0.033816,-0.078937,-0.067911, &
            -0.129989,-0.050793,-0.031337,-0.019488,-0.046660,-0.031318,-0.049247,0.032565, &
            -0.032382,-0.057458,-0.029433,0.061429,-0.085183,-0.166764,-0.046198,0.079343, &
            1.201037,-0.461002,-0.236200,-1.677869,-0.241960,-1.188503,0.195069,1.051377, &
            0.640528,-0.217244,0.043002,-0.504296,0.017292,-0.242829,0.256573,-0.039991, &
            0.072331,0.015818,0.062546,0.096590,-0.046857,0.432974,-0.396324,-0.711577, &
            0.273295,0.081167,0.379587,0.336946,-0.059931,0.618695,-0.184137,-1.165908, &
            1.050380,0.054747,0.291788,0.154050,-0.057463,0.584480,-0.169030,-0.754552, &
            0.448750,0.105821,0.357103,0.231707,-0.099335,0.699436,-0.454371,-0.885881, &
            -0.001510,0.059932,0.267937,0.694210,0.100658,0.399545,-0.175032,-0.626741, &
            -0.286138,0.140275,0.090931,0.580077,0.012302,0.027904,-0.095526,-0.599066, &
            -0.181372,0.323407,0.219600,0.034495,-0.134923,0.301761,-0.421243,-0.792355, &
            -0.214462,0.345205,0.647228,0.832308,0.007804,-0.011205,-0.507883,-0.577544, &
            0.154678,0.031120,-0.408977,-1.291277,0.025250,-0.404474,0.076117,0.492656, &
            0.314973,0.010202,-0.398750,-1.017733,0.189540,0.049515,0.184124,0.546912, &
            0.469116,0.082516,-0.158709,-0.686684,0.294365,0.069006,0.089018,0.281924, &
            0.357190,-0.016440,-0.234119,-0.680634,0.167050,0.181643,0.122802,0.167357, &
            0.023201,0.087574,-0.159616,-0.671191,0.053699,0.148072,-0.022691,-0.183828, &
            -0.186332,-0.044568,-0.375905,-0.568219,-0.008108,0.604145,0.015639,-0.497144, &
            -0.334129,0.068321,-0.380150,-0.770577,0.129765,0.388793,0.091531,-0.367188, &
            -0.399827,0.043201,-0.340830,-0.619857,0.066311,0.581686,-0.192036,-0.556680, &
            -0.772437,0.882121,0.003744,-0.399940,1.176881,1.356484,-0.423834,-0.541376, &
            -0.455892,1.327844,0.266368,1.029105,1.108756,0.637588,-0.105367,0.324817, &
            -0.477875,0.743841,-0.953483,0.948307,0.378762,-0.284051,0.474308,0.400785, &
            -0.160392,0.821325,-0.791123,0.722750,0.246210,-0.191744,0.699416,-0.145803, &
            -0.481143,0.776355,-0.719011,0.826155,0.300421,0.508881,0.434222,-0.282044, &
            -0.098282,0.061301,-0.598751,0.328501,0.032810,0.379845,0.499681,0.133159, &
            0.401218,0.099928,-0.093002,0.571254,0.007622,-0.184792,0.304079,0.023611, &
            0.421715,0.258197,0.100870,0.841460,0.166725,0.117295,0.107625,0.101276, &
            0.311210,0.153159,-0.665744,-1.155642,0.239545,0.283412,0.919277,0.286932, &
            0.856211,-0.605027,-2.041195,-1.300276,-0.609982,0.011040,0.929669,0.360843, &
            -0.355556,-0.261602,-0.179063,1.370467,-0.546363,-0.229377,-0.779667,-0.377517, &
            -0.274499,-0.052836,-0.420957,0.546528,-0.255839,-0.020967,-0.309718,-0.108523, &
            -0.505301,0.148545,0.180930,0.161339,-0.009077,0.006289,-0.208615,-0.006655, &
            -0.185204,-0.211158,0.109696,0.105641,0.222257,0.071792,-0.024178,0.337857, &
            0.024870,-0.210710,0.018541,0.049435,0.132853,-0.109638,0.038300,0.246711, &
            0.295381,-0.620351,0.000793,-0.150683,-0.011043,0.019503,0.008305,0.167202, &
            0.415515,-0.942899,-0.310428,0.074851,-0.006832,0.084631,0.228091,0.378715, &
            0.530699,-1.093775,-0.049215,0.147262,-0.180730,-0.098992,0.238452,0.402629, &
            0.303874,-5.856721,-0.143740,1.354333,0.595307,-0.610506,0.521473,-0.256124, &
            -0.234071,-10.136463,0.433492,1.060642,0.820696,-0.040675,0.467008,-0.219156, &
            -1.479298,-12.583584,-0.699925,-3.976192,0.309441,-0.246364,0.427060,-0.290513, &
            -0.558429,-11.019127,0.560296,-8.603391,0.616526,0.057998,-0.272749,-0.166315, &
            0.009141,-8.393627,0.757983,-7.672794,0.275056,-0.115689,0.030802,-1.955021, &
            -1.441907,-4.956510,0.122089,-3.595754,0.291916,-0.231487,0.265193,-1.382665, &
            -0.520154,-3.026413,0.320826,-0.734036,0.078187,-0.458491,-0.139251,-1.424522, &
            -1.358554,-1.701707,0.470915,0.272935,-0.074154,-0.834090,-0.123923,-2.746621, &
            -1.264356,-1.171853,0.447377,0.477397,0.292259,-1.178761,0.060417,-2.089387, &
            -0.230548,-1.758295,0.633321,0.722359,-0.090000,0.106096,-0.711297,-1.181062, &
            -0.275356,-0.323325,0.041823,-1.362187,-1.950305,0.614854,-0.186019,-0.696280, &
            0.612538,-0.153261,-0.723643,-1.955941,-1.359688,0.325864,-0.279353,-0.911738, &
            0.547709,-0.282190,-1.418472,-1.518904,-1.455324,-0.305390,-0.527008,-1.271821, &
            0.240782,-0.390517,-1.495836,-1.361211,-1.403516,-0.191061,-0.857614,-0.957208, &
            -0.188613,-0.452314,-1.215543,-1.141807,-1.617563,0.239969,-0.659495,-0.489593, &
            -0.629138,-0.437624,-1.433717,-1.189850,-1.890840,0.740339,-1.043043,-0.202022, &
            -0.492831,-0.056637,-1.715998,-1.068440,-2.308444,0.864820,-1.068038,-0.364903, &
            -0.310148,0.071147,-1.969252,-0.488224,-2.424061,1.430004,-1.364517,-0.147692, &
            0.047789,0.197252,-3.515760,2.454047,-3.154588,2.289763,-1.844668,0.449356, &
            0.948548,-1.889467,-1.977323,3.879094,-2.958129,0.259973,-0.063525,0.032913, &
            2.692882,-2.744815,-0.017007,1.500544,-0.797922,-1.695561,0.820809,0.043327, &
            1.669111,-2.406826,0.423093,-1.004682,0.538080,-0.319779,-0.172786,1.382569, &
            -0.392599,-2.758052,-0.258923,-2.331595,0.528643,-0.444141,0.281016,0.961459, &
            0.721675,-2.350945,-0.538043,-2.335796,0.767092,-1.178547,0.989001,0.465067, &
            0.884533,-1.280858,0.030962,-1.224373,0.540282,-0.645263,0.570242,1.645063, &
            1.350413,-0.779028,0.288075,1.515184,0.470567,0.177090,0.060783,2.300366, &
            2.323616,-1.587624,0.313821,1.815816,0.179545,-0.672187,-0.121723,2.081488, &
            1.785699,-2.677703,-0.550279,-0.227470,-0.351633,-1.325033,0.676321,1.273754, &
            0.734152,-0.009902,0.081122,-0.145322,-0.230953,-0.368551,-0.319010,0.405921, &
            -0.196294,-0.194706,-0.065098,0.041035,-0.169328,0.130383,-0.211056,0.266023, &
            -0.039526,0.096961,0.015914,-0.049792,0.046660,-0.050592,-0.031997,-0.186757, &
            0.091288,0.039942,-0.040586,-0.106037,0.104708,-0.011592,-0.019613,0.057965, &
            0.347911,0.095821,0.054462,-0.052967,-0.110582,-0.039546,-0.162116,-0.097444, &
            0.198799,0.020010,0.055288,-0.058123,-0.024834,-0.145037,-0.123152,0.085358, &
            0.144572,-0.021935,-0.016267,-0.066144,-0.130520,-0.227268,-0.108532,0.170108, &
            0.658423,-0.003408,0.229152,-0.094815,-0.198051,-0.231375,-0.394578,0.442176, &
            1.610891,0.721473,0.739724,-0.819799,-0.589452,-1.380229,-1.526678,0.871871, &
            1.716840,0.893625,1.476047,-0.327533,-0.094557,-1.557414,-1.330001,0.592669, &
            0.465758,1.001755,1.550985,-0.615622,0.005994,-0.634612,-0.082777,0.221827, &
            0.354233,0.751053,1.675152,-1.253442,-0.115504,-0.748587,-0.227453,-0.035529, &
            0.373482,0.732351,1.885547,-1.140156,0.309888,-0.744626,0.703197,-0.460532, &
            -0.372257,-0.247095,0.298358,-1.712331,-0.292829,-0.775841,0.067454,-0.402498, &
            -0.704504,-0.332963,-0.626199,-1.367762,-0.493511,-0.016070,0.089865,-0.908832, &
            -1.494731,-0.607799,-1.360528,-1.116691,-0.357831,0.373312,-0.414797,-1.119034, &
            -0.789573,-0.672129,-1.393330,-0.293186,-0.624788,0.521270,-0.649087,-0.300897, &
            -1.680861,-0.364337,-1.310686,-0.245389,-0.480193,0.578043,-0.693762,-0.610914, &
            0.292961,-0.018762,-0.424716,-0.539040,0.031965,-0.668051,-0.102698,0.322756, &
            0.524800,0.064615,-0.297762,-0.418065,0.132766,-0.730232,-0.067104,0.395416, &
            0.616456,-0.064199,0.041679,-0.120361,0.037033,-0.822947,-0.113930,0.542941, &
            0.708100,-0.119034,0.040557,0.183673,0.240456,-0.479126,0.070665,0.562633, &
            0.402336,0.025067,0.039890,0.141658,0.045627,-0.831466,-0.162314,0.543225, &
            0.357960,-0.047796,0.228082,0.643133,0.277352,-0.725688,0.140075,0.518756, &
            0.328933,0.057306,0.222836,0.419020,0.421157,-0.555629,0.227562,0.675204, &
            0.390787,-0.015458,0.475851,0.488708,0.378957,-0.502120,0.043523,0.580586, &
            0.608143,0.787707,0.691724,-0.616530,0.939369,-0.496656,0.255239,0.646384, &
            -0.143953,1.606954,0.785434,-1.023475,1.321845,-0.718936,0.592369,1.058106, &
            -0.535466,1.631703,0.866750,-0.365525,1.283664,-0.813682,0.174161,0.894829, &
            -0.983710,1.085996,0.444655,1.959915,1.033332,-0.138623,-0.115136,0.356527, &
            0.247346,0.611221,0.480312,2.559426,0.772860,-0.194928,0.188789,-0.504824, &
            0.680716,0.309407,0.682134,2.533203,0.163978,-0.167773,0.354963,-0.546396, &
            0.064413,0.211932,0.213059,1.415569,0.228588,0.857656,-0.113466,-0.065260, &
            1.051995,0.261960,0.135654,0.197575,-0.136681,0.174931,-0.099777,0.055983, &
            0.748548,0.092771,0.651529,0.194623,-0.460300,0.501116,-0.691843,-0.063903, &
            0.593387,-0.135480,0.626060,1.073236,-0.249269,0.904339,-0.945615,0.010028, &
            0.212162,-0.035208,0.195361,-0.304979,-0.123285,-0.169082,-0.102917,0.115950, &
            -0.032046,-0.009138,-0.007467,-0.169052,-0.009914,-0.004015,0.017271,0.053760, &
            0.103959,-0.029460,-0.116507,0.001249,0.026369,0.079390,0.061585,0.030086, &
            0.034660,-0.007646,-0.224337,-0.007907,-0.009074,0.104103,0.065138,-0.075031, &
            0.093046,-0.009745,-0.064605,0.070689,0.014139,0.148512,0.026116,-0.095047, &
            -0.037067,0.004166,-0.043357,-0.018519,-0.001414,0.045578,0.015781,-0.036678, &
            -0.173444,-0.000163,-0.055353,0.010832,0.040716,0.045239,0.017305,0.025607, &
            -0.072867,0.025376,0.046216,-0.080372,0.028947,0.106808,-0.014161,-0.071512, &
            0.124322,0.036586,0.070789,-0.061071,0.060649,-0.087346,-0.023101,0.168926, &
            0.032773,0.078342,0.045233,-0.435849,-0.075154,-0.357438,-0.064515,0.244663, &
            0.049052,-0.035810,0.081975,0.098209,0.100007,-0.184156,0.091749,0.188080, &
            -0.081871,-0.009319,0.002826,0.303529,-0.050303,0.160357,-0.156064,-0.226041, &
            -0.162992,-0.019909,0.048552,0.192361,-0.051292,0.005667,-0.163424,-0.142871, &
            -0.009636,0.011078,-0.110292,-0.060585,0.061419,0.350586,0.119431,-0.281683, &
            0.102338,-0.061727,-0.065389,0.228229,0.000844,0.052789,0.030829,0.059404, &
            0.058479,-0.037084,0.136964,0.008861,-0.083121,-0.108027,-0.180685,0.077503, &
            -0.390722,0.056016,0.061780,-0.034628,-0.012188,0.009305,-0.213391,-0.113889, &
            0.270954,-0.048461,-0.180578,0.050023,0.067128,-0.060207,0.201075,0.151372 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.650862,1.032545, &
            -1.092924,-6.307319, &
            1.226633,-0.567469, &
            -1.955560,-2.057618, &
            0.234587,2.011530, &
            0.213642,-0.750272, &
            1.610521,-0.897867, &
            1.179321,0.074121 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.573329,-1.590145/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-2.36911,0.260619,2.197315,0.015607,-1.780283,1.659165,0.39779,1.110756/)
real, dimension(2) :: bias2 = &
(/0.239102,0.113119/)
real, dimension(1) :: bias3 = &
(/0.29535/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
