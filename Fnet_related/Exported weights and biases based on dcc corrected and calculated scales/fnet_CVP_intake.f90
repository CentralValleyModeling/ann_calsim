module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.021678,0.183980,0.124514,0.052403,0.136629,0.027928,0.071001,-0.214523, &
            -0.011272,0.413890,-0.114054,-0.014504,0.255173,-0.081463,0.090381,-0.072824, &
            0.088544,0.467188,-0.438795,0.000849,0.231571,0.060858,0.159189,-0.019631, &
            0.193982,0.119979,-0.315636,-0.031309,0.030270,0.172299,0.132969,-0.033245, &
            0.202565,0.154458,-0.204611,-0.039414,-0.006636,0.222762,0.074642,0.009989, &
            0.052042,0.088796,-0.058154,-0.024663,0.016879,0.090931,-0.006477,-0.010369, &
            0.093232,0.166307,-0.215661,-0.044934,0.035776,0.095330,0.024666,-0.000057, &
            0.036384,0.326262,-0.310274,-0.068552,0.160768,-0.069295,0.073113,-0.098808, &
            0.242186,0.309736,-1.565132,-0.458274,0.521073,0.170308,0.075164,-0.893120, &
            -0.095572,0.014459,-0.306186,-0.096628,0.315761,0.048062,-0.025431,-0.622842, &
            -0.095186,0.107886,1.835463,0.002371,0.121800,0.090077,-0.004748,-0.301204, &
            -0.216543,-0.217101,2.516306,0.138342,-0.180265,-0.076202,-0.013594,0.022575, &
            -0.245496,-0.050831,0.409310,0.149845,-0.382333,-0.204371,-0.125993,0.118782, &
            -0.221118,-0.695377,-0.202082,0.113720,-0.493096,-0.273778,-0.192563,-0.007907, &
            -0.349620,-0.994864,-0.123043,0.083780,-0.324417,-0.165922,-0.511595,-0.325702, &
            -0.183260,-0.131466,-0.307893,0.102452,0.032013,-0.168522,-0.119171,-0.172708, &
            -0.217191,-0.702108,0.067102,0.001199,-0.205221,0.080464,-0.647196,-0.292898, &
            -0.319877,-1.116795,-0.038680,0.183660,0.000225,0.112820,-0.352715,-0.286742, &
            -0.186907,0.817290,1.022803,0.135034,-0.005351,0.110960,-0.274319,-0.497856, &
            -0.327602,1.116121,1.636870,0.541008,0.133217,0.588519,-0.203897,-0.778039, &
            0.065298,1.117292,0.956090,0.289602,0.164999,0.723902,-0.023779,0.070033, &
            0.089783,-0.005578,0.182499,-0.109476,0.266729,0.144762,0.012340,0.310946, &
            -0.107342,-0.318102,0.284322,-0.138952,0.235157,-0.278498,0.191312,0.281036, &
            -0.054222,-0.385865,0.143346,-0.019787,0.066204,0.008598,0.111039,0.250221, &
            -0.074737,-0.166277,0.075873,0.088759,-0.014809,-0.150853,0.211278,0.043484, &
            -0.061053,0.000038,0.148487,0.248238,-0.194197,0.106232,0.249644,0.032214, &
            -0.012000,0.057785,-0.482284,1.134929,-0.366585,0.493726,0.065217,0.335592, &
            -0.156201,0.119940,-0.756095,1.361018,-0.554154,0.397457,-0.256124,0.547356, &
            0.124174,-0.705651,-2.372244,0.760512,-0.708679,-0.432044,0.499421,0.728308, &
            0.333151,0.012686,-1.961895,0.558712,-0.073814,0.082662,0.008180,0.108559, &
            0.445242,0.693895,0.463101,0.565175,0.043519,0.660640,0.324509,0.313149, &
            0.401813,1.285336,-0.056637,0.219570,-0.100481,0.755130,0.127644,1.294183, &
            0.339149,0.113985,-0.997803,-0.144928,0.418134,0.222138,0.058861,-0.061770, &
            0.308835,-0.630648,0.783276,-0.072741,0.005513,0.904732,-0.154911,-0.318900, &
            0.250137,-0.429971,-0.326147,0.138556,0.257983,0.759156,0.344646,0.549271, &
            0.781228,0.509009,-2.577238,-0.604497,0.930266,0.210081,0.450837,-0.453717, &
            0.505379,0.374931,-0.457167,-0.330133,-0.034444,-0.928003,-0.017024,-0.150396, &
            0.176449,0.981030,1.299129,-0.172206,-0.201641,-0.699952,0.890810,-0.629737, &
            0.266113,2.352702,0.762914,0.078603,-0.466393,0.056925,0.826234,0.322333, &
            0.306961,1.879036,-0.200545,-0.009156,0.007895,-0.044984,-0.038744,0.278218, &
            0.370745,0.779299,-0.388727,-0.230108,0.287458,0.006835,-0.256960,-0.334496, &
            0.313528,0.613996,-0.098488,-0.656175,0.383592,0.036123,-0.462084,-0.387135, &
            0.104262,0.142481,-0.270218,-1.245598,0.571198,0.043538,-0.387846,-0.329252, &
            0.175158,0.226107,-0.516725,-2.085409,0.823064,0.159082,-0.205022,-0.359437, &
            -0.702830,-0.004905,-0.581238,-7.389334,0.063931,-0.040431,0.828812,-0.317066, &
            0.304483,0.530956,1.609903,-11.662109,-0.175383,-0.856478,1.005994,-0.421818, &
            0.885248,0.379226,2.147300,-10.987429,0.932992,0.547369,6.881457,-0.651932, &
            -0.408211,0.203523,0.325891,-8.346122,0.001371,-0.265756,5.213699,-0.354105, &
            -0.362292,0.377188,-1.199633,-5.271415,0.267590,-0.412456,5.446557,-0.250620, &
            0.804596,0.632998,-0.552803,-2.603763,0.168899,-0.485856,4.096419,-0.287643, &
            0.128200,0.777637,0.556453,-1.614978,-0.195672,-0.339942,2.225585,-0.316816, &
            0.675427,0.702843,-2.558970,-0.130602,0.003412,-0.202081,1.353107,0.387891, &
            -0.095081,0.482144,-5.315284,-0.130251,0.055385,-0.090600,1.345653,-0.288054, &
            -0.370903,-0.680390,-2.952133,-0.502732,0.566438,-0.606239,1.700850,-1.247698, &
            4.302435,-0.242567,0.147724,-1.410411,-2.420694,0.224696,1.090982,0.681458, &
            3.689604,1.149614,-0.164594,-1.459014,-3.326731,1.971233,1.574929,-0.512517, &
            3.653367,1.456728,-0.651501,-1.750017,-3.611796,2.677911,1.236898,-0.549362, &
            3.668941,0.535834,-0.434218,-1.464911,-2.663835,1.916526,0.953893,0.016811, &
            3.274409,-0.256353,-0.103689,-1.490003,-1.618844,1.502110,0.293887,0.549158, &
            3.045949,-0.366338,0.031235,-1.462570,-1.333421,0.947938,0.024219,0.732310, &
            2.934828,-0.801648,0.235387,-1.846379,-0.826746,0.709973,-0.212415,0.415195, &
            2.964640,-0.780331,-0.192437,-2.028421,-0.629644,0.770240,-0.203252,0.531477, &
            2.582639,-1.231420,-0.204211,-2.558128,-0.190436,-0.086406,-1.205682,0.349607, &
            1.070790,-0.827883,-0.341707,-3.471751,0.075376,0.736953,-0.455701,-0.374447, &
            0.632244,-0.801465,-0.965172,-2.665243,-0.088839,3.506928,2.452271,-1.404274, &
            0.870667,-2.169553,0.725687,-1.961280,0.295912,0.830276,1.860688,0.337408, &
            0.452405,-2.235609,2.110031,-1.092195,-0.297441,-0.159849,1.941189,-0.450690, &
            0.015202,-3.021579,1.516559,-0.745636,-0.617922,-0.265271,2.041133,-0.463468, &
            0.240971,-2.898848,0.608585,-0.489385,-0.574743,-0.251698,1.580542,0.107660, &
            0.445751,-1.884482,0.323512,-0.738340,-0.806461,-0.044858,1.599228,-0.004274, &
            0.275286,-0.551703,-0.487092,-1.379250,-0.875344,0.053006,1.726121,0.589223, &
            0.997087,0.342661,-0.975764,-0.837440,0.303726,0.403213,1.849347,0.676237, &
            -0.109765,-0.247205,-0.526502,0.088716,0.000674,0.285302,-0.309208,0.051564, &
            -0.036261,-0.006132,0.039706,-0.016869,0.104977,-0.079862,0.034603,0.029270, &
            -0.150796,0.047565,-0.157484,0.074264,0.087601,0.026198,-0.086573,-0.047288, &
            0.113980,-0.159368,-0.050460,-0.016164,-0.158652,0.055805,-0.092847,-0.066362, &
            0.051492,-0.131865,0.114118,-0.035100,0.172171,0.112557,-0.037010,-0.177808, &
            0.150829,0.077457,0.150126,-0.004488,0.107539,0.171607,0.028931,-0.094204, &
            -0.017371,-0.245681,-0.063160,0.012504,0.057216,0.085903,-0.053158,0.067953, &
            -0.258019,-0.123118,-0.884688,0.133378,0.040980,0.155746,-0.326597,0.068140, &
            -0.355195,-0.328613,-0.790180,0.426129,-0.084917,0.619614,-2.145809,-0.970259, &
            -0.551971,-0.704422,-0.494763,0.625512,0.324038,0.516938,-1.957349,-0.885175, &
            -0.709485,-1.264932,0.256623,0.566927,0.217255,-0.180189,-1.240265,-0.515220, &
            -0.990826,-1.266970,0.322566,0.177156,0.218625,-0.876302,-1.452834,-0.293817, &
            -1.109377,-1.598010,0.587970,0.286495,0.009799,-0.947948,-0.434908,-0.392911, &
            -1.356040,-0.991363,0.769473,-0.001003,-0.304210,-1.356610,-0.407568,-0.324222, &
            -0.875325,0.400831,-0.275876,-0.165738,-0.661946,-1.428565,-0.072520,-0.255029, &
            -0.497095,1.350892,0.437069,-0.292706,-0.859967,-1.724796,0.245676,-0.111996, &
            -0.339859,0.914741,-1.051652,-0.068255,-0.368512,-0.948863,0.395904,-0.185890, &
            -0.095518,1.113109,0.118640,-0.262117,-0.399416,-0.812613,-0.265089,-0.069085, &
            0.553164,1.981395,-0.311176,-0.269256,0.108045,0.181604,0.885008,0.465245, &
            0.610163,1.407080,-2.587027,-0.180461,0.256310,0.570540,0.633670,0.437702, &
            0.448439,1.273775,-2.512620,-0.105140,0.163859,0.621828,0.492582,0.135023, &
            0.526287,1.039080,-0.650784,-0.137240,0.065193,0.547555,0.278797,-0.150153, &
            0.512104,1.216262,-0.300036,-0.098091,0.218101,0.458339,0.365142,-0.005206, &
            0.448409,0.920140,0.138408,-0.057097,0.086814,0.391164,0.293913,0.144420, &
            0.216792,0.796826,0.138357,-0.181572,0.249995,0.185520,0.217000,0.128350, &
            0.212848,1.026568,0.232640,-0.016711,0.303838,0.401465,0.421951,0.073909, &
            0.069768,0.931330,-0.115516,0.654822,0.606442,0.366792,0.658019,-0.356103, &
            -0.087697,-0.092221,-0.479012,1.523601,0.442796,0.216011,0.956619,-0.499021, &
            -0.243448,0.095228,0.721307,1.258295,-0.320107,0.336204,0.467644,-1.615075, &
            -0.600118,-1.106701,-0.230914,1.018893,0.091993,0.164514,-0.224269,-0.236823, &
            -0.964692,-1.762000,-1.083116,0.528730,-0.027532,0.182320,-1.561851,-0.358331, &
            -0.758371,-1.893390,-1.271230,0.134301,-0.662406,-0.398516,-1.245431,-0.127828, &
            -0.546557,-1.473715,-0.359588,0.314234,-0.166941,-0.049980,-1.170832,-0.425201, &
            -0.370697,-1.119109,-1.204580,-0.052167,-0.143571,0.172964,-0.488409,-0.095359, &
            -0.360519,-0.901523,-1.176591,0.158069,-0.111590,0.112436,-0.342439,-0.287435, &
            0.147490,0.003091,-1.495525,0.264452,-0.367723,0.032812,-0.586856,0.058135, &
            -0.237812,-0.022618,0.376144,0.003161,-0.151106,-0.277798,-0.260674,-0.118692, &
            -0.127659,0.203798,-0.206696,0.062287,0.161154,-0.145882,0.037984,-0.130572, &
            0.106803,0.382850,-0.453245,-0.038000,0.249623,-0.095312,0.304021,-0.102092, &
            0.018812,0.230624,-0.036402,-0.024055,0.149958,-0.156124,0.174839,-0.077995, &
            -0.097076,0.196864,0.138915,0.010995,0.120051,-0.319105,0.171324,-0.131932, &
            -0.057088,0.104368,0.029828,0.013480,0.082922,-0.166119,0.110874,-0.103604, &
            0.029065,0.045532,0.129607,0.003832,-0.015373,-0.021666,0.075258,-0.017282, &
            -0.107914,0.037729,0.074384,0.027502,0.050342,-0.172067,0.023394,-0.164987, &
            -0.174886,0.166922,0.340230,0.104436,0.032289,-0.125906,-0.112846,-0.185792, &
            -0.121668,-0.112704,1.323473,0.039593,-0.114276,-0.309020,0.013474,-0.034361, &
            -0.107371,-0.594208,2.172018,-0.045017,-0.122608,-0.093015,0.013873,-0.235865, &
            -0.269376,-0.024775,-0.079640,0.089974,-0.253623,-0.207354,-0.431880,-0.033942, &
            0.071454,0.038731,0.192150,-0.200926,0.211830,0.250658,-0.102804,0.103940, &
            0.700773,0.653935,0.108660,-0.157966,0.279953,0.592376,0.725251,0.233013, &
            -0.227209,0.167615,0.244711,0.119773,-0.084797,-0.169034,-0.215719,-0.029586, &
            0.255302,-0.140503,-0.422185,-0.104410,-0.006928,0.047076,0.240116,0.062611, &
            0.054930,0.132835,0.264206,0.060035,0.352808,0.075248,0.440346,-0.187184, &
            -0.220422,0.017096,0.139334,-0.088956,0.133463,-0.016582,-0.527128,-0.173295 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.093269,1.495902, &
            1.299017,0.272802, &
            -5.394082,3.253577, &
            -6.057282,3.949355, &
            -0.729866,0.357719, &
            1.074137,-0.489789, &
            0.722764,-0.979073, &
            -3.032930,2.133541 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.21331,1.817283/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.137287,-1.642419,1.623173,0.801179,1.768502,-2.038374,-0.565654,1.516503/)
real, dimension(2) :: bias2 = &
(/0.423147,-0.260698/)
real, dimension(1) :: bias3 = &
(/0.21766/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
