module fnet_CO

! a = 5.569e-005
! b = 0.090701

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.334237,0.018000,0.025918,1.063529,-0.046726,0.147434,0.573150,0.107728, &
            0.102342,-0.017140,-0.022445,0.955309,-0.154782,0.097403,-0.334199,-0.046327, &
            -0.025031,0.063970,-0.019692,0.726021,0.021963,-0.023850,-0.094541,0.040909, &
            0.000608,-0.023749,0.019769,0.617458,0.025283,-0.023657,0.074418,0.032537, &
            -0.050595,0.028335,0.161865,0.680430,-0.044744,-0.080615,0.244437,-0.017397, &
            -0.051115,0.112802,0.253240,0.694120,0.278844,-0.123530,0.174068,-0.047091, &
            -0.048362,0.173105,0.192082,0.391317,0.316730,-0.386147,0.297181,0.052501, &
            0.029042,0.047912,-0.064874,0.166389,0.335056,-0.207664,-0.324473,0.059495, &
            -0.001525,0.560994,-0.223759,0.598413,-0.693075,-0.632965,0.627450,0.164277, &
            0.082335,0.036246,-0.371842,1.946203,-0.512124,-0.023356,-0.231439,0.059131, &
            -0.567166,0.591172,0.402810,1.755572,0.652080,0.473529,0.575947,-0.220740, &
            0.035713,-0.177981,0.210550,0.099204,-0.720015,0.642695,0.020956,-0.235515, &
            0.173241,0.050513,-0.032732,-0.284498,-0.170473,-0.106940,0.017207,-0.010125, &
            0.230863,0.121366,-0.339638,-0.488807,0.775960,0.038165,-0.917819,-0.080186, &
            0.151065,0.373198,-0.174304,-0.325528,0.478138,-0.316063,-0.513177,0.138513, &
            0.060399,0.709039,0.077156,-0.324835,-0.713337,-0.557461,0.466247,0.155706, &
            -0.132838,0.851184,-0.081245,-0.175779,0.337702,0.272368,0.446378,-0.316099, &
            -0.072128,0.585381,0.597872,-1.819493,0.201799,0.001302,0.641118,-0.176882, &
            -0.150648,0.205252,-0.275047,0.501489,-0.755291,0.460419,-0.060296,-0.114444, &
            0.302432,0.481704,0.092088,0.118029,-0.576607,0.716444,-0.112304,-0.111004, &
            0.156567,0.223260,0.166484,0.524844,0.047124,0.474443,-0.020193,-0.003212, &
            0.156592,0.447170,0.319819,0.557966,-0.894255,0.042504,-0.258279,0.182297, &
            0.155756,0.149093,0.560598,-0.070203,-0.237386,0.304814,-0.174548,0.232154, &
            0.125955,0.288662,0.129057,-0.327031,0.096394,0.360023,0.001991,0.283959, &
            0.224203,0.100690,0.246906,0.228492,0.576631,0.129965,0.109707,0.312688, &
            0.445120,0.438755,0.438807,0.392508,1.420585,-0.161016,0.392526,0.365256, &
            0.550403,0.451876,0.614421,0.065906,-0.418192,0.326128,0.258209,1.123167, &
            0.722483,0.442745,0.203001,0.651818,-0.866041,1.102202,0.388802,0.026047, &
            0.289634,1.288101,0.453100,-0.063582,-0.031138,-0.411680,-1.827544,0.467619, &
            -0.044398,-0.095682,0.056745,0.473545,-0.624038,-0.356565,0.604883,0.478596, &
            0.382032,0.641796,0.071486,0.285098,-1.707589,0.304081,0.078267,-0.473042, &
            0.274442,0.512239,0.362901,-0.814386,1.014306,-0.667572,-0.304211,0.091277, &
            -0.358010,0.177461,-0.047182,-0.003168,0.022652,0.178635,0.273046,0.073089, &
            -0.004116,-0.290740,0.360146,0.126797,0.942311,0.414801,0.751708,-0.279614, &
            -0.343597,-0.100434,1.032128,-0.329080,0.226899,-0.101992,1.516158,0.158632, &
            0.545297,-0.341200,-0.219556,-1.711654,-0.436832,-1.018742,-0.563399,0.163207, &
            -2.494663,-3.305136,-2.950023,-3.538697,-0.924881,-1.740686,-2.697005,-2.222633, &
            -4.408704,-4.444249,-3.703636,-3.584072,-1.304492,-4.585554,-4.472471,-3.862883, &
            -4.416639,-4.463607,-4.241237,-3.234070,-0.442163,-4.180519,-3.183486,-3.740279, &
            -4.045879,-4.340395,-4.347760,-3.087442,-0.276422,-3.995547,-2.343544,-3.769753, &
            -4.367891,-4.674674,-4.792589,-3.308837,0.065619,-4.365924,-1.450005,-4.163186, &
            -4.894592,-5.115782,-5.382567,-3.499502,-0.037872,-5.146898,-1.477229,-4.465609, &
            -5.941560,-5.441028,-6.190978,-3.945398,-0.673432,-6.022472,-1.967051,-5.158173, &
            -6.634449,-6.577971,-6.817972,-4.205180,-1.982801,-6.967976,-3.214124,-6.296540, &
            -11.928697,-11.577243,-11.786040,-7.392089,-6.733236,-11.758213,-7.748345,-10.905316, &
            -11.424786,-12.546168,-12.957596,-8.229991,-5.837914,-8.882680,-6.828178,-6.883128, &
            -7.905142,-10.327826,-10.778033,-7.429406,-4.201781,-4.191356,-6.112780,-1.341224, &
            -3.665427,-6.121230,-7.027130,-5.472333,-0.919694,-0.944469,-2.744263,0.933457, &
            -2.261279,-4.746116,-6.468055,-4.420090,-0.438482,0.063703,-0.945009,0.927194, &
            -1.322707,-3.035947,-4.902926,-2.888326,0.628631,0.458532,-0.534661,0.290006, &
            -0.251912,-2.027274,-2.894050,-1.398761,0.429521,0.712970,-0.475543,-0.051316, &
            -0.357129,-1.732087,-1.921252,-1.634349,-0.381667,0.585015,-0.967454,0.138497, &
            0.596028,-0.642336,-1.329296,0.392187,0.207331,0.089234,0.287112,-0.286031, &
            0.160947,-0.257502,-2.408219,1.244746,0.368373,0.315783,-0.415105,0.181145, &
            -0.479760,-0.098113,-1.346192,-0.509603,0.774890,-0.342691,0.985767,-0.997222, &
            -0.960596,-0.235528,-1.358831,-0.651214,0.357992,-0.369468,0.834122,-1.218197, &
            -0.869183,-0.535096,-1.531269,-0.700018,0.293584,-0.661888,0.778920,-1.449927, &
            -0.979148,-0.627870,-1.317243,-0.662081,0.431731,-0.600972,0.576197,-1.276081, &
            -1.405671,-0.562616,-1.513451,-0.715960,0.341567,-0.644763,0.253170,-1.217148, &
            -1.535680,-0.766627,-1.697361,-0.650944,0.112100,-1.043412,0.275056,-1.278153, &
            -1.522346,-0.712550,-1.306836,-0.707433,0.099118,-0.911853,0.040539,-1.573659, &
            -1.482689,-0.816768,-1.568220,-0.628801,-0.036665,-1.057017,-0.104274,-1.565018, &
            -1.379553,-0.675047,-2.001564,-0.353654,1.041748,-1.462513,-0.256713,-2.451655, &
            -2.044329,-2.313856,-2.858629,-1.491097,0.321374,-1.229236,-2.223610,-1.308979, &
            -1.077045,-1.846396,-3.248543,-0.863816,2.067062,0.088708,-1.269349,-0.520471, &
            -0.507005,-1.044359,-1.616408,-0.200124,0.791110,0.376205,-0.918363,-0.071283, &
            -0.231180,-0.467522,-1.388369,-0.073159,0.822463,0.053240,0.217431,0.120497, &
            -0.129786,-0.483634,-0.241217,-0.067053,0.366552,0.038572,0.135743,0.033890, &
            0.299511,-0.597215,-0.147100,0.001608,-0.025270,-0.366723,0.038314,0.280557, &
            -0.256244,-0.358502,-0.077732,-0.955931,-0.688758,-0.322300,-0.709036,-0.025312, &
            -0.204833,-0.626978,-0.798296,-1.304863,-1.202263,0.639005,-1.294839,-0.117675, &
            0.352435,0.220496,-1.144457,-1.187170,-0.424769,-0.366530,-1.357672,0.670603, &
            -0.002817,0.047300,0.307513,-1.265984,0.043931,0.292430,1.126960,0.643666, &
            -0.275898,0.179115,0.058133,-0.679184,0.293276,0.093966,0.508852,0.252042, &
            -0.253575,0.204599,-0.232553,0.134587,0.058862,0.249584,0.298811,0.061814, &
            0.077446,-0.177177,-0.183237,0.147456,-0.076496,0.202548,-0.446894,-0.081864, &
            0.094057,-0.078330,0.061792,-0.155712,-0.154074,0.101601,-0.131368,-0.036744, &
            -0.049157,-0.045079,0.225169,-0.478567,-0.180043,-0.244536,0.306771,0.015506, &
            -0.082476,0.058072,0.161728,-0.609554,0.078665,-0.206266,0.266082,0.054001, &
            -0.365303,-0.171859,-0.188265,-0.772572,0.316445,0.194534,0.691671,0.063461, &
            0.487073,0.147826,0.169335,-1.084292,-0.415425,0.285764,1.710245,-0.169664, &
            -0.698295,-1.365218,-1.154101,-1.272908,-2.182821,-0.726048,-0.349180,-1.014921, &
            0.377045,0.872791,-0.472696,0.489195,-2.056247,0.558233,0.112612,0.676183, &
            -0.287103,-0.016568,-0.203765,0.095047,-2.669115,-0.471994,-0.689764,0.178860, &
            0.760166,-0.134814,-0.137626,1.122216,-3.350028,1.140842,-0.525274,0.752886, &
            -0.142978,-0.307992,-0.130778,-0.328415,-2.395604,0.122533,-1.090879,-0.088023, &
            0.951085,1.210642,-0.036639,0.925071,-1.010637,0.702711,-0.319990,1.013305, &
            -0.664030,-0.042472,-0.659398,1.820630,-1.091118,-0.529774,-1.541822,-0.303080, &
            -0.179431,-0.146403,-0.431722,0.686022,-0.805158,-0.193105,0.167174,-0.491586, &
            -0.370792,0.108762,-0.041525,1.232348,0.276123,-0.769821,-0.177056,-0.925559, &
            -0.233845,-0.268209,-0.210608,0.066181,0.823204,-0.785973,0.239578,0.381749, &
            0.196356,-0.269282,-0.258733,0.076984,0.488865,-0.091849,0.530161,0.582975, &
            -0.091669,-0.072521,-0.100400,0.301564,0.252076,-0.157583,0.380728,0.565107, &
            0.013373,0.172725,-0.262523,0.215776,0.752480,-0.153341,-0.386566,0.273785, &
            -0.027016,0.170521,0.052248,0.278392,0.537999,-0.133533,-0.579591,0.177854, &
            0.166413,0.068659,-0.006015,0.146543,-0.213644,-0.311782,-1.012795,0.286443, &
            0.294482,0.055300,-0.015566,-0.246336,-0.150078,0.157228,-0.698147,0.137803, &
            0.335943,0.427637,-0.098235,-0.270117,0.625690,0.290808,-0.148892,0.148664, &
            1.158222,0.696109,0.246537,-1.160345,1.306303,1.434538,0.298966,0.710091, &
            0.889141,0.733796,0.788749,-0.519028,0.920969,-0.215270,-0.185960,-0.144886, &
            0.408212,0.221569,0.525155,-0.566151,-1.920362,-0.007575,0.519223,-0.454210, &
            0.482555,0.071448,0.828687,-0.404295,-0.469806,-0.261769,0.527836,-0.023574, &
            0.355204,0.464357,0.804336,-0.150893,-0.751709,0.088720,0.237267,-0.116433, &
            0.233652,0.165136,-0.134933,-0.592856,-0.545732,-0.128201,-0.417092,-0.047349, &
            0.350016,0.008103,-0.437022,-0.264967,0.250312,0.214269,-0.459176,0.167574, &
            0.126585,-0.175891,-0.637604,-0.039858,0.002095,0.222805,0.124389,-0.520013, &
            0.565880,0.007262,0.301853,-0.322223,1.373011,0.755800,0.706477,-0.103682, &
            0.066397,-0.107185,-0.028057,-0.043043,1.249626,-0.124063,0.096953,0.129631, &
            -0.085569,0.040231,0.113729,0.056398,0.442363,0.108123,-1.982330,-0.033818, &
            -0.269690,0.026914,0.612348,0.406562,0.138645,0.139356,-2.014289,0.027160, &
            -0.291568,-0.203640,1.626286,0.414085,0.151482,-0.045289,-0.425704,0.100184, &
            -0.111258,-0.068630,1.480983,0.196217,-0.021038,-0.121113,0.017590,0.054698, &
            -0.007072,0.098539,1.510508,0.011758,-0.122937,-0.159023,-0.286925,0.011920, &
            0.142807,-0.096962,1.196429,-0.118379,-0.131097,-0.238289,-0.256207,0.048796, &
            0.185504,-0.038229,1.392214,-0.493176,-0.432224,-0.186348,-0.337072,0.038094, &
            0.171404,-0.023919,1.045582,-0.506351,-1.899257,-0.332386,-0.004601,-0.013604, &
            -0.172372,-0.094698,0.777562,-0.399073,-1.492888,0.065468,0.770386,-0.131229, &
            -0.050537,-0.136913,0.012829,-0.001320,-0.717059,0.423742,-0.000027,-0.134192, &
            -0.009774,0.082047,-0.111823,0.385210,-0.650704,0.180956,-0.697915,-0.140370, &
            -0.190534,0.045740,0.104229,-0.686638,0.291721,-0.366999,0.961789,0.385625, &
            0.131699,0.031697,-0.152735,0.400402,-1.231229,0.491094,-0.534998,-0.322729, &
            -0.115139,-0.042301,0.128791,0.589613,0.189279,-0.333586,0.312161,0.136208, &
            0.083675,-0.072784,0.033498,-0.421454,1.199008,0.054404,0.276584,-0.071986, &
            0.048049,-0.076392,-0.168943,-0.020779,-1.776636,0.203591,-0.204121,0.057626, &
            0.252643,0.029437,0.198093,0.288020,0.773442,-0.227165,-0.136100,-0.197628, &
            -0.263645,0.228962,-0.132546,-0.494342,1.124646,0.226426,-0.316994,0.031052 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/4.157022,-8.627971, &
            4.267400,-7.630097, &
            1.047523,-6.176161, &
            2.627122,-2.923752, &
            1.368442,-4.831670, &
            0.586240,-8.661844, &
            -0.142085,-2.536157, &
            1.454059,-6.130462 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.006383,-0.692755/),(/1,2/))
real, dimension(8) :: bias1 = &
(/3.304969,2.194798,1.746543,1.161734,1.602368,3.722445,3.200527,2.549864/)
real, dimension(2) :: bias2 = &
(/-1.706073,1.43351/)
real, dimension(1) :: bias3 = &
(/0.51293/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
