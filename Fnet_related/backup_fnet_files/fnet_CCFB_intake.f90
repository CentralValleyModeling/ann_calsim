module fnet_CCFB_intake

! a = 0.00076145
! b = 0.026005

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.072919,-0.170477,0.084663,-0.372055,-0.137504,-0.017476,-0.122476,-0.233792 &
			,-0.024901,0.001305,-0.070263,-0.006257,0.007427,-0.043610,-0.274564,-0.143869 &
			,-0.030457,-0.044717,0.046740,0.053062,-0.018745,0.088673,0.146604,0.026593 &
			,-0.132602,-0.041786,0.030134,0.005913,-0.071510,-0.008121,-0.135992,-0.126971 &
			,-0.013271,0.089863,0.022565,0.067276,0.056155,-0.097711,0.103895,-0.016594 &
			,-0.109214,-0.058373,0.056805,-0.114491,-0.140221,-0.039313,-0.010008,-0.035846 &
			,0.013041,0.120684,0.095134,-0.083001,-0.021954,-0.233348,0.014271,-0.089315 &
			,0.176809,0.123916,0.023112,-0.236308,-0.066575,-0.293997,-0.229943,-0.197145 &
			,0.472223,-0.207594,0.199854,-0.804747,-0.169888,0.024305,-0.494719,-0.785521 &
			,0.056392,-0.445302,-0.208788,-0.039783,0.213205,0.603452,-0.722071,-0.537249 &
			,0.202540,-0.173377,0.067758,0.150085,0.196132,0.212389,-0.504992,-0.919178 &
			,0.057212,-0.167099,0.212744,0.076889,0.304842,0.306657,-0.861488,-0.857703 &
			,0.207064,-0.033940,-0.156363,0.374266,0.025766,0.222522,-0.527505,-0.555334 &
			,0.597317,-0.061213,-0.057949,0.123346,0.116085,0.328601,-0.008674,-0.208670 &
			,0.176126,-0.262778,-0.278699,0.228398,0.291245,0.433860,-0.034473,0.147712 &
			,-0.020936,-0.435723,-0.307896,0.514025,0.497642,0.450042,0.222030,-0.023547 &
			,0.138418,-0.518399,-0.272984,0.366695,0.512429,0.514182,0.621855,0.098908 &
			,-0.164297,-0.532533,-0.420493,0.843762,-0.482505,0.584232,0.550693,0.247631 &
			,-0.030167,0.088487,-0.054093,-0.843816,0.863057,-0.328614,-0.008481,-0.280873 &
			,-0.025344,-0.090785,0.035536,-0.901251,0.511185,-0.239559,-0.113639,-0.164333 &
			,-0.000179,-0.221222,-0.106184,-0.648098,0.721632,-0.061715,-0.075076,0.067581 &
			,-0.162868,-0.050089,0.110542,-0.447891,0.693818,-0.128572,-0.144945,0.042555 &
			,0.020201,0.094097,-0.010760,-0.286991,0.488097,-0.028705,-0.094449,0.139597 &
			,-0.180480,-0.094038,0.093710,-0.161066,0.449616,-0.085233,0.075170,-0.143557 &
			,-0.398983,-0.213408,0.138508,-0.316881,0.472436,0.017358,-0.110528,-0.168148 &
			,-0.352812,-0.068923,0.012349,-0.248248,0.277301,-0.129888,-0.068491,0.015004 &
			,-0.274752,-0.613890,-0.064052,-0.110629,0.021980,0.095638,-0.078273,-0.004924 &
			,-0.073340,-0.876353,-0.123765,-0.133196,-0.304839,0.174951,-0.573833,-0.122247 &
			,-0.087177,-0.756843,0.130227,0.048202,-0.556349,-0.043010,-0.391015,-0.317527 &
			,-0.025254,-0.599625,0.135130,-0.209060,-0.434569,0.292018,-0.401508,-0.223388 &
			,-0.202406,-0.458231,0.167076,0.015110,-0.048424,0.020220,-0.137223,-0.073875 &
			,-0.217338,-0.246428,0.295200,-0.426871,-0.128849,-0.135016,-0.128622,0.029462 &
			,-0.006634,-0.061061,0.278445,-0.329861,-0.099531,-0.206571,-0.030803,-0.045600 &
			,-0.278952,-0.053256,0.281910,0.073262,-0.410116,0.009024,-0.016017,0.029858 &
			,-0.059615,0.010243,-0.071137,0.030430,-1.098288,-0.265227,-0.394712,-0.126671 &
			,0.150458,0.493675,-0.090879,0.241642,-1.936027,-0.779363,-0.887862,-0.126183 &
			,-0.327940,0.434905,0.033637,0.156821,-0.426477,-1.174692,-0.189797,-0.091401 &
			,-0.160894,0.746399,-0.226293,-0.124708,-0.201491,-1.256145,0.078878,-0.289418 &
			,-0.248574,0.628427,0.049255,-0.066727,-0.169600,-1.170250,-0.143545,-0.191428 &
			,-0.020753,0.885779,0.095177,-0.264244,-0.432762,-0.874830,-0.108843,-0.035101 &
			,-0.178467,1.273272,0.132307,0.197283,-0.106841,-0.994525,-0.030696,-0.023702 &
			,-0.191143,1.625661,0.047779,0.000033,-0.459590,-0.793390,-0.183124,-0.091173 &
			,0.096768,1.936201,0.070348,0.037467,-0.359952,-0.690068,-0.075944,-0.030560 &
			,-0.381944,2.284812,0.277572,-0.264631,-0.457635,-0.390744,0.497365,-0.148091 &
			,-0.791623,4.665039,0.562645,-0.325746,-0.040981,1.017489,1.646482,-0.582521 &
			,-0.307579,5.794099,0.793335,-0.609074,0.569656,1.263667,1.704083,-0.425403 &
			,-0.620808,5.745683,1.165245,-0.459182,-0.359372,1.313888,1.347630,-0.526927 &
			,-0.463070,5.313455,0.829670,-0.420127,-0.259988,1.141981,1.261746,-0.519038 &
			,-0.026490,4.471527,0.571519,-0.503432,-0.258972,0.406806,1.243351,-0.496193 &
			,0.052862,3.626177,0.454121,0.084635,0.284018,-0.151705,0.922100,-0.689105 &
			,0.348609,2.597280,0.068969,-0.176310,0.527061,-0.407682,0.381074,-0.051434 &
			,0.247927,1.461564,-0.041782,-0.162197,-0.262475,-0.653739,-0.012531,-0.039539 &
			,-0.154705,1.661177,-0.194098,0.238523,-0.529855,-0.608031,0.259877,0.072262 &
			,0.228397,2.385901,0.134938,-0.033642,-0.528874,-0.035898,0.020542,0.008019 &
			,0.076474,0.830118,-0.811666,-0.376495,-0.019177,-1.470388,-0.067858,-1.314722 &
			,-0.268087,0.689875,-0.938602,-0.596052,-0.214452,-1.737560,-0.358654,-1.582587 &
			,0.057577,0.744265,-0.650338,-0.383183,0.313510,-1.536199,-0.288082,-1.019558 &
			,0.279739,0.794711,-0.408671,-0.014977,0.138613,-1.567500,-0.241406,-0.902442 &
			,0.285042,1.140725,-0.359199,0.104908,0.418428,-1.581980,-0.669387,-0.805563 &
			,0.518312,1.021671,0.009147,0.266950,0.576844,-1.693244,-0.305081,-0.414872 &
			,0.515085,1.051639,-0.124825,0.049530,0.762651,-1.565932,-0.390933,-0.628742 &
			,0.724291,0.966904,0.286636,0.366648,0.653396,-1.432552,-0.309057,-0.214952 &
			,0.793910,1.404039,0.343888,0.630196,1.201948,-1.196068,-0.497135,-0.227682 &
			,0.740823,2.226310,-0.078688,-0.147632,0.050401,-0.628618,-0.476098,-0.500297 &
			,0.053734,1.868779,-0.239689,-1.075752,-2.111596,-0.280459,-0.488598,-0.470279 &
			,-0.248700,1.377716,-0.199467,-0.481429,-0.984746,-0.270419,-0.482868,0.178908 &
			,-0.157721,0.915284,-0.138951,-0.292559,-0.164354,-0.607180,-0.677095,0.645165 &
			,-0.739408,0.845691,-0.148094,-0.230620,0.147212,-0.567151,-0.453571,0.339140 &
			,-0.232697,0.623172,-0.061135,0.128609,-0.038255,-0.385836,-0.700372,-0.306950 &
			,-0.076613,0.897563,-0.121755,-0.064276,-0.454125,-0.695049,-0.972529,-0.620834 &
			,0.101518,1.202501,0.253963,-0.051291,-0.257946,-0.870661,-0.850522,-0.932710 &
			,0.062843,1.922946,0.904821,-0.767934,-0.639434,-0.535139,-0.903932,-1.143551 &
			,-0.199441,-0.181847,-0.376649,0.009582,-0.238489,0.126498,-0.001767,0.414687 &
			,0.134449,0.056758,0.141578,-0.054627,0.020810,0.078545,0.147368,0.176912 &
			,-0.102701,-0.026580,-0.085386,0.113585,-0.060824,0.098988,0.069470,0.132263 &
			,-0.124094,0.020270,-0.112798,-0.150350,0.097147,-0.149967,-0.162584,-0.015411 &
			,-0.132212,-0.048786,0.048968,0.002443,-0.152845,-0.111101,-0.064784,-0.067826 &
			,0.055648,0.043719,-0.210280,0.093483,0.045163,0.031955,-0.015762,0.172885 &
			,-0.005952,-0.141399,0.039195,-0.023017,-0.188851,0.252219,0.011875,0.063106 &
			,-0.149954,-0.148685,-0.417161,0.072798,-0.106831,0.132542,-0.025508,0.482623 &
			,-0.054717,-0.471068,-0.943077,-0.006577,-0.498077,0.192097,0.090819,1.167761 &
			,-0.203301,-0.634939,-0.776854,0.103241,-0.314004,0.240412,-0.054951,1.132779 &
			,0.077614,-0.282570,-0.049148,0.562102,0.131992,0.143360,0.148595,0.803592 &
			,-0.174349,-0.297763,0.137894,0.534755,-0.185822,0.401789,0.161554,0.974084 &
			,-0.017737,-0.085482,0.338997,0.246125,0.003208,0.307304,-0.041184,0.477625 &
			,-0.305518,0.140020,0.254903,0.370643,-0.410544,0.483582,0.976263,0.504096 &
			,-0.134135,0.521419,0.170803,0.521800,0.008805,0.275535,0.725787,-0.071659 &
			,-0.205859,0.591020,0.303738,0.255961,0.391534,0.088962,0.867946,-0.521654 &
			,-0.055105,0.504486,-0.177616,0.209441,0.199276,0.148125,1.148386,0.297488 &
			,-0.232932,0.513069,0.108251,0.254241,0.332860,-0.158030,0.814425,0.033012 &
			,0.239667,0.176619,0.195522,-0.410629,-0.298197,-0.084866,0.489107,-0.201542 &
			,0.115265,0.257962,0.119208,-0.427231,-0.133871,-0.187327,0.398377,0.177631 &
			,0.243789,-0.018331,0.118970,-0.658443,-0.179754,-0.291463,0.268559,0.031659 &
			,0.290697,0.117978,-0.019867,-0.653016,-0.423023,-0.043714,0.128825,-0.019587 &
			,0.159381,-0.073033,0.221639,-0.307635,-0.428264,-0.130113,0.303008,-0.027261 &
			,0.138125,-0.177748,0.081927,-0.446642,-0.409302,-0.022624,0.301845,-0.136702 &
			,0.011799,0.058976,0.199525,-0.260480,-0.320120,-0.069978,0.307400,0.191166 &
			,-0.079169,-0.227092,0.123578,-0.520980,-0.329973,0.064372,0.240145,-0.040627 &
			,0.034300,-0.532926,-0.063781,-0.022379,-0.339085,-0.176617,-0.146887,0.195934 &
			,-0.048700,-0.922161,-0.361721,-0.059779,-0.352930,0.007363,-0.277412,0.417874 &
			,-0.230286,-0.616517,-0.775234,-0.599183,-0.078087,0.064826,-0.269900,0.433416 &
			,0.010819,-0.955973,-0.435173,0.315661,-0.390248,0.067680,-0.180003,0.056756 &
			,-0.069806,-0.534764,-0.284170,0.488734,-0.781201,-0.037711,-0.207743,-0.004887 &
			,0.116741,-0.197574,-0.339707,0.561788,-0.882822,-0.066958,0.117840,0.021583 &
			,0.284807,-0.329006,-0.364110,0.566842,-0.103152,0.013444,0.095301,-0.015374 &
			,-0.112493,-0.077833,-0.112394,0.130502,-0.055233,0.320414,0.299134,-0.030579 &
			,-0.231011,0.003853,-0.143820,0.303124,0.050056,0.001516,0.650157,-0.043660 &
			,-0.000652,-0.137392,-0.319194,0.468990,0.446536,-0.342478,0.674129,0.469147 &
			,-0.222854,0.146824,0.146567,-0.162626,0.115194,-0.270589,0.049203,0.043926 &
			,-0.260996,0.005695,0.219390,-0.232040,0.005429,-0.082867,0.030882,0.131726 &
			,-0.169437,-0.093533,0.188516,-0.112700,-0.249643,-0.020590,0.116505,-0.049032 &
			,-0.389237,-0.056869,0.047690,0.025107,0.037826,-0.081643,0.111227,0.015627 &
			,-0.303420,-0.003943,0.151845,-0.079412,-0.118925,-0.075028,-0.034628,0.028900 &
			,-0.281851,-0.133957,0.036531,0.047524,-0.054218,0.109442,0.047149,0.001264 &
			,-0.015475,0.012460,-0.026678,0.027869,0.117607,0.070825,-0.220184,-0.063155 &
			,-0.129702,-0.012183,-0.032791,-0.011175,0.034431,0.014917,-0.027081,0.088547 &
			,-0.025533,0.010567,-0.057148,-0.008240,-0.035120,-0.080966,-0.116180,-0.095140 &
			,-0.096834,-0.011526,-0.059155,0.125661,-0.077850,-0.072919,-0.011135,-0.078620 &
			,0.011573,-0.059691,-0.068814,0.108794,0.153882,0.166938,-0.094646,-0.166712 &
			,0.046123,0.019355,-0.117968,0.158858,0.172304,0.133788,-0.137451,0.012323 &
			,0.146185,0.072446,-0.112198,0.211028,-0.251074,-0.037404,0.033379,-0.098082 &
			,0.241742,0.067719,-0.029908,-0.036600,-0.001717,0.061997,-0.151075,0.067689 &
			,-0.005728,-0.025208,-0.049650,0.063012,-0.383481,-0.050772,0.097743,0.072499 &
			,0.225223,0.036756,-0.250520,0.213778,0.170703,0.101331,0.048965,0.126920 &
			,0.075737,0.007743,-0.026502,0.026634,0.304850,0.129696,0.171002,0.079412 &
			,-0.082586,-0.007268,-0.017245,0.016732,-0.408168,-0.033066,-0.040848,-0.018980 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.278843,0.769841 &
			,-1.578257,-2.974087 &
			,0.534948,1.748895 &
			,0.240519,1.614416 &
			,0.827604,2.465996 &
			,-1.613746,-1.510492 &
			,-1.013501,-0.329948 &
			,0.752974,1.121586 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.291791,1.463702/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.420052,-0.525675,0.76638,1.021025,0.608715,-0.299987,-0.190674,1.475242/)
real, dimension(2) :: bias2 = &
(/0.23025,-0.059733/)
real, dimension(1) :: bias3 = &
(/-0.23658/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
