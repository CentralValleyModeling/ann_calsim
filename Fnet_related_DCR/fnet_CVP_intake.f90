module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.128819,-0.097928,-0.018603,-0.022779,0.239404,0.615788,0.069541,0.627025, &
            -0.127638,0.109462,-0.048991,-0.036898,0.188445,0.298781,-0.033118,0.335960, &
            -0.005979,0.073699,0.040063,0.101132,-0.147332,0.051684,-0.009535,0.039336, &
            -0.014895,0.008553,0.011268,0.027953,0.086194,-0.085074,0.002037,-0.097162, &
            0.028617,0.072376,-0.045196,-0.046878,0.150176,-0.144525,-0.038931,0.215730, &
            0.032336,-0.000673,-0.042828,-0.022569,0.114892,-0.108040,-0.002822,-0.093423, &
            -0.066523,0.078769,-0.024741,-0.017002,0.013089,-0.020688,-0.039620,-0.001830, &
            -0.072874,0.163307,-0.005571,-0.027337,0.114511,0.155595,-0.103221,-0.160241, &
            -0.482159,0.306734,-0.030536,0.076531,1.066404,0.515524,-0.224495,-0.860129, &
            0.037313,-0.233469,0.047898,0.040658,-1.141700,0.506080,0.003419,0.413524, &
            0.308771,-0.218394,0.117876,0.041947,-1.787919,0.466168,-0.004492,0.737155, &
            0.043860,-0.295058,0.071720,-0.009795,-1.030463,-0.848626,-0.012121,-0.496235, &
            -0.070054,0.036214,-0.157286,-0.077150,-0.311876,-0.997243,-0.025702,0.527915, &
            0.162048,0.013499,-0.018546,-0.106879,0.071536,-0.172670,-0.025282,1.008372, &
            0.480192,0.552469,0.033371,0.466767,-0.143703,0.840292,0.094758,1.461271, &
            0.321674,0.187178,0.078379,0.084228,-0.310784,0.239223,0.053894,0.919132, &
            0.294583,0.453754,-0.069300,0.537234,-0.611490,0.142918,0.211092,0.230845, &
            -0.333983,0.107795,-0.068637,0.235400,1.366883,-0.089931,0.226387,-1.791103, &
            1.035376,-0.071335,-0.189839,-0.108354,-0.693866,-0.509110,-0.007605,2.449394, &
            0.869839,-0.322422,-0.276149,0.046229,-0.215697,-0.121979,0.264780,2.448603, &
            0.787298,-0.130812,-0.311561,-0.083146,-0.339375,-0.433412,0.188027,1.693132, &
            0.912402,0.007908,0.147191,0.150194,-0.586828,-0.783146,-0.029011,0.539398, &
            0.618760,0.129857,0.134670,0.149578,-0.309855,-0.580157,-0.093845,0.305137, &
            0.285367,0.028433,0.217869,0.289735,-0.195137,-0.257378,-0.015819,0.192161, &
            0.535255,-0.114347,0.019430,0.045265,-0.341991,-0.127296,0.042605,0.458641, &
            0.245876,-0.307708,-0.019583,-0.056926,-0.409129,0.222193,0.071488,0.605976, &
            0.228840,-0.545841,0.029586,-0.042467,-0.703316,0.263179,0.646645,1.882064, &
            0.110349,-0.033162,-0.098669,0.356642,0.625855,0.776914,0.941870,0.468635, &
            -0.420629,-0.191464,-0.112733,0.081349,-0.158085,1.388467,0.676755,-1.248539, &
            -0.110855,-0.258540,0.067217,0.137606,0.204394,0.535512,0.529343,-0.638705, &
            -0.691625,0.216323,-0.046287,-0.007789,0.488086,0.101387,0.310003,-0.605249, &
            -1.004856,0.286170,-0.116763,0.223456,0.808756,0.188692,0.180971,-0.886306, &
            -0.496177,-0.232246,-0.018987,-0.155348,0.159006,0.174205,0.129286,-1.397961, &
            0.200667,-0.482198,0.165369,0.180631,0.162551,0.394230,0.364663,-0.886560, &
            -0.857726,-0.252252,-0.016560,-0.053341,-0.632145,0.283837,0.214669,0.532617, &
            -2.890486,0.558400,0.053399,-0.534328,-0.599771,-0.453890,-0.417205,0.698445, &
            -0.253065,0.417970,0.029949,-0.861234,-0.818619,-0.342791,-0.450752,0.343876, &
            -0.582611,-0.594097,-0.002497,-0.692667,-0.547331,-0.328987,-0.548502,0.633795, &
            -0.578837,-0.617992,-0.399534,-0.816554,0.122132,-0.392196,-0.421431,0.714360, &
            -0.464130,-0.232161,0.042195,-1.147612,0.306769,-0.227491,-0.679095,0.810364, &
            -0.293386,-0.149497,-0.062605,-1.267795,0.845067,0.114465,-0.672528,0.930074, &
            -0.433197,-0.207380,0.113197,-1.052583,0.474873,0.578541,-0.868091,0.899327, &
            -0.398847,-0.050486,0.220585,-0.937948,0.287278,0.367858,-0.971894,0.455534, &
            -0.601143,-0.192772,0.143148,-1.134030,0.258934,0.273395,-1.671540,0.254281, &
            -1.042990,-0.731018,-0.123324,-0.288741,-0.022301,-0.646086,-4.821855,-0.810853, &
            0.193430,-0.967867,-0.039978,-1.103273,0.552307,-2.424642,-7.025209,-1.044485, &
            -0.242244,-2.643330,0.131479,-1.536848,-1.052620,-1.815523,-7.459648,-1.078577, &
            0.381982,-0.894623,-0.015977,-1.208192,-1.268606,-1.332621,-6.826662,1.048822, &
            0.113758,-0.377788,0.254357,-1.745858,-1.992973,-0.169056,-5.124436,1.469729, &
            -0.075749,-0.264676,0.141091,-2.468824,-0.704616,0.294466,-3.322861,1.417128, &
            0.925860,-0.469125,-0.079839,-1.761770,-0.015731,-0.049326,-2.693667,1.697755, &
            0.168817,-0.176375,-0.066171,-1.617500,0.437163,1.472303,-1.246768,-0.257234, &
            -0.189144,-0.450441,-0.047866,-0.943368,1.471700,1.362924,-1.047463,-0.367257, &
            -0.454272,-0.482388,-0.049198,-1.540672,1.130318,-2.346199,-1.838635,0.082810, &
            0.268334,0.341852,-1.152926,-2.894609,-1.007346,-0.480193,-0.936478,0.390377, &
            -0.576071,-0.204276,-1.927916,-2.530657,-1.847987,0.609896,-0.970873,0.631264, &
            -0.432576,0.018401,-2.189639,-2.751563,-1.396178,0.535098,-1.001897,0.584030, &
            0.412351,0.466241,-1.447858,-2.789476,-0.663326,0.122355,-0.975153,0.739636, &
            0.865444,0.354519,-1.020209,-2.598970,0.088096,-0.107709,-0.987253,0.669440, &
            0.774656,0.692908,-0.535734,-2.794798,0.444004,-0.009575,-0.998528,0.328516, &
            0.816032,0.766482,-0.389953,-2.715379,0.300339,-0.295411,-1.052310,0.416515, &
            0.738528,0.702444,-0.044892,-2.559737,0.047846,-0.244054,-1.264024,0.447070, &
            0.976366,1.329144,0.161167,-2.130175,-0.335863,-0.966701,-1.625883,0.137632, &
            -0.357664,-0.224732,-0.503501,-1.030781,1.712479,0.547263,-2.908353,1.162855, &
            -3.462845,-3.106947,-0.210147,-0.948702,3.706716,5.295435,-2.229921,2.819244, &
            -1.828380,-1.058064,-0.005663,-1.016318,2.229390,3.222084,-1.628144,1.120151, &
            -0.886529,0.057302,0.201373,-1.188834,1.515831,-0.374638,-1.309179,-0.435262, &
            -0.598237,-0.525259,-0.033301,-1.067330,0.370601,-1.169002,-1.147636,-0.477170, &
            -0.458529,-0.627400,0.055503,-0.738734,-0.931101,-1.287520,-0.947737,-0.053491, &
            -0.446297,-0.641781,0.255983,-1.063812,0.472431,-1.074738,-0.953293,0.529927, &
            0.283008,-0.330653,0.104453,-1.174667,-0.785965,-0.783426,-1.118628,0.005271, &
            1.049778,-0.408836,0.118821,-1.613012,-3.286976,-0.925510,-1.032464,-0.800272, &
            -0.301737,0.294027,-0.128518,0.255332,0.607678,0.605225,0.120453,-0.141367, &
            -0.008906,0.213548,0.017596,0.062836,0.123928,-0.082024,-0.078310,-0.244787, &
            0.058570,0.006321,-0.074581,-0.116114,0.133164,0.037899,-0.027620,0.237831, &
            -0.064584,-0.013048,-0.010538,0.052598,0.187924,0.106738,0.038299,0.083945, &
            -0.159141,0.005591,-0.087193,-0.053437,-0.002337,0.045545,0.066337,0.242771, &
            -0.051414,-0.005456,0.101746,0.022071,0.013740,-0.098607,-0.034787,-0.110195, &
            0.013804,0.077784,-0.051951,0.038647,0.089225,0.151083,0.018534,-0.106406, &
            -0.482333,0.418667,-0.124525,0.298848,0.529044,0.359452,0.108096,0.029042, &
            -1.327980,0.961496,-0.436845,0.950949,1.374039,0.958126,0.642803,0.383164, &
            -0.868767,0.556190,-0.455367,0.709828,1.535767,0.534940,0.683376,0.152816, &
            -0.089935,0.239372,0.146563,0.229305,0.329061,0.516222,0.525567,-0.639784, &
            -0.184135,0.145824,0.293656,0.260346,0.232779,0.130440,0.207753,-0.427144, &
            -0.024772,-0.507748,0.486142,0.050597,-0.442034,-0.178663,0.286148,-0.966499, &
            0.297733,-0.040309,0.223185,0.178391,0.650010,0.837967,-0.286336,-0.797842, &
            0.325807,-0.138756,0.297402,0.151623,-0.668823,0.398461,-0.338523,-0.276383, &
            0.831700,-0.134354,0.033958,-0.146079,-0.721895,0.159217,-0.685593,0.169775, &
            0.421726,0.151135,0.014860,-0.034101,-0.255922,0.525290,-0.405141,-0.256315, &
            0.337881,-0.006397,0.007428,-0.068864,-0.282468,-0.458439,-0.418979,0.648463, &
            0.072927,0.063675,-0.153150,0.122334,-0.051846,1.040918,-0.118336,-0.253446, &
            -0.158408,0.004822,0.012751,0.166678,0.447395,1.385069,-0.052819,-0.165381, &
            -0.284583,-0.048930,-0.154864,-0.013238,0.640288,2.047241,-0.007472,0.284908, &
            -0.226112,-0.096994,0.006132,0.280061,1.069700,1.517100,0.211967,0.507876, &
            0.025617,0.014135,-0.138252,0.271078,0.875391,0.838848,0.260996,0.604578, &
            0.248926,-0.065229,0.080730,0.152742,0.300580,0.779251,0.063429,0.386956, &
            0.079945,0.043735,0.014674,0.091055,0.484192,0.261994,0.074730,0.485277, &
            0.109762,-0.218161,0.031109,0.155988,0.393046,0.282032,0.044276,0.060037, &
            -0.082990,-0.192714,-0.097443,0.535446,0.735548,0.169311,0.706373,0.669252, &
            -0.271954,-0.322436,0.115481,0.653917,0.165829,-0.686296,1.210240,1.508179, &
            -0.334560,-0.236700,-0.869630,0.885979,-0.132105,-1.012724,0.906471,0.875930, &
            -0.729307,-0.345905,-0.017256,0.376249,-0.575485,-0.950181,0.844810,-0.926858, &
            -1.858597,-0.244808,-0.001377,0.621032,-0.474379,-1.283036,0.744040,-2.725958, &
            -2.033452,-0.010785,-0.070141,0.593624,-0.604375,-1.283662,0.393034,-2.669398, &
            -0.915230,0.047536,-0.049397,0.071590,0.912620,-0.781789,0.429810,-0.754727, &
            0.173561,0.072520,-0.016551,0.349456,0.760342,0.121195,0.004473,-0.717659, &
            0.216956,0.458691,-0.139252,0.315907,-0.153349,0.497519,0.184559,-0.354528, &
            0.029846,0.558490,-0.193633,0.350606,1.058770,1.166032,0.102220,-0.965159, &
            0.133649,-0.035369,0.015443,-0.006302,-0.865937,-0.316766,-0.071619,0.007309, &
            -0.046440,-0.207971,0.182007,-0.050754,-1.415503,0.448545,-0.111481,-0.313043, &
            0.188186,-0.287216,0.146572,0.059300,-1.728091,0.834355,-0.009991,-0.105061, &
            0.188425,-0.151252,0.079608,0.041927,-0.627767,0.595100,0.033893,0.114282, &
            0.032426,-0.047558,0.014100,0.002420,-0.139840,0.151054,0.010958,0.021148, &
            0.035520,0.003259,-0.074644,-0.027636,0.113309,-0.020470,0.021258,-0.056604, &
            -0.077886,-0.048977,0.048601,0.000745,0.010795,-0.015138,0.001099,0.129188, &
            0.008593,0.002891,-0.068822,-0.018042,0.046092,-0.038265,0.024928,0.051030, &
            -0.174028,-0.014792,0.066682,0.092839,-0.045944,-0.537562,0.026109,0.326487, &
            -0.200103,0.098416,-0.015207,0.144688,-0.038782,-0.060373,0.000509,-0.526903, &
            -0.336152,-0.281600,-0.082887,-0.259930,1.184302,-0.748260,0.013683,-0.691817, &
            -0.099402,-0.003193,0.157724,0.171772,-0.095862,-0.881159,0.009201,0.597653, &
            -0.361215,-0.119838,0.023720,-0.100548,-0.682158,-0.669746,-0.042565,0.032662, &
            -0.496819,-0.460965,0.161714,-0.253250,-0.921255,0.135609,0.043256,0.809545, &
            -0.280750,0.224906,0.063388,0.108231,-0.058596,-0.042100,-0.030744,0.536102, &
            0.407659,0.201515,-0.131419,-0.020247,0.131039,-0.277239,-0.087688,-0.301184, &
            0.130436,-0.356567,0.086152,-0.237098,-0.105167,0.517400,0.013984,0.612964, &
            -0.476931,0.447142,-0.080472,0.170959,0.110246,-0.328920,-0.089614,-0.078664 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/4.352051,-0.603204, &
            1.471914,-1.550691, &
            1.398049,-2.014922, &
            -1.474455,-0.057457, &
            -0.591831,-2.060414, &
            -1.102053,-0.401001, &
            5.565583,-0.809881, &
            -0.395399,0.323671 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.468376,-1.228619/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.370534,0.007166,1.127644,0.38669,1.65061,0.222276,0.374429,0.099911/)
real, dimension(2) :: bias2 = &
(/-0.084348,-0.152259/)
real, dimension(1) :: bias3 = &
(/0.043425/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
