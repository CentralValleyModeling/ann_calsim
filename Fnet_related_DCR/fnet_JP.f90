module fnet_JP

! a = 0.0002308
! b = 0.06699

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.256050,0.042888,0.089830,-0.157049,-0.345417,-0.257741,0.001128,-0.050256, &
            -0.429221,-0.050423,0.176489,-0.148905,0.251566,-0.037812,0.080126,0.011112, &
            -0.582071,0.089783,0.170142,-0.132972,0.266834,-0.078422,-0.012803,0.085925, &
            -0.502559,0.221206,0.170163,-0.185234,0.108297,-0.143886,0.054595,0.150966, &
            -0.086699,0.208656,0.015347,-0.079355,0.018393,-0.352757,-0.004729,0.039169, &
            -0.146207,0.056188,0.090559,-0.055341,0.131218,-0.248136,-0.070712,0.044941, &
            -0.275801,-0.002536,0.101192,-0.061169,0.228174,-0.179289,-0.063216,0.044045, &
            -0.449496,0.138000,0.201786,-0.117156,0.218306,-0.210258,-0.100283,0.086347, &
            -0.019129,0.458138,-0.060811,0.055167,-0.062467,-0.459324,-0.239552,0.072178, &
            0.245903,0.497534,-0.083767,0.174515,-0.040375,-0.420558,-0.502322,0.177333, &
            0.332115,1.332880,0.323620,0.093578,-0.420910,-0.489270,-0.546827,0.345656, &
            0.189606,0.760814,0.657259,0.044067,0.054256,-0.818173,-0.622756,0.119060, &
            -0.030057,0.396496,0.051256,0.069607,0.033222,-0.631089,-0.458916,0.132366, &
            0.029320,0.448465,-0.206539,0.018085,-0.115227,-0.142572,-0.157785,0.373953, &
            0.450590,0.474221,0.062106,0.163140,0.091632,-0.254831,-0.408939,0.165808, &
            0.754737,0.674648,-0.337976,0.216719,-0.520395,-0.086221,-0.374390,0.283022, &
            1.003145,0.870370,-0.137957,0.156265,-0.275252,-0.227049,-0.211301,0.315868, &
            0.532088,0.647634,0.262906,0.012388,0.134647,-0.348090,0.043228,0.130253, &
            0.352190,0.008514,-0.032043,0.075136,-0.112368,0.210592,-0.268711,0.335998, &
            0.166698,-0.104911,-0.351522,0.294738,-0.159805,0.001042,-0.362768,0.201112, &
            0.412481,-0.013505,-0.285917,0.324664,-0.122476,0.006643,-0.264185,0.071194, &
            0.375252,-0.015712,-0.297900,0.236363,0.125287,-0.155309,-0.074717,0.014861, &
            0.523248,0.142580,-0.077833,0.241369,-0.002029,-0.013047,-0.086099,0.064324, &
            0.304879,-0.077054,-0.168691,0.249516,-0.009354,0.012261,-0.183152,0.060095, &
            0.507570,0.073698,-0.211865,0.320222,0.099723,0.097255,-0.115387,0.076514, &
            0.383066,0.044181,-0.118010,0.449743,-0.181544,-0.018174,-0.359450,0.094863, &
            0.391953,-0.080008,0.596402,0.430294,-0.468079,-0.601582,0.180150,0.046886, &
            -0.085622,-0.681309,0.534560,0.406664,0.071839,-0.492845,0.065396,-0.302154, &
            -0.248402,-1.110168,0.274542,0.117790,1.063597,-0.601897,0.093641,-0.200382, &
            -0.316662,-0.289741,0.179910,0.315172,0.469822,-0.141522,0.193166,-0.384649, &
            0.339944,-0.633247,-0.067226,0.169336,-0.300370,-0.114466,-0.097742,-0.211858, &
            1.061972,-0.461153,-0.318013,0.175015,-0.437839,0.233449,-0.100464,0.088609, &
            0.111405,-0.265188,-0.248583,0.167647,-0.236480,0.430937,0.227609,-0.099442, &
            0.054324,-0.181587,-0.204430,0.042464,0.190172,-0.025276,0.130089,-0.030058, &
            0.086473,-0.321948,0.378879,0.008114,-0.248690,-0.290529,-0.283256,-0.252803, &
            -0.346031,-1.274782,0.582217,0.031577,0.333794,0.032039,0.013028,-0.869383, &
            -4.276464,-1.335760,2.873177,-1.487659,1.254778,1.720478,2.125846,-0.723401, &
            -3.239203,-1.305622,2.273094,-2.304307,1.282965,2.099160,2.259734,-1.484988, &
            -3.397570,-1.340023,2.619002,-2.362382,1.210096,1.991025,2.426025,-1.270645, &
            -3.321763,-1.935612,2.513894,-2.511319,0.832412,1.962815,2.812902,-1.278602, &
            -3.720449,-2.139928,2.428126,-2.901179,0.328406,1.882517,2.788370,-1.621968, &
            -3.410125,-1.837426,2.203995,-3.159557,0.215634,2.016046,2.745337,-1.588297, &
            -3.360339,-1.855852,2.035708,-3.717104,0.265436,2.271180,2.680007,-2.184888, &
            -2.598144,-1.687109,1.836754,-4.133596,0.466506,2.508236,2.255915,-2.587445, &
            0.080863,0.519947,0.131587,-7.299584,1.971618,4.314356,0.147961,-5.750604, &
            -0.045312,1.119760,1.129754,-7.837518,0.311809,4.287180,0.916773,-5.896679, &
            -2.109471,1.062006,3.333750,-5.345177,-0.982855,4.076203,1.774274,-4.979442, &
            -1.828161,1.479364,3.327548,-3.384604,0.250510,3.680854,1.809220,-3.879288, &
            -1.029824,1.540261,3.116121,-2.245079,0.530396,3.487390,1.990957,-3.005369, &
            0.501431,0.210458,2.150228,-1.805548,0.296561,2.007694,2.947047,-1.942091, &
            0.307447,-0.531925,1.246929,-1.117590,0.059578,1.225693,2.272658,-1.221447, &
            -0.673033,-0.321591,0.420430,-0.841762,-0.051066,0.839920,1.716900,-1.354226, &
            -0.605195,-0.595435,0.733208,-0.680530,-0.083323,1.127028,1.926818,-1.475628, &
            -0.026127,-0.777731,1.037961,-0.954675,-0.482004,0.879851,1.772951,-2.067052, &
            -0.209019,-0.763423,0.729137,-1.013104,0.655708,-0.322466,1.205804,-0.692254, &
            -0.608108,-0.786510,0.887443,-1.366904,0.392825,-0.246701,1.115104,-0.583146, &
            -0.619173,-0.797147,1.187987,-1.139621,0.568272,-0.139628,0.820598,-0.622906, &
            -0.991341,-0.911696,0.992347,-1.216386,0.146069,0.176513,1.054722,-0.491401, &
            -0.714903,-0.647860,1.203824,-1.287672,0.356830,0.297537,0.832404,-0.709859, &
            -0.863037,-0.666443,1.168672,-1.402615,0.408656,0.240463,0.822096,-0.700168, &
            -0.942117,-0.611341,0.890750,-1.503148,0.395785,0.575660,0.400372,-0.757256, &
            -0.585886,-0.325418,0.968636,-1.386803,0.325635,0.555306,0.337522,-1.017807, &
            -0.908225,-0.813223,1.190514,-1.601617,0.096495,0.807459,0.152984,-0.757434, &
            -0.546197,-0.161827,0.962807,-2.440140,0.455116,2.020915,-0.689096,-1.540770, &
            -0.573506,-0.471711,1.350602,-1.733830,0.260127,1.760222,0.195583,-1.081625, &
            -0.216326,-0.704259,0.894209,-1.205104,0.776028,1.420079,0.695813,-0.409168, &
            -0.141353,-1.632102,0.501121,-0.605488,0.492493,0.877072,0.924656,-0.314399, &
            -0.698594,-1.519800,0.493133,-0.332318,0.337268,0.578442,0.782737,-0.408357, &
            -0.751587,-1.550045,-0.095891,-0.192914,0.114565,0.954449,0.867414,-0.622228, &
            -0.502391,-1.529984,0.236268,-0.317530,0.043005,1.110540,0.188933,-0.628085, &
            -0.467748,-2.203285,0.225628,-0.018877,0.116835,0.989626,0.583199,-0.597069, &
            0.162105,-1.975767,0.090338,-0.126357,0.597132,0.876013,0.323884,-0.240869, &
            0.065417,-0.075889,-0.172446,0.119746,-0.116018,-0.028886,-0.303446,0.135680, &
            0.038831,0.067606,0.067916,0.023402,-0.113455,0.000305,-0.077790,0.110910, &
            -0.003102,0.112213,0.015670,0.074908,0.020512,-0.075439,-0.118135,0.045963, &
            0.144789,-0.027479,0.021157,0.051115,-0.142598,0.002294,-0.129381,-0.022271, &
            0.076251,-0.092477,0.014179,0.018592,-0.093964,0.040650,-0.056244,0.013814, &
            -0.278852,-0.134255,0.231908,-0.147251,0.127266,-0.090338,-0.018746,0.024657, &
            -0.088679,0.032149,-0.125657,-0.008731,-0.120320,-0.100627,0.004785,-0.078282, &
            -0.259291,-0.245075,0.072617,-0.080739,-0.048597,0.303175,-0.025601,0.045289, &
            0.052439,-0.596770,-0.156852,0.160315,-0.360961,-0.000990,-0.406112,0.126123, &
            0.219609,-0.470488,0.051153,-0.051837,0.088409,-0.047804,-0.417497,-0.353860, &
            0.561043,-0.244363,-0.273992,0.209869,0.617762,-0.035368,-0.210756,-0.119881, &
            0.377128,-0.226343,-0.359310,0.077011,1.011799,-0.615477,0.199207,-0.494575, &
            -0.110585,-0.068899,-0.006163,0.144333,0.930271,-0.228319,0.602458,-0.220239, &
            -0.365537,-0.315601,-0.593487,0.237459,0.742068,-0.245197,0.328827,-0.500155, &
            -0.197302,-0.545189,-0.491640,0.043576,0.175858,-0.390035,0.499318,-0.198257, &
            -0.186338,-0.157590,-0.346513,-0.544676,0.315446,-0.094793,0.700943,0.044378, &
            -0.814891,-0.234385,-0.180690,-0.546608,-0.072592,0.550601,0.475235,0.039076, &
            -0.274125,-0.008367,-0.234886,-0.485169,0.055653,0.124344,0.353718,0.107701, &
            0.208780,-0.203958,-0.165467,0.063987,-0.033731,0.007593,-0.125792,-0.026589, &
            -0.045582,-0.090575,-0.056867,0.069833,-0.085541,0.136020,0.018793,-0.074765, &
            0.464977,-0.070840,-0.184178,0.292896,-0.207141,0.166135,-0.197263,-0.168455, &
            0.614056,-0.118601,-0.130556,0.170798,-0.006678,0.214519,-0.138341,0.041447, &
            0.649175,0.039308,-0.218087,0.178400,-0.019684,-0.007191,-0.300273,0.160237, &
            0.815102,0.241709,-0.050596,0.316907,0.475097,0.096627,-0.334258,0.161458, &
            0.702363,0.235944,-0.039585,0.211482,0.426350,0.073036,-0.415850,0.293717, &
            0.916821,0.128671,-0.363739,0.431540,0.414090,0.064520,-0.301807,0.239485, &
            0.182255,0.339610,-0.631604,1.008459,0.007758,0.133249,-0.259569,0.497932, &
            0.292581,0.345668,-0.882491,0.932108,0.485601,-0.048304,-0.617665,0.543403, &
            0.755020,0.289151,-1.148103,0.756539,0.641963,-0.218802,-0.883075,0.155417, &
            0.582568,0.043546,-0.807410,0.526154,-0.142281,-0.063356,-0.468633,-0.041127, &
            -0.027396,0.428474,-0.540685,0.331353,-0.022411,0.052628,-0.380370,0.161056, &
            -0.521687,0.292118,-0.734754,0.161019,0.122459,0.087343,-0.340049,0.307740, &
            -1.260980,0.133081,-0.194859,0.284533,-0.156831,0.216288,-0.232906,0.062439, &
            -0.772628,0.210267,-0.519252,-0.074665,-0.230898,0.293942,-0.184921,0.426754, &
            -0.709231,-0.072347,-0.456811,0.168941,-0.450567,0.556971,-0.461484,0.537223, &
            -0.274122,0.028660,0.045014,-0.321705,-0.334994,0.362741,-0.240701,0.546152, &
            -0.153702,-0.064091,0.067679,-0.034560,0.319711,-0.076745,0.089093,-0.065231, &
            -0.141829,-0.158725,0.138645,-0.028574,0.160376,-0.064162,-0.047185,-0.059442, &
            -0.011436,0.054430,0.135171,-0.031218,0.198681,-0.020033,0.014626,0.040748, &
            -0.143823,0.118456,0.018860,-0.019609,0.098516,-0.116336,-0.031322,0.041268, &
            0.010424,-0.129623,-0.044586,0.012052,-0.035109,-0.011873,0.024852,-0.084784, &
            -0.033029,-0.045541,-0.014466,0.010619,0.079139,-0.000477,0.024955,-0.035124, &
            -0.135169,-0.068618,0.077646,-0.042164,0.207166,0.019426,0.101265,-0.022239, &
            0.042729,-0.077425,0.129040,-0.035094,0.108453,-0.052110,0.042446,-0.064975, &
            -0.109723,0.164414,-0.301240,-0.023158,-0.166205,0.146966,0.059371,0.190232, &
            -0.128435,0.104868,0.086302,-0.071151,0.167125,0.071606,-0.081603,0.179174, &
            -0.094367,0.014093,-0.090599,-0.034530,-0.034910,0.269646,0.120831,0.095072, &
            0.271877,-0.344655,0.014859,0.028876,-0.131983,-0.112578,0.031863,-0.300784, &
            -0.055813,-0.330362,0.199384,0.014214,0.263463,0.058219,-0.080368,-0.100960, &
            0.304172,0.361662,-0.055139,-0.015564,-0.159852,0.035861,0.155672,0.126906, &
            0.116545,0.377589,-0.351162,0.047992,-0.367238,-0.088295,-0.047047,0.201659, &
            -0.178268,0.089151,0.009755,0.040317,0.092228,-0.028802,-0.254394,0.063568, &
            -0.240523,-0.392570,0.164681,-0.099906,0.218011,-0.001349,0.074459,-0.147099, &
            -0.459135,-0.318863,0.082147,-0.138787,0.076899,-0.105222,0.012743,-0.081641 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.430216,1.337953, &
            -0.872036,1.019165, &
            0.548658,-0.615586, &
            5.691464,-3.509853, &
            -0.969599,0.736233, &
            -1.315811,1.052866, &
            0.107763,-1.186084, &
            2.160564,-2.220467 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.298305,-1.999485/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.443187,-1.527779,0.601444,1.237757,-1.174149,-0.985213,1.172912,1.326858/)
real, dimension(2) :: bias2 = &
(/-0.006652,0.123098/)
real, dimension(1) :: bias3 = &
(/0.817827/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
