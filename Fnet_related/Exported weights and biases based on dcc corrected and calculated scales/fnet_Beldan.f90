module fnet_Beldan

! a = 4.5804e-005
! b = 0.091868

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.196336,-0.020961,-0.117781,-0.065386,-0.118012,0.011995,-0.047315,-0.042792, &
            0.106442,-0.020098,-0.035293,-0.022208,-0.010815,0.001051,-0.011725,-0.007332, &
            -0.040147,0.016986,0.048253,-0.125363,-0.062404,0.043602,0.018060,-0.015280, &
            0.077790,-0.012661,-0.082450,0.019215,-0.126995,-0.001180,-0.024351,-0.031727, &
            0.056649,-0.023532,0.047333,-0.003747,-0.044163,0.033506,0.049569,-0.038620, &
            0.217078,-0.050820,-0.082240,-0.011879,-0.088949,-0.036800,0.070087,-0.046568, &
            0.128917,-0.011174,-0.106371,0.066240,-0.019699,-0.030614,0.017446,-0.052990, &
            -0.036027,-0.016418,-0.044188,-0.000119,0.023113,0.030982,-0.027431,0.027059, &
            0.244627,-0.100936,0.131747,-0.006082,0.108888,0.181672,0.034063,-0.079357, &
            -0.121743,0.080201,-0.093247,-0.288375,-0.363419,0.049079,-0.250860,0.090467, &
            -0.011325,0.058301,-0.077391,0.122236,-0.365202,-0.110919,-0.117538,0.044699, &
            0.261069,-0.158033,-0.120540,0.301716,-0.558895,-0.148245,0.170835,0.022720, &
            -0.011397,-0.092113,0.035634,0.380117,0.010518,-0.110042,0.170345,0.072944, &
            0.156416,-0.123472,-0.072889,-0.233922,0.206887,-0.024123,0.128220,0.127626, &
            0.105601,0.014021,0.082900,0.175401,0.246562,0.066948,0.006380,-0.106010, &
            -0.302402,0.116028,0.113465,0.012922,0.149926,0.003521,-0.028479,0.022153, &
            0.084988,0.091849,-0.415298,-0.150963,-0.048165,-0.040653,-0.238519,0.005471, &
            -0.119259,0.065956,-0.324494,0.020024,0.299121,-0.237782,-0.082553,0.220041, &
            -0.034198,-0.003808,0.102237,0.396421,0.441425,-0.027502,0.177808,-0.026651, &
            0.102820,-0.000244,-0.098865,0.047956,0.113640,-0.015075,0.017339,-0.024041, &
            0.100570,-0.067554,0.107053,0.064194,-0.133369,0.121421,0.178277,-0.131209, &
            -0.064702,0.028300,-0.312222,-0.041235,-0.104011,-0.044112,0.100015,0.014395, &
            -0.300872,0.123045,-0.066803,-0.184461,0.138891,0.007336,0.179444,0.047974, &
            -0.254533,0.119946,-0.041518,-0.071606,0.037127,0.063626,0.178473,-0.041802, &
            -0.216446,-0.030011,-0.002095,-0.003798,-0.094647,0.078964,0.231618,0.076420, &
            -0.431434,0.145684,-0.416793,0.128719,-0.032957,0.078345,0.134944,0.021919, &
            -0.001007,0.423674,-0.074648,0.786569,-0.626464,0.256909,0.379582,0.002468, &
            -0.315109,0.276747,0.411523,0.805990,-0.997107,0.106108,0.785318,0.257214, &
            -0.566198,0.221233,1.318784,0.222949,0.200954,0.038898,0.533951,0.718877, &
            -0.117180,0.233197,0.116869,-0.817946,0.655896,0.054517,0.063006,0.458270, &
            -0.004003,0.393867,-0.084970,-0.546775,0.933211,-0.175866,-0.165293,0.307567, &
            0.204358,0.419000,-0.310911,0.829043,0.138766,-0.389330,0.160428,-0.323869, &
            -0.457908,-0.072268,0.119217,0.212465,-1.211828,-0.180187,0.228216,0.118684, &
            0.194626,-0.348762,0.062895,0.294180,-0.186567,0.004088,0.196809,0.245829, &
            0.638929,0.015855,0.096376,-0.411515,0.516243,0.060732,0.155867,-0.089550, &
            -0.188061,0.258175,0.046964,-0.681772,0.410172,0.061216,-0.252184,0.059316, &
            1.054045,-0.539198,-1.133814,0.781389,0.584607,0.053964,-0.215187,0.221497, &
            1.979068,-0.709641,0.285821,0.931399,0.097861,-0.647713,-0.747191,-0.314584, &
            2.634433,-0.497361,2.196735,0.900759,-0.017060,-1.195793,-1.758301,-0.431857, &
            2.793050,-0.548591,3.096010,0.718029,-0.301603,-1.751437,-2.442999,-0.594224, &
            3.457974,-0.778171,3.153101,1.258563,-0.446648,-1.719772,-2.391269,-0.433856, &
            4.232941,-0.550457,2.852180,1.572242,-0.854182,-2.174138,-2.554305,-0.639531, &
            4.395170,-0.688688,2.679143,1.981837,-0.591191,-2.558976,-2.852930,-0.642565, &
            4.596996,-1.266671,2.672172,1.760223,-0.412062,-2.922355,-3.422702,-0.975362, &
            2.585755,-7.040461,3.862836,0.277882,3.517940,-7.117860,-7.729591,-6.026381, &
            2.905093,-8.585784,0.644042,4.478237,6.342993,-2.590549,-6.171320,-7.693106, &
            2.535468,-6.938575,-0.260965,6.241591,8.065806,2.187133,-2.845679,-7.767283, &
            2.696968,-3.119899,-1.497401,4.124808,6.896987,1.889500,-1.206714,-6.263847, &
            1.930974,-0.933013,-0.629327,2.554485,5.367981,0.615473,0.228385,-5.501265, &
            1.578311,-0.285896,0.773939,1.897356,2.641611,0.307625,0.394125,-4.530147, &
            1.642602,-0.146266,-0.061388,0.574289,-0.437829,0.082020,0.122597,-2.485043, &
            1.200722,0.037897,-0.146373,0.065337,-0.317973,-0.019555,0.204081,-1.715998, &
            0.687079,-0.272459,0.118139,-0.555399,-0.480850,0.312099,0.208072,-0.759962, &
            0.657274,0.137142,1.905824,-0.808413,1.095907,-0.092414,0.544594,0.069271, &
            0.838303,-0.154284,0.269672,0.924621,-0.072753,-0.318009,0.339064,0.085653, &
            0.678442,-0.034050,0.590005,0.852530,0.378155,-0.280393,0.177953,0.000676, &
            0.360123,-0.197924,0.486621,0.635321,0.513002,-0.340844,-0.136664,0.049745, &
            0.759226,-0.510516,0.645045,0.805660,0.303594,-0.554832,-0.342184,-0.047762, &
            0.584667,-0.485277,0.418380,0.892387,0.522052,-0.565582,0.017275,-0.154510, &
            0.828592,-0.244840,0.247366,1.005683,0.291845,-0.302556,-0.022409,0.174370, &
            0.790403,-0.118860,0.180247,1.008400,0.558821,-0.553879,-0.312174,0.196833, &
            1.013447,-0.551871,0.059655,1.033958,0.627243,-0.740654,-0.394693,-0.096577, &
            0.174861,-1.577034,-0.873364,0.301526,1.301278,-1.827898,-1.156104,-0.441389, &
            0.244798,-2.041798,-1.387408,0.720950,1.689398,-0.855401,-0.840765,-1.770915, &
            0.722743,-1.601930,-0.090463,0.905236,1.743308,0.267873,0.522194,-2.082861, &
            1.283027,-0.644971,0.932776,0.126819,-0.224055,-0.128225,0.674414,-2.127891, &
            1.190203,-0.301208,-0.155990,0.087126,-0.881351,-0.360134,0.581385,-1.669072, &
            0.469338,-0.162587,-0.371009,0.152208,-1.224912,-0.723033,-0.249116,-0.351214, &
            -0.106571,0.052919,-0.130523,-0.094773,-1.258022,-0.162987,-0.953063,0.186933, &
            -0.232838,-0.173799,-0.086089,-0.092905,-0.158660,0.663170,-0.964229,0.234796, &
            -0.074809,-0.119759,0.270767,-0.884171,0.272331,0.746059,-0.346707,-0.261855, &
            -0.054889,0.041424,0.166604,-0.905173,0.227663,0.563821,0.451916,-0.615770, &
            -0.130920,0.024116,0.155398,0.062167,0.390023,0.279520,-0.159537,-0.054676, &
            -0.244651,0.061584,-0.206267,0.015500,0.107377,-0.003692,-0.025029,0.078648, &
            0.093209,0.013557,-0.196863,-0.199372,0.110445,0.163512,-0.033967,-0.132677, &
            -0.038350,-0.042726,-0.177599,-0.042025,-0.016729,0.068091,0.143474,-0.102054, &
            -0.075585,-0.098107,-0.145627,0.035001,0.077135,0.026110,0.062042,0.066280, &
            0.036192,-0.087863,-0.289264,-0.056567,0.149009,0.121460,-0.038888,-0.018848, &
            -0.130853,-0.013141,-0.312855,0.149714,0.129092,0.053146,0.017855,-0.063429, &
            -0.134406,-0.067800,0.390981,0.047103,0.435968,0.400189,-0.134779,-0.058980, &
            -0.656369,-0.320088,-0.743468,0.152708,0.656567,0.840715,-0.351585,-0.103125, &
            -0.719107,-0.602309,-0.136955,0.527172,0.498022,0.514762,-0.096201,-0.259277, &
            0.301148,0.220070,1.527540,-0.060283,-0.672499,-0.003193,-0.120325,0.068275, &
            -0.056464,-0.088296,0.309616,-0.406079,-0.878641,0.214764,0.040525,-0.055710, &
            0.075945,-0.085158,1.110535,-0.528658,-1.471885,0.122263,0.233353,-0.019863, &
            -0.412748,0.143626,-0.187919,-0.715288,-0.809929,-0.106837,0.601851,-0.088940, &
            0.012122,0.204587,0.620987,-0.339617,-1.025390,-0.270310,0.281116,0.065428, &
            -0.342024,0.004852,0.799125,-0.414693,-0.648559,-0.119910,0.246850,-0.140702, &
            -0.180219,0.047074,0.742462,-0.738501,0.131033,-0.120562,0.052686,0.116420, &
            -0.475160,0.026134,-0.579646,-0.292496,0.097558,-0.152330,0.304339,0.196907, &
            0.148080,0.152400,0.000839,0.017081,0.101957,-0.162737,-0.131686,-0.069894, &
            -0.013709,0.089620,0.043552,0.085078,0.167395,-0.200121,0.226338,-0.056411, &
            0.201427,0.013532,-0.035059,-0.051665,-0.064842,-0.017935,0.193003,-0.208510, &
            0.084403,-0.039756,-0.236226,0.169076,-0.159572,-0.052906,0.024364,-0.070344, &
            -0.143674,0.063460,0.165162,-0.045302,0.022922,0.066020,0.168164,-0.013076, &
            -0.307532,0.059362,0.206566,-0.000819,0.184211,0.137524,0.296133,-0.043470, &
            -0.642210,0.155173,0.367650,-0.169446,0.017575,0.069423,0.203296,0.107922, &
            -0.500138,0.142809,0.050674,-0.152915,0.299332,0.220110,0.164857,-0.084704, &
            -1.261080,0.568989,-0.009367,-0.490386,0.299834,0.505090,0.390406,0.458310, &
            -1.623812,1.045149,0.616807,-0.940586,0.338743,-0.070524,0.107162,0.662039, &
            -1.570562,0.891106,0.041396,-0.783520,0.410044,-0.496078,0.136028,0.509233, &
            -1.007375,0.448426,-0.472741,0.212738,0.589230,-0.304136,-0.071682,0.495306, &
            -0.496808,0.234813,-0.285743,-0.326802,0.605072,-0.156739,-0.466134,0.693361, &
            -0.153740,0.096051,-0.418968,0.008115,0.563995,-0.155376,-0.256418,0.448423, &
            -0.339046,-0.159762,-0.513340,-0.009744,0.482243,0.281832,-0.069055,0.179287, &
            -0.445610,-0.036155,0.262027,-0.330624,-0.315087,0.125968,-0.018694,0.036505, &
            -0.956612,0.062772,-0.474565,-0.440915,-0.175112,0.357986,-0.245033,0.080483, &
            -0.771342,0.043890,0.235697,-0.183337,-0.146696,0.296751,-0.065197,0.152240, &
            0.327914,0.164972,0.240025,-0.760632,0.147467,0.184525,-0.231786,0.009325, &
            0.649736,0.314619,0.239033,-1.204854,-0.037000,0.080875,-0.257886,0.235020, &
            0.817191,0.390908,0.623998,-0.965546,0.020993,0.003612,-0.387766,0.207950, &
            0.879792,0.243486,2.826284,-0.786824,-0.421062,-0.275284,-0.219377,0.465459, &
            0.343671,0.107528,0.153543,-0.257215,-0.199027,-0.131754,-0.043318,0.042477, &
            0.263030,0.029642,-0.072244,0.035049,-0.074523,-0.075842,-0.048733,0.006647, &
            0.213692,0.048809,-0.082103,0.088283,-0.091017,-0.120246,-0.072386,0.038863, &
            0.021955,0.051593,0.098693,0.281874,-0.125128,-0.097433,-0.090542,0.080781, &
            0.158873,0.254901,0.987469,0.599105,-0.383945,-0.290461,0.129819,0.188852, &
            -0.076464,0.208979,0.415015,0.482272,-0.321338,-0.162781,0.098242,-0.032402, &
            0.204217,0.091080,-0.235989,0.048578,-0.297814,-0.200427,-0.082596,-0.004421, &
            0.107076,-0.024796,-0.007217,-0.058146,-0.405618,-0.023284,0.070622,-0.042837, &
            -0.018887,-0.024875,-0.089442,0.336377,-0.201429,-0.069866,-0.048453,0.044859, &
            -0.132310,0.079836,-0.319599,0.211741,-0.202976,-0.213318,-0.026995,-0.061921, &
            0.176801,-0.008043,0.008455,-0.004781,0.168479,0.093978,-0.001229,-0.096064, &
            -0.042729,0.122513,0.015339,-0.303781,0.227364,-0.023561,-0.133674,0.095213, &
            -0.085411,0.005721,-0.084976,-0.062414,-0.148775,-0.026671,-0.092349,0.056123, &
            0.139424,-0.006075,-0.101986,0.161065,0.492417,-0.045608,0.071015,-0.026529 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.136709,-0.557880, &
            -1.044158,-2.883936, &
            0.522978,1.375745, &
            1.686259,0.127543, &
            -0.134725,1.791180, &
            0.526722,-2.299980, &
            -0.659083,-3.196625, &
            0.687184,-4.646550 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.307501,-1.917413/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.889437,0.120294,-2.655101,0.446637,-0.659859,1.225228,0.69082,0.872666/)
real, dimension(2) :: bias2 = &
(/0.366932,0.450893/)
real, dimension(1) :: bias3 = &
(/0.671325/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
