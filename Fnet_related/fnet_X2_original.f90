module fnet_X2

! a = 0.015276
! b = -0.57708

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/-0.120319,0.788275,-1.009729,0.774520,0.893542,0.622755,1.422984,0.500153 &
			,-1.637370,-0.315616,-3.606838,0.650415,-0.730436,-0.683117,0.126038,-0.301615 &
			,-2.031322,-1.304704,-4.028199,0.355130,-1.531157,-1.410965,0.010057,-0.780446 &
			,-2.289790,-1.549137,-2.839335,-0.157956,-1.233553,-1.180435,-0.468475,-0.294660 &
			,-1.526550,-1.612995,-1.577801,-0.899736,-1.283941,-1.077972,-0.386357,0.086714 &
			,-1.388597,-2.150225,-0.266268,-0.648061,-1.257873,-0.847257,-1.025100,0.634470 &
			,-1.637492,-2.461170,0.517405,-0.295196,-1.707584,-0.778353,-1.692166,0.076326 &
			,-2.446379,-4.385046,0.094156,0.817720,-2.801851,-2.437064,-3.220334,-1.495405 &
			,-3.729797,-11.733859,0.583610,10.356593,-4.456186,-8.860982,-11.333550,-10.757063 &
			,1.017546,-5.251099,1.069828,10.379177,0.686589,-4.915795,-10.919968,-9.055868 &
			,1.776239,-0.657939,-1.302505,8.267693,2.037656,-5.020430,-7.255782,-6.088498 &
			,0.461075,1.189882,-0.779030,6.123593,0.245575,-6.509552,-2.475918,-2.464522 &
			,-0.243846,0.783818,0.845115,3.669900,-0.340371,-6.788088,-1.049574,-0.627982 &
			,-0.448852,0.575645,-0.188750,0.607178,-0.431424,-7.073715,1.059677,1.100622 &
			,-0.579205,-0.023432,0.163234,0.502843,-0.333811,-7.109605,1.374634,0.809565 &
			,-0.075028,-0.173976,0.242981,0.485789,0.967519,-6.883158,0.452200,0.239823 &
			,-0.310103,0.247003,-0.281570,-0.794746,-0.039032,-7.184428,-0.141075,-0.112769 &
			,-0.004892,0.421692,0.493239,-0.765941,-0.741627,-7.231494,-1.551170,-0.554316 &
			,0.442798,-0.603975,0.079199,-0.358310,0.407793,-0.288983,-0.341160,0.248309 &
			,0.449345,-0.525737,-0.021716,0.160569,0.138071,-0.367143,0.077614,0.484436 &
			,0.243072,-0.322165,-0.043801,0.197071,0.055641,-0.308636,0.339867,0.255461 &
			,-0.016080,-0.136149,0.061715,0.123324,-0.062842,-0.161329,0.431159,0.144155 &
			,0.255701,-0.037084,-0.164853,0.129134,-0.253218,0.068826,-0.016179,-0.033560 &
			,0.169624,-0.104760,-0.088423,-0.126832,-0.227304,-0.096982,0.184305,-0.004681 &
			,0.158889,-0.075060,-0.096257,0.118453,0.079315,-0.142974,0.295147,-0.075356 &
			,-0.071363,-0.003936,0.101048,0.255143,0.167247,-0.030242,0.256960,-0.097227 &
			,-0.091251,-0.044350,0.143115,0.063226,0.303068,0.079628,0.327157,-0.497366 &
			,-0.067632,0.011440,-0.027411,-0.257728,0.051742,0.094352,0.325432,-0.351084 &
			,0.248842,-0.117141,-0.079949,0.038747,-0.085638,-0.198028,0.114413,-0.107888 &
			,-0.124832,0.219365,0.063073,-0.042956,0.048929,0.050216,-0.187092,-0.266277 &
			,-0.063680,-0.096122,-0.010577,-0.772823,0.253310,-0.235256,-0.244877,0.046591 &
			,0.155807,0.425153,-0.017946,-0.612318,-0.927222,-0.585056,-0.319440,-0.048986 &
			,0.000686,-0.144024,0.022244,0.302615,-0.272219,0.183513,0.221295,0.353448 &
			,0.145671,-0.124328,0.003059,-0.150606,-0.288412,0.144107,0.503058,-0.290805 &
			,-0.109193,0.156597,0.067817,0.069599,0.236994,-0.137726,-0.050439,-0.323107 &
			,-0.080745,-0.107961,-0.016139,-0.219889,0.092553,-0.020766,-0.434730,0.442458 &
			,0.430541,0.242723,0.345880,0.430354,0.146996,-0.037389,-0.581366,-0.205852 &
			,0.226846,-0.192992,0.184930,-0.075248,-0.287616,-0.050532,-0.069358,-0.115049 &
			,0.043144,-0.140769,0.102344,-0.207530,0.234734,0.097576,0.015198,0.099346 &
			,0.000688,0.010012,0.159711,-0.087130,-0.007532,-0.069894,-0.025317,-0.157467 &
			,0.113121,0.014528,-0.038711,0.156147,-0.038513,0.163097,-0.258542,0.201564 &
			,0.042653,0.206991,-0.220455,0.362188,-0.014422,0.010374,-0.162509,0.255539 &
			,0.262679,0.094354,-0.212972,0.115511,-0.073770,-0.025391,-0.367024,-0.190199 &
			,0.080034,0.150688,-0.505586,0.089926,0.377310,0.035477,-0.142629,0.104039 &
			,0.086167,0.372114,0.598920,-0.019982,0.164523,0.837770,-0.697355,-0.252869 &
			,-0.228026,0.524593,-0.548819,0.810508,-0.667407,0.789222,-0.538779,-0.837373 &
			,-0.462684,0.571615,0.377254,-0.402705,-0.451531,0.221519,0.878606,-0.593798 &
			,-0.547908,0.415509,-0.337305,0.087445,-1.004827,-0.049368,0.483888,-0.666281 &
			,-0.560823,0.533862,0.578659,0.296308,-0.404104,0.655851,0.603501,-1.095841 &
			,-0.385767,0.069562,0.288977,0.241858,-0.776206,0.320820,-0.196954,-0.572267 &
			,0.006564,0.517418,0.964211,0.225669,-0.847280,0.739074,0.411091,-0.116645 &
			,-0.583270,0.480405,-0.178690,0.554381,-0.449553,0.442609,0.140977,-0.026046 &
			,-0.079804,0.003901,-0.016364,0.463702,-0.113569,0.226662,-0.117290,0.577031 &
			,-0.124043,-0.526053,0.241381,-0.101886,-0.697852,-0.240855,-0.033984,0.516629 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.230900,-0.998095 &
			,2.614239,0.057726 &
			,1.487465,-3.907940 &
			,-2.668638,2.151366 &
			,2.761365,-0.194681 &
			,7.636735,-1.102185 &
			,3.784501,0.226235 &
			,4.074109,-0.298977 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.787801,-0.162584/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.284668,2.378662,1.814072,-2.22779,1.207428,3.991502,0.568197,2.000931/)
real, dimension(2) :: bias2 = &
(/-1.346,0.79629/)
real, dimension(1) :: bias3 = &
(/0.291908/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 54
  !  inarray2(i) = inarray(55-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
