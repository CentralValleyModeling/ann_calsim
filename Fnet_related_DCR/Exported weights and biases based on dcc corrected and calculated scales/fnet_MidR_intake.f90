module fnet_MidR_intake

! a = 0.00084822
! b = 0.0059421

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.100649,0.089234,-0.269497,0.335745,0.098488,-0.119620,-0.059048,-0.140267, &
            0.087978,0.002344,-0.307943,0.138181,0.078093,-0.039030,-0.009828,-0.022321, &
            0.032388,0.027482,-0.173393,-0.021776,-0.014996,-0.030681,-0.016579,-0.029987, &
            0.046776,-0.029972,0.042496,-0.025928,0.021363,0.033041,-0.114394,0.001944, &
            0.060614,0.039881,-0.081729,0.055315,0.009432,-0.049590,-0.009675,-0.075513, &
            0.022189,-0.005786,-0.012014,-0.015028,-0.011377,-0.017385,-0.064858,-0.076056, &
            0.060658,0.025694,0.224495,0.063673,0.012433,-0.084457,0.060854,-0.120912, &
            0.127578,0.021997,-0.008033,0.031552,0.017855,-0.175838,0.092979,-0.202888, &
            0.389570,0.032509,0.719214,1.152607,0.551365,-0.850096,0.915628,-0.898456, &
            0.077040,0.188410,0.218727,0.545567,0.346033,-0.452568,0.569328,-0.183066, &
            -0.308671,0.139018,-0.952192,0.022997,0.014278,-0.155332,-0.261305,-0.064825, &
            0.243223,-0.102023,-0.170201,-0.800059,-0.025167,0.332616,-0.860205,0.121653, &
            -0.129392,0.017727,0.061639,-0.459637,-0.068779,0.134178,-0.932828,0.127926, &
            -0.237583,0.233539,0.469540,-0.208784,-0.079766,-0.085664,-0.351487,0.128112, &
            -0.167505,-0.049490,0.059623,-0.335762,-0.081147,0.007740,-0.206665,0.135341, &
            -0.000075,-0.032277,0.308876,-0.514224,-0.087734,0.129285,-0.435379,0.061300, &
            0.083797,-0.179306,-0.181882,-0.650428,-0.046456,0.067643,-0.334351,0.049880, &
            0.091471,-0.111658,-0.357345,-1.023883,-0.220857,0.226843,-0.517232,0.161338, &
            0.162616,-0.125285,0.457148,-0.276226,-0.100505,-0.053418,-0.247429,-0.372747, &
            0.176430,-0.252811,0.029811,-0.582660,-0.236594,0.450137,0.015235,-0.379721, &
            0.430589,0.011186,0.352670,-0.572412,-0.105521,0.305630,-0.049503,-0.320524, &
            0.125675,0.037602,0.378810,-0.407999,-0.076979,0.246997,-0.314384,-0.080628, &
            0.114504,-0.157879,0.278273,-0.366136,-0.028555,0.275252,0.063851,-0.035083, &
            0.197140,-0.011177,0.425689,-0.507735,-0.022090,0.201387,0.170608,0.001010, &
            0.080387,-0.031640,0.516668,-0.398129,0.003728,0.384670,-0.088138,0.168521, &
            0.155212,-0.159030,0.476616,-0.672908,-0.052949,0.623155,-0.120843,0.031864, &
            -0.248427,0.049635,0.525166,-0.777754,-1.017195,1.989330,-1.033123,-0.290479, &
            -0.148389,-0.142408,0.365384,-0.763786,-1.392618,1.485703,-0.590328,-0.095950, &
            -0.195546,-0.397626,0.361145,-0.619540,-1.199671,0.357632,-0.028504,-0.160402, &
            -0.208239,-0.316223,0.065026,-0.328367,-0.730587,0.154613,0.494393,-0.128195, &
            -0.060654,-0.087388,-0.372693,0.312456,-0.489748,0.149607,0.572205,0.042841, &
            0.097515,-0.180818,-0.561436,0.398549,-0.218723,-0.301484,-0.411170,-0.382744, &
            0.178789,0.058131,-0.411520,0.020432,-0.060986,-0.179892,0.458429,-0.155857, &
            -0.061728,-0.291623,0.280849,0.118225,0.090833,0.711218,-0.026331,0.328533, &
            0.107347,-0.601845,0.786030,0.112164,0.109822,0.825372,1.240038,0.075441, &
            0.165006,-0.290908,0.912397,1.501140,0.563892,0.571586,3.075527,0.294371, &
            0.111558,0.270777,-0.722600,1.141530,0.261477,0.662597,-0.460018,-0.177659, &
            -0.193325,-0.188316,-0.734668,0.940144,0.215790,0.283592,-0.569594,-0.079281, &
            -0.299763,-0.129910,-0.636756,0.901764,0.211162,-0.034052,-0.366226,0.100565, &
            0.018662,0.141224,-0.547001,0.768814,0.245823,0.423486,-0.051114,0.305554, &
            -0.015140,0.090048,-0.354125,0.711559,0.453137,0.171871,0.103377,0.032748, &
            0.136938,-0.263101,-0.335493,0.642556,0.457705,0.162010,0.458327,-0.019283, &
            0.320907,-0.100760,-0.687897,0.776980,0.495320,-0.091822,0.545139,-0.012370, &
            0.536568,-0.094918,-0.550234,0.636720,1.272226,-0.230901,0.556235,-0.225382, &
            0.611223,-0.232750,-0.588456,-0.462577,5.573403,-0.368395,0.862102,-0.916670, &
            0.927960,0.181738,-0.327411,-1.407210,9.499972,0.063531,0.235459,-0.335226, &
            0.976232,-1.310492,0.251487,-2.751562,10.792711,0.885658,-0.888054,0.060064, &
            0.039897,-0.885420,0.968878,-2.305739,9.460768,1.009810,1.344523,0.603230, &
            0.275951,0.038349,1.472701,-0.514773,6.454933,0.694093,0.869612,0.223743, &
            0.992270,0.465779,1.080373,1.148616,4.150478,-0.004596,-0.756326,0.262733, &
            0.671514,-0.060891,0.049080,0.770300,2.481494,0.287677,-0.234120,0.154877, &
            0.671070,-0.768157,-0.534371,1.141394,1.474894,0.894631,1.503046,0.005957, &
            0.261446,-1.092504,-0.278367,1.475469,0.666500,0.979326,4.059287,0.424927, &
            -0.190383,0.083183,-0.172861,0.884870,0.673250,0.625124,4.237106,0.382481, &
            2.760011,2.863578,-0.503066,-0.623171,0.907215,-2.841455,-1.616218,-0.361859, &
            2.718696,2.377616,-0.624997,-0.335377,0.721231,-2.770498,-1.718616,-0.674353, &
            2.813410,2.316286,-0.619540,-0.582160,0.733578,-2.371347,-1.888583,-1.020802, &
            2.765394,2.374080,-0.398624,-0.631008,0.417569,-2.085669,-1.900819,-1.195015, &
            3.127731,1.930411,-0.299302,-0.593965,0.325132,-2.093683,-1.658292,-1.066327, &
            3.492078,1.918807,-0.412308,-0.406618,0.428432,-2.326313,-1.520488,-1.117694, &
            3.694839,1.899773,-0.042080,-0.033082,0.425452,-2.118218,-1.849140,-1.238476, &
            3.993861,2.044428,-0.271525,0.211284,0.334551,-2.060448,-2.273042,-1.210379, &
            5.243306,2.275943,0.276541,0.697241,0.854635,-2.384387,-2.761460,-0.955910, &
            5.144685,1.857954,0.563497,1.140859,2.386007,-2.464312,-3.060099,-1.205340, &
            3.627133,1.287351,0.345361,0.076604,3.026308,-1.106356,0.198273,-1.773995, &
            1.542317,0.381686,-0.114743,0.610196,2.619963,0.024874,1.520810,-1.513945, &
            0.875428,0.111131,-0.269120,1.412011,1.404064,0.012460,-1.335224,-1.526098, &
            0.906382,0.117085,-0.267759,1.724680,0.501358,-0.415951,-2.601881,-1.146394, &
            0.869457,-0.175597,-0.317735,1.567294,0.661628,-1.137576,-1.626605,-0.584211, &
            0.967838,1.148780,-0.296225,1.609602,1.247775,-0.998949,-0.030832,-0.695025, &
            0.566963,0.436658,0.070898,1.104328,1.732416,-1.195982,0.706042,-0.724533, &
            0.355232,-0.865916,0.098921,0.886245,2.274563,-1.014363,1.878594,-1.277284, &
            -0.010083,-0.525254,0.139086,0.383159,0.099186,0.290558,0.435045,-0.130214, &
            0.044137,-0.319608,0.252293,0.137062,0.093727,0.319371,0.086190,0.042351, &
            -0.008389,-0.030763,-0.060419,0.110138,-0.076366,-0.042887,0.188782,-0.146668, &
            0.008203,-0.139497,0.033857,-0.005412,0.006000,0.183017,-0.027195,0.100088, &
            -0.146982,0.033197,0.095299,0.120022,-0.127385,-0.017621,0.300435,0.035589, &
            -0.069756,-0.257116,-0.021912,-0.012955,-0.072407,0.133732,0.074647,-0.047247, &
            0.049991,-0.272860,0.168247,0.167919,0.029557,0.159373,0.208363,-0.044731, &
            0.089521,-0.621470,0.237182,0.388495,0.060457,0.455564,0.565309,-0.091434, &
            -0.614863,-1.680690,0.482753,0.879046,-0.782600,0.847881,1.496703,-0.330450, &
            -0.139638,-1.327646,-0.017293,1.028533,-0.573398,0.660937,0.964537,-0.043871, &
            -0.391621,-0.394246,0.199544,0.150741,-0.377532,-0.091038,0.563793,0.258246, &
            -0.417807,-0.888583,0.205530,0.371676,-0.219731,0.383661,0.696924,0.330112, &
            -0.391289,-0.683186,0.016510,-0.457744,-0.165019,-0.006889,0.177525,0.414305, &
            -0.795274,-0.550669,0.195024,0.287127,0.534557,-0.053385,0.541275,0.688102, &
            -1.076150,-0.330183,-0.316989,0.217691,0.361184,-0.246758,0.318587,0.390676, &
            -1.082188,-0.023709,-0.205767,0.690752,0.429061,0.082648,-0.062394,0.531581, &
            -1.089017,-0.465689,0.060370,1.505243,0.530331,0.211982,0.669812,0.197635, &
            -1.133675,0.004944,-0.126364,0.841854,0.168585,0.076045,0.241443,0.283868, &
            -0.178081,0.386543,0.314677,0.182768,-0.154892,-0.349598,0.471688,-0.479297, &
            -0.026111,0.550367,0.162552,0.286526,-0.133087,-0.269892,0.272901,-0.490605, &
            0.129511,0.455531,0.494459,0.097413,-0.038898,-0.379508,0.179137,-0.418391, &
            0.078401,0.556119,0.290429,0.157339,-0.071749,-0.457795,-0.016356,-0.409458, &
            0.163528,0.415087,0.186000,-0.199206,0.001747,-0.376441,0.057855,-0.220831, &
            0.236631,0.243330,0.159907,-0.182166,-0.017680,-0.184768,0.176698,-0.241517, &
            -0.129208,0.283866,0.005966,-0.199799,-0.184698,-0.294398,0.238828,-0.127502, &
            -0.042833,0.449375,0.208599,-0.309253,-0.045328,-0.058197,0.423727,-0.029659, &
            -0.578575,0.931103,-0.004040,-0.632484,-0.905348,1.023410,1.152327,-0.284637, &
            -0.789168,0.447525,0.016896,-0.841988,-1.488174,0.980385,0.694430,0.044646, &
            -0.492380,0.103457,0.145126,-1.373143,-1.240655,0.685269,0.433800,0.214178, &
            -0.854831,0.545621,0.445206,-1.265690,-1.206788,0.651180,0.049633,0.320165, &
            -0.448824,0.397642,0.104252,-0.536784,-0.742335,0.730417,0.168321,0.347542, &
            -0.458753,0.417098,0.287225,0.489198,-0.728142,0.368395,0.274815,0.729162, &
            -0.146555,-0.011476,0.511849,0.535366,-0.127821,0.566587,0.462335,0.621817, &
            -0.080760,-0.093468,0.380993,-0.135961,-0.211982,0.401482,1.641451,0.279590, &
            -0.126394,0.200554,0.203007,-0.212791,-0.095224,0.176335,1.063821,0.135614, &
            -0.383007,-0.170678,0.049911,0.531244,-0.346128,0.233797,-0.236417,0.034624, &
            -0.231650,-0.131558,-0.183761,0.518220,0.048049,-0.126519,0.023935,-0.181219, &
            -0.140679,0.022264,-0.015265,0.209955,0.021867,-0.041391,0.027344,0.047410, &
            -0.012929,0.072482,-0.171523,0.136430,0.012861,-0.080827,0.183487,-0.023493, &
            -0.030120,0.040724,-0.016577,0.056731,0.007128,-0.050260,0.059225,0.007471, &
            0.087089,-0.022957,-0.029093,0.046333,0.047738,0.071379,0.012627,0.004386, &
            -0.114778,0.000707,-0.236845,0.102986,-0.012498,-0.048563,-0.019607,0.009039, &
            0.072803,0.078715,-0.080544,0.055929,0.007252,-0.087683,0.068521,-0.075039, &
            0.007365,-0.002582,0.025837,-0.059719,0.012336,0.016712,0.155301,0.061091, &
            -0.180788,0.077596,0.050283,-0.062811,-0.089065,0.152350,-0.002483,0.085156, &
            -0.049422,-0.352652,0.027223,-0.178470,-0.082838,0.243294,-0.302831,-0.162932, &
            -0.044131,-0.762856,0.083289,-0.267807,0.109989,0.623164,-0.778717,0.007492, &
            -0.070200,0.014175,-0.440132,-0.088436,0.009376,-0.029763,-0.677151,0.081619, &
            -0.134326,0.031772,-0.231167,0.265319,0.029112,-0.305817,0.040957,-0.158918, &
            0.113401,0.084703,-0.254133,0.256423,0.094118,-0.092100,0.115923,-0.147551, &
            0.058538,0.008812,0.004355,-0.173842,-0.058643,0.122610,-0.549627,0.016276, &
            -0.018637,-0.295940,0.924921,0.038702,0.029326,0.098507,0.484080,-0.128329, &
            0.074940,-0.219056,2.018607,0.137256,0.104469,0.247557,0.600463,-0.000301, &
            -0.051459,-0.171512,1.951380,0.008202,-0.022278,0.087066,-0.115084,-0.110345 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.618233,-1.468596, &
            -3.528647,0.562700, &
            1.231386,-0.672476, &
            0.630420,-0.472194, &
            -3.022562,0.823498, &
            -1.342415,0.329279, &
            -2.214197,-1.035771, &
            2.094421,1.936038 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.665404,-0.679282/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-0.355626,-4.102702,-0.084437,1.427028,-0.482904,-2.483614,-2.22586,2.9974/)
real, dimension(2) :: bias2 = &
(/0.613919,-0.273678/)
real, dimension(1) :: bias3 = &
(/0.165238/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
