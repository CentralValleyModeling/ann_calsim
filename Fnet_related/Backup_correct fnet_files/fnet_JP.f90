module fnet_JP

! a = 0.0002308
! b = 0.06699

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.074482,0.130799,-0.265732,0.416137,-0.164926,0.183621,0.137199,-0.388882, &
            0.060334,0.047208,-0.153198,0.206443,-0.139691,0.028077,0.124154,0.036022, &
            0.027301,0.100204,0.016349,0.097489,-0.119652,0.121225,0.054775,-0.008156, &
            0.161069,0.008434,-0.049763,0.044877,-0.165225,0.077323,0.128686,-0.050790, &
            -0.048772,0.046921,-0.183771,0.126495,-0.205168,0.069774,-0.063868,-0.023688, &
            0.182893,-0.025039,0.051386,0.054726,-0.094029,0.022511,0.042267,-0.107117, &
            0.089903,0.100389,0.000837,0.017931,-0.257359,-0.010807,-0.138179,-0.220748, &
            0.065788,0.001033,0.053156,0.048609,-0.154458,-0.139208,-0.278994,-0.304725, &
            -0.032841,-0.057144,-0.031313,-0.580525,-0.126940,-0.087925,0.217424,0.364183, &
            -0.179149,0.298131,0.470265,-0.591931,0.066067,-0.066534,-0.050276,0.358435, &
            -0.389045,-0.535426,-0.629031,1.442242,0.697816,0.142533,-0.240030,-0.387055, &
            -0.132738,-0.463503,0.198059,0.725408,0.576101,0.082262,-0.000039,0.643272, &
            -0.008463,-0.258757,0.123371,0.617761,0.539675,-0.088560,0.037089,0.272909, &
            0.270564,0.068782,-0.173835,1.061390,0.308764,0.264378,0.133370,-0.808282, &
            0.060076,0.367259,-0.043757,0.863162,0.062678,0.176683,-0.051219,-0.363960, &
            0.154234,0.120680,-0.409194,1.166992,-0.149281,0.095783,0.031609,0.199508, &
            0.054969,-0.077744,-0.474702,0.772620,-0.326584,0.214394,0.042558,0.882638, &
            0.252648,-0.245237,-0.251785,0.218362,0.161756,-0.375418,0.290708,0.462190, &
            0.073821,-0.033274,0.057478,-0.015810,-0.350440,0.012518,-0.301356,0.245174, &
            0.034817,0.094060,-0.076679,0.088016,-0.170363,-0.221620,-0.324525,0.364851, &
            0.248315,-0.227318,-0.117295,0.168829,-0.166471,-0.159692,-0.314455,0.193949, &
            -0.030079,-0.097095,-0.192163,0.186029,-0.080520,-0.193102,-0.430007,0.023306, &
            0.040885,-0.196128,-0.256495,0.070490,0.150902,-0.183278,-0.187006,-0.181332, &
            0.041137,-0.081437,-0.304764,0.132671,0.020790,-0.253412,-0.292290,-0.029066, &
            0.139641,-0.130967,-0.274802,0.023778,0.055010,-0.424840,-0.278532,-0.269413, &
            0.105476,0.115904,-0.145296,0.084941,0.174002,-0.359650,-0.253703,0.013562, &
            0.396150,0.245764,-0.018718,0.024259,0.470642,0.258623,-0.528151,0.361924, &
            0.585349,0.579319,-0.376624,0.694290,0.152964,0.241124,-0.174909,0.367833, &
            0.020660,0.079538,-0.405253,-0.249552,-0.172474,0.545528,-0.285413,-0.437900, &
            0.258265,-0.384414,-0.401973,-0.919588,0.096842,-0.222149,0.059273,0.352128, &
            -0.029151,-0.214743,-0.357387,-0.302348,0.470182,-0.597897,-0.089823,-0.559701, &
            0.137426,-0.080681,-0.084333,0.521768,0.379122,-0.404102,0.187706,0.632195, &
            -0.110759,-0.080191,-0.084570,0.456807,0.243234,0.169223,-0.127748,-0.090019, &
            -0.282333,-0.045961,-0.570371,-0.428310,-0.119769,0.302023,0.006894,-0.078340, &
            -0.067550,0.242396,-0.130038,-0.223981,-0.172008,-0.372721,0.076954,0.514471, &
            0.348191,0.403909,-0.163735,-0.473767,-0.191586,-0.058654,0.519576,-0.831007, &
            -0.426002,0.672836,-0.011902,-2.073091,0.161978,2.232972,0.792754,0.249386, &
            -1.042079,0.037943,0.758480,-2.071050,-0.785998,2.304961,1.602126,-0.106425, &
            -1.323708,0.079605,0.725962,-2.259747,-0.760181,2.703415,1.818450,0.530404, &
            -1.226739,-0.209639,0.715217,-2.135487,-0.765763,2.862857,2.108095,0.751034, &
            -1.533868,-0.081039,0.915872,-2.285967,-0.708272,3.125013,2.019664,1.051828, &
            -1.565520,-0.452013,0.949274,-2.065535,-1.203457,2.946243,2.544871,1.179758, &
            -2.011098,-1.004029,1.314166,-1.944883,-1.765895,2.970214,2.546204,1.092621, &
            -2.370897,-1.103883,1.890341,-1.723747,-2.189620,3.108201,3.239061,0.636195, &
            -5.313038,-4.446611,4.756372,1.424378,-5.431289,1.434343,6.056901,-2.395438, &
            -5.785070,-4.616608,5.398228,1.363431,-6.022298,2.992463,6.336211,-1.475660, &
            -3.758567,-2.530107,3.648410,-0.798486,-4.267383,4.890070,3.906817,-0.879213, &
            -2.189945,-1.147950,2.246127,-1.847965,-2.817721,4.472959,2.028175,-0.933930, &
            -1.440070,-1.185006,2.070878,-2.106289,-2.007162,3.468256,1.080985,-1.906816, &
            -1.216603,-0.982448,1.335990,-2.014253,-1.000549,3.404744,0.489372,-2.480056, &
            -1.083787,-0.874381,1.046389,-1.473788,-0.671681,2.661316,0.239498,-2.262343, &
            -0.510907,-0.738781,0.306473,-1.218636,-0.621153,1.793799,0.133480,-1.694649, &
            -0.268864,-0.698833,-0.195638,-0.589949,-0.284380,0.665303,-0.267137,-1.695096, &
            0.358434,-1.115803,0.420417,0.218698,-0.414495,0.570766,0.059028,-2.237444, &
            -0.168041,0.006445,0.692923,-0.245260,-0.475616,0.925246,0.432317,-1.294029, &
            -0.152651,0.245224,0.485564,-0.320916,-0.381714,0.911974,0.611675,-0.756169, &
            0.024953,0.265095,0.428292,-0.454505,-0.197372,0.792710,0.474747,-0.565513, &
            -0.031227,-0.032977,0.406335,-0.348861,-0.491758,0.600369,0.663619,-0.532982, &
            -0.069037,0.187694,0.343300,-0.494026,-0.428774,0.621412,0.794104,-0.413640, &
            -0.462371,0.028505,0.639001,-0.598804,-0.433883,0.516857,0.795222,-0.605585, &
            -0.314514,0.005824,0.820779,-0.590454,-0.613608,0.604510,0.989296,-0.273447, &
            -0.509385,-0.090504,0.803791,-0.216714,-0.622165,0.758759,1.009277,-0.483563, &
            -0.881458,-0.553640,1.317264,0.100940,-1.107687,-0.015019,1.476617,-0.544363, &
            -1.520971,-0.868236,1.830006,0.523125,-1.504421,-0.064897,1.382830,-0.956832, &
            -1.002689,-0.424187,0.961280,-0.166680,-0.852225,0.271110,0.820665,-0.913700, &
            -0.838918,-0.559596,0.607136,-0.011301,-0.584259,0.597851,0.527385,-1.061439, &
            -0.606931,-0.409760,0.061199,-0.191588,-0.066436,0.862868,0.048186,-1.114900, &
            -0.126313,0.105773,0.024352,0.013534,0.141830,1.027902,-0.448707,-1.463643, &
            -0.118748,0.161704,-0.239199,0.889359,-0.237088,-0.062845,-0.047346,-1.683769, &
            -0.077470,0.277817,-0.373482,0.816110,0.118413,-0.151412,-0.007815,-1.101943, &
            0.267825,0.329802,-0.579286,1.204738,0.042041,0.262312,0.063092,-0.877984, &
            0.075104,-0.370388,-0.370066,1.558272,-0.181114,0.509438,0.674527,-0.999899, &
            0.054678,0.153007,-0.057427,0.046066,0.062040,-0.505927,-0.054406,0.062259, &
            0.024409,0.165762,0.128053,-0.137763,0.090692,-0.113759,0.172048,0.339434, &
            0.051350,0.078264,-0.026490,0.156356,-0.119147,0.115485,-0.031182,0.026662, &
            0.073110,0.019405,-0.008081,0.223566,-0.108238,-0.039803,-0.012452,0.040069, &
            0.037471,0.172993,0.082668,0.199064,0.063681,-0.160922,0.018195,-0.120233, &
            -0.049224,-0.035279,-0.123474,0.051245,0.046102,-0.217416,-0.004347,-0.002436, &
            -0.026544,0.106408,0.096696,-0.233507,0.120986,0.060278,0.250724,0.178257, &
            0.051740,-0.052843,0.097573,-0.145321,0.025847,-0.222850,0.127317,0.206051, &
            0.069283,0.018541,-0.365649,-0.051232,0.493208,-1.057751,-0.126247,1.071422, &
            -0.243029,-0.382090,-0.113999,0.246870,0.300022,-0.656359,0.015440,0.094659, &
            0.040583,-0.051149,-0.352766,0.194824,0.194790,0.017598,-0.414740,-0.269557, &
            -0.313283,-0.257707,-0.156149,-0.070752,0.267029,0.258503,-0.278682,-0.943067, &
            -0.304843,0.002180,-0.063635,-0.178755,0.195266,1.232675,-0.533367,-1.111150, &
            -0.051311,-0.341997,-0.105987,0.245377,-0.102487,0.088347,-0.035723,-0.379234, &
            0.151709,0.272500,-0.110567,0.056429,0.034610,-0.171985,-0.130528,-0.180636, &
            -0.185363,0.084594,0.633409,-0.245506,-0.406944,-0.325977,-0.283491,-0.610523, &
            -0.032541,-0.226838,0.287271,-0.767572,-0.085219,-0.719223,0.027320,0.015249, &
            -0.034613,0.082331,0.322841,-0.481518,-0.053438,-0.663271,0.253874,0.202941, &
            -0.054371,-0.058287,0.044256,-0.240304,-0.054461,0.080776,0.048788,0.309936, &
            -0.057788,0.003345,-0.033553,-0.064810,0.094781,0.081724,-0.035848,0.042430, &
            -0.032610,-0.176749,-0.013246,-0.255060,0.058327,-0.244082,-0.179840,-0.058138, &
            0.186096,-0.200868,-0.038713,0.109968,-0.172596,-0.025730,-0.199873,0.024265, &
            0.096835,-0.127061,0.156440,-0.000504,0.028033,0.008834,-0.161841,-0.133775, &
            0.171441,-0.155503,0.054703,0.233049,-0.177526,-0.376127,-0.326465,-0.132955, &
            -0.001516,-0.098091,-0.070471,0.120841,0.082523,-0.302061,-0.159028,-0.444403, &
            0.050758,-0.186204,0.144023,0.173187,0.164995,-0.308014,-0.356710,-0.220773, &
            0.148909,0.153352,-0.415093,-0.268963,0.626398,-0.624770,-0.607031,-0.019889, &
            0.410589,-0.017010,-0.764224,-0.116731,0.473567,-0.981769,-0.409818,-0.670591, &
            -0.204752,-0.230378,-0.240574,0.121922,0.372782,-0.800256,-0.446398,-0.669740, &
            0.118329,-0.015173,-0.116320,0.347138,0.415771,-0.263100,-0.194456,0.023993, &
            -0.270795,-0.019056,0.041408,0.201878,0.298704,-0.398985,-0.141270,-0.212352, &
            0.260941,0.399107,-0.300910,0.576398,0.325050,-0.445571,-0.138384,-0.251253, &
            0.036938,0.314915,0.670420,0.064548,-0.040051,-0.431197,-0.004048,-0.064265, &
            0.350664,0.448921,0.505737,0.164178,0.260086,-1.050421,0.100112,0.309870, &
            0.418380,0.488696,0.070467,0.332722,0.064188,-0.953487,0.126008,0.786665, &
            0.178451,0.372198,0.640376,0.054243,-0.008206,-0.855888,0.194589,0.738797, &
            0.025916,-0.013262,0.094157,0.104942,0.136511,0.040207,0.056783,-0.044951, &
            0.206136,-0.102231,0.027127,0.098684,-0.174951,0.097605,-0.020514,0.027683, &
            0.135689,-0.212345,0.147054,-0.154135,0.017298,-0.083052,-0.068879,0.029948, &
            0.091198,-0.124628,0.085146,0.005375,0.054728,-0.041254,-0.014977,0.034137, &
            0.148243,0.009408,0.033858,-0.043598,-0.123815,0.028629,0.042182,0.027741, &
            -0.046764,0.084350,-0.098740,-0.144415,-0.238884,-0.065707,-0.101102,0.090800, &
            0.022892,-0.057193,0.024266,0.062500,-0.127526,0.127547,-0.112931,0.033458, &
            0.058248,0.015671,-0.055890,0.071691,-0.027489,0.010139,0.048448,-0.073838, &
            0.047222,0.077580,0.141940,0.038930,0.253632,0.064641,0.256688,-0.165716, &
            0.108649,-0.027504,0.188452,-0.047612,-0.038873,0.021133,-0.057705,-0.091180, &
            -0.081434,-0.074803,-0.221077,0.054219,0.202108,-0.279638,0.120671,0.134664, &
            -0.088392,-0.102519,0.017384,-0.058429,0.011461,0.174761,-0.030537,0.017416, &
            -0.096326,0.139288,0.099641,-0.160002,-0.013451,-0.119984,-0.083876,0.014214, &
            -0.272332,0.130603,-0.144994,0.414364,0.204460,-0.052682,-0.151886,-0.214367, &
            0.138842,-0.163207,0.031522,-0.007077,0.009455,0.163345,0.158605,0.053801, &
            0.038436,-0.070629,0.081899,0.017287,0.064261,-0.175817,-0.149567,0.001179, &
            0.048063,-0.092255,-0.024275,-0.087289,0.092331,0.072899,0.111759,-0.130687, &
            -0.181038,0.146384,0.066523,0.064130,0.089427,0.003674,-0.023526,0.095140 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.315447,3.905025, &
            -1.133316,2.866418, &
            -0.298304,-2.266460, &
            -0.679957,-0.767837, &
            -0.604423,2.634016, &
            3.979194,-0.795279, &
            0.745321,-2.955493, &
            1.862365,2.119235 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.852181,3.308507/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.154515,1.240027,-0.999234,-1.504919,1.203219,0.221046,-1.310219,1.209457/)
real, dimension(2) :: bias2 = &
(/-0.168999,-0.05356/)
real, dimension(1) :: bias3 = &
(/-0.73427/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
