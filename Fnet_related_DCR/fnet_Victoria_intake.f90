module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.146223,-0.137512,0.209674,0.009012,0.042928,-0.010229,0.311577,-0.246844, &
            0.123227,-0.015441,0.044978,0.041252,0.022636,0.121640,0.168780,-0.067806, &
            0.099824,0.033546,0.070803,0.034383,-0.030918,0.001986,0.019469,-0.095742, &
            0.091838,-0.011002,-0.020286,-0.002942,-0.041835,0.054257,-0.122423,-0.054957, &
            0.165632,-0.002658,-0.046318,-0.005967,-0.054904,0.137156,-0.036445,-0.048750, &
            0.113428,0.024796,-0.094792,0.004931,-0.104856,-0.018505,-0.033274,-0.064494, &
            0.201909,-0.032737,0.026075,-0.042264,-0.010078,0.099671,-0.006402,0.007319, &
            0.299840,0.101506,0.099088,-0.034507,-0.093998,-0.048828,0.040285,-0.025376, &
            0.373019,-0.169280,0.703862,-0.551627,-0.040225,-0.339585,1.243645,0.118450, &
            -0.768477,-0.450379,-0.069825,-0.464896,-0.063986,-0.615370,0.521239,-0.078532, &
            -1.159939,-0.294131,0.504211,0.006509,0.231304,-0.830895,0.047231,-0.141294, &
            -1.150997,-0.745816,-0.311688,-0.315521,0.353078,-0.522827,0.780120,0.088658, &
            -0.424211,-0.413260,-0.572783,0.010404,0.175953,-0.122208,0.358701,0.240074, &
            0.047086,-0.393716,-0.247461,0.048143,0.134574,0.110666,-0.177904,0.053599, &
            -0.130150,-0.175930,-0.276502,-0.160547,-0.002465,-0.495632,0.241285,0.146579, &
            0.100963,-0.575018,-0.493316,-0.429734,0.225508,-0.128328,0.227096,0.415790, &
            0.931442,-0.304723,-0.183945,-0.208866,0.375556,0.160039,0.072940,0.489957, &
            0.888645,-0.179545,-0.445598,-0.163721,0.184803,0.316926,-0.006416,0.542976, &
            0.304098,0.234274,0.567404,0.142461,-0.009643,-0.040109,-0.230620,-0.057189, &
            0.251100,0.318729,0.653090,0.175140,0.074635,-0.207200,-0.201302,-0.135187, &
            0.028208,0.372424,0.446829,0.276654,-0.033001,-0.268716,-0.020949,-0.098896, &
            0.078948,0.301393,0.403236,0.339821,-0.004108,0.066649,0.110342,-0.175178, &
            0.025533,0.238894,0.331189,0.318625,-0.000834,-0.208985,-0.142742,-0.139803, &
            0.263843,0.203377,0.134463,0.397719,-0.025283,-0.207011,-0.113984,-0.056968, &
            -0.159668,0.168771,0.195479,0.238690,-0.053252,-0.145114,-0.193603,-0.101784, &
            -0.320039,0.026236,0.279645,0.473632,0.230913,-0.084868,-0.224355,-0.023277, &
            -1.836261,0.203911,-0.351607,1.240560,0.505776,0.182633,-0.016012,-0.028373, &
            -0.698864,0.195763,-0.619336,0.730292,0.896269,0.400156,-0.027753,0.180885, &
            1.058364,-0.409354,-0.148900,-0.386568,0.506695,0.454142,0.060777,0.022402, &
            -0.551583,-0.449423,-0.518655,0.034425,0.660258,-0.392242,-0.080442,0.253795, &
            -1.592375,-0.134865,-0.192668,0.342575,0.648490,-0.624133,-0.335612,-0.125036, &
            -1.010306,-0.102542,-0.022883,-0.004930,0.035104,-1.114433,-0.697596,-0.118275, &
            -0.157948,0.045975,0.116709,-0.172425,-0.040267,-1.022533,0.186911,-0.128377, &
            -0.558616,0.054615,0.151958,-0.010718,0.121500,-0.560946,0.351974,-0.205844, &
            -1.050805,-0.006957,0.270986,-0.396649,-0.131701,-0.678182,0.751304,-0.307882, &
            -1.312890,-0.325179,-0.219238,-0.533176,-0.301512,-0.915659,1.474889,-0.743811, &
            -0.835253,0.248827,0.041987,0.612939,-0.413612,0.450351,-0.654913,-0.306519, &
            -0.538944,0.320640,-0.028877,0.543919,-0.237316,0.307065,-0.538888,-0.404607, &
            -0.198310,0.630525,0.023074,0.452188,-0.384228,0.394062,-0.280557,-0.431049, &
            -0.092791,0.549386,-0.009257,0.557246,-0.516605,0.485998,-0.118923,-0.547969, &
            -0.191876,0.358283,0.266678,0.604588,-0.575280,0.705131,-0.402846,-0.555899, &
            -0.215315,0.160118,0.306369,0.411521,-0.640632,0.739666,-0.401727,-0.801660, &
            0.019518,0.028367,0.209510,0.440267,-1.181857,0.742016,-0.201941,-0.814302, &
            -0.146733,-0.131564,0.167070,0.282795,-1.864020,0.693374,-0.681697,-0.912024, &
            -0.382774,-1.026610,1.058668,0.395680,-4.839132,0.514238,-0.488119,-0.655219, &
            -1.164437,-0.634010,1.231659,-0.077453,-7.161741,0.467476,-0.015906,-0.405437, &
            -1.111197,-0.257102,3.420954,-0.821012,-6.336989,0.971334,0.618611,-0.567105, &
            -1.532359,-0.110068,4.879660,-0.159711,-5.070499,0.731789,0.861009,-0.095847, &
            -1.222717,-0.525354,3.787653,-0.208254,-3.729147,0.261881,-0.088452,-0.237884, &
            -0.400078,-0.453965,1.950425,-0.312919,-2.514698,-0.701474,-0.524027,-0.433644, &
            0.587209,-0.507277,1.562504,-0.339462,-1.693998,-0.947332,0.250823,-0.759046, &
            0.708380,-0.831408,1.274094,-0.692179,-1.052628,-1.049602,-0.286662,-0.460531, &
            0.337825,-0.560290,1.064255,-0.325242,-0.326620,-0.986309,0.908887,-0.286867, &
            -0.123432,-0.255669,0.860153,-0.067810,-0.201998,-0.747648,-0.867906,0.327590, &
            0.072077,-1.288927,0.388953,-0.646636,-0.219072,-0.088546,0.663388,-1.828238, &
            0.379771,-1.392530,0.232165,-0.364043,-0.087691,-0.394265,1.030448,-2.014839, &
            0.673976,-1.338863,-0.064670,-0.088140,0.101897,-0.303085,1.230828,-2.082729, &
            0.684072,-1.296593,-0.020800,-0.396389,-0.120898,-0.554305,1.098126,-1.928338, &
            1.057540,-0.841520,-0.276404,-0.217958,-0.087847,-0.432037,0.977549,-1.845370, &
            1.312320,-0.879102,-0.650991,-0.091412,0.074101,-0.412297,0.769952,-1.981956, &
            1.298126,-0.631780,-0.711325,-0.256320,-0.099479,-0.269135,0.610758,-2.048328, &
            1.535673,-0.728068,-1.157221,-0.238474,0.049629,-0.416335,0.096247,-2.086747, &
            2.441502,-0.848095,-2.490534,-0.105095,-0.451540,-0.853676,-1.108188,-2.617410, &
            2.439130,-1.026497,-2.064275,-0.238248,-1.760607,-1.017591,-1.672662,-2.157149, &
            1.515076,-0.601691,0.648660,-0.446242,-2.132466,-0.315560,0.843933,-1.343093, &
            0.200918,0.356310,1.601913,0.143006,-1.391077,-0.293038,1.531547,-0.693344, &
            -0.157254,0.202685,1.118470,0.373640,-0.738811,-0.393944,0.492689,-0.445975, &
            -0.543749,0.319671,1.163608,0.485137,-0.663212,-0.332932,0.546079,-0.443246, &
            -1.045909,0.864702,0.841929,0.574506,-0.127130,-0.304909,1.142523,-0.330411, &
            -1.348338,0.627356,0.734121,0.775252,-0.422521,-0.254383,0.224180,-0.244992, &
            -1.398451,0.572763,1.367148,0.184982,-0.437223,0.059578,0.084493,-0.031269, &
            -1.170718,0.432412,2.360065,-0.390757,-1.542324,-0.286524,0.224313,-0.049732, &
            0.175488,0.401675,0.179244,0.049714,-0.094723,0.047654,-0.074372,0.157517, &
            -0.006527,-0.006717,-0.075197,0.118737,0.028681,-0.114993,-0.215763,0.059266, &
            0.027830,0.055949,0.133786,0.036330,0.013841,0.017768,-0.050992,-0.096442, &
            -0.149887,-0.062085,-0.157914,0.036116,-0.022524,-0.051800,0.122127,0.097507, &
            -0.098766,0.105797,0.131952,-0.066319,0.024059,-0.075200,-0.061151,0.104524, &
            -0.030733,0.006772,0.114953,0.121615,0.128004,-0.022110,-0.006622,0.023629, &
            0.078189,0.102359,0.191748,0.107022,0.006634,-0.029684,-0.358785,0.034621, &
            0.359609,0.312342,-0.027919,0.223223,0.019939,0.107099,-0.079376,0.146431, &
            0.543467,0.882726,0.057984,0.666929,0.013396,-0.024047,-0.082103,0.581016, &
            0.454395,0.932291,-0.312346,0.821131,0.034943,-0.021119,0.293075,0.342892, &
            0.116943,0.795930,-0.423975,0.126653,-0.017046,0.240302,0.696911,0.039299, &
            0.406069,1.015954,-0.445879,0.231892,-0.185012,0.225490,0.330017,0.144581, &
            -0.378051,0.701153,-0.394336,0.089430,-0.047820,0.149955,0.629923,0.164912, &
            0.171881,0.558580,0.473948,-0.425619,-0.564883,0.228196,0.239867,0.090619, &
            -0.072286,0.403347,0.622600,-0.402910,-0.632462,0.211783,-0.218924,0.120045, &
            0.008339,0.107883,0.497874,-0.354024,-0.680867,-0.287645,-0.421203,0.082048, &
            0.390362,0.442387,0.902674,-0.135670,-0.509226,-0.180676,-0.641746,0.113129, &
            -0.087248,0.109072,0.543869,-0.254504,-0.411365,-0.553434,-0.552191,-0.018884, &
            0.663236,-0.261540,0.348044,-0.192069,0.089732,0.126574,0.549107,0.191961, &
            0.581866,-0.108878,-0.016363,0.018879,-0.153660,0.258661,0.572887,0.044348, &
            0.342273,-0.342138,-0.096608,-0.110667,0.003848,0.012530,0.521926,0.057313, &
            0.359891,-0.301802,-0.218832,-0.018665,0.064933,0.341841,0.549080,0.244248, &
            0.197367,-0.049651,0.111815,-0.091738,0.042045,0.114257,0.431564,0.037041, &
            0.456426,-0.295004,-0.181499,-0.040553,0.076260,0.167358,0.611183,-0.022822, &
            0.412110,-0.199201,0.016027,-0.021962,0.158089,0.027250,0.455665,-0.006303, &
            0.441769,-0.159857,-0.091440,-0.048764,0.064437,-0.044578,0.475883,0.329965, &
            0.332803,-0.159340,0.372966,0.515369,0.703527,-0.149930,0.787415,0.176633, &
            -0.035703,0.149105,0.117016,0.309215,1.121925,-0.490636,0.604573,0.471311, &
            -0.982605,0.393386,-0.466985,0.796517,0.616867,-0.110813,0.178427,0.355847, &
            -0.885534,0.439646,-1.340184,0.827712,0.607132,0.377787,-0.116865,0.610883, &
            -1.119797,-0.084092,-1.314231,0.589982,0.565142,0.529365,0.143393,0.508491, &
            -0.722519,-0.097189,-1.268774,0.180573,0.205014,0.746472,-0.244446,0.370750, &
            -0.591051,0.043743,-0.804930,0.233624,0.255109,0.481763,-0.571509,0.104934, &
            0.099504,-0.298810,-0.014163,-0.071379,-0.048362,0.358644,-0.129750,0.192864, &
            0.503504,-0.239743,0.177456,-0.035347,-0.127786,-0.118450,-0.226450,0.237242, &
            0.969662,0.075999,-0.205283,0.308696,0.292119,-0.257881,-0.610889,0.032309, &
            -0.209776,0.473514,0.282858,-0.098123,-0.216888,-0.507816,-0.233431,0.187241, &
            -0.322025,0.114969,0.186783,-0.057423,0.036918,-0.610428,-0.141056,0.099284, &
            -0.024522,0.104721,0.075241,0.035277,-0.054875,-0.370828,0.156353,-0.063631, &
            -0.207329,-0.009101,0.141581,-0.162632,-0.022328,-0.288648,0.003935,-0.040986, &
            0.007464,0.007924,0.226657,-0.053456,0.080868,-0.398726,-0.213967,0.045251, &
            -0.055442,0.130559,0.376223,-0.098385,0.011593,-0.119368,-0.230156,-0.068983, &
            -0.067030,-0.069636,0.075492,-0.162380,0.059209,-0.211987,-0.052020,0.116071, &
            -0.430519,-0.111162,0.167090,-0.320208,-0.001196,-0.200770,0.079649,0.001289, &
            -0.418358,-0.103519,0.243757,-0.003219,0.175344,-0.029096,-0.121555,-0.018059, &
            -0.962768,-0.169729,-0.057827,0.027421,0.172442,-0.966559,-0.101585,-0.040399, &
            -0.849924,0.277970,0.219036,-0.008335,-0.258883,-0.940216,0.149110,-0.118579, &
            -0.123557,0.144649,-0.142716,0.096422,-0.126512,-0.272375,0.093337,-0.022034, &
            -0.122256,-0.064664,-0.148886,-0.162041,-0.139625,-0.211822,0.185815,-0.030680, &
            -0.371441,-0.046966,0.032441,-0.110338,-0.068941,0.288899,0.146942,-0.058698, &
            -0.043031,-0.126355,-0.094443,0.117715,0.152909,0.295995,-0.009569,-0.115617, &
            -0.302743,-0.084106,-0.157823,0.008264,0.028171,0.036267,-0.242688,0.036182, &
            -0.319791,0.054740,0.037323,0.046543,-0.072539,0.044590,-0.191636,-0.026498, &
            0.514600,-0.104898,0.106312,0.017522,0.101095,0.336039,0.177863,0.009282 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.690931,0.673193, &
            1.844478,1.755173, &
            -0.693653,-2.089945, &
            -1.662611,-1.008635, &
            3.141386,3.358400, &
            -0.835410,-0.949346, &
            -0.828913,-0.935167, &
            -1.354103,-1.370792 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.142712,1.275284/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.5931,2.168225,-0.633377,-1.591065,0.356223,-0.074343,-2.542555,0.24638/)
real, dimension(2) :: bias2 = &
(/-0.302419,-0.185992/)
real, dimension(1) :: bias3 = &
(/0.032127/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
