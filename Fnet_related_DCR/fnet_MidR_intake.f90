module fnet_MidR_intake

! a = 0.00084822
! b = 0.0059421

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.431778,-0.011256,-0.183791,-0.487172,0.043335,0.116621,-0.012146,-0.344421, &
            -0.115280,-0.005102,-0.076044,-0.129002,0.001999,0.164710,-0.015898,-0.130843, &
            -0.076867,-0.009419,-0.045376,-0.028895,0.013353,0.154468,0.006723,0.090276, &
            -0.084552,-0.000495,-0.086035,-0.013113,0.026219,0.355629,-0.017750,0.055624, &
            -0.102518,0.008526,-0.035302,0.006741,0.026127,0.188417,-0.007529,0.067206, &
            -0.219232,0.028873,-0.075690,-0.094069,0.046142,0.142174,-0.013884,0.008329, &
            -0.550910,0.020705,0.001764,-0.052940,0.046676,0.176062,0.029081,0.042837, &
            -0.845918,0.082508,-0.038935,-0.011603,0.114552,0.222185,0.021483,0.079015, &
            -1.380852,0.410611,-0.003753,-0.974352,0.482951,0.341560,0.108698,-0.565554, &
            -0.463639,0.217432,-0.329996,-0.634149,0.222918,0.031171,-0.248838,-1.453765, &
            0.145314,0.123557,-0.132130,-0.404283,0.071198,0.370888,-0.217241,-0.801546, &
            0.058400,-0.111102,-0.300637,-0.245514,0.025967,0.335911,-0.048218,-0.332181, &
            0.643542,-0.187579,-0.007047,0.158189,-0.081667,0.296363,-0.002643,0.386482, &
            -0.113923,-0.001726,0.047721,0.113175,-0.125029,0.366893,-0.207191,-0.059434, &
            -0.714534,0.121294,0.146389,-0.049278,-0.042493,0.342098,-0.042119,-0.291333, &
            -0.428713,0.372205,0.316280,-0.413110,-0.139997,0.368584,-0.119172,-1.076888, &
            -1.250913,0.302435,0.376587,-0.365607,-0.162386,0.542984,-0.146632,-1.249533, &
            -1.438052,0.121093,0.393953,-0.281916,-0.160605,0.600047,0.099055,-0.779529, &
            -0.328211,0.038452,-0.124633,-0.039666,0.093098,0.208932,0.021046,0.441770, &
            0.020645,-0.057216,0.027276,0.008884,0.044338,0.315785,0.116804,0.378644, &
            -0.176449,-0.054727,0.062177,-0.154602,0.003119,0.229399,0.157086,0.478665, &
            -0.173899,-0.161803,0.094338,0.122002,0.038254,0.313479,0.134785,0.387058, &
            -0.043553,-0.171918,0.033248,0.142677,0.010041,0.174065,0.079769,0.680258, &
            -0.345377,-0.146863,0.167493,0.284424,0.032021,0.244988,0.080214,0.753713, &
            -0.207392,-0.060430,0.238145,0.070605,-0.084870,0.197936,-0.011103,0.527921, &
            -0.056590,-0.395458,0.203793,0.366584,-0.115484,0.344306,-0.028572,0.975967, &
            0.550832,-1.456918,0.233448,0.465473,-1.022567,0.360794,-0.130578,1.585417, &
            1.109939,-0.432343,0.534343,0.354300,-1.227593,0.110116,0.139323,1.074802, &
            0.595739,0.228996,0.024763,0.016623,-0.780601,0.108577,-0.196468,0.107111, &
            -0.207203,-0.304869,-0.056285,0.027758,-0.636158,0.096037,-0.088063,0.203115, &
            1.117486,-0.141099,-0.097065,0.246623,-0.645659,0.276156,-0.098487,0.752476, &
            0.122418,-0.074595,-0.259061,0.248299,-0.313329,0.148824,-0.257673,0.620530, &
            -0.667859,0.134356,-0.108251,-0.357063,-0.033578,0.190118,-0.195032,-1.391628, &
            -1.761133,0.086592,0.313065,-0.457029,-0.297675,0.408689,0.073581,-0.118843, &
            -1.940457,-0.155494,0.058221,-0.487526,-0.037028,0.529236,0.404977,0.677016, &
            -2.249256,-0.312324,-1.307422,-0.633765,0.340319,0.276653,-0.076375,-0.087456, &
            0.662662,0.158500,-0.092887,0.589649,-0.065198,0.196452,-0.523276,0.579986, &
            0.783823,-0.096976,-0.268652,0.469088,-0.020829,0.529769,-0.145304,0.557695, &
            0.498065,-0.151100,-0.127746,0.310940,-0.067709,0.228938,-0.273206,0.368550, &
            0.603260,-0.138944,-0.206850,-0.029649,-0.160962,0.367109,0.013195,-0.218337, &
            0.518879,-0.350763,-0.521776,0.115559,0.341989,0.523670,-0.003619,-0.344846, &
            0.286204,-0.255564,-0.805644,0.179999,0.528509,0.332219,-0.141890,-0.025404, &
            0.258470,-0.490862,-0.981716,0.036864,0.618451,0.209947,0.008540,-0.238475, &
            0.241662,-0.580142,-1.078945,0.211720,1.046129,0.427240,0.179683,0.250663, &
            0.018673,-0.976000,-0.273716,-0.139518,5.738616,0.438308,-0.413242,-0.567218, &
            -0.782026,-0.837086,-0.117974,-0.467118,9.438762,0.393661,-0.075382,-1.518684, &
            -0.494024,0.180668,-0.399027,-0.911265,9.724421,0.080559,0.072295,-2.330263, &
            -0.718784,-0.093119,1.106689,-0.326187,8.793015,0.409628,-0.197348,-2.656964, &
            -0.881007,0.336751,0.537219,0.042576,6.387354,0.376096,-0.668716,-1.437077, &
            -1.010434,0.343886,-0.590397,0.558151,4.055463,0.231618,-0.450358,-0.862993, &
            -1.800436,-0.197288,-1.036191,-0.185161,2.792691,0.291166,-0.277486,-0.965153, &
            -3.418497,-0.002883,-0.765285,-0.538409,1.519337,0.377504,-0.260743,-1.165322, &
            -2.777614,0.463764,-0.502416,-1.177238,1.174677,0.322636,0.113032,-0.305377, &
            -2.007462,-0.863354,-0.398860,0.024708,1.657364,0.294554,0.034178,-0.901800, &
            -0.978472,-0.531176,-2.210424,0.237337,1.273265,0.134453,-0.380757,-0.571383, &
            -0.812664,-0.746618,-2.234565,-0.279457,1.035060,0.139700,-0.463459,0.084268, &
            -0.968462,-0.629103,-2.591152,-0.390299,0.692546,0.385948,-0.289575,0.394152, &
            -0.902019,-0.246510,-2.900197,0.035709,0.973870,0.145369,-0.261122,0.238132, &
            -0.963772,-0.042574,-3.274056,0.098194,0.829781,0.442058,-0.372478,0.036296, &
            -0.961024,0.124586,-3.432981,0.312516,0.991296,0.339166,-0.154827,0.156401, &
            -0.892556,0.353756,-3.730570,0.660309,0.848355,0.283996,-0.571667,-0.026382, &
            -0.893857,0.311195,-4.323252,0.721922,0.759980,0.293792,-0.395558,0.647335, &
            -0.745081,1.739138,-5.111527,1.583820,1.382777,0.112262,-0.911166,1.294565, &
            -0.894625,1.944065,-4.141777,0.817167,3.262754,0.312183,-1.156819,0.924385, &
            -0.528369,1.353710,-2.072634,-2.225098,3.275834,0.082344,-1.068394,-1.512497, &
            0.015640,-0.056399,-0.484077,-2.512619,2.604319,0.281965,0.018215,-2.094434, &
            0.603385,-0.142192,-0.408462,-1.542478,2.067493,0.128089,0.393456,-1.095218, &
            1.182663,-0.623871,-0.626466,-0.824494,1.771326,0.288385,0.373919,0.272608, &
            0.878375,-1.084176,-0.615344,-0.018815,1.218983,0.436376,0.737129,0.910700, &
            -0.325516,-1.397175,-1.482220,0.962488,1.174783,0.143525,0.200649,0.773065, &
            -0.794208,-1.078748,-1.706770,0.689476,1.881794,0.202778,-0.048631,0.069072, &
            -0.755145,-1.096895,-2.095735,0.298157,2.197971,0.077236,0.085949,-0.816066, &
            0.307578,-0.108404,0.009584,-0.105077,-0.002522,0.568571,0.122004,0.208479, &
            -0.049275,0.128666,0.000024,-0.061214,-0.012891,0.198102,-0.103101,-0.298341, &
            0.033489,-0.116369,0.003670,-0.039631,-0.041007,0.249340,-0.000221,-0.091262, &
            0.057058,0.061576,0.059549,-0.135098,-0.035604,0.208035,-0.028062,-0.021055, &
            -0.106371,-0.159177,0.123669,0.032009,-0.061234,0.310033,0.094270,0.205369, &
            0.138164,-0.019615,0.083045,-0.018713,-0.051078,0.197474,0.014023,0.135146, &
            0.108173,0.011894,-0.040943,-0.023983,-0.027774,0.491794,-0.092168,-0.045016, &
            0.162010,-0.100377,0.028600,-0.176679,-0.081357,0.399745,0.091560,-0.069261, &
            0.751859,-0.184044,0.414896,-0.615883,-0.369906,0.269344,0.258583,0.640758, &
            0.175988,-0.194594,0.483977,-0.596722,-0.478183,0.571104,0.228248,-0.273402, &
            -0.674010,0.192791,0.124523,-0.283115,-0.517546,0.562839,0.346965,-0.411051, &
            -0.930594,0.110562,0.344198,-0.658363,-0.261246,0.192821,0.628983,-0.583795, &
            -1.291920,0.156959,0.281999,-0.568330,-0.303138,0.459863,0.559317,-0.869878, &
            -1.094038,0.365855,0.412394,-0.719955,0.394984,0.403175,0.521089,-0.475866, &
            -1.480435,0.366337,0.096320,-0.798457,0.564329,0.296204,0.363814,-0.435960, &
            -0.993773,0.151711,0.238137,-0.738635,0.786040,0.607240,0.296668,-0.028318, &
            -0.423045,0.139001,0.275169,-0.379202,0.363677,0.365636,0.107020,0.133624, &
            -0.118825,0.101394,0.370165,-0.272084,0.357348,0.365001,0.209378,0.578376, &
            0.476244,0.115505,-0.081193,-0.308165,0.076292,0.498253,-0.194398,0.150831, &
            0.168301,-0.101934,-0.273828,-0.233694,0.000407,0.290515,-0.218558,-0.207298, &
            0.040653,0.075462,-0.070001,-0.280817,-0.020922,0.217604,-0.212662,0.027659, &
            0.131848,-0.117220,0.044220,0.096202,-0.124045,0.349523,-0.229594,-0.097083, &
            0.141784,0.027389,0.095427,-0.102809,-0.014350,0.515896,-0.064417,-0.412258, &
            -0.119639,0.010379,0.018837,0.014205,-0.009763,0.398578,-0.150878,-0.396905, &
            -0.175174,-0.114499,0.184656,-0.062152,-0.151635,0.497778,-0.129219,-0.715405, &
            -0.302000,-0.094932,0.519806,-0.070213,-0.197100,0.195399,-0.128104,-0.552777, &
            -0.949794,-0.227991,1.284921,-0.685294,-0.959466,0.237591,-0.257538,-0.506292, &
            -0.313123,-0.387954,1.068613,-0.469995,-1.481446,0.202485,0.148269,-0.247627, &
            0.483561,-0.435006,0.938506,-0.088787,-1.358457,0.599464,0.092263,0.253511, &
            1.408057,-0.653077,0.941509,0.645411,-1.191631,0.517984,-0.117598,0.210717, &
            1.005294,-0.581096,0.782717,0.442588,-0.887275,0.498077,-0.294285,-0.073282, &
            0.394281,-0.160892,0.255577,0.471334,-0.693799,0.616163,-0.385358,-0.713050, &
            0.474250,-0.294511,0.198703,0.661867,-0.730584,0.509791,-0.256007,0.048419, &
            0.767211,-0.301988,-0.026913,0.322802,-0.110778,0.370932,-0.319793,-0.692502, &
            0.586316,-0.002732,0.041561,0.445064,-0.024915,0.525941,-0.253924,-0.527073, &
            1.220333,0.213500,0.499719,0.422578,-0.485153,0.600617,-0.209432,0.466899, &
            -0.072027,0.040565,0.040749,-0.013432,0.099634,0.426930,0.079627,-0.028028, &
            -0.023036,-0.061897,0.091558,0.036419,0.010647,0.217767,0.104396,-0.021683, &
            -0.127310,0.020580,-0.043047,-0.028600,0.009372,0.422706,-0.040890,0.067958, &
            -0.156319,-0.007841,-0.038587,0.025264,-0.021236,0.206220,-0.079629,0.186257, &
            -0.100402,0.011722,-0.023280,-0.017848,0.025079,0.254679,0.010020,0.193961, &
            -0.227161,-0.055339,0.005891,0.011154,0.025236,0.242078,0.073099,0.368764, &
            -0.095452,-0.030994,-0.057175,-0.037834,0.048699,0.054822,0.065081,0.172132, &
            -0.118760,0.002981,-0.116065,-0.016390,0.055144,0.308797,-0.025774,0.219477, &
            0.246343,-0.051926,0.015632,-0.053832,-0.107271,0.353955,-0.066326,0.103885, &
            -0.126375,0.024544,0.193120,-0.129672,-0.095147,0.234896,-0.002395,-0.152203, &
            -0.313613,-0.069460,0.098884,-0.106871,-0.009128,0.126459,-0.031185,-0.707898, &
            0.248201,-0.229651,-0.130099,0.123490,-0.038108,0.170741,0.058350,0.207892, &
            -0.386831,0.027547,0.144953,0.117635,0.060362,0.201912,0.027329,0.158782, &
            0.411298,-0.017510,-0.249521,-0.222098,0.164044,0.143066,0.054817,-0.000123, &
            0.744333,-0.152931,-0.126774,0.202819,-0.052107,0.414951,0.040797,0.468887, &
            0.535224,-0.082810,-0.075587,0.240245,0.026148,-0.008404,0.049138,0.260401, &
            0.391951,-0.119697,0.057212,0.265860,0.004129,0.327035,0.050996,0.230849, &
            -0.291115,0.162633,-0.127577,-0.234781,0.022788,0.297928,-0.190619,-0.341610 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.071346,-2.044310, &
            3.066396,-3.759479, &
            -1.193429,-1.369626, &
            2.266867,1.102412, &
            -3.729965,-0.437072, &
            0.318052,-0.631825, &
            1.669147,-1.846954, &
            -1.642845,0.037818 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.040132,-0.614227/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.761829,1.239497,0.141461,0.939209,-0.66965,0.543327,2.888953,-0.95803/)
real, dimension(2) :: bias2 = &
(/-0.020792,-0.456443/)
real, dimension(1) :: bias3 = &
(/0.072521/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
