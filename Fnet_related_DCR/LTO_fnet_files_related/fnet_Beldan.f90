module fnet_Beldan

! a = 4.5804e-005
! b = 0.091868

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.100149,0.014077,-0.030119,0.092100,-0.187562,-0.027031,0.415535,0.080907, &
            0.047053,0.137121,-0.032381,0.018749,-0.096006,0.034613,0.321469,0.092091, &
            0.033687,0.053748,-0.043155,-0.097200,-0.081539,-0.004055,0.125389,-0.013570, &
            0.073133,0.124837,0.086200,-0.006352,-0.071583,0.015922,0.124291,-0.018548, &
            0.056957,0.011075,0.058912,-0.050831,-0.080354,0.001918,0.141284,0.049739, &
            0.072571,0.092473,0.080046,-0.019182,-0.067042,-0.034336,0.110424,-0.053097, &
            0.081011,0.072987,0.071547,-0.040006,-0.083117,-0.019078,0.169816,0.011746, &
            0.083855,0.066717,0.059877,-0.082583,-0.053123,0.021718,0.184599,0.138376, &
            0.565530,0.211768,1.208026,0.045190,-0.279761,0.145456,0.971735,0.430269, &
            0.362016,0.690239,1.173409,0.021028,-0.153425,0.156313,0.820063,-0.081291, &
            0.188159,0.474468,0.573677,-0.556807,-0.391093,0.577606,0.610524,0.220775, &
            0.156747,0.675782,0.759490,-0.583141,-0.086942,0.254980,0.867530,0.075516, &
            -0.046305,0.215107,-0.630751,0.117163,-0.036101,0.326228,0.583055,0.405765, &
            -0.121583,0.117082,0.292600,-0.077792,0.114331,0.459817,-0.017846,0.361175, &
            -0.060123,0.271338,1.742891,-0.400594,-0.041042,0.582344,-0.393056,-0.170497, &
            0.461238,0.271164,2.556724,-0.140687,-0.369225,0.306795,-1.045515,-0.617661, &
            0.471746,-0.071642,0.740584,-0.150050,-0.060718,-0.227336,-0.144368,0.359835, &
            0.478969,-0.083402,1.449070,-0.588871,-0.034637,0.058510,-0.658867,0.015015, &
            0.209008,-0.556539,0.196764,0.043390,-0.042520,-0.037473,-0.751710,-0.330339, &
            0.283902,-0.425836,0.210008,-0.261662,-0.037933,-0.107545,-0.698769,-0.193991, &
            0.258408,-0.204920,0.344231,-0.090350,-0.010577,-0.071792,-0.379205,-0.219862, &
            0.041484,-0.363170,-0.115638,-0.415517,0.150358,-0.043431,-0.383294,-0.194276, &
            0.140800,-0.056247,-0.228143,-0.210128,0.090765,-0.082382,0.023870,-0.048840, &
            0.138276,0.005522,-0.183197,0.220684,0.007599,-0.013605,-0.045861,-0.234266, &
            -0.053722,-0.163010,-0.174280,0.105161,0.174665,-0.002714,0.012079,-0.200183, &
            -0.046116,-0.226242,-0.550825,0.376372,0.134766,0.010769,0.283640,-0.163481, &
            -0.261896,-0.183138,-0.707589,0.358646,0.495033,0.480619,-0.057038,-0.619655, &
            -0.070489,-0.113581,-0.268613,-0.370025,0.441659,0.487720,-0.551740,-0.987853, &
            -0.672120,-1.177285,-1.005235,-0.501069,0.279778,1.168288,-1.347159,-1.173408, &
            0.331648,0.247814,0.559924,0.661035,-0.095604,-0.015727,-0.552658,-0.642012, &
            0.218503,0.093332,-0.495826,0.410364,-0.721590,0.114333,-0.403183,-0.385907, &
            0.667893,0.217252,-0.636571,-0.167173,-0.448047,0.158120,-0.086719,-0.050788, &
            -0.059637,0.456412,0.532109,-0.229003,0.346936,-0.350381,-0.276338,-0.167624, &
            -0.285690,0.537015,0.146009,-0.500592,0.039200,0.366796,0.033436,-0.262591, &
            -0.160893,0.947665,-0.204132,-0.305620,-0.109737,0.467009,0.479810,-0.740512, &
            -0.032163,1.359558,0.339296,0.344052,-0.080613,-0.227002,1.361372,-0.587043, &
            -0.194314,-0.778704,-1.358633,-1.222695,-0.104672,0.627707,-0.932438,0.100539, &
            -0.813850,-0.767265,-1.005756,0.230759,-0.544294,0.180811,-0.992379,0.299996, &
            -1.532567,-0.552472,-0.899509,0.694508,-1.050170,0.195655,-1.064898,0.632397, &
            -1.856877,-0.945027,-0.815696,0.618123,-1.709534,0.221902,-1.116456,0.594226, &
            -1.848335,-0.976303,-0.987104,0.887025,-2.200299,0.156037,-0.974722,0.773981, &
            -2.068940,-1.241377,-1.271795,1.268715,-2.298151,0.025208,-1.239079,1.053197, &
            -2.211297,-1.284240,-1.549725,1.785625,-2.940462,0.023096,-1.533552,1.038755, &
            -2.767686,-0.883005,-1.127954,2.639070,-3.545983,-0.422375,-2.243389,2.001672, &
            -6.124885,1.400786,1.558675,5.205580,-6.795367,-4.577002,-5.935327,6.098790, &
            -5.638660,0.868894,1.935511,7.895913,-6.306198,-6.074455,-6.818063,5.366994, &
            -2.406982,-1.548154,0.046484,8.568516,-3.402934,-4.347069,-4.378397,1.656735, &
            -1.028450,-1.373363,-1.294615,7.431910,-1.965727,-1.872067,-2.759407,0.512324, &
            0.288939,-1.710246,-4.006893,4.911213,-0.944990,-0.096559,-1.737997,-0.107563, &
            0.562654,-0.978533,-3.934998,3.844920,-0.187584,0.336483,-0.878634,0.464071, &
            0.114848,-0.244150,-2.120351,2.546794,-0.245655,0.238800,-1.165985,0.144002, &
            0.711125,-0.111959,-1.800159,2.288632,0.144106,0.728686,-1.707275,-0.329228, &
            0.433564,0.370756,-0.681634,1.426440,0.182923,0.153481,-1.152189,-0.226468, &
            1.845823,1.908300,1.166268,0.140212,-0.011726,-0.372823,-0.540578,0.102197, &
            0.353700,-0.332995,-0.647261,0.598748,0.208481,-0.077905,-0.154213,0.945109, &
            0.263737,-0.375866,-0.378672,1.071775,0.022901,-0.021835,0.070793,0.977701, &
            0.507910,-0.497773,-0.499176,1.224816,0.145318,-0.429967,0.084557,0.802952, &
            0.154715,-0.422577,-0.497574,1.147115,-0.282621,-0.356623,0.070367,0.952076, &
            -0.001119,-0.141828,0.040756,1.260135,-0.325063,-0.579933,-0.090113,1.006839, &
            -0.022357,-0.330857,-0.095113,1.101048,-0.258151,-0.754728,0.241247,1.323177, &
            0.073900,-0.220549,-0.225017,1.095185,-0.281322,-0.811985,0.328272,1.421361, &
            -0.280998,-0.313751,-0.144822,0.773695,-0.435844,-0.805690,0.086433,1.462213, &
            -1.254239,-0.396417,-0.078612,-0.169176,-0.755096,-0.408019,-0.418325,2.044546, &
            -1.928409,-0.058375,-0.181704,-0.158385,-1.186777,-0.279708,-0.795741,1.352219, &
            -2.164790,0.798077,1.265990,1.694465,-1.410779,-1.530735,-0.712516,0.973991, &
            -0.693050,-0.050644,0.154227,-0.411032,-1.143710,0.100224,0.100616,-0.237038, &
            -0.069534,0.152066,0.621493,-1.069724,-0.800227,0.139403,-0.459995,-0.689045, &
            -0.300092,0.461828,0.482926,-0.993130,-0.859616,0.030260,-0.403405,-0.569254, &
            -0.256288,-0.194882,0.436796,-0.306804,-0.588622,0.069927,0.890373,-0.587284, &
            0.165641,0.075396,-0.787332,1.026579,-0.861802,-0.430411,0.766252,-0.027552, &
            0.507523,1.476106,-1.151760,2.006108,-0.749494,-0.565834,0.161997,-0.027287, &
            2.000790,3.509249,-1.065648,1.966630,0.083437,-0.288367,1.500101,-0.765707, &
            -0.118829,-0.344186,-0.078228,0.005383,0.214094,-0.295135,-0.263178,-0.482078, &
            0.146366,0.236546,-0.071770,0.160877,0.088148,-0.078338,-0.164831,-0.157856, &
            0.134519,-0.042833,-0.086263,0.077454,-0.130522,-0.161047,-0.011274,-0.184166, &
            -0.012453,-0.074310,-0.091429,0.303080,0.192781,-0.030665,-0.028745,0.253522, &
            0.063642,0.076472,-0.000421,0.084594,0.025244,-0.106398,0.059685,0.066279, &
            -0.021359,-0.007879,-0.155791,0.088432,0.000064,0.077186,-0.120605,0.065825, &
            0.154324,-0.056218,-0.156987,0.071739,0.065012,-0.311622,-0.123887,-0.056307, &
            -0.108811,-0.228086,-0.187471,-0.032116,0.107019,-0.352236,-0.178892,-0.321043, &
            -0.088166,-0.210321,-0.845533,0.216381,0.125445,-1.230614,-0.500726,-0.684777, &
            -0.355426,-0.032212,-0.729643,-0.029509,-0.227259,-1.192535,0.112436,-0.234313, &
            -0.479402,-0.581161,-0.178857,-0.567403,-0.109685,-0.237649,0.542631,-0.155818, &
            -0.428794,-0.577411,-1.451763,-0.478398,-0.078198,-0.021102,0.348978,0.454065, &
            -0.254605,-0.387751,-0.935939,-1.047273,-0.417228,0.001583,0.507162,0.857721, &
            -0.086171,-0.375751,-1.534123,-0.602777,0.205472,0.170261,-0.175108,0.733448, &
            -0.441263,-0.590289,-0.838911,-0.554950,0.204940,0.356163,0.214425,0.826045, &
            -0.444959,-0.236686,-0.040541,-1.026583,0.074946,0.151692,0.129079,0.320078, &
            -0.635272,-0.777878,-0.513441,-0.595555,0.463241,-0.085011,-0.382042,0.343933, &
            -0.154378,-0.465537,-0.539987,-0.171734,0.526768,0.187857,-0.439487,0.347116, &
            -0.234297,-0.762806,-0.604550,-0.253579,0.323806,-0.204604,0.169854,-0.037158, &
            -0.063485,-0.467335,-0.370798,-0.073437,0.129756,-0.014287,0.040221,0.103010, &
            0.049304,-0.150372,-0.131764,-0.203654,0.249754,-0.404615,0.044242,0.144954, &
            0.023223,-0.391524,-0.189200,-0.017438,0.228724,-0.307042,0.034370,0.097428, &
            0.223960,-0.281480,-0.139862,0.056833,0.161421,-0.327728,-0.197153,0.106855, &
            0.142404,-0.135166,-0.244162,-0.248342,0.176767,-0.319351,-0.206663,-0.100668, &
            0.251232,0.046565,-0.038786,-0.333707,0.208365,-0.367854,-0.180721,-0.102901, &
            0.148404,0.149024,-0.188949,-0.083334,0.305485,-0.145980,-0.427211,-0.085106, &
            0.727452,-0.084715,-0.237240,-0.278721,0.412372,-0.167136,0.050403,-0.706921, &
            0.441987,0.593635,0.233643,-1.035848,0.401049,-0.094370,-0.445409,-0.488080, &
            0.260409,-0.205690,-0.422954,-2.013090,-0.013896,0.594929,-0.074797,-0.291146, &
            -0.387210,-0.058297,0.581441,0.051440,-0.141290,0.126905,-0.001095,0.103751, &
            0.069147,-0.319808,-0.697016,0.149898,-0.089396,0.862585,0.130415,0.420298, &
            0.147387,-0.367044,-1.354977,-0.154606,-0.124767,0.823401,0.446920,0.726520, &
            -0.333160,0.379032,0.338827,0.221797,0.080519,-0.428007,0.215649,0.470185, &
            0.114771,0.116063,0.028127,-1.061300,0.221993,-0.057226,0.273658,0.399770, &
            0.439632,0.153391,0.047162,-0.747597,0.079337,-0.018977,-0.336219,0.166005, &
            0.184373,-0.127303,0.639192,0.513063,0.237999,-0.331416,-0.307309,-0.060274, &
            -0.005502,0.720535,-0.079508,0.198520,-0.157435,-0.124292,0.397314,-0.553683, &
            -0.097647,0.422044,-0.996649,0.254018,0.002613,-0.167594,0.558650,-0.690532, &
            -0.275966,0.576556,-1.357330,0.549900,-0.018515,0.007025,0.855424,-0.848322, &
            -0.075434,0.544570,-0.558915,0.383919,-0.092811,-0.015820,0.654753,-0.658630, &
            -0.178433,0.248176,-0.200758,0.343342,-0.079434,0.143016,0.627431,-0.412590, &
            -0.130380,0.154266,0.006802,0.191749,0.008282,0.086310,0.401441,-0.273328, &
            -0.117559,0.244661,-0.148834,-0.036104,-0.027491,0.050347,0.356446,-0.367127, &
            -0.101925,0.190282,-0.115542,0.035083,0.030802,0.014421,0.298568,-0.311048, &
            -0.230590,-0.149280,0.395001,-0.610381,0.107462,0.262271,0.254601,-0.320515, &
            -0.076536,-0.217060,1.126574,-0.562095,0.113640,0.197008,-0.074268,0.371328, &
            -0.116999,-0.316415,0.769972,-0.507598,0.092645,0.243033,-0.148657,0.405688, &
            -0.168131,-0.155319,0.185015,-0.411111,0.187324,0.291895,-0.160531,0.148855, &
            0.033556,-0.689463,0.690844,-0.126664,0.076029,0.117532,-0.024888,0.801123, &
            0.034698,-1.397095,0.496938,-0.170005,0.511930,-0.524150,-0.577981,1.168617, &
            0.016705,-0.489622,0.026363,0.372087,0.059930,-0.060257,-0.086318,0.242280, &
            -0.168374,0.651926,-0.396644,0.191881,-0.076724,0.238711,0.154405,-0.562980, &
            0.049592,0.388182,-0.225058,0.246432,-0.122187,-0.212717,0.255082,-0.365568, &
            -0.124913,-0.698318,-0.138815,-0.170821,-0.048471,-0.024869,-0.088162,0.355417 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.185840,2.763026, &
            1.522648,-0.506055, &
            2.061744,0.990812, &
            1.399184,1.337581, &
            -3.123219,1.186713, &
            -2.638168,0.870148, &
            -0.891986,0.706871, &
            1.620871,0.206625 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.566154,1.590481/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.397336,-0.584112,-0.175474,-0.668197,1.305469,-0.633307,0.671095,-0.273863/)
real, dimension(2) :: bias2 = &
(/0.127329,-0.232773/)
real, dimension(1) :: bias3 = &
(/0.350781/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
