module fnet_ORRSL

! a = 0.00057239
! b = 0.038113

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.050874,-0.004581,0.145821,-0.033895,0.066158,0.190045,0.234347,-0.042565, &
            -0.033005,0.020637,0.043147,0.006856,0.037438,-0.030098,0.037817,0.032181, &
            0.011990,0.027482,0.014525,0.054692,0.029065,-0.070228,0.097097,-0.041524, &
            -0.011909,0.078169,0.043133,0.023595,0.034298,-0.047854,0.038407,0.056001, &
            -0.060851,0.049452,0.058800,0.027974,0.052843,-0.041237,0.031509,0.060882, &
            -0.023950,0.024439,0.023210,0.091225,0.032305,-0.146479,0.134266,0.002305, &
            -0.044876,0.032671,0.036461,0.012018,0.048438,-0.018799,0.095736,0.050204, &
            -0.021737,0.028461,-0.023827,0.140685,0.011326,-0.261655,0.184723,0.010391, &
            -0.224817,0.162496,0.097713,0.131421,0.430124,-0.316025,0.729595,0.245644, &
            -0.046602,-0.166213,-0.225999,-0.203877,0.142953,0.668236,0.099685,-0.223282, &
            0.115114,0.016318,-0.390842,-0.319109,-0.144579,1.016386,-0.232818,-0.061819, &
            -0.055211,-0.133380,-0.420450,-0.420440,-0.027155,1.061809,-0.172757,0.145738, &
            -0.019684,-0.147521,-0.314541,-0.255403,-0.292586,0.541595,-0.408479,-0.005820, &
            0.242558,0.165529,-0.250111,-0.191425,-0.109141,0.349345,-0.255311,-0.114262, &
            0.160247,-0.142513,-0.582377,-0.021462,0.362532,-0.251973,-0.403681,-0.156571, &
            0.243657,-0.285957,-0.687659,-0.110920,0.557256,0.162538,0.293550,-0.245504, &
            0.196960,-0.538097,-1.040490,0.103453,0.297470,-0.132327,0.378292,-0.224356, &
            0.265017,-0.349784,-1.262668,0.491268,-0.157137,-0.781921,0.466167,0.392176, &
            -0.337491,-0.271880,-0.407128,0.012548,0.313800,-0.650561,-0.570355,0.436036, &
            -0.096342,-0.126728,-0.427603,0.007762,0.277540,-0.578054,-0.502561,0.273900, &
            -0.189912,-0.251710,-0.185256,0.123647,0.069832,-0.500440,-0.372600,0.012331, &
            -0.082402,-0.147386,-0.193305,0.081612,0.074264,-0.367344,-0.472288,-0.073974, &
            -0.067072,-0.139799,-0.157919,0.026928,-0.091974,-0.502310,-0.595940,0.067199, &
            0.049022,-0.155433,-0.334727,0.123318,-0.190329,-0.604588,-0.460066,0.016163, &
            -0.121047,-0.177298,-0.074760,-0.011917,-0.218689,-0.294568,-0.714092,0.078477, &
            -0.147796,-0.426513,0.032053,-0.115995,-0.485958,-0.414010,-0.735963,0.063779, &
            0.512154,-0.644658,0.465536,-0.128754,-1.136660,-0.712074,-0.517673,0.280316, &
            0.416467,-0.776565,0.355371,-0.105545,-0.324632,-0.354225,0.401953,0.184970, &
            0.406452,-0.686430,0.182774,-0.031981,-0.417907,0.358147,0.364102,-0.048146, &
            0.445073,-0.441625,-0.030200,-0.386141,-0.432265,0.765564,0.176860,0.035469, &
            0.327728,-0.311768,-0.218800,-0.054553,0.169938,0.071677,-0.291051,-0.077636, &
            0.338044,-0.051610,-0.291684,0.081020,0.552685,-0.617921,-0.404750,-0.038861, &
            0.002850,-0.172659,-0.397240,0.057091,0.763030,-0.230735,-0.067020,-0.045662, &
            -0.225417,-0.314371,0.060112,0.099828,0.504212,-0.252930,0.335087,0.195376, &
            0.209067,0.079522,0.155365,-0.042329,-0.461086,-0.273516,-0.138516,0.107598, &
            0.365433,0.813880,0.507277,-0.262212,-1.061892,0.298854,0.158004,0.761011, &
            0.254021,0.793089,1.241143,-0.274317,-0.071533,0.097157,1.106502,1.460121, &
            -0.065563,0.940524,1.181274,-0.094688,-0.677178,0.207355,1.411186,1.341490, &
            -0.260348,0.860937,1.352547,-0.151054,-0.481284,0.114993,1.413915,1.174750, &
            -0.498195,1.389775,1.582558,0.050809,-0.604178,0.108531,1.154200,1.181303, &
            -0.559828,1.297654,1.932581,0.058972,-0.602784,0.128780,1.224260,0.879011, &
            -0.705622,1.885156,2.508395,0.032369,-0.350460,0.115416,0.998246,1.078785, &
            -0.909702,2.147112,2.768483,0.071509,0.006095,-0.162562,1.151938,0.990185, &
            -1.380929,2.458525,2.766616,0.112968,0.131820,-0.299110,0.961508,1.078073, &
            -5.811839,6.032059,1.072539,0.083449,-1.126629,-0.439561,3.725598,-0.429134, &
            -7.721876,8.013214,1.156284,0.119218,-0.138766,-0.855954,5.505625,0.107112, &
            -7.269533,7.042792,1.215907,0.125463,-1.497865,-0.389813,5.720582,1.232013, &
            -5.652655,5.804556,0.134845,0.209612,-2.918073,-0.380801,4.343433,1.938040, &
            -4.380462,4.215693,-0.200359,-0.130301,-3.361263,0.038888,2.230454,2.462137, &
            -3.545334,2.894544,-0.293297,0.190512,-2.791547,0.203473,0.618793,3.247744, &
            -3.036650,1.846690,-0.531516,-0.232208,-2.621049,-0.005462,0.011617,3.242688, &
            -2.295478,0.820307,0.302538,-0.325999,-1.883957,0.404277,-0.549250,3.264583, &
            -1.593538,0.933344,0.691599,-0.120294,-2.025173,0.231204,-0.022096,2.288529, &
            -1.958564,1.997886,0.780378,-0.126700,-2.870163,0.390408,0.640126,1.847445, &
            -0.695725,0.864195,1.028005,-0.581893,-0.512034,2.291089,1.255289,1.215280, &
            -0.792469,0.874170,1.074079,-0.632185,-0.463722,2.582601,1.190335,1.403047, &
            -0.587332,0.753764,1.241007,-0.230699,-0.282348,2.752058,1.013989,1.425325, &
            -0.814105,0.810104,1.008850,-0.510779,0.288691,2.592957,1.310430,1.512323, &
            -0.834709,0.921981,1.181092,-0.313810,0.320328,2.184795,1.301206,1.455958, &
            -0.935530,1.117589,0.824000,-0.274482,0.572213,2.088624,1.424009,1.185354, &
            -0.821270,1.500315,0.924626,-0.574551,0.692376,2.004008,1.225767,1.499709, &
            -1.284975,1.350268,0.817139,-0.660519,1.052668,1.961917,1.257017,1.260857, &
            -2.015932,2.069801,0.368306,-0.781092,1.581652,1.138007,1.643525,0.964032, &
            -2.262183,2.707651,-0.369409,-1.005438,1.644500,1.220508,2.024103,0.840908, &
            -2.004757,2.563725,-0.058348,-0.482385,1.037916,0.137798,2.248775,0.891523, &
            -1.174225,2.165853,0.263884,0.031866,0.870605,-0.278307,1.030758,1.321120, &
            -0.935737,1.227012,0.719882,-0.417552,0.666786,0.434387,0.313666,1.208362, &
            -0.782383,0.939484,0.675099,-0.402643,-0.071654,0.150104,0.041501,0.806762, &
            -0.356940,0.867084,0.887824,0.362438,-0.650944,0.083703,0.272811,0.453564, &
            -0.391434,0.971225,0.849269,0.345056,-0.996862,-0.336470,0.788750,0.156695, &
            -0.342961,1.095743,0.988564,0.659708,-0.863466,-0.655181,0.537050,-0.072050, &
            -0.510908,1.338250,1.299281,0.377161,-0.526788,-1.016080,0.788274,0.168921, &
            0.011302,-0.067188,0.144108,0.061280,0.077876,-0.167805,0.016220,-0.306248, &
            -0.030387,-0.108470,0.004179,-0.036409,-0.063887,0.174328,0.114896,-0.030294, &
            -0.017003,0.041543,0.040689,0.095661,-0.005696,-0.073198,0.014311,-0.001123, &
            -0.074075,-0.176547,-0.040897,-0.026665,-0.042131,0.045304,0.076859,0.024687, &
            0.121646,0.112413,-0.029012,0.031736,0.054795,0.151117,-0.198692,-0.161447, &
            -0.100582,-0.144187,0.098945,-0.088314,0.060509,0.096662,-0.051892,-0.019649, &
            0.071217,-0.045143,-0.081537,0.038044,-0.112428,0.074315,0.120597,-0.081588, &
            0.073860,-0.032859,0.129472,0.066085,0.267724,0.039571,0.194733,-0.276668, &
            0.101172,-0.183610,0.146397,0.152544,1.099185,-0.699174,0.192347,-0.592655, &
            0.204514,-0.216391,0.042171,0.151807,0.040167,-0.520949,-0.101017,-0.542188, &
            0.433644,-0.354064,-0.120201,0.373667,-0.416119,-0.911857,-0.077261,-0.279221, &
            -0.005359,-0.389446,-0.086889,0.692826,-0.563659,-0.927715,-0.404190,-0.712040, &
            0.091852,-0.569654,-0.344610,0.836816,-1.180954,-0.479195,-0.558537,-0.231124, &
            -0.096512,-0.043436,0.126222,0.869382,-0.627842,-0.823839,0.359011,-0.672691, &
            -0.164222,0.114973,0.358969,0.539323,0.025197,-0.571007,0.207461,-0.555217, &
            -0.485762,0.390056,0.274540,0.444115,0.551500,-1.147514,0.062232,-0.363449, &
            -0.373458,0.096579,0.454617,0.206264,0.470606,-0.769618,-0.061710,-0.235587, &
            -0.375317,0.448954,0.553548,0.005639,0.852945,-0.779308,0.304044,-0.247231, &
            -0.261613,-0.123735,0.220321,0.108059,-0.426900,-0.166552,0.300015,0.175667, &
            -0.151572,0.074071,0.276837,0.079923,-0.150314,-0.285941,0.124581,0.209655, &
            -0.029515,0.024844,0.336874,-0.149605,-0.197804,-0.090211,0.395828,0.166327, &
            -0.154177,-0.150018,0.127489,-0.075240,-0.367372,-0.093870,0.091733,0.181893, &
            0.135379,-0.084174,-0.023950,-0.061778,-0.326284,-0.134002,0.433706,0.034291, &
            0.175398,-0.256688,-0.065691,0.060145,-0.535800,-0.107099,0.460013,-0.205485, &
            0.081529,-0.181185,-0.152478,-0.048644,-0.429551,0.193521,0.344355,0.021165, &
            0.297827,-0.168804,-0.486581,-0.127743,-0.749351,-0.034080,0.141090,-0.040369, &
            0.941553,-0.723795,-0.367526,-0.391560,-0.764331,0.369892,-0.342297,-0.748416, &
            1.449019,-0.952533,-0.621864,-0.534752,-1.182160,0.164933,-0.982095,-0.940540, &
            0.918997,-0.757027,-1.003769,-0.110077,-0.703416,0.356605,-1.109878,-1.250346, &
            0.705203,-0.561569,-0.913515,0.030297,-0.324419,0.123296,-0.422332,-0.976590, &
            0.833094,-0.281524,-0.471615,-0.329049,0.031553,-0.103104,0.009895,-0.912181, &
            0.604719,-0.348537,-0.252255,-0.280502,-0.114770,0.471517,-0.295528,-0.607877, &
            0.529415,-0.139427,-0.162479,-0.359920,0.074790,0.239498,-0.756344,-0.344478, &
            0.004652,-0.204926,0.230248,-0.288843,0.185749,0.833951,-0.677463,-0.361518, &
            0.345336,0.201675,0.093644,-0.253454,0.942082,0.867384,0.077210,-0.410755, &
            0.124031,0.361544,0.251889,-0.254398,1.314332,0.461138,0.691767,-0.114598, &
            -0.160510,-0.071194,0.060286,0.061507,-0.011930,-0.365458,0.098755,0.219567, &
            0.009307,-0.016142,-0.089272,0.082022,-0.020778,-0.152640,-0.085703,-0.007920, &
            -0.041787,0.003986,0.081860,0.004963,0.051605,0.018947,-0.111733,-0.060805, &
            0.001907,-0.066216,-0.082777,0.028769,-0.018503,-0.011127,0.020590,-0.046232, &
            0.012176,0.010484,0.043377,-0.026327,-0.000572,0.042179,0.030304,-0.022014, &
            -0.057654,-0.074218,0.005655,-0.024177,-0.019505,0.068987,-0.005886,0.002369, &
            0.014308,-0.049236,0.007659,0.027063,-0.032144,0.009499,0.186917,-0.053837, &
            -0.005163,-0.069466,-0.058076,0.033255,-0.027524,0.022379,0.163573,-0.011796, &
            0.103598,-0.013150,-0.066962,-0.011807,-0.075463,-0.019504,0.178224,-0.025842, &
            -0.102451,-0.129343,0.101475,-0.045445,0.149323,-0.107686,0.176936,-0.056577, &
            -0.005423,-0.021774,-0.070425,0.038684,-0.058413,0.138263,-0.365850,-0.153498, &
            0.054875,0.012604,0.078414,0.035754,-0.020052,0.136573,0.123258,-0.205766, &
            0.075987,-0.014351,0.116608,-0.002913,-0.042679,0.111080,0.391755,-0.178104, &
            0.196384,0.469964,0.092914,-0.026239,0.088419,-0.029623,-0.456839,-0.010564, &
            0.250000,0.143128,0.261051,-0.102960,-0.189120,0.024694,0.218985,-0.122799, &
            0.041406,0.020416,0.038132,-0.080879,0.166943,0.054591,0.073550,-0.054517, &
            -0.107648,-0.086165,-0.169111,0.091684,0.009455,-0.026489,-0.122962,0.008077, &
            -0.149812,-0.281416,-0.234892,0.052165,0.146006,-0.320493,0.076862,-0.013604 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.505483,-3.308221, &
            -1.074329,2.654098, &
            1.120641,-0.761000, &
            2.016501,-0.283725, &
            1.925866,-3.705505, &
            -0.418737,-0.803979, &
            -0.017055,1.565928, &
            1.176833,-0.855906 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.2203,-2.028798/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.22301,-1.327288,1.589915,1.560939,1.196296,0.617439,-1.783313,0.997679/)
real, dimension(2) :: bias2 = &
(/0.321957,0.243107/)
real, dimension(1) :: bias3 = &
(/0.921837/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
