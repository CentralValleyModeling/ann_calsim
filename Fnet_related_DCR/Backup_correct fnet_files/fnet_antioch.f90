module fnet_antioch

! a = 8.5267e-005
! b = 0.087541

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.200062,0.304986,-0.138855,-0.056821,0.010056,-0.296414,0.186317,0.090325, &
            0.085091,0.138557,-0.031769,0.039416,-0.167044,-0.068652,0.341191,0.132415, &
            -0.028633,0.083709,0.117629,-0.011780,-0.041652,-0.072024,0.144765,-0.072603, &
            0.035530,-0.004770,0.006679,0.036574,0.011262,0.009660,0.098043,0.072641, &
            0.133758,-0.093114,0.177849,-0.158912,0.039466,-0.166412,0.271440,0.202435, &
            -0.013181,0.089112,0.155724,-0.122388,0.085207,-0.150179,0.204094,0.153912, &
            -0.148108,0.004457,0.153292,0.039052,0.088210,0.084761,0.084203,0.098498, &
            -0.101988,-0.018444,-0.022781,-0.229958,-0.028911,-0.019012,0.147851,0.045512, &
            0.216541,0.384786,-0.310123,0.005300,-0.128381,-0.114583,0.048648,-0.347896, &
            0.078539,0.489317,-0.108810,-0.062341,0.242245,-0.084262,-0.084470,-0.219929, &
            -0.189802,0.262034,-0.699930,-0.102128,-0.532888,-0.055278,-0.041265,-0.151326, &
            -0.506733,-0.091122,-0.002181,-0.199880,-0.017478,0.325805,-0.104614,-0.232331, &
            -0.311205,0.106165,-0.148502,-0.237005,-0.033538,0.053614,0.051159,0.355370, &
            -0.509803,-0.186831,0.007832,-0.148205,-0.018939,0.118930,-0.045186,0.601529, &
            -0.228658,0.054224,0.126030,-0.087827,-0.209927,-0.092832,0.211487,0.172697, &
            -0.182099,0.172927,0.272613,0.196475,-0.160351,-0.039270,0.171514,0.254943, &
            -0.065152,0.655690,0.085969,0.487192,-0.144398,0.476781,0.178557,-0.315739, &
            -0.007189,0.389889,0.147920,0.637961,-0.182113,0.189553,-0.195534,-0.217568, &
            0.173756,-0.006276,0.132489,-0.022488,0.246609,-0.045060,0.020731,0.089764, &
            -0.122393,0.121372,0.154472,-0.080848,-0.021532,-0.014829,-0.094080,0.053937, &
            -0.094043,-0.161254,0.202287,-0.302250,0.227977,0.169995,-0.142600,0.113143, &
            0.083949,0.030261,-0.146658,-0.278199,-0.119390,-0.080937,-0.050953,0.104112, &
            -0.073726,-0.042180,-0.049328,-0.343190,0.046309,0.157900,-0.137312,0.076604, &
            0.102451,0.135822,0.059431,0.079759,-0.164878,-0.155982,-0.226040,0.225070, &
            0.148750,0.271157,-0.202778,0.008240,0.055193,0.137592,-0.257122,0.176490, &
            0.021752,0.223016,0.066173,-0.230131,0.039683,0.045122,-0.476265,0.156406, &
            0.400410,0.133467,0.499741,-0.344583,0.083300,-0.163610,-0.848919,0.297052, &
            0.205257,0.369697,0.388618,0.039009,0.220032,0.280327,-0.990216,0.197902, &
            0.266144,-0.185126,0.002881,-0.286259,0.322482,-0.029705,-0.823365,0.068969, &
            0.447781,-0.164049,-0.009223,-0.121237,0.414898,-0.210639,-0.769192,0.300875, &
            0.236292,0.200813,0.011779,-0.030215,0.642667,0.099463,-0.263170,0.107850, &
            -0.091356,0.533299,0.102489,-0.014551,0.581166,0.409011,0.218727,0.145912, &
            -0.073415,0.087743,-0.189345,-0.091906,0.295572,0.391202,0.161555,0.300440, &
            0.553473,-0.113795,-0.177580,0.432412,0.333917,0.138929,0.050791,0.648503, &
            0.332218,0.309346,-0.059580,0.371002,0.041622,-0.023028,0.034759,-0.167303, &
            0.032631,0.135321,-0.255643,0.465472,-0.057363,0.123027,-0.126321,0.154261, &
            -0.113586,-0.140937,0.145205,0.949040,0.339580,0.757183,0.146163,-0.619213, &
            -0.528989,-0.617741,-0.411749,1.261668,0.580333,0.239988,0.201879,-0.787085, &
            -0.772370,-0.511209,-0.569705,1.664794,1.041465,0.067270,0.623730,-0.858407, &
            -1.270871,-0.576969,-0.628391,1.777407,1.437243,-0.055414,0.980424,-1.175639, &
            -1.491929,-0.862034,-1.302620,2.099889,1.403663,-0.722977,1.096556,-1.821089, &
            -1.562478,-1.343397,-1.356839,2.236138,1.853387,-1.178338,1.706224,-1.866350, &
            -2.241275,-1.740635,-2.017248,2.468719,2.260610,-1.724753,2.222825,-2.420735, &
            -2.550347,-2.252096,-2.688448,3.040017,3.037879,-2.148110,2.848505,-2.832988, &
            -5.363896,-4.420347,-4.935455,4.750119,5.434045,-4.615490,5.321794,-4.761817, &
            -4.688377,-4.747377,-4.924803,4.542346,4.923538,-5.211915,4.910171,-4.895405, &
            -1.997291,-4.220334,-2.798501,2.301271,3.154675,-3.904898,2.849931,-3.107295, &
            0.422125,-3.009683,-1.138276,0.083405,1.189521,-2.675784,0.858998,-1.686070, &
            0.943783,-2.856462,-0.634892,-0.560739,0.533265,-2.122112,0.493380,-1.061208, &
            0.806483,-2.223795,-0.516270,-0.717847,0.703460,-1.573932,0.372285,-0.724206, &
            0.926648,-1.729585,-0.498639,-0.276000,0.179245,-1.250350,0.337532,-0.240131, &
            0.962146,-1.009443,-0.206983,-0.394160,0.235276,-1.216749,0.369821,-0.183638, &
            0.832164,-0.521327,0.330371,-0.022092,-0.069434,-0.916894,0.470371,-0.290711, &
            0.490593,-0.147624,0.411123,0.322487,-0.071943,-0.894843,0.275789,-0.333373, &
            0.181830,-0.275133,0.240534,0.248664,0.081538,-0.198893,0.278659,-0.232575, &
            0.069044,-0.362126,0.211926,0.250380,-0.051235,0.021360,0.463999,-0.217334, &
            -0.031616,-0.413872,0.032480,0.719463,0.166954,-0.285240,0.600071,-0.541651, &
            -0.025009,-0.355107,0.083350,0.655948,-0.010237,-0.241701,0.537906,-0.558158, &
            -0.289438,-0.364552,-0.147111,0.711150,0.154556,-0.321128,0.668358,-0.779636, &
            -0.331390,-0.414017,-0.151881,0.602443,0.405212,-0.277633,0.633835,-0.704893, &
            -0.320318,-0.341436,-0.414274,0.772259,0.375882,-0.531137,0.737622,-0.677912, &
            -0.653841,-0.420161,-0.230568,0.822533,0.593978,-0.516792,0.588879,-0.893434, &
            -1.070009,-0.712218,-0.469477,0.949569,0.589420,-0.569920,1.253990,-0.898486, &
            -0.578755,-0.857745,-0.638224,1.002760,0.599082,-0.712180,1.045104,-1.034688, &
            -0.163042,-0.768984,-0.420042,0.558002,0.271488,-0.423690,0.637617,-0.738039, &
            0.337269,-0.907962,-0.436072,0.302696,0.474392,-0.515681,0.305981,-0.476990, &
            0.278399,-0.807757,-0.182212,0.049538,0.087718,-0.287755,0.401447,-0.725291, &
            0.575621,-0.427264,0.035490,-0.008011,-0.039520,-0.320952,0.334633,-0.103634, &
            0.401718,-0.103811,0.120530,0.089184,-0.254498,-0.062568,0.315696,0.000585, &
            0.297471,-0.055995,0.253233,0.104508,-0.167334,0.054085,0.310283,0.068966, &
            0.509374,0.594741,0.278739,0.121819,0.145636,-0.273613,0.241613,0.281602, &
            0.184983,0.340320,0.541942,0.477466,0.495604,-0.246413,0.625558,-0.151299, &
            0.075886,0.248143,-0.052252,0.118639,-0.317262,0.175937,0.001531,-0.159981, &
            0.238131,-0.025570,-0.235170,-0.150179,-0.039565,-0.084238,-0.183368,-0.153032, &
            0.034577,-0.002906,0.107487,-0.172114,0.036372,-0.094349,-0.071491,-0.121560, &
            -0.158121,-0.028394,0.093402,-0.095311,-0.070747,0.108865,0.186828,-0.040281, &
            -0.185510,0.113455,-0.191493,-0.225001,0.164121,-0.010177,-0.181039,-0.016338, &
            0.129321,-0.042174,-0.146622,-0.008697,0.169826,0.090849,-0.021051,-0.050031, &
            -0.006921,0.080490,0.006196,0.157698,-0.058106,0.022551,0.116726,0.093374, &
            0.139508,0.150384,-0.120378,0.363056,-0.005659,-0.165870,-0.093230,-0.123603, &
            0.376553,0.375103,0.019164,0.234346,-0.276190,0.228934,-0.090131,-0.158410, &
            -0.027118,0.152961,-0.789291,0.388339,-0.208061,-0.147097,0.071518,-0.396128, &
            0.164215,0.172759,-0.212844,-0.289349,-0.506331,0.007077,-0.329759,0.226648, &
            0.064994,-0.196105,-0.465492,-0.436767,-0.414787,-0.307514,0.215396,0.216089, &
            0.405316,-0.407806,-0.390492,-0.229582,-0.614443,-0.209544,-0.100942,0.118186, &
            0.310395,-0.202017,-0.513232,0.107481,-0.399414,-0.201567,-0.057321,-0.155921, &
            0.331668,-0.233599,-0.020334,-0.180141,-0.493127,0.085214,-0.134035,0.388007, &
            -0.497829,-0.286736,-0.201284,-0.090324,-0.185185,-0.255867,0.161409,-0.148143, &
            -0.462871,-0.056743,-0.152553,0.406466,0.121394,0.357305,0.338489,-0.094934, &
            -0.290521,-0.167416,0.225582,0.356841,-0.039672,0.135694,0.068698,-0.033965, &
            0.076573,0.145593,-0.032983,-0.359977,-0.056274,-0.386497,0.046503,-0.204305, &
            -0.101248,-0.083015,-0.066221,-0.306751,-0.320150,-0.111138,-0.197994,-0.064206, &
            0.136242,-0.183866,-0.144841,-0.308875,-0.096293,-0.136636,-0.222452,-0.001467, &
            -0.121367,-0.046783,-0.027022,-0.148075,0.048176,-0.075686,-0.219118,-0.078307, &
            -0.174063,-0.150229,-0.175016,-0.527453,-0.003980,-0.354192,-0.076655,0.196710, &
            -0.267757,-0.052767,-0.134824,-0.319061,0.010450,-0.184517,-0.104420,0.087598, &
            -0.097732,-0.157426,0.073986,-0.156893,-0.283975,-0.227262,-0.080963,-0.009173, &
            0.049957,0.062826,0.093630,-0.388881,-0.177982,-0.275674,0.016367,-0.046259, &
            0.311878,-0.047922,0.149445,-0.502701,-0.364638,0.289068,-0.698342,0.127299, &
            0.326816,0.235808,0.012668,-0.093058,-0.369097,0.198236,-0.363549,0.264068, &
            -0.102056,-0.221126,-0.170787,-0.192657,-0.000570,0.108549,-0.127963,0.132702, &
            -0.149117,-0.024919,0.155811,0.001629,-0.301363,0.311490,-0.007483,0.269373, &
            -0.352151,-0.090842,0.042688,0.068911,-0.162934,0.317233,-0.053269,0.164799, &
            -0.162565,0.142170,0.073461,0.107532,-0.088894,0.211542,-0.005810,0.145747, &
            -0.265165,-0.277745,0.451579,0.078484,-0.135944,0.292185,0.038847,-0.116139, &
            0.005981,0.203116,0.237520,0.275430,0.039865,0.140383,0.069788,-0.280352, &
            -0.293204,0.122598,0.427862,0.229441,-0.145603,0.330367,-0.175724,-0.204902, &
            -0.288736,0.077732,0.154481,0.290081,-0.171304,0.436334,-0.262003,-0.489527, &
            0.035405,0.091970,-0.007014,0.014224,-0.156922,-0.014396,0.213762,0.039929, &
            0.011899,0.056438,0.026368,0.015995,0.019804,-0.118518,-0.017267,0.062715, &
            0.009302,0.016129,0.069080,0.043157,-0.058421,0.034738,0.080306,-0.049722, &
            -0.055353,0.080610,-0.110416,-0.104928,-0.071266,-0.108037,-0.115093,-0.123603, &
            -0.103687,-0.049181,-0.018373,0.026809,-0.210574,0.138728,0.104656,-0.059075, &
            -0.105483,-0.084635,0.038134,-0.186767,-0.199415,0.008238,0.169869,-0.083633, &
            -0.052957,0.112481,0.074773,-0.049378,-0.030380,-0.210007,-0.018348,-0.032962, &
            -0.026761,-0.069333,0.124809,0.002223,-0.008129,-0.052286,0.080161,0.102464, &
            0.030154,-0.129077,0.166631,0.259184,0.152873,-0.098124,-0.276407,0.139864, &
            0.028788,0.085434,0.056439,0.057808,0.149536,-0.030696,-0.141940,-0.130517, &
            -0.176526,-0.073713,-0.056649,-0.225609,0.011440,0.211555,0.153847,0.034782, &
            0.245254,-0.047500,-0.122489,0.008788,0.261353,0.228912,0.046683,-0.050813, &
            -0.166479,-0.139938,-0.034302,-0.028275,0.259845,0.278893,-0.096773,0.151835, &
            -0.053705,-0.022725,-0.347411,-0.040206,0.145523,0.227391,-0.031406,0.292819, &
            0.070051,-0.009817,-0.034667,0.131899,0.083330,0.004002,-0.070548,0.090565, &
            0.077012,0.075625,0.047815,0.012780,0.062967,-0.125406,-0.077322,-0.049055, &
            -0.008027,-0.139811,-0.006696,-0.237404,0.210044,0.207993,0.083276,-0.003930, &
            0.171837,-0.028412,0.013035,0.035089,0.119135,0.268172,0.212149,-0.096418 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.302424,3.218681, &
            1.124442,4.281155, &
            -0.143519,4.488010, &
            3.699495,-2.959405, &
            1.110087,-2.664632, &
            1.854491,2.955620, &
            1.600673,-2.691667, &
            0.061197,3.742429 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.220962,1.412324/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.622994,1.345025,1.616302,-1.565772,-1.725908,1.582943,-1.747334,1.444325/)
real, dimension(2) :: bias2 = &
(/1.359838,-0.42057/)
real, dimension(1) :: bias3 = &
(/0.325874/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
