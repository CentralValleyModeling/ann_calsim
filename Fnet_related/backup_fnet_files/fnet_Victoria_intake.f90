module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.163159,0.047389,-0.031137,0.094151,0.052759,-0.110653,0.104516,0.409526 &
			,-0.010056,0.029435,0.075265,0.013707,-0.048020,-0.016809,0.001192,0.251439 &
			,-0.007484,0.029932,0.070063,-0.036823,-0.029572,0.044191,-0.051663,0.162271 &
			,0.007076,0.035268,0.053416,-0.036539,-0.025943,0.022654,-0.074827,0.173484 &
			,-0.032268,0.020553,0.033575,-0.076226,-0.040490,0.053116,-0.113094,0.163607 &
			,0.007339,0.046413,-0.024797,-0.087639,-0.049740,0.023657,-0.087749,0.048954 &
			,0.023722,-0.053503,-0.056299,-0.069797,0.037800,0.011419,-0.061377,0.001248 &
			,0.063665,-0.009674,-0.150281,-0.126171,0.006678,-0.021787,-0.026695,-0.206151 &
			,0.777348,0.128461,-0.906859,-0.334398,0.035660,-0.484734,0.169607,-0.304808 &
			,0.319854,0.516592,-0.194220,0.212726,-0.137218,-0.311167,0.161026,1.113018 &
			,0.093183,0.145404,-0.200634,0.613036,-0.121150,-0.265334,0.145135,-1.326411 &
			,0.008793,0.052075,-0.278141,0.339214,0.173022,-0.008565,0.325493,-0.801395 &
			,-0.036957,-0.333445,-0.141818,0.009608,0.202126,0.184674,0.189340,-0.590772 &
			,-0.084588,-0.088387,-0.015025,0.210281,0.086524,0.159406,0.044015,-1.060160 &
			,-0.145858,0.214190,-0.489531,-0.329358,-0.413921,-0.392966,0.594241,-0.328892 &
			,-0.174992,0.289587,-0.096440,-0.227389,-0.358651,-0.381828,0.063138,0.739170 &
			,-0.085806,0.104792,0.093570,-0.098465,-0.323752,-0.582450,0.011466,0.151379 &
			,-0.207579,-0.119163,0.071731,0.156252,-0.224261,-0.546550,0.413691,-0.759982 &
			,0.367851,0.169557,0.154381,0.264625,-0.024042,-0.642732,-0.261170,0.275123 &
			,0.142135,0.117964,0.260825,0.538826,0.047830,-0.295645,-0.024997,0.320367 &
			,0.039399,0.152905,0.132854,0.489689,-0.060949,-0.329603,-0.101008,0.521710 &
			,-0.096184,-0.063924,0.122523,0.357497,-0.100879,-0.142436,0.069559,0.376224 &
			,0.072342,0.306518,0.035488,0.173967,-0.111552,0.074421,-0.138417,0.219079 &
			,0.038703,0.248782,0.181450,0.049116,-0.305528,-0.092419,-0.231973,0.263989 &
			,-0.043062,0.157342,0.185811,0.000495,-0.319901,0.115934,-0.086596,0.413655 &
			,-0.027960,0.302499,0.348783,0.265643,-0.421494,0.122575,-0.342694,0.531932 &
			,-1.278031,0.600889,0.851050,1.348226,-0.699462,1.224780,-0.679609,-0.575200 &
			,-1.602678,0.625180,0.375035,0.723034,-0.497771,0.570707,-0.396643,-0.964045 &
			,-0.904630,0.473730,-0.344955,-0.180841,-0.303222,-0.381545,-0.395730,0.072200 &
			,-0.964194,0.013460,0.290883,0.212756,0.236400,-0.193814,-0.553227,1.370695 &
			,-0.938257,-0.079726,0.254217,-0.042305,-0.005295,0.137681,-0.593624,0.562900 &
			,-0.452290,-0.219504,-0.027680,-0.451969,-0.265470,-0.295649,-0.021400,0.057604 &
			,-0.267939,-0.480973,-0.143633,-0.162667,0.288738,-0.231601,0.107900,-0.006537 &
			,-0.014351,-0.049938,-0.131209,0.158947,0.162151,-0.524229,0.087442,0.447829 &
			,0.072267,0.334689,-0.436917,-0.114040,0.438478,0.012903,-0.119203,0.934169 &
			,-0.193881,-0.974434,-0.293611,-0.716688,1.434877,1.379896,-0.823193,1.195574 &
			,-0.089088,-0.239279,0.054077,-0.315772,-0.040249,0.518482,-0.586438,-0.564618 &
			,-0.279593,-0.168753,-0.081145,-0.119792,0.146029,0.299417,-0.379999,-0.379636 &
			,-0.243034,0.003581,0.186611,0.035767,0.071205,0.356146,-0.074224,-0.400691 &
			,0.045056,-0.140923,0.426882,0.284964,0.053678,0.086959,-0.145085,-0.114635 &
			,0.201789,-0.239481,0.304279,0.109647,0.183580,0.168224,-0.178950,0.207257 &
			,0.279853,-0.353715,0.427391,0.269106,0.166797,0.210134,-0.133881,0.654790 &
			,0.542149,-0.186151,0.303865,0.103732,0.290216,0.172001,-0.329904,0.942219 &
			,0.765534,-0.404607,0.339945,-0.287376,0.121986,0.136102,-0.285272,0.923742 &
			,5.631753,-0.691558,0.198699,-0.380895,-0.321023,3.065764,-0.376696,0.686585 &
			,9.703855,-0.447985,-0.155132,0.735529,-0.189323,7.081288,1.082466,-0.001292 &
			,12.508056,0.363302,0.179173,0.750376,-0.303602,8.814273,0.373230,-0.247763 &
			,11.482162,-0.034461,0.525128,0.075127,-0.514486,8.435476,0.143309,0.890133 &
			,9.078459,-0.144425,-0.322715,-0.507278,-0.392133,7.763094,-0.239247,1.823325 &
			,5.789032,0.106303,0.020632,-0.210083,0.335676,5.397165,-0.110987,0.136574 &
			,4.385985,-0.300120,-0.762709,-0.508239,1.007575,3.978205,0.000856,-0.190710 &
			,3.217235,-0.362573,-0.520371,-0.427612,1.486486,3.546242,-0.364937,0.536039 &
			,2.115661,-0.388490,-1.066656,-0.007088,1.909083,4.053271,0.554409,0.281291 &
			,1.815587,-1.642087,-0.231881,0.247413,1.731254,5.689209,0.325486,-0.585697 &
			,0.638621,0.237903,-0.538752,-2.703805,0.110063,0.213701,-0.448526,0.307292 &
			,0.484219,0.257065,-0.934855,-1.811732,-0.324713,-0.201802,-0.796425,0.419263 &
			,0.162654,0.117268,-1.155770,-1.673692,-0.228472,-0.544102,-1.124236,0.554823 &
			,-0.007329,-0.063694,-0.950118,-1.278821,-0.240660,-0.667267,-1.152618,0.102444 &
			,0.031822,0.395462,-0.621728,-1.411178,-0.217120,-0.961158,-0.853745,-0.291365 &
			,0.197177,0.322937,-0.407956,-1.795023,-0.437977,-1.048121,-1.109880,-0.658150 &
			,-0.121490,0.387732,-0.286650,-1.804507,-0.331164,-1.381154,-1.076148,-0.646699 &
			,-0.389185,0.316690,-0.259068,-1.830108,-0.224259,-1.535205,-1.752578,-0.734314 &
			,-0.525860,-0.313844,0.810857,-3.078152,0.139883,-2.561666,-2.992088,-2.442552 &
			,1.456191,-0.735683,0.600198,-2.348196,1.001636,-0.146103,-2.239606,-1.456792 &
			,3.174467,-0.887250,-0.305960,0.822392,1.888832,2.231340,0.092487,1.109709 &
			,2.986767,-1.351332,-0.715379,1.405814,1.766113,1.933147,1.564428,2.337231 &
			,2.653654,-0.716580,0.001565,0.803703,1.503201,1.648272,0.879603,2.357096 &
			,2.660641,-0.279229,0.355284,1.058589,1.082446,2.246208,0.507596,1.505975 &
			,1.313501,-0.333731,-0.281933,0.297016,1.030078,2.257046,0.868206,0.865174 &
			,0.303758,-1.024184,0.181793,-0.076297,1.276273,1.995940,0.000578,-1.374938 &
			,1.402970,-1.326480,-0.505637,-0.224871,1.184906,2.533292,-0.571799,-1.959694 &
			,2.951968,0.105991,-1.240389,-0.668216,1.316605,2.517708,-0.410370,-2.046273 &
			,0.156310,-0.275862,-0.039376,0.092576,0.298392,-0.269754,-0.042504,0.315035 &
			,0.101082,0.014160,0.135244,-0.165449,0.061329,-0.008439,-0.046096,0.186916 &
			,-0.011337,-0.100428,-0.065439,0.088799,0.058825,0.109125,-0.101028,-0.242410 &
			,-0.011448,0.023296,-0.169806,-0.018059,-0.080546,-0.016754,-0.022551,0.143062 &
			,0.086798,-0.057053,-0.060876,0.127489,-0.072833,-0.224073,0.164081,-0.179784 &
			,0.093458,-0.034048,-0.138010,-0.000708,0.021750,-0.076547,-0.002095,0.135761 &
			,0.017402,-0.135837,0.040504,0.041532,0.163442,-0.009979,-0.176981,0.214159 &
			,0.098359,-0.424422,0.093498,0.141971,0.250671,-0.260546,0.044410,0.211283 &
			,0.094799,-0.919711,-0.360236,0.649397,0.096555,-1.787620,0.527589,0.554677 &
			,-0.234335,-1.099768,-0.390588,0.630533,-0.045916,-1.964303,0.821812,0.379244 &
			,-1.231615,-0.078307,-0.137380,0.006045,-0.204731,-1.781344,1.298296,-0.089898 &
			,-0.944058,-0.464735,-0.062245,-0.052180,-0.193025,-1.703964,1.070887,-0.382068 &
			,-1.305341,-0.461786,-0.305744,-0.105425,-0.637116,-1.078333,1.301087,-0.170404 &
			,0.053624,0.182791,-0.690643,-0.638295,-0.818419,-0.529346,0.257541,-0.216251 &
			,0.199912,0.524684,-0.518201,-0.407566,-0.853739,-0.044730,-0.023538,0.131808 &
			,0.750882,0.746307,-0.398210,-0.304002,-0.915979,0.540226,-0.674427,-0.055190 &
			,0.984058,0.868444,-0.312224,-0.134130,-0.267590,0.183415,-0.553669,-0.093405 &
			,0.658174,1.065646,0.080107,-0.204877,-0.344419,0.363015,-0.672810,0.097816 &
			,0.019649,-0.170707,-0.430285,-0.169612,-0.352630,-0.089764,-0.140117,-0.362623 &
			,-0.023431,-0.032657,-0.623872,0.069282,-0.053753,-0.131921,-0.171255,-0.449907 &
			,0.040692,-0.034214,-0.371589,-0.093576,-0.241051,-0.040412,-0.004167,-0.462446 &
			,-0.076210,-0.132928,-0.345407,0.012496,-0.018088,0.060864,-0.126903,-0.532506 &
			,0.022526,0.022030,-0.207070,0.174103,0.024538,0.093703,0.013729,-0.367171 &
			,-0.014375,-0.043126,-0.265703,0.153503,-0.040552,-0.073802,0.254250,-0.400227 &
			,-0.026314,0.098801,-0.136229,0.308912,0.060382,0.006059,0.131317,-0.395298 &
			,-0.002673,-0.194367,-0.168840,0.300285,0.128881,0.095879,0.263605,-0.056798 &
			,-0.918327,-0.559321,0.053564,1.193899,0.224172,0.042661,0.467641,0.743734 &
			,-1.484150,-0.559088,0.340251,1.218863,0.422644,-0.323495,0.650643,1.266905 &
			,-1.429023,-0.492745,0.697489,1.559030,0.035192,-0.609823,0.726554,0.329011 &
			,-1.416262,-0.544582,0.591643,1.199910,0.161193,-0.073782,0.655011,-0.980247 &
			,-0.860230,-0.698346,-0.394753,0.239700,0.081514,0.578193,0.446081,-0.514360 &
			,-0.648269,-0.766831,-0.147131,-0.484296,-0.098924,0.729700,0.506459,-0.571287 &
			,-1.152417,-0.381594,0.220653,-0.020695,-0.210614,0.070333,0.423835,-0.160958 &
			,-0.459870,-0.761368,0.030695,-0.306115,-0.223429,0.199240,0.037172,0.219671 &
			,-0.152471,-0.269309,0.094025,-0.350341,-0.305310,-0.419775,-0.129141,0.058673 &
			,-0.173169,-0.443336,0.329457,-0.162697,-0.293532,-1.003228,-0.416310,0.000672 &
			,0.111633,-0.148667,-0.054469,-0.143310,0.076208,-0.142577,0.260403,0.288033 &
			,-0.003883,0.053857,0.043852,-0.102440,-0.067879,0.045259,-0.008735,0.297854 &
			,-0.007196,0.047530,0.012862,0.025468,-0.007582,0.025457,-0.106550,0.111982 &
			,0.027699,0.038825,0.040889,-0.011826,0.043654,0.020812,-0.204207,0.254106 &
			,-0.019211,0.000752,-0.062917,-0.041189,0.057735,0.089569,-0.052150,0.034623 &
			,-0.013037,-0.002234,0.088640,-0.004256,-0.022553,0.008835,-0.042987,0.206999 &
			,-0.017984,0.080241,0.084910,0.039768,-0.087135,-0.004083,-0.102265,0.017724 &
			,-0.009500,0.009222,0.071482,0.036525,0.020399,0.038319,-0.101916,0.150723 &
			,-0.037429,0.043070,-0.003903,0.028298,0.049273,0.031060,-0.008749,0.356771 &
			,0.050098,-0.129850,-0.003616,-0.089054,0.086678,-0.218801,0.031025,0.581395 &
			,-0.032663,-0.114531,0.164232,0.242663,0.137356,0.145066,-0.021607,0.137278 &
			,-0.044057,-0.003750,0.045685,0.047555,-0.178762,-0.066961,0.049013,-0.825689 &
			,0.126474,-0.127696,-0.051207,-0.032120,0.072557,-0.064479,0.002216,-0.414518 &
			,-0.001493,-0.058543,-0.117169,0.128015,0.262346,0.250376,-0.007838,-0.293687 &
			,0.048511,0.032138,-0.199915,-0.063932,0.128807,0.033605,0.026982,-0.025315 &
			,-0.012207,0.001023,0.121376,-0.154862,-0.023973,-0.044385,-0.171204,0.582533 &
			,0.029196,-0.117616,0.250948,0.323004,0.060458,-0.048634,0.085004,-0.462803 &
			,0.033812,-0.183564,-0.032879,-0.031528,0.085133,0.028141,0.030016,0.067397 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.621853,-2.285574 &
			,3.487080,1.779334 &
			,1.905634,-0.976633 &
			,-1.617607,0.241306 &
			,0.781345,0.607799 &
			,-0.831080,-1.222709 &
			,1.085924,1.114500 &
			,-0.822294,0.640704 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.215421,1.617288/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.39469,1.785444,1.547299,-1.31874,0.766065,-0.350366,2.26559,-0.879956/)
real, dimension(2) :: bias2 = &
(/0.265273,0.099088/)
real, dimension(1) :: bias3 = &
(/-0.272745/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
