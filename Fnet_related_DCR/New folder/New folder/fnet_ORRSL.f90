module fnet_ORRSL

! a = 0.00057239
! b = 0.038113

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.272943,-0.798699,0.357444,0.605743,1.213091,-0.248510,0.067445,-0.258314, &
            -0.275791,-0.310082,0.090935,0.312019,0.340245,-0.056361,-0.100639,0.041679, &
            -0.153525,-0.221558,0.090418,0.294031,-0.078138,-0.065499,0.008609,-0.048484, &
            -0.251382,-0.169450,0.098401,0.035129,-0.116859,-0.090007,0.091849,-0.072823, &
            -0.087944,-0.038029,-0.092205,0.042145,0.073021,0.007395,0.291822,-0.206226, &
            -0.084585,-0.025867,-0.073632,-0.093664,0.145303,0.004123,0.210506,-0.173711, &
            -0.257599,-0.002718,-0.011594,-0.187853,0.080771,-0.049018,0.239300,-0.129926, &
            -0.316399,-0.178803,0.057144,-0.232025,-0.055115,-0.067999,0.120388,-0.080387, &
            -0.602277,-0.528603,0.353305,-0.552416,-0.418332,-0.280802,-0.014144,0.149635, &
            0.691951,0.532610,-0.174774,-1.310239,0.232648,0.036501,-0.578710,0.144124, &
            0.156686,-0.439286,0.284758,0.363989,-0.926832,-0.032234,-2.376256,1.025759, &
            0.378426,-0.714552,0.185115,1.416166,-0.118574,0.110162,-2.403758,0.271941, &
            0.487819,-0.378844,-0.072438,-0.387333,0.942997,0.141976,-2.263711,0.018038, &
            -0.209069,-0.215099,0.128417,-0.253776,0.750860,0.007680,-0.308161,0.038414, &
            0.366336,-0.008945,-0.283496,0.707058,0.948471,0.252478,-0.452917,0.106957, &
            -0.071456,-0.030966,0.087011,-0.052734,0.926483,-0.083518,-0.433859,-0.197092, &
            -0.796557,0.137866,0.796363,0.201370,0.149990,-0.417791,-0.283205,0.245543, &
            0.669112,-0.356804,0.504656,0.230995,0.337438,0.043065,-0.573832,0.195163, &
            0.131307,0.374701,-0.152262,0.293095,1.345643,0.092839,0.257440,-0.205351, &
            -0.096989,0.199726,-0.127226,0.091837,0.847560,0.068777,-0.092925,0.315817, &
            -0.164221,0.176772,0.007480,0.132973,0.622909,-0.014753,-0.201142,0.386018, &
            -0.242674,-0.083426,0.043453,0.481781,0.241033,-0.006278,-0.351496,0.430056, &
            -0.422328,-0.126236,0.117773,0.492345,0.267760,-0.037076,-0.454940,0.533405, &
            -0.407510,-0.253245,0.115007,0.375860,0.111671,0.012225,-0.410903,0.468066, &
            -0.229365,-0.299272,0.125160,0.344371,-0.127866,0.071074,-0.559511,0.517215, &
            -0.428540,-0.361469,0.183172,-0.036208,-0.025130,0.079260,-0.410036,0.519852, &
            -0.605933,-0.003964,0.132796,-0.747943,-0.996107,1.002368,-0.013340,1.312183, &
            -0.276376,-0.402124,0.765473,-0.251663,-0.653614,1.028582,0.175843,0.619252, &
            0.501488,-0.141951,0.357260,1.112488,-1.079205,0.662764,1.412597,-0.783613, &
            -0.160022,0.467026,0.493934,-0.506969,-0.666960,0.206162,0.185207,0.052099, &
            -0.152686,0.371536,0.075571,-0.438552,-0.141734,0.233660,0.694610,-0.406050, &
            0.499643,0.433926,-0.019600,0.316730,-0.224651,0.139544,0.426902,-0.272248, &
            0.122845,-0.054479,0.140407,-0.488369,-0.472013,0.100064,-0.090354,0.049295, &
            -0.015413,-0.236242,0.089189,0.839436,-0.318346,0.000577,-0.166615,0.084047, &
            0.212897,0.492307,-0.079935,0.507990,-0.428642,0.181800,-0.347732,0.679320, &
            0.140123,-0.080857,0.017152,-0.315177,-1.363435,0.056756,0.265260,0.096844, &
            0.642799,-0.193691,0.385979,-0.545284,0.815736,0.211912,0.169218,-0.442178, &
            0.731141,0.298851,0.147196,-0.394277,0.763451,-0.167836,0.394324,-0.266722, &
            1.279233,1.079340,-0.142476,-0.251807,0.667092,-0.124971,0.273657,-0.231101, &
            1.742969,1.458029,-0.513502,-0.300285,0.565799,-0.436472,0.540416,-0.409751, &
            2.159286,2.014657,-0.700141,-0.167875,0.698350,-0.561592,0.599437,-0.539900, &
            2.856437,2.823925,-1.148405,-0.500268,0.785647,-0.660081,0.503088,-0.432292, &
            3.235586,3.828031,-1.396752,-0.557996,0.929395,-0.989762,0.321629,-0.100366, &
            3.150554,4.678295,-1.476137,-0.356259,0.585074,-1.354039,0.287496,-0.274062, &
            4.434223,4.360490,-6.562777,0.026189,0.462895,-6.895009,-0.293116,0.884413, &
            3.176459,2.070524,-10.595248,-0.031770,-0.029280,-11.917785,-1.135333,1.180969, &
            0.168272,0.815695,-8.822946,2.447434,-0.183460,-10.270880,-1.722398,1.240462, &
            -1.442042,-1.063121,-5.407516,1.315173,-0.132034,-5.908975,-0.543106,0.630421, &
            -2.231495,-2.226735,-4.240910,0.479152,0.055657,-3.686528,-0.122905,0.048420, &
            -4.040692,-2.559469,-2.549832,0.722064,-0.022118,-1.765205,0.341151,-0.558345, &
            -4.080316,-3.623563,-2.614734,-0.220205,-0.337510,-1.328973,0.308448,0.083767, &
            -3.690135,-4.240758,-1.563335,-0.996995,1.053282,-1.160797,0.136816,-0.124745, &
            -3.778049,-2.754967,-0.906284,-2.659089,0.372637,-1.025885,-0.109423,-0.149784, &
            -3.036919,-3.024870,-0.877169,-3.860236,2.169500,-1.141601,0.426184,-0.164978, &
            0.794672,-0.519857,-0.694925,0.040529,-0.242078,-0.505408,-1.544939,0.141913, &
            0.366699,-0.185465,-0.730699,0.016543,-0.552292,-0.557176,-1.749883,0.049024, &
            0.295015,0.266308,-0.783693,0.405756,-0.860332,-0.144006,-1.548453,-0.004356, &
            0.498507,0.592987,-0.708792,0.126853,-0.825743,-0.125446,-1.613352,-0.050785, &
            0.453300,0.682030,-0.457318,0.335832,-0.632820,-0.233775,-1.874086,-0.035886, &
            0.407224,0.702893,-0.303261,0.277919,-0.632170,-0.524467,-2.039421,0.086261, &
            0.713998,0.771496,-0.656099,0.024114,-0.556815,-0.522683,-2.104428,0.264285, &
            0.664751,1.113524,-0.476378,-0.078410,-0.100201,-0.303871,-2.467426,0.158518, &
            1.077030,0.594730,-1.391205,0.316660,0.694151,-1.563570,-3.982436,0.163540, &
            1.901968,-0.474291,-2.737735,-0.327524,1.070767,-2.908391,-5.404417,-0.165467, &
            0.467565,-0.577394,-1.790774,-1.452608,0.843561,-2.250847,-4.894728,0.658448, &
            -0.017758,-0.555562,-1.602882,-1.738953,-0.147945,-1.613419,-3.411659,1.940620, &
            -0.678090,-1.437899,-0.816361,-1.995218,0.456377,-1.108336,-2.329575,2.665351, &
            -1.479606,-1.134932,0.060581,-3.022373,0.221296,-0.396366,-2.091574,2.690254, &
            -1.546806,-0.621442,0.190727,-2.338973,-1.849902,-0.151003,-1.174223,0.932402, &
            -0.400958,-0.682029,-0.278105,-0.534745,-0.008718,-0.600914,-0.792011,-0.526966, &
            -0.702954,-0.681773,0.297067,2.559470,1.891873,0.098387,-0.633589,-0.790290, &
            -0.895903,-0.083419,-0.255135,3.471043,3.157488,-0.899765,-0.457846,-0.240678, &
            0.157526,-0.058127,0.215147,-0.242721,-0.167628,-0.055143,0.309841,-0.039484, &
            -0.042997,-0.102487,-0.043082,0.178489,-0.005026,0.012870,-0.025732,0.033043, &
            -0.115148,-0.076067,-0.115317,-0.018561,0.075532,0.056863,0.139148,-0.015309, &
            0.081062,0.022395,0.125038,-0.036137,-0.153899,-0.039011,-0.085742,0.146330, &
            0.014045,0.066070,0.047721,-0.166145,-0.013816,-0.012605,-0.023179,0.088205, &
            -0.024413,0.021096,0.040142,0.212492,-0.142762,-0.021532,0.043500,0.017096, &
            0.007299,-0.152184,0.012418,-0.075277,-0.252574,0.027321,0.086378,0.093935, &
            0.302025,0.166009,0.230595,-0.287063,-0.018829,-0.068085,-0.013646,-0.135770, &
            1.405745,0.544896,0.968179,-1.406561,0.052263,-0.170495,0.126478,0.110093, &
            1.702282,0.676317,0.533974,-1.955885,-0.439674,0.243392,-0.539338,0.942643, &
            0.622400,0.064129,0.332705,-1.267387,-0.109490,0.418596,-1.198953,0.637730, &
            0.120982,0.376093,0.087042,-0.997476,-0.435163,0.282380,-1.197006,0.812946, &
            -0.162214,0.052907,-0.212234,-0.903808,-0.168257,0.285142,-2.678110,1.069900, &
            -0.497006,-0.932345,-0.431776,0.543330,0.063507,-0.014801,-0.101221,-0.182585, &
            -0.590313,-0.756246,-0.375899,0.039836,0.385885,-0.238899,0.588361,-0.733649, &
            -0.205894,-1.186283,-0.697282,0.612235,0.581800,-0.073346,2.099704,-1.112853, &
            -0.678555,-1.243160,-0.254671,0.741873,0.230358,-0.248579,2.140412,-1.081104, &
            -0.720223,-0.706736,-0.077972,0.904299,0.185072,-0.283656,2.279453,-1.054311, &
            0.050913,0.439688,-0.026151,-0.540854,0.174288,-0.097060,0.248924,0.122341, &
            0.054597,0.297696,-0.066779,-0.480036,0.124344,-0.104682,0.258214,-0.045415, &
            -0.163095,0.302573,-0.013700,-0.557406,0.296924,-0.096355,0.087191,0.086932, &
            -0.290195,0.173689,-0.060058,-0.489557,0.111197,-0.078899,-0.014716,0.034719, &
            -0.203218,-0.011383,-0.104937,-0.387851,0.235615,0.006585,0.048797,-0.038522, &
            -0.189631,0.007249,-0.168671,-0.718196,-0.045833,0.059274,0.022131,0.061540, &
            -0.493995,-0.212884,0.048651,-0.835708,0.079815,0.011647,-0.250750,0.094054, &
            -0.417349,-0.156782,0.063707,-1.340101,0.178478,0.033909,-0.181689,0.150455, &
            -0.511182,-0.815424,0.184785,-2.762978,0.504019,0.781848,-0.012294,0.567427, &
            -0.161452,-0.979155,0.540897,-0.428605,0.307223,0.676461,-0.361074,0.770028, &
            0.215851,-0.285551,0.192933,0.815960,-0.641603,0.471948,-0.465611,0.343779, &
            0.260820,-0.752928,0.328627,0.618646,-0.123702,0.519245,0.605612,-0.270415, &
            0.868778,-0.457036,-0.382497,-0.825889,0.477168,0.368971,0.310871,-0.217030, &
            1.050160,0.151068,-0.243460,-0.586889,0.382498,0.687267,-0.055352,-0.156860, &
            0.931991,0.062696,0.082499,-0.093843,0.061021,0.259723,-0.001353,-0.160682, &
            0.804757,0.250106,-0.261860,-1.109772,-0.265211,0.203521,-0.682399,0.567400, &
            0.762122,0.393579,0.677433,-0.942095,0.257803,0.143146,-0.727928,0.435253, &
            1.425901,0.352648,0.188960,0.069638,-0.012711,-0.022589,-0.057789,0.021948, &
            0.135024,-0.066106,0.034474,-0.077833,0.157572,0.004530,0.263456,-0.196872, &
            0.058868,-0.011964,-0.021180,-0.010396,0.073643,0.029184,0.016167,0.013705, &
            0.014390,-0.026420,-0.012838,0.052334,-0.045582,0.018979,-0.038472,0.058212, &
            -0.007978,0.003537,-0.014577,0.090187,0.117638,0.008788,-0.061464,0.037700, &
            0.005692,-0.011709,-0.012994,0.077109,0.074583,0.009505,-0.033191,0.015432, &
            -0.067644,0.018265,0.011185,0.010782,-0.006515,-0.019785,-0.013611,0.020354, &
            -0.039435,0.048148,0.026848,0.041278,0.126970,-0.020417,-0.050290,0.017459, &
            0.062940,-0.017533,0.001219,-0.155329,0.028179,0.022121,-0.059390,0.012074, &
            -0.051533,-0.067377,-0.027758,-0.024077,-0.134301,0.045135,-0.081019,0.141091, &
            0.086964,-0.011243,-0.000154,0.136135,1.055106,-0.006389,-0.098541,-0.224754, &
            -0.150396,0.106580,0.135745,-0.278876,-0.446190,-0.095103,0.178459,0.067417, &
            0.109916,0.058282,-0.013396,0.218866,-0.226478,-0.015693,-0.005567,0.067725, &
            -0.050967,-0.007014,-0.077322,-0.000770,0.397486,0.007710,0.052789,-0.163905, &
            0.093451,-0.011390,-0.044780,0.039718,0.307216,0.069896,-0.145523,0.094733, &
            -0.005915,-0.108402,-0.058794,0.096700,-0.002774,0.043527,-0.010999,0.025840, &
            0.125208,-0.291183,-0.056298,-0.139841,-0.220280,0.116377,-0.022450,-0.012038, &
            -0.204473,0.039657,0.082628,0.066569,-0.294448,-0.058899,-0.066241,0.151704, &
            -0.037533,0.235579,-0.094346,-0.130164,0.244841,-0.044960,0.131710,-0.125959 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.922195,0.512172, &
            -1.896549,-0.506282, &
            -5.580965,-2.138821, &
            -9.064528,1.115468, &
            0.432877,-0.289768, &
            -7.290245,-1.823763, &
            5.969571,-3.272648, &
            1.326256,-1.425331 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-2.202997,1.763384/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.46355,2.387693,2.667521,2.780603,-1.246372,2.332883,2.356201,-2.086513/)
real, dimension(2) :: bias2 = &
(/0.952821,0.529041/)
real, dimension(1) :: bias3 = &
(/1.798137/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
