module fnet_CCFB_intake

! a = 0.00076145
! b = 0.026005

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.076942,0.023980,0.017094,0.567851,0.658626,0.410370,0.049219,0.072344, &
            0.043797,0.034448,-0.010996,0.469697,0.470199,-0.692698,0.047213,-0.012725, &
            -0.149349,0.063105,-0.022373,0.138043,0.140060,-0.363252,0.052181,-0.147944, &
            -0.246953,0.202563,-0.009308,0.226029,0.249803,-0.188046,0.124121,-0.196956, &
            -0.223337,0.244590,-0.027588,0.195886,0.205481,-0.094873,0.138087,-0.193005, &
            -0.216369,0.247196,-0.039796,0.204451,0.221589,-0.026200,0.133818,-0.212825, &
            -0.193920,0.260659,-0.041331,0.045980,0.060542,-0.006025,0.141109,-0.178859, &
            -0.307002,0.249595,-0.122898,-0.085992,-0.028203,-0.114761,0.199254,-0.374737, &
            -0.818449,0.727838,-0.486640,0.686872,0.524395,-0.729964,0.318405,-1.024261, &
            -0.081663,0.675531,-0.073383,0.084131,-0.181337,-0.297496,0.143696,0.068254, &
            0.270101,0.027763,0.186969,-0.272884,-0.057075,0.752811,-0.135585,0.503772, &
            0.342995,0.180801,0.219666,-0.485506,0.125832,1.305526,-0.005906,0.395029, &
            0.024507,0.339083,0.157663,-0.417044,-0.101134,1.000849,0.142991,0.243100, &
            -0.002725,-0.047783,0.108832,-0.590804,-0.321632,1.037344,-0.023391,0.100978, &
            -0.273904,0.116276,0.097190,-0.838965,-0.650090,0.786500,0.035800,-0.078781, &
            -0.072940,0.115200,0.130646,-0.770914,-0.373778,0.832841,-0.012964,-0.021545, &
            -0.056046,-0.089608,0.061688,-0.456266,-0.532153,0.359659,-0.132761,0.089996, &
            0.122583,-0.178043,0.136659,-0.522929,-0.063652,-0.348491,0.026282,0.221629, &
            -0.379981,0.245216,0.173451,-0.138224,-0.200117,1.449409,-0.129403,0.024666, &
            -0.565998,0.365427,0.392813,-0.214565,0.380608,1.482881,0.032592,0.030512, &
            0.025934,0.221847,0.181749,-0.043585,0.111705,0.378394,0.118273,0.227125, &
            0.367205,0.031472,-0.041256,-0.263681,-0.142310,0.018556,0.009001,0.116270, &
            0.273728,-0.175589,0.031507,-0.346490,-0.023602,0.209788,-0.202106,0.045432, &
            0.212941,-0.230938,0.065658,-0.086187,-0.134236,-0.173694,-0.179288,0.216552, &
            0.210076,-0.265772,0.084950,-0.127856,0.106200,-0.113881,-0.308932,0.023996, &
            0.085353,-0.120831,0.181555,-0.254846,-0.053456,-0.111841,-0.232275,0.115754, &
            -0.016461,-0.068981,0.827683,-0.515499,-0.169042,-0.564222,-0.340468,0.160519, &
            -0.222934,-0.039542,1.142511,-0.417139,-0.230505,-0.908787,-0.093504,0.473132, &
            0.050539,0.637411,0.687452,0.026934,0.130771,-1.046303,0.494654,0.145374, &
            -0.268931,0.102367,0.362662,-0.028928,-0.457237,-0.558076,-0.079054,-0.197292, &
            -0.495377,0.581405,0.375961,-0.020239,-0.393227,-1.036621,0.267895,-0.013048, &
            -0.318785,1.181323,0.247102,0.068641,-0.651818,-1.504264,0.130901,-0.071440, &
            0.099372,0.515287,0.155715,-0.547359,-0.444004,-0.188121,0.021181,0.083445, &
            -0.012311,-1.093729,-0.124164,-0.259979,0.104076,0.336014,-0.348065,-0.168796, &
            0.102149,-0.307052,0.030360,0.138863,0.571987,-0.613360,-0.146345,-0.170067, &
            -0.219871,-0.574143,-0.409159,0.326312,-0.323911,-0.561451,-0.437510,-0.807679, &
            0.230322,0.622989,-0.326125,1.848534,0.452908,-0.032626,-0.216425,-0.810506, &
            0.253567,0.918706,-0.432057,0.497351,1.650565,2.193467,-0.765026,-0.299143, &
            0.048737,0.165165,-0.226951,0.869783,1.356606,0.054275,-0.212987,-0.587136, &
            0.056313,-0.021695,-0.336357,0.961201,0.525908,-0.312563,0.127073,-0.457158, &
            -0.075438,0.029958,-0.420605,0.767543,0.390632,-0.297462,0.021992,-0.207025, &
            -0.112629,-0.110911,-0.583506,0.603330,0.304406,-0.051177,0.041025,-0.284839, &
            -0.157362,0.289081,-0.750113,0.659398,0.012140,-0.180418,0.168455,-0.327238, &
            0.043461,0.239019,-1.352481,0.702981,-0.024604,-0.260444,-0.206786,-0.450758, &
            0.192067,1.755803,-4.988745,-0.528134,-0.704395,0.125217,-0.932399,-0.044998, &
            0.451454,2.199213,-7.719939,-0.091296,-0.630314,2.336466,-1.019465,-0.987036, &
            0.384395,2.128767,-8.350818,-1.376576,0.704727,2.252678,-0.088905,-0.318458, &
            -0.075700,0.413223,-6.683657,-1.813057,-0.072690,1.517897,0.276473,0.121589, &
            0.028368,-2.627267,-4.437286,-1.457601,0.554375,1.217716,0.213093,-0.541221, &
            0.341259,-3.156007,-2.450313,-0.197599,0.771152,0.569609,-0.408620,-0.717435, &
            -0.249324,-2.736651,-1.660285,0.030152,2.013043,-0.404335,0.050196,-0.306015, &
            -0.004713,-2.007395,-0.813850,0.649345,1.659505,-1.631528,0.152543,-1.042239, &
            -0.199591,-1.390023,-0.868651,0.565116,1.101790,-3.591143,-0.041872,-0.347073, &
            0.132439,-2.683551,-1.011040,-0.851761,0.846562,-1.112919,0.127122,0.196693, &
            -1.258240,-0.846383,-1.352337,-0.953660,0.125405,0.143389,-1.003233,-3.865990, &
            -2.449959,-0.374016,-1.352065,-1.139488,0.720126,-0.812126,-1.081357,-3.535083, &
            -1.761487,-0.617517,-1.021024,-0.632145,0.188492,-0.545922,-0.594642,-3.595040, &
            -1.140804,-0.736193,-1.144649,-0.088996,-0.309457,-0.120257,-0.040336,-3.242151, &
            -0.624777,-0.563174,-1.100930,-0.084034,-0.464261,0.056769,0.064725,-3.152320, &
            -0.429586,-0.641791,-1.297880,0.236994,-0.379388,0.244014,0.400918,-3.154655, &
            -0.613568,-0.753840,-1.655313,0.218927,-0.180465,0.379080,0.381136,-2.758532, &
            -0.328890,-0.513871,-1.693285,0.156069,0.081481,0.563593,0.161048,-2.462274, &
            0.132451,-0.814323,-2.634165,0.787171,0.191669,0.140987,0.453495,-2.126592, &
            -0.630208,-0.644091,-3.832844,1.213764,0.368356,-1.512641,0.486369,-1.341554, &
            -2.210315,-0.337597,-3.423217,1.215235,0.221363,-3.938609,0.125356,-0.172585, &
            0.053726,0.388874,-2.692299,2.386132,-0.598444,-0.595375,0.237131,-0.057715, &
            0.489416,0.329936,-1.384525,2.000954,0.311340,2.506990,-0.206701,-0.180371, &
            0.350389,-0.551799,-0.513004,1.832181,0.382791,2.055487,-0.512656,-0.382179, &
            0.182177,-1.348499,-0.131675,1.305412,0.997946,0.577354,-0.344872,-0.165005, &
            0.196736,-1.854395,-1.027478,1.730954,1.281578,-0.264567,0.133206,0.421743, &
            0.097847,-1.317820,-0.872957,2.243285,1.422674,-0.288014,0.060638,0.387778, &
            -0.261211,-1.194243,-0.605036,1.588836,2.466880,-1.649475,0.888902,0.161718, &
            -0.299146,0.424920,-0.012892,0.142738,-0.405630,-0.208109,0.078884,-0.138898, &
            -0.040634,0.118080,-0.012190,-0.046801,-0.007364,-0.029205,0.115664,-0.020819, &
            -0.035757,0.073279,0.004129,0.260038,0.123013,-0.147416,0.038648,-0.000684, &
            -0.064202,-0.110196,-0.027599,-0.145135,-0.191358,-0.445514,-0.111813,-0.134415, &
            -0.140763,0.063511,-0.004205,0.304720,-0.113508,0.018240,-0.047507,-0.076403, &
            -0.001207,-0.039092,-0.015451,0.048997,-0.166638,0.137106,-0.037378,0.020706, &
            -0.100086,0.080681,0.045577,0.090252,-0.112069,-0.058696,-0.019751,-0.016154, &
            -0.191814,0.396722,0.043516,0.225588,-0.094778,-0.409403,0.069187,-0.071851, &
            -1.291684,1.072272,0.356449,1.119318,-0.698750,0.699947,0.220176,-0.475994, &
            -0.869538,1.041548,0.559087,0.726489,-0.957395,-0.495540,-0.088166,-0.043623, &
            0.060946,0.291192,0.493254,-0.357813,-0.385318,0.148906,0.181306,0.417225, &
            0.439230,0.334707,0.353257,-0.212250,0.388009,0.779288,0.270414,0.752540, &
            0.651081,-0.132527,0.454155,-0.740650,0.395802,0.565159,0.264208,1.156288, &
            0.655640,-0.243606,-0.057295,-0.585700,0.355621,-0.129725,0.168580,0.933329, &
            0.575598,-0.720001,-0.240731,-0.031657,1.079743,0.093009,0.143654,0.450622, &
            0.831709,-1.106370,-0.247099,0.052866,1.368444,-0.142546,-0.336739,0.489857, &
            0.328975,-0.959483,-0.327572,0.668822,0.610820,-1.584262,-0.319942,0.085297, &
            0.375375,-0.801812,-0.363229,0.781797,1.005685,0.299210,-0.284139,-0.048521, &
            0.080310,-0.073744,-0.272680,0.405881,1.425063,-1.404790,0.083890,-0.579340, &
            -0.046522,-0.456066,-0.211354,0.322443,0.904183,-4.641223,0.060391,-0.463954, &
            -0.387138,-0.208488,-0.102542,0.559462,0.367664,-1.080546,-0.249802,-0.393791, &
            -0.202130,-0.077582,-0.047664,0.349553,0.171048,-0.308665,-0.214991,-0.303917, &
            -0.219615,-0.176806,-0.107216,0.452466,0.148509,-0.153578,-0.125823,-0.231569, &
            -0.035410,-0.043949,-0.097163,0.109267,0.095585,-0.046775,0.068201,-0.101992, &
            -0.002524,0.006542,-0.043843,0.114507,0.136823,-0.221156,-0.028799,-0.096145, &
            0.088402,-0.233678,-0.000513,-0.200129,0.077782,-0.288752,-0.099662,0.120929, &
            -0.077920,0.454770,0.651482,-0.192239,0.122721,-0.761809,-0.184583,0.229381, &
            0.032886,0.827794,1.147932,-0.623227,-0.446309,-0.915424,-0.536680,0.455852, &
            -0.227441,0.704975,1.107120,-0.798197,-0.485194,0.114832,-0.687349,0.293566, &
            0.252778,0.214818,0.697986,-0.687485,-0.654144,-0.409902,-0.122156,0.560441, &
            -0.310423,0.266123,0.731424,-0.447510,-0.910981,-0.477117,-0.058707,0.735699, &
            -0.107017,0.312282,0.336233,0.008225,-1.045998,0.576136,-0.173811,0.347576, &
            -0.056211,-0.116887,0.038499,0.115941,-1.287133,-0.136679,-0.078104,0.428772, &
            0.113382,-0.229407,0.096444,-0.576843,-0.653302,-1.248816,-0.056730,0.686360, &
            -0.075579,-0.222871,0.043287,-0.117310,-0.291678,-0.950303,-0.190424,0.142289, &
            -0.202516,0.019654,0.129481,0.195831,-0.210174,-0.916468,-0.254059,-0.433912, &
            0.257241,-0.508077,-0.197255,0.488913,0.348563,-0.162757,-0.222030,-0.054749, &
            0.263089,-0.166845,-0.005625,0.225081,0.234394,-1.678022,-0.093348,0.112031, &
            0.078414,-0.085868,-0.006907,0.125869,0.174646,-0.254116,-0.048215,0.007387, &
            0.022427,0.004704,0.023385,0.023907,0.001892,0.080633,-0.014478,0.055995, &
            -0.044244,0.037287,0.006190,-0.020422,-0.029316,0.087109,0.024740,-0.003059, &
            0.074769,-0.078796,0.021819,0.061732,0.070330,-0.038281,-0.047831,0.085925, &
            0.024122,-0.078204,-0.000651,0.025313,-0.006987,0.024006,-0.052725,0.031926, &
            0.035474,-0.112214,-0.025360,0.048276,0.097200,0.097788,-0.009313,0.019455, &
            0.105334,-0.115161,0.066193,-0.002665,0.046720,0.132018,-0.128272,0.162575, &
            -0.020987,0.020377,0.043854,-0.202345,-0.156610,0.199381,-0.124450,-0.075362, &
            0.118371,-0.327857,-0.017978,-0.054036,-0.104192,1.225480,-0.202034,0.214225, &
            -0.038246,0.176441,-0.004005,-0.085012,-0.033963,0.947951,0.136660,0.090602, &
            -0.080294,-0.032744,-0.112639,0.216381,0.364389,-0.026781,0.225788,-0.120628, &
            0.039306,-0.216032,-0.050686,-0.148546,0.180357,-0.287731,-0.072071,-0.177777, &
            -0.049913,0.081727,0.098647,-0.169043,-0.218958,0.848887,-0.036167,0.083530, &
            0.018803,-0.287760,-0.122572,0.241196,0.248152,-1.861034,-0.005947,-0.188673, &
            0.146916,-0.253002,-0.062013,0.146149,0.441303,0.172378,-0.095673,-0.048694, &
            -0.191143,0.279021,0.010798,0.003541,-0.143179,0.727263,0.145271,-0.051594 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.264509,2.327971, &
            1.729446,-0.245683, &
            -3.373473,6.059830, &
            -0.961013,0.038437, &
            -0.243615,-1.278090, &
            2.438087,6.177889, &
            -0.787822,1.634271, &
            1.218156,-1.180577 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.911247,1.952652/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.009121,-2.137433,0.747502,1.034458,-0.761738,1.958555,1.186762,0.543313/)
real, dimension(2) :: bias2 = &
(/0.146837,-0.493314/)
real, dimension(1) :: bias3 = &
(/0.266915/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
