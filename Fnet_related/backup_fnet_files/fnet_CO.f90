module fnet_CO

! a = 5.569e-005
! b = 0.090701

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.158598,0.086928,-0.069400,0.067194,-0.125555,0.257771,0.004541,-0.020599 &
			,0.005981,0.076889,-0.001481,-0.034357,0.054204,0.045194,0.058213,0.045518 &
			,0.069173,0.174063,-0.074145,0.008445,-0.044425,-0.081765,0.033471,0.061282 &
			,-0.003127,0.067643,0.025596,0.027804,-0.026060,-0.040550,-0.022293,0.028501 &
			,0.125393,0.116250,-0.027529,-0.048552,0.059007,0.137113,0.099005,-0.032678 &
			,0.141938,0.213689,-0.097619,0.003294,0.022117,0.160096,0.066144,0.102402 &
			,0.104932,0.085834,-0.075575,-0.004200,0.003747,0.041077,0.048998,0.040437 &
			,0.152888,0.229887,-0.078299,0.028239,0.062395,0.017643,0.071137,-0.011563 &
			,0.701014,0.908220,-0.227060,0.230476,0.300776,0.008449,0.044429,0.113183 &
			,0.629481,1.342780,-0.238750,-0.125583,-0.449077,0.045751,-0.003643,0.412734 &
			,0.753355,1.468902,0.058793,0.003065,-0.367705,0.559525,-0.027069,0.191860 &
			,0.365128,0.826804,0.292457,-0.068739,-0.076515,1.010886,-0.036451,0.281249 &
			,-0.134511,-0.032461,0.138586,-0.009433,0.034905,0.220693,-0.037288,0.077114 &
			,0.273616,0.200169,-0.066841,-0.365256,0.006895,-0.448301,0.204400,-0.154415 &
			,0.142301,0.210513,-0.262437,-0.242237,-0.061021,-0.688040,0.200794,0.082944 &
			,0.492405,0.759807,-0.291797,-0.215965,-0.072623,-0.365821,0.146847,0.497458 &
			,0.589223,0.619698,0.048523,-0.012283,0.831618,0.140172,-0.102499,0.638380 &
			,0.301570,0.489411,0.405375,0.012668,1.063120,0.033757,-0.255362,0.585927 &
			,-0.494391,-0.085812,-0.170859,-0.087970,-0.218642,0.011515,0.131592,0.351546 &
			,-0.125177,-0.226619,0.026278,0.068561,-0.174030,-0.260628,0.063356,0.185708 &
			,-0.357393,-0.401942,0.081260,0.036190,-0.076103,-0.011389,0.069809,0.158260 &
			,-0.208609,-0.269165,0.210684,-0.042990,-0.106291,-0.101194,0.007682,-0.007401 &
			,-0.267833,-0.268498,0.116818,-0.046114,-0.019709,0.082120,0.205288,-0.101645 &
			,-0.384212,-0.354767,0.293731,0.022930,0.089207,0.051877,0.024560,0.073184 &
			,-0.224885,-0.454978,0.224703,-0.116279,-0.132582,-0.190327,0.095362,-0.229550 &
			,-0.203367,-0.322974,0.114972,0.120465,-0.089299,-0.114614,0.048293,0.031014 &
			,-0.421559,-0.682521,0.024681,0.497580,0.201613,0.231660,0.345703,-0.051172 &
			,-0.185773,-0.837547,0.134910,-0.045583,0.203480,-0.640988,0.266428,-0.027742 &
			,-0.147621,-0.725242,-0.134612,-0.399178,0.395241,-0.883833,0.372804,0.384406 &
			,-0.141296,0.006572,0.255203,-0.302540,0.390558,-0.819488,0.141647,0.347849 &
			,0.387626,-0.302047,0.039926,-0.184694,0.235268,-0.241956,0.039528,0.121851 &
			,0.166991,-0.031153,-0.075212,0.093048,-0.100048,0.262250,0.080443,0.005603 &
			,0.214848,0.098048,0.248034,-0.282801,0.241188,0.055923,0.052833,0.182047 &
			,0.127881,0.085508,0.279355,-0.204449,0.352209,-0.368322,-0.073503,-0.104126 &
			,0.104529,-0.337245,0.310605,0.175236,0.368309,-0.548420,-0.082921,-0.477903 &
			,-0.180977,-1.034411,0.330189,0.544067,0.676210,0.161324,-0.278426,-0.865489 &
			,-0.830774,-2.250703,-2.018297,2.532061,1.783400,1.697162,-1.852734,-1.888248 &
			,-1.479489,-2.173283,-2.757184,1.875851,2.296842,2.354706,-2.480036,-2.029307 &
			,-1.234372,-2.142792,-2.998110,2.151743,2.273145,2.363153,-2.366545,-2.010488 &
			,-0.795095,-2.585495,-2.983962,2.337544,2.493348,2.310209,-2.187181,-2.068411 &
			,-0.611697,-2.645582,-2.822269,2.595623,2.585748,2.298106,-2.317758,-1.768242 &
			,-0.405018,-2.607052,-2.923218,2.482492,2.566923,1.995769,-2.589138,-1.971572 &
			,-0.349138,-2.520109,-3.482161,2.540592,2.684848,2.254569,-2.846230,-2.282175 &
			,-0.752418,-2.140546,-3.829777,2.344178,3.239511,3.033336,-3.207931,-2.532621 &
			,-2.522775,0.003788,-5.678877,0.669355,5.045423,4.848954,-5.388604,-4.445913 &
			,-3.500641,0.868204,-5.162877,2.680292,4.370513,3.622280,-4.091165,-4.704736 &
			,-5.494618,2.285639,-3.829050,3.438437,2.456413,2.017760,-2.420457,-4.310093 &
			,-4.278895,2.055697,-2.340513,3.267817,0.622761,0.566651,-0.974448,-3.306367 &
			,-4.266026,2.200459,-1.604229,2.023877,-0.603857,0.742251,-0.310167,-2.839140 &
			,-2.734980,0.853078,-1.054902,1.271336,-1.000882,0.879336,-0.006962,-1.682992 &
			,-1.742369,0.234122,-0.475459,0.564728,-0.701408,0.710205,-0.271723,-0.525838 &
			,-1.540510,0.442627,0.017762,0.161861,-0.430671,0.393879,-0.125885,-0.375876 &
			,-1.554948,0.014174,0.042411,0.262947,-0.057722,0.145548,0.136149,-0.577585 &
			,-1.455015,-0.153679,-0.113548,0.519318,0.537066,0.340912,-0.073281,-0.539783 &
			,-0.298150,-0.784768,-0.449725,0.552657,0.128326,1.006231,-0.391335,-0.218002 &
			,-0.245221,-0.881443,-0.692653,0.416575,0.407660,1.024410,-0.538486,-0.416558 &
			,-0.093988,-0.539186,-0.568833,0.543000,0.299149,1.117537,-0.720209,-0.101603 &
			,-0.217985,-0.617957,-0.362627,0.659067,0.352536,0.897632,-0.689953,-0.308067 &
			,-0.340498,-0.381280,-0.534755,0.420283,0.467197,1.054340,-0.871431,-0.449193 &
			,-0.231588,-0.412540,-0.649217,0.616272,0.280226,1.188721,-0.773767,-0.631461 &
			,-0.373383,-0.464994,-0.484644,0.495064,0.496262,0.862084,-0.683910,-0.575342 &
			,-0.139524,-0.452756,-0.587595,0.472896,0.600831,1.240513,-0.886574,-0.544036 &
			,0.098252,-0.483090,-0.552072,-0.137399,0.638136,1.518104,-1.075517,-0.444624 &
			,-0.410980,-0.312711,-0.908464,0.120532,0.331292,1.614871,-1.300251,-1.036270 &
			,0.363253,-1.153954,-0.454106,0.623869,-0.235783,0.759091,-0.377932,-0.555483 &
			,0.354557,-0.813794,0.026564,0.079492,-0.154219,0.477079,0.099245,-0.498017 &
			,-0.240383,-1.041166,-0.496623,0.200776,0.212487,0.652229,0.027961,-0.426078 &
			,-0.889682,-0.616560,-0.145400,0.219464,0.252329,0.566465,-0.029140,-0.507483 &
			,-1.029122,-0.681761,-0.209745,0.454597,0.085417,-0.146682,-0.028533,-0.464783 &
			,-0.916988,-0.781370,-0.247546,0.336561,0.521500,-0.457499,0.034289,-0.445390 &
			,-0.861210,-1.057258,-0.225441,0.512794,0.344805,-0.489031,-0.104845,-0.476101 &
			,-1.396975,-0.447527,-0.640182,0.501942,0.941641,-0.154728,0.392783,-0.518994 &
			,0.335842,0.322715,0.179296,0.223409,0.177093,-0.147638,0.183250,0.111263 &
			,0.103919,0.077926,-0.041080,0.150972,-0.025112,0.122509,-0.023127,0.074381 &
			,0.069824,0.249621,0.115267,0.102098,-0.041431,0.094367,0.043656,-0.057250 &
			,0.106224,0.195532,-0.035829,-0.034614,0.019937,-0.206088,-0.074185,0.153739 &
			,0.119508,0.008392,-0.135165,-0.066460,-0.003332,-0.066199,0.176362,-0.095892 &
			,-0.047196,-0.177998,-0.062849,-0.093547,0.183963,0.033071,0.111010,-0.132448 &
			,0.171721,0.025281,0.047172,0.189691,0.315349,0.128246,-0.107300,-0.073341 &
			,-0.290678,-0.151170,0.093642,0.140212,0.393744,0.093477,-0.102115,0.020615 &
			,0.185625,-0.355474,0.387131,0.058125,0.615887,0.381339,-0.051076,0.108607 &
			,-0.857788,-0.379680,-0.040618,-0.276043,1.037208,0.527356,-0.143199,-0.526598 &
			,-0.063456,-0.151347,0.101208,-0.087199,-0.211893,0.130813,0.493648,0.145543 &
			,-0.832273,-0.323837,0.091735,-0.118959,0.098518,0.746546,0.236779,-0.145133 &
			,-0.583905,-0.405162,0.112649,0.081219,-0.172698,0.296173,0.532268,-0.123797 &
			,-0.282811,-0.110348,0.142128,-0.367393,0.041067,0.674963,0.177026,-0.199822 &
			,0.192471,-0.580878,0.081980,0.139030,-0.902967,0.321850,0.230568,0.500402 &
			,-0.048239,-0.127445,-0.432081,-0.394150,-1.159431,0.897672,-0.175182,0.141777 &
			,0.164014,-0.371628,-0.085720,-0.461625,-0.298297,0.988412,-0.145865,-0.146303 &
			,0.107029,-0.137259,0.021024,-0.378557,-0.610953,0.522010,-0.368743,-0.051436 &
			,-0.118869,-0.007326,-0.183064,-0.107967,-0.061605,-0.192115,-0.061215,-0.254288 &
			,-0.068743,0.084738,0.251626,-0.094521,-0.146629,-0.139923,0.183994,-0.179356 &
			,-0.068560,-0.028798,0.007048,-0.124139,-0.245970,0.004473,0.207707,0.017582 &
			,0.075654,0.042773,0.073645,-0.234056,-0.308652,-0.102246,0.126672,-0.055326 &
			,-0.141551,0.209599,-0.084555,-0.053743,-0.113595,-0.290561,0.124503,0.146529 &
			,-0.076670,0.254621,0.089415,-0.292365,-0.202977,-0.198736,0.133147,0.114697 &
			,-0.049728,0.167076,-0.024134,-0.334603,-0.132663,-0.241870,0.105342,0.200980 &
			,-0.074144,0.068100,0.281307,-0.381999,-0.248621,-0.178648,0.077541,0.184916 &
			,-0.026556,0.099420,0.460690,-0.193350,-0.341123,-1.030919,0.585120,0.261376 &
			,-0.012596,0.011725,0.457479,-1.086983,-0.569850,-0.651562,0.548829,0.467522 &
			,0.052450,0.091199,0.379502,-1.311281,-0.216149,-0.374257,0.172499,-0.065948 &
			,0.159588,-0.042450,0.450016,-0.769155,-0.566872,-0.397841,0.104316,0.165276 &
			,0.356983,0.074792,0.464257,-0.654935,-0.263163,-0.480812,-0.029891,0.206346 &
			,0.193347,0.350256,0.454410,-0.502124,-0.336145,-0.425854,-0.040609,-0.115670 &
			,0.190843,0.065085,0.217732,-0.183070,-0.158564,-0.478294,0.094060,-0.028823 &
			,0.310945,0.172775,0.088200,-0.033747,-0.072305,-0.201478,-0.310206,-0.096952 &
			,0.170799,0.040348,0.366082,-0.155914,-0.332524,0.158869,0.090704,0.079480 &
			,0.474030,0.198281,0.205280,0.124454,-0.094588,-0.037462,-0.286300,0.021747 &
			,-0.087631,-0.235672,-0.105496,0.030884,0.025672,0.153825,0.001862,0.017039 &
			,-0.140973,-0.070143,0.039850,-0.004833,-0.015888,0.148397,-0.038622,0.074807 &
			,-0.013353,0.160224,-0.078933,-0.032813,-0.008563,0.103177,0.041917,0.133066 &
			,-0.118600,-0.097414,0.088539,-0.038528,0.165040,0.222993,0.073346,-0.022111 &
			,-0.032245,-0.046048,-0.104457,-0.013363,0.138820,-0.075936,0.092768,0.008063 &
			,0.009630,0.069394,-0.073215,0.082420,0.060552,0.160413,0.022769,0.062579 &
			,-0.045060,0.040846,0.035982,-0.165293,0.189550,0.181412,0.217467,-0.037061 &
			,-0.081172,-0.131951,-0.009767,0.102202,0.071790,0.047005,-0.037548,-0.019661 &
			,0.037890,-0.079569,0.138326,-0.123516,0.413724,0.079404,0.031964,-0.043324 &
			,-0.081034,-0.176258,0.039795,-0.146592,0.202634,-0.021424,0.130838,-0.009832 &
			,-0.145746,-0.166699,-0.001889,0.095354,0.125509,0.059344,-0.012619,0.049911 &
			,0.066922,-0.013751,-0.054328,0.111730,0.100748,0.131360,0.097105,-0.129558 &
			,0.060231,0.009460,0.045210,0.075809,-0.180203,-0.196350,-0.179776,-0.069406 &
			,0.523216,0.165712,0.081634,-0.055874,-0.247774,-0.478459,-0.177828,-0.359198 &
			,0.087162,0.112843,-0.088542,-0.048942,-0.096666,-0.452744,-0.031161,0.049971 &
			,-0.255321,-0.163807,-0.003385,0.053030,0.150855,-0.082806,0.003385,0.136390 &
			,-0.243927,-0.409013,0.052317,-0.027593,-0.247663,0.400526,-0.074448,0.017065 &
			,-0.500466,-0.237349,-0.104371,0.056126,0.031174,-0.022740,-0.019557,0.366356 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-3.859351,0.418696 &
			,0.482443,-1.484885 &
			,-3.338527,-0.126675 &
			,0.511809,1.573864 &
			,1.324793,-0.333083 &
			,0.794080,-0.882031 &
			,-3.169503,0.890188 &
			,-3.382206,1.604770 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.239796,1.327568/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.96323,-1.035815,1.233762,0.714457,-1.014625,-0.701227,0.779884,0.980317/)
real, dimension(2) :: bias2 = &
(/-0.317206,0.175284/)
real, dimension(1) :: bias3 = &
(/0.391985/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
