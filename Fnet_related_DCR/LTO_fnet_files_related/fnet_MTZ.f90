module fnet_MTZ

! a = 2.9315e-005
! b = 0.086358

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.128550,0.247279,-0.054579,0.031396,-0.034199,0.383485,-0.081992,-0.181326, &
            0.055125,0.183275,-0.017893,0.029861,-0.010314,0.036959,0.028830,-0.078743, &
            -0.012980,0.250466,0.049343,0.068840,-0.044133,0.002440,-0.093465,0.016364, &
            -0.040115,0.191037,-0.002999,0.092326,-0.015369,0.108029,-0.097781,-0.046404, &
            -0.121209,0.252917,0.015963,0.088269,-0.018127,0.131367,-0.157852,-0.030502, &
            -0.017817,0.137178,0.027369,-0.006861,0.002560,-0.012522,0.041352,-0.001603, &
            -0.107335,0.381897,0.022215,0.006053,-0.005820,0.040441,-0.046710,-0.025510, &
            -0.039227,0.506808,0.053698,0.090218,-0.009425,-0.028841,-0.055852,0.003051, &
            -0.182748,0.125721,0.063667,0.287786,-0.075838,0.596341,-0.297276,-0.168816, &
            -0.505734,0.168632,0.132805,0.623309,0.076169,0.549413,-0.538657,-0.353262, &
            -0.157888,0.486054,-0.132575,0.703680,0.352676,0.184776,-0.398424,-0.324002, &
            0.390133,0.290110,-0.446219,0.144921,0.381785,0.093893,0.256818,-0.236853, &
            0.234094,0.520089,-0.084970,-0.106034,0.013481,-0.126298,0.204340,-0.000364, &
            -0.023701,0.070874,0.070554,-0.555402,-0.120952,-0.169571,0.221888,0.198372, &
            0.005757,0.148357,0.199349,0.020486,0.194090,-0.573867,0.134795,0.112593, &
            -0.114546,0.431407,0.130410,0.241915,0.410018,-0.730198,-0.258548,0.675276, &
            0.084724,-0.001599,0.568110,-0.013744,0.323347,-1.023488,0.138611,1.150325, &
            0.325131,0.270259,0.673150,0.085777,0.121316,-1.459502,0.195736,0.835060, &
            0.225943,0.350012,-0.316887,0.042212,0.206469,0.156291,0.165819,-0.279691, &
            0.214860,0.379085,-0.134203,-0.078602,0.192679,0.090854,0.023695,-0.027100, &
            0.090950,0.519571,-0.078368,-0.120709,0.095935,0.100665,-0.071725,-0.129186, &
            0.169344,0.356659,-0.075424,-0.085419,0.158114,-0.138683,0.018746,-0.085361, &
            0.130810,0.421589,-0.000419,-0.013316,0.098468,-0.038429,-0.071630,-0.098147, &
            0.195471,0.192432,0.059820,0.029473,0.029882,-0.117763,-0.093135,-0.146773, &
            0.163475,0.197458,0.003535,-0.283594,0.065995,-0.152128,0.158483,-0.083910, &
            0.091759,0.320410,0.009503,-0.260033,0.100252,-0.084592,0.024687,-0.205880, &
            0.172492,0.104246,0.079364,-0.894646,0.342727,0.905064,-0.299931,0.050985, &
            -0.383206,0.359421,0.012357,-0.716359,0.276057,0.333665,-0.129426,-0.034030, &
            -0.495409,0.219657,0.105059,-0.784919,0.579341,-0.705000,0.048129,0.317648, &
            -0.457484,0.155533,0.401045,0.002312,0.081760,-0.191356,-0.341720,0.044322, &
            -0.026194,0.268251,0.128823,0.076665,0.371624,-0.552845,-0.061324,0.354839, &
            0.156993,0.319416,-0.162926,-0.019311,0.278400,-0.371132,0.249293,-0.052441, &
            0.249560,0.402667,-0.282988,-0.208392,0.210560,0.091845,0.338616,-0.018658, &
            -0.331851,0.309013,-0.269617,-0.646052,0.156215,-0.296197,0.008728,0.250828, &
            -0.423146,0.376605,0.302513,0.109578,-0.138394,0.106193,-0.370276,0.130367, &
            -0.532869,0.188298,0.340776,0.620652,-0.496402,1.187696,-1.199622,0.390878, &
            -2.858700,0.383279,0.186888,1.603712,-0.358294,3.638032,1.639523,0.729670, &
            -2.932081,0.404792,-0.673536,1.796515,-0.828438,3.573796,1.759888,0.833404, &
            -2.201988,0.188368,-1.202735,2.079009,-1.082958,3.636917,1.659341,1.121225, &
            -1.432739,0.209179,-1.439900,2.295960,-0.949871,3.448883,1.659652,0.976549, &
            -0.823979,0.209281,-1.336000,2.454851,-1.104427,3.231483,1.672974,1.166412, &
            -0.590101,0.167524,-1.214168,3.014356,-0.808243,3.159137,1.272731,1.759500, &
            -0.176743,0.038586,-1.159507,2.966961,-1.136751,3.327249,1.057275,2.093822, &
            -0.000858,0.384844,-2.197634,4.009277,-1.856136,2.721897,1.390114,3.058153, &
            -0.408951,0.304581,-10.086310,7.140132,-9.054809,-0.954995,3.479805,7.779254, &
            2.092771,0.443160,-9.338256,2.334506,-8.950546,1.896394,-0.010269,4.630429, &
            0.702589,0.422985,-5.697359,-1.284788,-7.408898,2.953880,-0.681500,1.747847, &
            -0.673916,0.295470,-1.820256,-1.102616,-4.820550,3.663776,-0.228909,0.038477, &
            -0.017205,0.485142,-0.632735,-0.677121,-3.865411,2.506503,0.330589,-1.011801, &
            -0.260667,0.156754,-0.144457,-0.058375,-2.650861,1.759482,0.422500,-0.981602, &
            -0.035918,0.419136,0.142767,0.187474,-1.389853,-0.038108,0.321345,-1.061906, &
            0.489402,0.228832,-0.166076,0.258282,-0.995744,0.013492,0.331730,-0.471618, &
            0.455298,0.196871,0.042147,-0.207768,0.019158,0.667977,0.671907,0.079512, &
            0.408506,0.068181,-0.402448,-0.179763,0.334894,-0.947480,0.146971,-0.162979, &
            -1.008226,0.359946,-0.497496,0.868009,-0.625899,-0.323198,0.377359,-0.282944, &
            -0.513961,0.195866,-0.655125,0.857441,-0.475965,0.160589,0.563421,-0.047326, &
            -0.355328,0.065475,-0.262576,0.548662,-0.366123,0.564802,0.523363,0.062951, &
            0.074236,0.043354,-0.383698,0.706369,-0.169658,0.769555,0.337001,-0.056210, &
            0.037327,0.071024,-0.072543,0.742467,-0.268664,1.036291,0.529429,0.375636, &
            0.274764,0.112927,-0.290521,0.782639,-0.357317,1.260541,0.150291,0.202360, &
            0.173357,0.181589,-0.086858,0.715070,-0.307786,1.732109,0.472767,0.612745, &
            -0.153161,0.234413,-0.285116,1.103866,-0.297286,1.691627,0.648835,0.939112, &
            0.565567,0.173440,-0.833296,1.691276,-0.860046,2.513556,0.413622,2.098012, &
            0.530975,0.290407,-1.086119,0.678416,-1.804971,2.393262,-0.036246,0.928895, &
            -0.792251,0.399757,-1.324326,0.110907,-2.099539,0.629487,-0.549756,-0.631116, &
            -0.946754,0.201027,-1.680267,0.103960,-1.769580,-0.174985,0.174356,-0.683780, &
            0.526650,0.405760,-0.461999,0.429449,-1.069565,0.061982,-0.142826,-0.081435, &
            0.703611,0.434968,1.225557,0.008166,0.143666,0.653119,-0.201709,0.354008, &
            -0.393823,0.138746,1.341349,0.412226,0.023077,-1.234750,0.126275,0.571255, &
            0.183972,0.244886,0.464871,-0.221918,-0.165691,-1.751373,0.057662,0.317241, &
            -0.576394,0.343530,-0.615164,-0.899887,0.341369,-1.724236,0.181391,0.021557, &
            -0.159832,0.202432,-0.919736,-1.259056,-0.044927,-3.930486,-0.122082,-0.138197, &
            0.179325,0.609226,0.287454,0.557266,-0.107627,0.203457,-0.816578,-0.010076, &
            -0.023487,0.237481,0.172394,0.530691,-0.143478,0.295883,-0.462470,-0.359921, &
            0.160445,0.192411,0.000782,-0.013849,-0.048154,0.182314,-0.084528,-0.091644, &
            -0.035178,0.303064,0.035278,-0.264913,0.018113,-0.006651,0.122881,0.100704, &
            0.017189,0.111396,-0.128482,0.088779,0.147288,-0.142676,-0.118693,0.197590, &
            -0.033464,0.520953,0.156259,0.099192,-0.043955,-0.272725,0.093781,0.046978, &
            0.072444,0.409749,0.287952,0.196949,-0.134969,-0.180958,0.047189,0.032879, &
            -0.127083,0.187086,-0.036917,0.359201,-0.140775,0.285586,0.180342,-0.107490, &
            0.663482,0.293763,0.365332,0.668261,-0.331464,-0.633147,-0.881859,-0.033405, &
            -0.128732,0.286105,-0.377431,0.622460,-0.312199,-1.724598,-0.629868,-0.195106, &
            0.114074,0.376001,-0.381808,-0.331809,-0.067419,-1.443785,-0.298027,-0.439997, &
            0.109139,0.221712,-0.088965,-0.007399,-0.395827,-2.340769,-0.195887,-0.444591, &
            0.289570,0.429215,-0.138887,-0.927261,-0.114992,-2.100386,-0.479660,-0.371321, &
            0.130947,0.217896,-0.208215,-0.517038,0.569936,-0.224634,-0.431445,-0.731588, &
            -0.221541,0.149662,-0.180327,-0.891224,1.165379,-0.043063,-0.234708,0.001398, &
            -1.089997,0.405616,-0.497894,-0.391552,0.828854,-0.717045,0.859985,0.396098, &
            -0.428926,0.370265,-0.283133,0.009594,0.069537,0.373740,0.948286,0.491319, &
            0.011669,0.303404,-0.176317,-0.036437,-0.006929,0.558321,0.559458,0.056709, &
            -0.117356,0.337618,-0.422267,-0.282311,-0.039140,0.801588,-0.153378,0.084836, &
            -0.210027,0.599265,-0.160523,-0.212240,-0.074611,0.494361,-0.338344,0.030801, &
            -0.152633,0.583190,-0.108763,-0.120222,0.071622,0.344107,-0.147144,0.274803, &
            -0.109110,0.507754,0.001395,-0.296973,-0.121066,0.302300,-0.087495,0.095850, &
            -0.266510,0.310444,0.036456,-0.293698,-0.198158,0.444913,-0.380764,0.327625, &
            -0.223535,0.530512,-0.019120,0.012863,0.028804,0.544864,-0.325710,0.119714, &
            -0.338946,0.474846,0.182601,-0.340225,-0.142447,0.267918,-0.126609,0.018555, &
            -0.155237,0.606817,0.126556,-0.015813,-0.056519,0.162271,-0.238824,0.255977, &
            0.101078,0.519604,1.019825,-0.519395,0.360742,0.282481,-0.140215,-0.255493, &
            0.208338,0.543972,0.902151,-0.041668,-0.085149,-1.159158,0.355122,-0.357807, &
            0.003923,0.554231,0.559298,0.086249,0.179175,-1.325186,0.332041,-0.332723, &
            0.095163,0.403145,0.210496,-0.042313,0.521873,-0.877202,0.545663,0.134732, &
            -0.532028,0.306279,0.304396,-0.246504,0.764343,-1.095622,-0.010127,-0.020499, &
            -0.341589,0.541109,-0.000744,-0.178036,0.109929,-0.471073,0.154819,-0.033901, &
            -0.084205,0.477185,-0.164004,-0.045393,0.200253,-0.233091,0.291049,-0.283010, &
            -0.053948,0.530070,-0.093644,-0.073974,0.127774,0.334825,0.227623,-0.124889, &
            0.060247,0.569653,0.150150,0.274754,0.142190,0.298323,0.236285,-0.207228, &
            0.226353,0.469409,0.383019,0.081448,-0.164628,0.968323,0.194618,-0.025794, &
            0.054369,0.219812,-0.156333,-0.190965,0.000062,-0.025362,0.082598,0.019390, &
            0.006363,-0.019821,-0.026181,-0.013483,0.002706,0.106563,0.083916,-0.067248, &
            0.012185,0.307141,0.019955,0.017227,-0.015002,-0.025026,-0.019153,0.018499, &
            -0.034275,0.041879,-0.077046,0.005034,0.033223,0.093947,-0.034955,-0.009112, &
            0.048359,0.121700,0.025033,0.053299,0.004200,0.018118,0.068664,-0.059982, &
            0.011570,-0.023221,0.005454,-0.117942,0.018152,-0.126436,0.057699,0.045812, &
            0.007021,-0.055076,-0.018687,0.031479,0.011133,0.032350,-0.046536,-0.000622, &
            0.004206,0.075002,-0.062020,0.030600,0.031197,0.045702,-0.006519,-0.025663, &
            0.037910,0.077717,-0.109573,-0.031896,0.111711,-0.091567,0.029236,0.085066, &
            -0.086336,0.370012,0.082294,-0.272838,-0.022486,-0.142666,0.103459,0.140257, &
            0.120540,0.456602,0.076955,0.065957,-0.014558,-0.102344,0.137446,-0.031133, &
            -0.017972,0.150372,-0.022455,-0.223206,0.058092,-0.241495,0.122665,0.140940, &
            -0.047559,0.456556,0.033638,0.098418,-0.072418,0.161062,-0.143308,0.005010, &
            -0.297711,0.312299,0.335801,0.392294,-0.182550,0.175049,-0.440217,-0.177052, &
            -0.050217,0.181925,0.049705,0.157821,-0.014474,0.081545,-0.183841,0.011475, &
            0.088063,0.161859,-0.059448,0.195668,0.014087,0.026573,-0.055904,-0.050051, &
            0.171937,0.434988,0.041118,0.117768,0.054407,-0.135073,0.056446,-0.042203, &
            -0.066652,0.559500,-0.374849,-0.296443,0.030386,0.635303,0.192987,-0.266669 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.560186,1.082595, &
            -0.657201,-0.998027, &
            -2.994980,1.197814, &
            1.337050,0.022451, &
            -5.265831,2.104029, &
            -1.167735,-0.965764, &
            1.461097,-1.390180, &
            1.513920,-0.331986 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.115412,-0.78425/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.342107,0.602464,1.608957,-1.079767,1.172721,2.169496,-1.240331,-1.203028/)
real, dimension(2) :: bias2 = &
(/-0.480315,-0.157229/)
real, dimension(1) :: bias3 = &
(/1.133973/)
contains
subroutine fnet_MTZ_initall()
end subroutine fnet_MTZ_initall
subroutine fnet_MTZ_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MTZ_engine
end module fnet_MTZ
