module fnet_JP

! a = 0.0002308
! b = 0.06699

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.035006,-0.024473,0.444063,-0.107184,0.369015,0.148345,0.271418,0.038333, &
            -0.027535,-0.013701,0.140139,-0.045716,0.164452,0.027227,-0.121663,0.019242, &
            0.012419,-0.029107,0.232171,0.058723,-0.054670,-0.002004,-0.063383,-0.030818, &
            0.016925,-0.019271,-0.065660,-0.064372,0.148199,0.107877,0.018065,0.045037, &
            -0.010710,-0.002451,-0.152164,-0.110035,0.149726,0.021618,0.021260,0.035465, &
            -0.008936,0.039511,-0.336747,0.039984,0.263370,0.048886,-0.021614,-0.025530, &
            0.089307,0.034030,-0.263949,-0.028207,0.193889,0.084091,0.095559,0.050892, &
            0.006177,0.095410,-0.401437,0.030250,0.170877,0.013874,-0.169525,-0.197485, &
            0.201734,0.300621,-0.090584,-0.100512,0.484996,-0.132415,0.620897,-0.339030, &
            0.215121,0.052771,-0.110650,0.000409,0.136142,0.039885,0.496817,0.019303, &
            0.240889,-0.038912,0.256544,-0.260692,0.338507,0.000045,0.780246,0.588879, &
            -0.157695,-0.132963,-0.689119,-0.088151,-0.017453,-0.310615,-0.032611,0.596001, &
            0.059540,-0.107126,-0.090085,-0.084746,-0.108664,-0.372257,0.156324,0.625270, &
            0.270161,0.052087,0.291105,-0.017436,0.010322,-0.054271,-0.031303,0.330892, &
            0.217355,0.012462,1.108980,-0.209083,-0.273985,0.279401,-0.042995,-0.164754, &
            0.412117,0.227043,1.110935,0.174523,0.233540,0.239208,0.402644,-0.087869, &
            0.690669,0.600418,-0.635761,0.692900,0.691124,-0.306251,0.321542,0.444786, &
            0.150942,0.646541,-0.451817,0.463087,0.179876,-0.508516,-0.463276,-0.000669, &
            0.229925,-0.088021,1.059225,0.281622,-0.260548,0.250867,-0.548754,0.277979, &
            -0.114658,-0.076364,1.048739,0.460240,-0.332724,0.086237,-0.094925,0.313662, &
            0.097251,-0.006442,0.847100,0.368018,-0.406615,0.027526,-0.218866,0.359597, &
            0.165429,0.067992,0.750895,-0.215590,-0.295699,0.151104,-0.017664,0.233960, &
            -0.077578,-0.015598,0.268512,-0.268124,-0.402061,0.051833,-0.285598,0.261087, &
            -0.021932,-0.003315,0.116592,-0.061285,-0.670265,-0.010104,-0.267696,0.168205, &
            -0.066434,-0.081648,0.129788,-0.152434,-0.753002,-0.010230,-0.095059,0.237943, &
            -0.005622,-0.069688,0.032209,0.174652,-0.725301,0.256334,0.130914,0.253856, &
            -0.572748,0.107856,0.482736,-0.528639,-0.284526,0.875359,0.566742,0.391229, &
            -0.452250,0.364239,0.965696,0.154591,-0.170756,0.383433,0.650194,-0.243908, &
            -0.170887,0.853757,1.901862,-1.065928,-0.067153,0.197487,0.130919,-0.683771, &
            -0.142176,0.803758,0.371785,-1.325123,-0.523045,-0.289418,0.150734,-0.762384, &
            0.085945,0.245056,1.129391,0.060219,-0.252341,-0.135772,0.702670,0.034986, &
            0.326227,-0.010743,1.034848,1.013472,0.549630,0.280367,0.302635,0.448677, &
            0.099508,-0.022910,-0.113804,0.471238,0.115635,-0.163698,0.032386,0.571092, &
            -0.175989,0.115389,0.719553,-0.436570,-0.276607,-0.439408,0.136200,-0.107441, &
            -0.141238,0.250860,-0.382613,0.470638,-0.266769,-0.602524,0.365737,-0.817260, &
            -0.555716,0.238179,-1.069579,-0.054540,-0.002609,-0.424593,0.211068,-1.071439, &
            -2.769505,0.388848,-0.794364,-0.215192,0.748074,-1.839516,-0.375815,-2.726879, &
            -2.249407,-0.429662,-0.315617,-0.754201,2.017174,-2.076570,-1.068512,-2.719561, &
            -2.594530,-0.642603,-0.333829,-0.395671,2.710769,-2.331827,-1.315145,-2.690131, &
            -2.828316,-0.655322,-0.020442,-0.508578,2.891764,-2.697001,-0.310164,-2.261656, &
            -2.872428,-0.764190,0.143845,-0.406701,3.368425,-3.081392,-0.183791,-2.195983, &
            -3.045738,-0.891232,0.247405,-0.164184,4.059888,-3.100915,0.079538,-2.442919, &
            -2.875823,-1.683565,0.294181,-0.038583,4.320472,-3.642333,0.712630,-2.485517, &
            -2.447766,-2.213236,0.215378,-0.254549,5.241699,-4.108508,0.232123,-3.267484, &
            0.647530,-6.786698,-3.132891,-5.005348,9.453858,-7.535931,-2.513788,-7.125043, &
            -0.879247,-7.004578,-4.294808,-2.984692,9.065519,-7.131321,-2.696741,-6.694603, &
            -1.706012,-6.306739,-4.651581,-1.326123,5.259646,-4.715195,-4.787303,-6.301015, &
            -1.610156,-4.766672,-4.734846,-1.214278,1.120615,-2.510481,-4.293208,-4.467249, &
            -1.402940,-4.028513,-4.300585,-2.637785,-1.587297,-0.447937,-4.097246,-3.255778, &
            -2.129097,-3.078871,-2.411549,-3.845023,-1.371161,0.344863,-2.719114,-1.510356, &
            -2.184929,-2.073435,-0.730039,-3.096899,-1.019297,0.085751,-1.386462,-0.509950, &
            -1.809730,-1.447520,0.478517,-2.299702,-0.553287,-0.330165,-0.826960,-0.161015, &
            -1.651967,-1.709711,0.831012,-2.310331,-0.226076,0.033032,-1.478606,-0.559624, &
            -1.762557,-2.090223,0.913803,-2.424557,-0.160923,0.177548,-1.378261,-1.194572, &
            -1.276982,-0.573911,-1.843257,-1.506355,1.168375,0.202305,-0.361635,-0.012224, &
            -1.286186,-0.559361,-1.768783,-1.133209,1.368527,0.303954,-0.178791,0.146502, &
            -1.124136,-0.736105,-1.765387,-0.886826,1.624491,0.135446,-0.471176,0.130807, &
            -1.089801,-0.529566,-1.870167,-0.949079,1.563798,-0.117339,-0.345598,0.005707, &
            -0.846490,-0.931564,-2.100158,-0.676532,1.522963,-0.099250,-0.360593,-0.473589, &
            -0.517422,-0.805277,-1.945513,-0.616344,1.752647,-0.366198,-0.717789,-0.349873, &
            -0.308713,-0.775516,-1.782225,-0.533026,1.999535,-0.386415,-0.609580,-0.619653, &
            -0.471616,-0.961060,-1.682746,-0.741469,1.810072,-0.507432,-0.296179,-0.538686, &
            0.453604,-1.422483,-1.983010,-0.605194,2.767251,-0.845712,-0.607892,-0.993324, &
            1.148184,-2.202344,-2.197319,-1.734873,3.017604,-1.942407,-1.902109,-1.968812, &
            -0.247837,-0.923054,-2.332794,0.093391,1.873190,-1.209264,-0.422803,-0.892976, &
            -0.627469,-0.446464,-2.291951,0.268574,0.764636,-0.884189,-0.637144,-0.027918, &
            -0.891702,-0.084685,-2.588571,0.526525,0.408457,-0.230173,-0.521557,0.379184, &
            -0.235878,-0.395997,-2.860777,-0.709222,0.526620,-0.002220,-1.124264,-0.638367, &
            -0.646383,-0.473388,-2.630645,-0.430508,0.287799,0.745863,-0.077355,-0.676899, &
            0.273261,-0.501726,-3.123341,-0.019984,0.446318,0.145168,-0.533315,-0.716036, &
            -0.118880,-0.090480,-2.544193,0.025641,-0.435943,0.685329,-0.372656,-0.182581, &
            -0.102465,-0.005466,-2.854813,-0.585314,0.943818,0.424102,-0.336981,0.008357, &
            0.123509,0.342249,-0.286271,0.479262,0.565584,-0.022546,-0.006208,-0.142683, &
            0.073385,0.123343,-0.282699,0.254573,0.243254,0.050720,-0.126636,0.082681, &
            -0.062281,0.055359,-0.215985,0.040925,-0.094706,0.104164,0.037239,-0.289733, &
            0.007667,0.049049,-0.215625,0.218802,0.062094,0.015911,-0.118404,-0.133545, &
            0.029656,0.012300,-0.137172,0.256151,0.087262,-0.087957,-0.027153,0.083945, &
            -0.017372,0.085067,0.065511,-0.021655,0.255551,-0.138589,0.142495,-0.124374, &
            -0.136309,-0.021842,-0.184184,0.020551,0.180659,-0.014501,-0.089484,-0.144105, &
            0.018414,0.179475,-0.159659,0.608867,0.297876,-0.203944,-0.310368,-0.261197, &
            0.019957,0.619698,-0.334520,1.199449,0.905334,-0.507980,0.413210,-0.143552, &
            0.246590,0.146627,-1.010096,0.183448,0.176791,-0.646051,-0.320378,-0.531276, &
            0.062468,0.164773,-0.071582,-0.731083,-0.283617,0.507823,0.104278,0.148268, &
            -0.175210,-0.137458,-0.339265,-2.317820,-0.593922,0.406755,0.473601,0.052947, &
            -0.608639,-0.240852,-0.527789,-1.757832,-1.525454,0.745228,0.688994,0.366364, &
            0.059368,-0.188844,-0.126346,-0.817429,-0.433443,0.174511,0.308788,0.579076, &
            -0.082772,-0.048925,0.207616,-0.124356,0.694256,0.487535,0.784989,1.104675, &
            0.285948,-0.701053,0.234146,-0.642120,1.154338,0.505581,0.333461,0.836373, &
            0.080421,-0.566821,0.392191,0.684652,0.975572,-0.376180,-0.393754,0.753008, &
            0.204929,-0.593367,0.384544,-0.405920,1.152635,-0.059473,0.322893,0.791303, &
            0.010173,-0.056301,-0.828927,0.020319,0.011332,0.199055,-0.712800,0.042863, &
            0.123046,0.085447,-0.445146,0.017376,-0.000205,0.140035,-0.237305,0.158215, &
            -0.035240,-0.017961,-0.569904,-0.119395,-0.067992,0.133020,-0.220461,0.140006, &
            0.132688,0.014110,-0.580502,0.101371,-0.280460,0.165689,-0.242134,-0.013319, &
            -0.043678,-0.093555,-0.494941,0.140313,-0.020319,0.172171,-0.389384,0.134702, &
            -0.003832,0.043334,-0.396526,-0.056145,-0.200379,0.046555,-0.590463,-0.022745, &
            0.073568,0.100328,-0.679760,-0.286231,-0.371254,0.229513,-0.762800,0.020914, &
            0.468669,0.424949,-0.718992,-0.135061,-0.163659,0.333857,-0.865741,0.155721, &
            0.172213,0.697530,-0.165461,-0.352973,-1.558093,-0.086792,-0.147737,0.078138, &
            0.582711,0.876979,-0.064476,-0.776072,-1.590370,0.397955,0.359824,0.378357, &
            1.452037,0.526084,0.150089,-1.864707,-0.904184,0.177457,0.342496,0.130829, &
            0.534903,0.219954,-0.020564,-0.791792,-0.367636,0.235034,0.480971,0.206510, &
            0.911922,0.578292,-0.201995,0.162990,-0.230266,0.067438,0.493851,0.515896, &
            0.621292,0.195820,0.246022,0.610560,-0.662359,-0.188149,0.114864,0.278561, &
            0.557870,0.143456,0.908309,0.514103,-0.971476,-0.326680,-0.309620,0.255562, &
            0.255478,-0.195347,0.665546,0.701398,-0.315038,0.078534,-0.149904,0.059698, &
            0.308889,0.351638,0.297871,1.503018,0.103996,0.318875,-0.351093,0.284999, &
            0.363727,-0.085762,-1.038413,1.523562,0.044322,0.276805,-1.063397,-0.252812, &
            0.080951,0.004775,0.343043,-0.224597,0.161536,0.014715,-0.066713,0.239829, &
            0.059045,-0.020130,0.251554,-0.016760,0.004853,-0.015149,-0.050915,0.167183, &
            0.033456,-0.047138,0.276670,0.127698,-0.019730,0.051849,-0.080218,0.074855, &
            0.059979,-0.052552,0.321543,0.134415,-0.065577,-0.015458,0.027728,0.120858, &
            -0.073788,-0.006067,0.499071,-0.038066,0.050696,-0.021573,-0.060533,0.035130, &
            -0.034221,0.011186,0.453084,-0.084217,0.064420,0.035280,-0.050128,-0.021451, &
            -0.070061,-0.021346,0.373241,-0.062678,0.052156,0.017903,-0.093361,0.032655, &
            -0.081383,0.041651,0.349913,-0.069733,0.046234,0.076714,-0.187090,-0.138892, &
            0.013004,0.232880,0.144548,-0.000541,0.281625,-0.143821,-0.164193,-0.120623, &
            -0.144730,-0.007013,0.057991,-0.018142,-0.123241,-0.186966,-0.540222,0.156263, &
            0.065033,0.000239,0.245449,-0.226493,-0.014552,0.071678,0.197675,-0.031063, &
            -0.013179,0.066973,0.023550,-0.046988,0.074707,-0.014648,-0.004365,-0.174186, &
            0.031729,0.178076,-0.336671,-0.106005,-0.013578,0.150774,0.031574,-0.468831, &
            -0.176621,0.047475,-1.933221,0.120722,-0.165509,-0.240922,0.425224,-0.481420, &
            -0.027009,-0.015803,0.042576,0.084718,0.002348,-0.190581,-0.012135,0.076738, &
            0.291393,-0.113319,0.080333,-0.111477,-0.132269,0.358373,0.148642,0.408229, &
            0.003553,-0.093136,-0.724678,-0.117764,-0.046563,-0.137382,-0.205411,0.535298, &
            -0.070882,-0.011875,-0.535339,-0.059605,0.079623,-0.113143,-0.473139,0.186053 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.781974,-1.408255, &
            1.901318,3.735442, &
            1.954380,2.757650, &
            -3.035437,4.826260, &
            -0.307327,-2.261627, &
            1.323516,4.070508, &
            -1.255984,3.591965, &
            1.530932,1.968034 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.893086,1.901327/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-1.687516,1.613379,0.392655,1.489334,-1.833367,1.565009,1.369054,1.908688/)
real, dimension(2) :: bias2 = &
(/-0.651191,-0.74328/)
real, dimension(1) :: bias3 = &
(/0.278691/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
