module fnet_MidR_intake

! a = 0.00084822
! b = 0.0059421

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.074839,0.069078,0.296622,0.167552,0.067093,-0.187504,0.013520,-0.079878 &
			,0.092732,-0.034764,0.283942,0.025396,0.004127,-0.050598,0.095219,-0.090756 &
			,0.088264,0.001730,0.117002,0.041972,-0.005333,-0.038155,-0.021567,-0.007509 &
			,-0.065457,-0.035007,-0.090098,-0.070055,0.013539,0.057568,0.004193,-0.007609 &
			,0.051428,-0.052032,0.137167,-0.032805,-0.003431,0.026781,-0.020340,-0.008065 &
			,0.111156,-0.047647,0.160170,-0.005685,0.016474,-0.007160,0.018658,-0.054042 &
			,0.053419,-0.090742,0.102890,-0.053496,-0.024491,0.035315,-0.027785,-0.014861 &
			,0.198058,-0.132428,0.243172,-0.007534,-0.080942,-0.001697,-0.147740,0.005386 &
			,0.588586,-0.392033,0.099964,0.436379,0.116369,-0.349133,-0.954666,0.045105 &
			,-0.648056,-0.106080,-1.342066,0.360470,0.270815,-0.292873,-0.135931,-0.147042 &
			,-0.566328,-0.019357,-0.439466,0.308937,-0.124611,-0.524965,0.487029,-0.330101 &
			,-0.736743,-0.065627,-0.229485,0.336588,-0.186076,-0.307764,0.549863,-0.211941 &
			,0.155797,-0.037175,-0.032385,-0.060187,-0.110137,0.042426,0.296023,-0.019243 &
			,0.273036,0.094912,0.464368,-0.183248,-0.023454,-0.004007,-0.149696,0.011353 &
			,-0.299825,0.033222,0.080659,0.119031,-0.239648,-0.077404,-0.401339,0.179308 &
			,-0.741554,0.140655,-0.947945,-0.029476,-0.007768,-0.009754,-0.231580,0.081981 &
			,-0.488988,0.233714,-0.842634,0.078388,-0.023869,-0.100619,-0.507859,0.129611 &
			,-0.705179,0.198616,-0.985394,-0.420872,-0.171088,0.117130,-0.320917,0.052336 &
			,-1.046126,-0.084510,-0.569374,0.173130,0.179015,-0.118539,-0.322470,-0.099553 &
			,-0.863661,0.148997,-0.678150,0.289019,0.122968,-0.187807,-0.252703,0.121259 &
			,-0.790227,0.115675,-0.849522,0.074135,0.190687,-0.065968,0.108879,-0.009240 &
			,-0.711703,-0.021838,-0.704258,0.167954,0.064931,-0.169405,0.165063,-0.110946 &
			,-0.558277,0.121542,-0.729689,-0.016093,0.277227,0.017175,0.095990,0.030800 &
			,-0.694667,0.147248,-0.701583,0.039956,0.270054,-0.118923,0.141387,-0.061917 &
			,-0.575828,0.135484,-0.801957,0.039503,0.206641,-0.112872,0.174379,-0.091641 &
			,-0.712816,0.198598,-0.537709,0.043288,0.285202,-0.163350,0.643372,-0.171557 &
			,-0.785038,1.190770,-0.682350,-0.445069,-0.327890,-0.103945,1.331724,0.200660 &
			,-0.375504,1.246987,-0.578909,-0.269357,-0.545453,0.035383,0.455700,0.139723 &
			,0.295556,0.872835,-0.679662,0.205949,-0.222344,-0.106192,-0.015426,0.031106 &
			,0.329297,0.569337,-0.042920,-0.036412,-0.630982,-0.174740,0.177827,-0.045640 &
			,0.135114,0.487795,0.479500,-0.347043,-0.675853,0.269169,0.220637,0.182066 &
			,0.213273,0.003190,0.102762,-0.135618,-0.768336,0.072121,-0.118842,0.149627 &
			,0.859906,-0.061788,-0.557072,0.016339,-0.213118,-0.069836,-0.309509,-0.075400 &
			,0.580035,0.433333,1.160771,0.117055,-0.021022,-0.144775,0.015296,-0.059877 &
			,0.713108,0.284164,2.388095,0.170278,-0.305206,-0.046418,0.876147,-0.018814 &
			,2.861101,-1.405862,1.235582,-0.143206,-0.813997,-0.009505,2.016370,-1.060398 &
			,-0.626821,-0.201574,-0.402072,-0.280579,-0.829447,0.072594,0.009799,0.198409 &
			,-0.397290,-0.271025,-0.268173,-0.519323,-0.338753,0.157605,-0.170676,-0.151687 &
			,-0.121993,0.049682,-0.291307,-0.397780,-0.067676,0.084513,0.239596,-0.153666 &
			,-0.417019,-0.291095,-0.450504,-0.362673,0.024134,0.018084,0.259240,-0.290986 &
			,-0.240347,-0.368267,-0.648256,-0.324553,0.183567,0.018790,0.147845,-0.435367 &
			,-0.085051,-0.823277,-0.870030,-0.487258,0.265697,0.112078,0.136410,-0.680375 &
			,0.305910,-1.322933,-1.121000,-0.247215,0.309751,0.118894,-0.071789,-0.590057 &
			,0.459039,-2.127921,-1.170061,-0.312963,0.193179,0.112682,-0.039864,-0.877877 &
			,0.729078,-6.073959,-1.723714,-0.884277,2.860570,-0.083419,0.386514,-0.507119 &
			,-0.480965,-8.576137,-1.659672,-0.633721,5.812692,0.269936,0.736024,0.120785 &
			,-1.132398,-8.599880,-3.080753,0.219364,9.132204,-0.020850,0.988857,-0.603993 &
			,-1.061450,-6.644522,-0.076905,-0.296960,8.658243,0.039791,0.807399,-0.088669 &
			,-0.569846,-5.031527,-0.024604,-0.312335,7.376876,0.106913,1.172968,-0.157471 &
			,-1.749585,-2.972521,-1.399151,-0.454581,6.455192,0.163369,0.381243,-0.622574 &
			,-0.350408,-1.140928,-0.137783,-0.135614,5.114265,-0.030118,0.217425,-0.619899 &
			,0.059682,-0.151315,2.274419,0.359285,4.545047,-0.239863,-0.068287,-0.490867 &
			,0.904707,-0.038282,3.034309,0.141559,3.835410,-0.204185,-0.554130,-0.371688 &
			,0.472638,-1.244895,4.956632,0.336587,3.360991,-0.357872,-0.331650,-0.252169 &
			,1.021222,-1.240036,3.192816,0.077063,0.811512,-0.309490,0.596108,-1.019042 &
			,1.335210,-1.294252,2.839624,0.326479,0.416255,-0.697543,0.741202,-1.253948 &
			,1.487171,-1.335352,2.485599,0.306778,0.169471,-0.577238,0.919713,-1.285060 &
			,1.092384,-1.488752,2.778873,0.265699,0.050703,-0.357239,0.387137,-1.632917 &
			,0.826848,-1.279950,2.539937,0.246607,0.001708,-0.297116,0.346284,-1.730602 &
			,0.563891,-1.666147,2.816031,-0.161125,-0.250438,-0.245992,-0.088118,-2.137968 &
			,0.426897,-1.834425,2.679924,-0.147610,-0.486893,-0.122207,-0.260360,-2.287549 &
			,0.090368,-1.637475,2.882023,-0.283047,-0.649321,-0.441430,-0.484978,-2.428721 &
			,-1.448650,-2.507328,3.427084,-1.090750,-1.404174,-0.455890,-2.412821,-3.899879 &
			,-2.553320,-3.285208,1.649010,-0.318219,0.707202,-0.788762,-2.916424,-4.067561 &
			,-1.954767,-2.903632,-2.978582,0.096530,2.472739,-0.645659,-0.527989,-2.607293 &
			,-0.076181,-2.077265,-2.040721,-0.155337,2.525413,0.193859,0.860764,-0.761670 &
			,0.609070,-1.206484,-1.692282,-0.091557,2.520364,0.120863,1.297637,-0.203535 &
			,-0.012980,-0.474428,-1.794732,-0.269264,2.689220,0.160764,0.901032,0.036589 &
			,0.987078,-0.237007,-0.342405,0.007307,2.656176,0.434514,0.782675,-0.036690 &
			,1.194238,-0.388485,1.459655,-0.491115,1.482940,0.265601,1.455293,-0.309631 &
			,1.426768,-0.929584,1.455432,-0.024123,1.358956,-0.016132,1.102954,-0.738781 &
			,2.736168,-1.458528,0.884443,1.189967,2.026658,-0.657944,1.752917,-0.551911 &
			,0.347678,0.152993,0.040410,-0.001780,-0.118360,0.002337,-0.583973,0.332253 &
			,0.181048,-0.052730,-0.006948,0.092977,-0.022888,-0.033061,-0.152440,0.026386 &
			,0.144181,0.056176,0.142629,-0.073532,0.049642,-0.018243,0.170323,-0.050226 &
			,0.000111,0.003602,-0.100239,0.051553,-0.103569,-0.086879,-0.107480,0.070979 &
			,-0.200030,0.170275,-0.146218,0.053445,-0.102321,-0.083437,-0.093192,0.160237 &
			,0.122030,-0.038556,0.065418,-0.127057,0.042101,0.032636,0.048741,-0.030395 &
			,0.283428,0.085078,0.231881,-0.029762,-0.051861,-0.008419,-0.099118,0.109397 &
			,0.606365,0.108915,0.191822,0.049961,-0.286249,-0.088995,-0.487232,0.266262 &
			,0.814278,0.243304,0.037790,-0.240917,-1.456041,0.003879,-0.610661,0.953466 &
			,0.585580,0.622790,-0.248745,-0.392020,-1.170988,0.050430,-0.497118,0.778857 &
			,0.407089,0.961507,-0.020791,0.006997,-1.004760,0.373955,-0.417449,0.363125 &
			,0.653949,0.576568,-0.238768,0.191700,-1.204990,0.257340,-0.655131,0.537109 &
			,0.639294,0.928745,-0.897605,0.248578,-0.519581,0.100863,-0.185949,0.109240 &
			,1.171472,0.182271,-0.353723,0.601100,0.404162,-0.259741,-1.108085,0.290594 &
			,0.115145,-0.157236,-0.962739,0.490654,0.639240,-0.236386,-0.712851,0.133654 &
			,-0.152125,-0.505200,-1.029140,0.348076,1.060312,-0.349097,-0.533016,0.122241 &
			,-0.298643,0.144277,-0.317589,0.488928,1.129030,-0.448180,-1.194071,0.361525 &
			,-0.895819,-0.286213,-0.701017,0.244575,0.539624,-0.002078,-0.490213,0.365859 &
			,0.437193,-0.111366,1.015496,-0.010791,-0.092876,-0.255617,0.128649,-0.160834 &
			,0.566130,-0.072073,0.940553,0.211873,0.024071,-0.239600,-0.007333,-0.102921 &
			,0.496727,-0.110620,0.565252,0.166023,-0.066203,-0.259493,-0.162690,-0.082305 &
			,0.476950,0.097485,0.625506,0.099206,0.121717,-0.212276,-0.057766,-0.057009 &
			,0.362303,-0.036445,0.522950,0.051390,0.014439,-0.206794,-0.097201,-0.148850 &
			,0.346766,0.015284,0.463323,-0.005930,0.022918,-0.072902,-0.080025,0.022005 &
			,0.727008,0.024483,0.224055,0.192694,0.219345,-0.047031,-0.074918,-0.006751 &
			,0.475695,0.180903,0.471132,0.126890,0.159709,-0.151050,0.135470,0.077057 &
			,0.999132,1.016723,0.519323,-0.186453,-0.322405,-0.316527,0.770066,0.128922 &
			,0.977570,1.356268,0.225968,-0.060018,-0.627771,-0.096831,1.298081,0.058827 &
			,-0.159879,1.072699,0.821708,-0.223930,-0.913813,0.037913,1.011640,0.321032 &
			,-0.651874,0.591538,0.382812,-0.685983,-0.900558,0.049032,-0.068535,0.229019 &
			,0.917040,0.634966,-0.078508,-0.348922,-0.414859,-0.006441,-0.049337,0.308034 &
			,1.911415,0.279437,0.563772,-0.608929,-0.535393,0.440916,0.384461,0.186602 &
			,0.420978,0.235152,0.822543,-0.524896,-0.703925,0.414545,1.026961,0.011993 &
			,1.100298,0.050012,-0.029841,-0.296551,-0.343683,0.235836,1.018859,-0.167830 &
			,0.335847,-0.289025,0.390351,-0.395287,-0.715393,0.398367,0.602519,0.020611 &
			,-0.936840,-0.162022,0.456764,-0.735021,-0.841626,0.329299,0.174246,0.113780 &
			,0.017090,-0.029945,-0.066473,0.058726,-0.032955,0.020020,-0.129929,0.100296 &
			,-0.093397,0.009035,-0.235804,-0.075909,0.057668,0.065189,0.052025,-0.008406 &
			,0.122536,-0.003571,0.112842,0.054922,-0.006259,-0.024786,0.022031,-0.001692 &
			,-0.098102,0.014474,0.061813,0.053863,0.024609,-0.086315,0.077378,-0.079373 &
			,0.038555,0.012527,-0.054823,-0.008389,-0.019938,-0.012552,-0.072558,0.014110 &
			,-0.018268,0.043783,-0.094138,-0.004855,0.039011,0.008223,-0.041756,0.021868 &
			,0.047387,-0.012683,0.141237,0.014251,-0.005011,-0.010321,0.095537,-0.032776 &
			,0.144417,0.001349,0.334300,0.043114,0.003081,-0.053749,0.079275,-0.053667 &
			,0.240872,0.015657,0.448675,0.004737,-0.137908,-0.094915,0.063622,-0.018843 &
			,0.368894,-0.033510,0.190859,-0.015176,-0.112438,-0.003249,-0.039491,0.019553 &
			,-0.570376,-0.020058,-0.304996,-0.085632,0.044751,0.015557,0.332176,-0.119006 &
			,-0.066815,-0.101722,0.167421,-0.126203,-0.181783,0.061551,0.089479,0.021741 &
			,0.442615,0.046874,-0.193941,-0.085123,0.139911,0.069775,-0.185382,0.059537 &
			,0.069812,-0.023097,0.422189,0.095204,0.059115,-0.070239,0.259312,-0.107169 &
			,0.021349,-0.109512,0.264289,0.060591,-0.140691,-0.073462,0.170242,-0.082020 &
			,-0.044693,-0.107800,-0.231274,-0.156235,-0.137418,0.122358,0.083661,0.002203 &
			,-0.270716,-0.020420,0.043662,-0.045503,0.052680,0.042651,0.043776,0.011077 &
			,0.544498,0.089716,0.186453,-0.131358,0.102314,0.031376,-0.051585,-0.003653 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.806710,-0.524614 &
			,4.887666,-1.872335 &
			,0.802730,0.698943 &
			,0.746278,1.878205 &
			,-2.115900,-0.880080 &
			,2.711530,0.619394 &
			,-1.109591,-0.944890 &
			,-2.670716,-2.243852 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.49363,0.784527/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-2.856086,0.069572,0.952993,1.33697,-0.257453,1.778628,-1.797935,0.796884/)
real, dimension(2) :: bias2 = &
(/-0.098314,-0.040638/)
real, dimension(1) :: bias3 = &
(/-0.143152/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
