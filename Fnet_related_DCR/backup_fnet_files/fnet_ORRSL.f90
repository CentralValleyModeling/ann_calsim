module fnet_ORRSL

! a = 0.00057239
! b = 0.038113

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.145871,-0.188120,0.011386,0.027597,0.062707,0.077347,-0.342838,0.076335 &
			,0.091937,-0.055840,0.029645,-0.003455,-0.030548,0.020896,-0.232812,0.077392 &
			,0.106932,0.006519,-0.016445,0.105853,-0.071811,0.089346,-0.255011,-0.065720 &
			,0.046233,-0.009922,-0.024234,0.034045,-0.085963,0.104762,-0.149661,0.058385 &
			,0.061770,-0.084203,0.028008,0.092138,0.063112,0.034190,-0.027335,0.087369 &
			,0.077072,0.128603,0.035187,0.070024,-0.039594,0.012511,-0.167338,-0.067560 &
			,0.134599,0.020466,0.097470,0.028453,-0.007842,-0.051231,-0.235971,0.117509 &
			,0.061548,0.127048,0.109670,0.109605,0.034321,-0.096765,-0.044678,-0.003003 &
			,0.314432,0.268886,0.173939,0.245011,0.132354,0.048507,-0.310503,0.245246 &
			,0.349004,0.259292,0.072251,-0.467961,0.301399,-0.148781,-0.836639,-0.110756 &
			,0.496258,0.080432,0.178711,-0.296591,0.468222,-0.465347,-0.869785,-0.254984 &
			,0.386849,-0.013406,-0.101145,-0.120362,0.079703,-0.202127,-0.690938,-0.183213 &
			,0.061757,0.014387,0.020283,-0.151070,0.128566,-0.164410,-0.090483,-0.042056 &
			,0.174206,-0.150819,0.024709,0.055576,0.307896,0.128928,-0.351158,-0.115907 &
			,0.143051,-0.392646,0.020911,-0.194763,0.343586,0.271673,-0.410779,0.231648 &
			,0.045185,-0.150330,-0.079948,-0.468547,0.385549,0.145204,-0.255468,-0.036080 &
			,-0.123983,0.413764,0.375921,-0.302468,0.319936,-0.170516,0.262142,-0.180831 &
			,-0.359730,0.799193,0.851229,0.238491,0.093285,-0.401639,0.998060,-0.388258 &
			,0.044781,0.063659,-0.029451,-0.540618,0.283464,0.221949,0.203342,0.414693 &
			,0.013519,0.081818,-0.250437,-0.506567,0.057318,0.309226,-0.097240,0.123372 &
			,-0.132391,-0.061201,0.024421,-0.230109,0.109393,0.013747,0.191499,0.187242 &
			,0.006496,-0.097123,-0.154762,-0.361458,0.064623,0.163652,-0.022978,0.267437 &
			,-0.003416,-0.045800,-0.146714,-0.374880,0.169433,-0.139452,0.064582,-0.009025 &
			,-0.194697,-0.124557,-0.242343,-0.509371,0.100671,0.026313,0.136298,-0.004509 &
			,-0.129010,-0.187980,-0.129330,-0.467756,0.023354,-0.083253,-0.045508,0.075515 &
			,-0.157390,-0.124521,-0.152414,-0.468091,-0.056750,-0.184764,0.010719,-0.086786 &
			,-0.101430,-0.623620,0.280608,-0.796469,-0.278797,-0.286395,-0.307243,-0.308191 &
			,0.233257,-0.938512,0.285813,-0.347261,0.142951,0.066822,-0.546239,-0.498133 &
			,0.336632,-0.804804,0.074127,-0.397294,0.119424,-0.126808,-0.382130,-0.387057 &
			,-0.231549,-0.929857,0.040380,-0.205332,-0.094948,-0.587148,0.291809,-0.356352 &
			,-0.117882,-0.828142,0.308637,0.069126,0.153974,-0.230026,0.350610,0.008838 &
			,-0.030424,-0.496081,0.134848,0.071413,0.088845,0.421055,0.175687,0.183583 &
			,0.128722,-0.206629,-0.067476,0.101227,0.209668,0.571320,0.161425,0.087104 &
			,-0.032532,-0.186507,-0.189017,-0.008620,-0.078213,-0.100157,0.424691,-0.035527 &
			,-0.416539,-0.253362,0.371447,0.186902,-0.113845,-0.251818,0.555098,-0.086430 &
			,-0.156372,0.149318,0.491559,1.135101,-0.666110,-0.599197,-0.075453,-0.162913 &
			,-0.370800,-0.243022,0.268802,1.378486,-2.007436,0.272547,-0.154300,0.071494 &
			,-0.510842,-0.073950,-0.005797,1.331620,-2.040914,0.088518,-0.285725,0.117082 &
			,-0.446522,0.361017,0.076848,1.399641,-1.813542,0.355108,-0.122768,0.105859 &
			,-0.604662,0.505019,-0.137252,1.399165,-1.976336,0.369110,0.076848,0.267341 &
			,-0.286259,0.742518,0.101553,1.830808,-1.992164,0.440416,0.044615,0.624478 &
			,-0.355608,0.782472,0.164519,1.776208,-1.848035,0.253254,0.034404,0.751729 &
			,-0.308095,0.996801,-0.006084,1.920961,-1.923108,0.314747,0.177505,0.950125 &
			,-0.216936,1.405358,-0.140398,2.306227,-1.768683,0.562660,0.336707,1.129894 &
			,-0.927878,4.835106,-3.106677,4.907358,0.199652,0.653990,0.199875,5.054956 &
			,-0.647643,6.626168,-5.260652,6.384380,0.723086,0.583351,0.702586,7.377914 &
			,-0.795787,6.059802,-5.559600,5.700753,0.285300,-0.229755,1.165176,6.905148 &
			,-0.628793,4.875123,-4.807025,4.252615,0.151942,-0.698477,0.963910,4.942629 &
			,-0.469715,3.896704,-3.860187,3.106021,-0.320858,0.030909,0.572285,3.632927 &
			,-0.015458,2.522466,-2.741693,1.565401,-1.111014,0.946816,0.124922,2.177429 &
			,0.133034,2.029798,-2.193942,0.791597,-1.297799,0.566191,-0.688268,1.526665 &
			,0.494531,1.156382,-1.654649,-0.026858,-2.141710,-0.007886,-0.840147,0.969794 &
			,0.157164,1.506684,-1.612104,0.151835,-1.877265,-0.717943,-0.625731,1.218859 &
			,0.042760,1.971503,-1.935841,0.803548,-2.033178,-0.889444,-0.351605,1.156522 &
			,0.496632,0.151285,-0.442219,1.108321,-0.988035,0.429578,-1.181635,0.672443 &
			,0.566170,0.274083,-0.386865,0.922974,-0.820782,0.784063,-0.915125,0.830376 &
			,0.563501,0.119615,-0.203648,1.270967,-1.227798,0.750898,-0.798138,0.483158 &
			,0.383976,0.317732,-0.029707,1.312836,-1.268542,0.956563,-0.790113,0.562813 &
			,0.549151,0.499309,-0.165584,1.102550,-1.209922,0.862119,-0.746628,0.542148 &
			,0.363911,0.643622,-0.043803,1.374771,-1.190807,0.788493,-0.679077,0.806739 &
			,0.282680,0.617076,-0.401226,1.496601,-0.955620,0.880290,-0.922881,0.954630 &
			,0.522990,0.922393,-0.390344,1.695522,-0.913922,0.926526,-0.825734,0.690145 &
			,0.282547,1.632304,-0.892513,2.138539,-0.596489,1.055377,-1.083504,1.583942 &
			,-0.425584,2.244731,-1.459866,2.070388,-0.253840,0.231333,-1.415468,1.913268 &
			,-0.296983,1.926092,-0.944663,1.882349,-0.338719,-0.214136,-0.656694,1.180321 &
			,-0.281414,1.573645,-0.727165,1.218008,-0.602731,-0.206780,-0.132376,0.630601 &
			,-0.004734,1.396527,-0.224757,0.100434,-1.173198,-0.613708,-0.663138,0.258883 &
			,-0.525946,1.380395,-0.465963,-0.002815,-0.912391,-0.972024,-0.225511,0.090756 &
			,-0.131749,0.473707,-0.540396,0.045873,-1.280791,-0.658165,0.383282,-0.058052 &
			,-0.303817,0.316866,-0.639578,0.095898,-0.965272,-0.283829,0.244855,-0.006251 &
			,-0.257320,0.727761,-0.917203,0.448682,-0.984348,-0.043964,0.558162,0.487310 &
			,0.127048,1.011829,-1.222725,0.345253,-1.047997,-0.544764,0.682927,0.457745 &
			,-0.075287,0.137500,0.058584,-0.038316,0.141639,-0.057784,0.146392,-0.132269 &
			,0.074444,0.200044,0.004466,0.017502,-0.035153,0.006382,-0.039603,-0.070451 &
			,-0.087995,-0.151853,0.030374,-0.037976,0.126543,-0.054867,-0.037653,-0.039109 &
			,0.080929,-0.037284,-0.131942,-0.116135,0.131105,-0.010462,0.146272,0.063539 &
			,-0.016490,-0.144586,0.016616,0.051920,0.069623,-0.212724,0.080453,-0.048945 &
			,-0.068664,0.036064,-0.150770,-0.164849,-0.086265,0.150374,-0.030909,-0.025856 &
			,0.022718,0.186562,0.072118,-0.042354,0.183906,-0.019415,0.028290,-0.161629 &
			,0.021523,0.143678,0.369102,0.194827,0.316372,-0.049435,0.104810,-0.171244 &
			,0.108091,0.493214,0.508973,0.125409,0.785067,0.020320,0.230359,-0.368428 &
			,-0.315569,0.260657,0.226494,-0.359481,0.601909,-0.469793,0.352157,-0.556721 &
			,-0.059359,-0.374387,0.072173,-0.217348,0.099775,-0.355389,0.384684,-0.433178 &
			,-0.038047,-0.218024,-0.060444,-0.320251,0.023332,-0.654381,0.192838,-0.439064 &
			,0.036251,-0.743736,-0.229624,-0.611059,0.163203,-0.658453,0.225754,-0.248733 &
			,0.230567,-0.147950,-0.220473,0.031534,0.164089,-0.971046,0.470601,0.155494 &
			,0.081927,-0.119846,-0.406799,0.212877,-0.149952,-0.457456,0.721531,0.310641 &
			,0.334077,-0.165522,-0.409306,0.532304,0.057741,-0.192568,-0.001745,0.634081 &
			,0.252885,0.236746,-0.191353,0.142288,0.279642,0.158733,0.018738,0.409001 &
			,0.297913,0.108703,-0.140318,0.669043,-0.121779,0.141091,0.009221,0.556197 &
			,-0.061649,0.342846,0.031414,-0.062239,0.021965,-0.054498,-0.103081,-0.028162 &
			,-0.082596,0.417723,0.096942,-0.122830,-0.374999,-0.188121,-0.188632,0.010694 &
			,-0.167516,0.126393,0.161768,-0.043197,-0.146411,-0.039348,-0.190843,0.022741 &
			,-0.092128,0.077236,-0.178059,-0.275873,-0.082115,-0.080419,-0.102277,-0.175355 &
			,0.069986,0.120357,-0.032168,-0.007752,0.027777,-0.202795,-0.168915,-0.262971 &
			,0.007127,0.165800,-0.039004,-0.462562,0.197276,-0.260012,-0.057000,-0.177408 &
			,-0.229882,-0.085973,-0.165029,-0.563089,0.194067,-0.235431,-0.227009,-0.269868 &
			,-0.030868,0.075723,-0.031466,-0.321473,0.223131,-0.366111,-0.261615,-0.246764 &
			,-0.571943,-0.572280,0.327701,-0.657164,0.224044,-0.707212,-0.329057,-1.035398 &
			,-0.467266,-1.052016,0.351995,-0.831135,0.558143,-0.786116,-0.166812,-1.144650 &
			,-0.509176,-0.880009,0.205664,-0.657284,0.903729,-0.397745,0.220604,-0.708640 &
			,-0.318988,-0.646662,0.147497,-0.208484,0.860337,-0.291917,0.310207,-0.583602 &
			,-0.356395,-0.847645,-0.075976,-0.207983,0.396377,-0.066596,0.078312,-0.205474 &
			,-0.593945,-0.819935,0.452982,-0.012862,0.092114,-0.089351,-0.219068,-0.170986 &
			,-0.412536,-0.602808,0.456051,0.009594,-0.100615,-0.019038,-0.031456,0.039994 &
			,-0.273281,-0.064664,0.427552,-0.085013,0.216540,0.297850,0.424308,0.105317 &
			,-0.369688,-0.116805,0.544692,0.326996,0.186331,0.503018,0.120177,-0.079775 &
			,-0.489326,0.289695,0.476073,0.685921,0.313549,0.686317,0.369111,-0.471038 &
			,0.020775,0.101654,0.085946,-0.058573,0.036721,-0.116577,0.059078,0.083221 &
			,0.024831,-0.084371,0.085167,0.032458,0.018980,-0.104194,0.007112,0.105480 &
			,-0.009663,-0.136864,-0.114316,0.033076,-0.128110,-0.045091,0.070909,0.079837 &
			,-0.089510,0.045635,-0.090475,-0.033261,-0.080754,0.094201,0.042439,-0.101032 &
			,0.027157,-0.069118,0.040240,0.053440,-0.070403,-0.024652,-0.026575,0.116896 &
			,0.020616,0.079735,-0.011055,-0.113266,0.128236,-0.031717,0.000731,-0.084807 &
			,0.009750,-0.079659,-0.029670,0.048430,-0.078234,0.092051,-0.050596,0.081919 &
			,0.040693,0.014597,0.108356,-0.100353,0.072577,-0.031700,-0.001630,0.185348 &
			,0.033676,-0.155220,0.452612,0.023703,-0.101447,-0.522889,-0.297749,0.408483 &
			,0.091408,0.035207,0.308591,-0.136741,0.162432,-0.032635,-0.081489,0.393576 &
			,-0.173319,-0.207870,-0.159010,-0.008199,0.043277,0.164220,0.413726,0.131331 &
			,0.000355,-0.255540,-0.032341,0.136496,0.074715,-0.033780,-0.008449,-0.012092 &
			,0.056367,-0.065399,0.015002,0.037374,0.035895,-0.066607,-0.135203,0.008894 &
			,-0.008812,0.135715,0.001811,0.383933,-0.220726,0.024278,0.146453,-0.213176 &
			,-0.153563,0.269301,-0.125781,0.187603,-0.205102,-0.329735,-0.025526,-0.778789 &
			,0.032517,0.212615,0.004243,-0.042858,0.028837,0.041487,-0.066293,-0.214022 &
			,0.117321,0.129948,-0.140913,-0.315198,0.174389,0.116705,-0.063213,0.040514 &
			,-0.025308,-0.179205,-0.118230,-0.230417,0.204412,0.127913,-0.013894,0.103999 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.639686,2.289612 &
			,-2.395123,1.009364 &
			,2.895985,-0.905354 &
			,-1.806616,-0.628093 &
			,-1.092424,-0.888958 &
			,2.333033,-0.630974 &
			,1.025446,0.488002 &
			,-2.096074,0.433654 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.12567,0.923254/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.312081,-1.072645,1.289644,-1.090849,-1.168076,1.510822,1.997615,-1.299052/)
real, dimension(2) :: bias2 = &
(/0.324734,0.166502/)
real, dimension(1) :: bias3 = &
(/-0.561908/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
