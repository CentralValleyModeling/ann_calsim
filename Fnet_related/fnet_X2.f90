module fnet_X2

! a = 0.015276
! b = -0.57708

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/-0.956156,1.370761,1.319049,-0.379921,0.028443,0.094936,0.807672,-1.421522 &
			,-1.726197,0.583306,3.251594,0.524600,-1.334241,1.435476,-0.353668,0.241725 &
			,-2.278696,-0.280952,4.035211,0.584261,-1.309397,1.753174,-0.777782,1.144484 &
			,-2.108978,-0.267753,3.751218,0.013942,-0.703734,1.802047,-0.767285,1.145361 &
			,-1.901647,-0.157375,3.389542,-0.483025,0.097771,1.691445,-0.802046,0.551467 &
			,-2.153004,-0.235041,2.283306,-0.353199,0.585754,2.050214,-0.772457,-0.279678 &
			,-2.554933,-0.413566,1.985013,-0.304148,0.490256,1.844338,-1.262725,-0.149276 &
			,-3.581587,-1.525931,2.373783,0.893676,0.116179,2.716881,-2.429302,0.801411 &
			,-8.191525,-6.513229,3.334917,7.252018,-0.662916,4.096760,-7.867539,4.843864 &
			,-2.092272,-3.505419,0.208477,8.375151,0.273000,-0.826712,-4.484480,0.260123 &
			,1.041632,-1.140718,0.180280,8.138327,-0.128124,-1.285839,-2.255337,-0.142763 &
			,1.597272,0.281132,-0.251380,6.387306,-0.395707,-0.293698,-1.241149,1.293714 &
			,0.593270,-0.171378,-0.253822,4.686561,0.441565,0.631691,0.028628,2.252336 &
			,0.285004,0.151291,0.103148,1.479156,-0.159923,0.454791,0.277270,2.048712 &
			,-0.643347,0.656807,0.173583,0.516773,-0.104791,-0.195747,0.200852,2.453085 &
			,-0.100880,0.023884,0.030205,0.173305,0.152067,-0.350921,-0.093515,2.537535 &
			,0.108040,0.108618,0.173363,0.378983,-0.313759,0.115859,0.095201,2.844385 &
			,0.499279,-0.591435,-0.408024,1.955161,0.166818,0.174486,0.267770,3.116463 &
			,-0.415287,0.408229,-0.028620,0.185850,0.058013,-0.475490,0.031525,0.465636 &
			,-0.208916,0.283281,-0.078255,0.121171,-0.158259,-0.615873,0.132921,0.824390 &
			,-0.270411,0.187133,0.014593,-0.067070,-0.006137,-0.045887,0.037857,0.054001 &
			,0.025293,0.058861,0.019395,0.016049,0.041753,0.255497,-0.043810,0.005325 &
			,-0.047201,-0.040647,0.067378,-0.073064,0.039043,-0.113393,-0.036375,0.029613 &
			,-0.074050,0.055680,0.054568,0.056274,-0.045658,-0.157744,0.117794,0.258194 &
			,-0.370507,0.071879,-0.024144,0.019035,-0.036308,-0.250175,0.241194,0.045460 &
			,0.111342,-0.046781,0.034876,0.114317,0.029510,-0.062107,-0.053031,-0.085096 &
			,-0.020438,-0.268767,-0.203172,-0.064599,-0.017640,-0.076984,-0.011705,-0.159830 &
			,0.075131,0.044050,0.056899,0.063726,0.025321,0.347332,-0.009569,-0.459984 &
			,-0.385270,0.147455,0.107973,0.173402,0.049874,-0.375397,0.272948,0.883634 &
			,0.121149,-0.198874,-0.202941,0.164474,0.069384,0.395608,0.237274,0.504637 &
			,0.064109,0.016255,-0.204669,-0.261108,-0.104790,0.601415,0.101939,0.818518 &
			,0.294618,-0.295772,-0.142540,0.057274,0.065275,0.115863,-0.054925,0.320304 &
			,0.002843,0.007637,0.038064,-0.146419,-0.063707,-0.175539,-0.113923,-0.106581 &
			,0.031757,-0.262994,-0.063922,-0.175112,-0.074279,-0.336328,0.100063,0.335653 &
			,0.211406,-0.104090,0.053100,-0.017328,0.074747,-0.160273,-0.291068,-0.020780 &
			,-0.017409,0.229072,-0.007017,-0.146839,-0.027090,0.406191,-0.127051,0.161916 &
			,0.113137,-0.221541,-0.784932,0.250606,0.119476,-0.051076,0.244261,0.048057 &
			,0.127495,-0.182025,-0.119488,0.087706,0.090361,0.037864,-0.002883,0.067266 &
			,0.143905,-0.086026,-0.125397,-0.067903,0.109067,0.176160,-0.069032,0.007876 &
			,-0.025495,-0.053820,-0.066870,0.096161,-0.021315,-0.204249,0.115849,0.003633 &
			,-0.076753,-0.044818,0.007460,-0.021171,0.096485,-0.089762,-0.002185,-0.356573 &
			,0.268666,-0.112544,0.048545,-0.025866,-0.090524,-0.190787,-0.082832,-0.012295 &
			,-0.045745,-0.114441,0.082732,-0.001328,0.080358,-0.164465,0.034442,0.087380 &
			,0.222660,-0.060951,-0.051226,0.216277,-0.288094,-0.063454,0.170446,-0.407388 &
			,0.347526,-0.400136,-1.004243,-0.171523,0.053736,0.087128,0.241754,-1.171449 &
			,0.536457,-0.556495,-0.050267,0.162836,-0.573363,0.731194,-0.208563,-1.060758 &
			,0.678772,-0.388283,-0.415392,-0.071357,-0.175456,0.653136,0.168216,0.129317 &
			,0.491890,-0.329854,0.194440,0.117196,-0.407577,0.766474,-0.326031,0.367729 &
			,0.769447,-0.331324,-0.447319,0.263283,-0.005885,0.518248,-0.304444,-0.193436 &
			,0.498018,-0.532335,-0.273449,0.086371,-0.136338,0.773405,-0.438244,0.491093 &
			,0.612208,-0.193647,-1.097405,-0.297384,0.204697,0.436307,0.036412,0.381688 &
			,0.320849,-0.176205,-0.187159,-0.426454,-0.638344,0.132909,-0.200341,0.386903 &
			,-0.010377,-0.313380,-0.586822,-0.545256,-0.484678,-0.207074,0.206488,0.342010 &
			,-0.532538,-0.371604,-0.560087,-0.543968,-0.496570,-0.159288,0.237239,0.598150 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.167477,1.991202 &
			,-0.399525,2.319536 &
			,-0.991900,-0.314571 &
			,-0.022073,-2.088334 &
			,1.033612,0.888966 &
			,-0.776541,-0.256503 &
			,-1.398771,2.060537 &
			,0.267203,-1.098181 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.363856,1.543442/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.745268,1.325516,-1.629852,-1.986483,0.792731,-1.110627,1.838553,-1.587794/)
real, dimension(2) :: bias2 = &
(/0.077661,0.131293/)
real, dimension(1) :: bias3 = &
(/-0.186444/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 54
  !  inarray2(i) = inarray(55-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
