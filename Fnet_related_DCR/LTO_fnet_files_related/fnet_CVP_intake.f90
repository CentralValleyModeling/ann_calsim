module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.130323,-0.104534,0.020262,0.076662,-0.242449,0.133248,-0.060183,0.441367, &
            0.077401,0.044021,0.101816,0.005541,-0.115008,0.095160,0.000011,0.428020, &
            0.035245,0.091591,0.059848,-0.016468,-0.081852,0.014881,0.135456,0.052516, &
            0.012697,0.051594,0.047243,0.033015,-0.007129,0.068109,-0.050770,0.248884, &
            -0.013118,0.004428,-0.005696,0.033926,0.003674,0.055480,-0.042784,0.083994, &
            -0.019323,0.060003,-0.044870,-0.128054,0.011027,-0.048940,0.177065,0.041738, &
            -0.006714,0.004506,-0.017967,-0.020426,0.002719,0.027439,-0.048597,0.076984, &
            -0.016221,0.120844,0.026342,-0.053851,-0.020719,0.147074,0.064024,0.224211, &
            0.258290,0.380878,0.115323,0.533419,-0.798531,0.365860,-0.154395,1.217186, &
            0.325299,-0.000901,-0.185692,0.787822,-0.445583,-0.325707,-0.816988,0.652939, &
            0.069492,0.091143,-0.155988,0.257537,-0.250655,-0.107161,-0.177299,-0.286424, &
            -0.031145,-1.852775,-1.143693,0.204809,0.083199,-1.151551,-0.311991,-0.608974, &
            -0.199964,-1.383116,-1.342693,-0.386030,0.186791,-1.212428,0.137566,-0.420301, &
            -0.109494,-0.281917,-0.553424,-0.001155,-0.033898,-0.265520,0.081219,-0.154433, &
            0.043009,-0.424800,-0.164069,-0.213293,0.370666,0.011169,-0.639517,-0.380689, &
            0.053499,-0.255906,-0.225865,0.212848,0.373116,-0.008589,-0.812269,-0.228468, &
            0.161815,-0.410587,0.014697,-0.381064,0.334123,0.578794,-0.518530,-0.605086, &
            0.413433,0.314822,0.115164,-1.171621,0.205920,0.101999,0.122664,0.503666, &
            -0.054473,-0.695324,0.106010,0.676427,-0.384931,0.398166,-0.605309,-1.544427, &
            0.208334,-0.909644,0.134161,0.508908,-0.497271,0.079061,-0.466090,-1.159560, &
            0.236003,-0.396399,0.180618,0.278110,-0.308748,0.127380,-0.428479,-0.980869, &
            0.045745,0.099690,0.102004,0.201250,-0.071686,0.103242,-0.229990,-1.118712, &
            0.052032,-0.019152,0.042995,0.242624,-0.014400,0.056111,-0.420213,-0.980275, &
            0.085256,0.064339,0.042874,0.365938,-0.177032,0.072635,-0.336514,-0.707570, &
            0.032735,0.086838,-0.166797,0.097925,-0.110930,-0.090771,-0.132316,-0.588727, &
            -0.044662,0.041317,0.104011,0.262821,-0.001087,-0.095047,-0.254890,-0.336603, &
            0.367321,0.094857,0.267303,-0.023669,-0.024039,-0.269466,0.025869,-0.003182, &
            0.722978,0.243366,0.307001,-0.120846,-0.031623,-0.284606,-0.069579,0.833705, &
            0.634203,0.833885,0.064651,0.024058,-0.056381,-0.190310,-0.155938,1.087271, &
            0.509548,0.670095,-0.071461,-0.121852,-0.216103,-0.372669,-0.091473,0.136509, &
            0.495629,0.488847,0.053586,-0.242558,-0.219536,-0.251011,0.466020,0.173696, &
            0.242866,0.177334,0.284506,0.133747,-0.336187,-0.163758,0.726047,0.212090, &
            0.172670,0.095757,0.281596,0.184793,-0.071297,-0.152870,0.429304,0.855416, &
            0.066891,0.323539,0.117871,0.142546,-0.047419,-0.268429,0.419250,1.003609, &
            0.080790,-0.553453,-0.132109,-0.162216,0.111239,-0.479798,0.547229,1.663580, &
            -0.170122,-0.693360,-1.006226,-0.153297,0.162145,-1.341693,1.099720,2.261178, &
            -0.214258,-0.231652,-0.534378,-0.185544,0.213042,-0.300989,0.613702,-0.238694, &
            -0.395045,0.322143,-0.520985,-0.207801,-0.149709,-0.204870,0.121436,0.147517, &
            -0.241654,0.707945,-0.339844,0.036778,-0.659610,-0.494307,0.075819,-0.074052, &
            -0.276741,0.352691,-0.283831,0.057331,-0.460842,-0.224662,0.249093,0.172845, &
            -0.237384,0.177122,-0.519426,0.057256,-0.174245,-0.243267,0.219946,0.416967, &
            -0.489792,0.004785,-0.433175,0.088952,-0.066113,-0.164852,0.152815,0.185316, &
            -0.753755,-0.509391,-0.410139,0.012272,0.018010,-0.309004,0.354611,0.134549, &
            -1.337959,-0.197566,-0.407446,-0.070847,-0.034155,-0.137116,0.315194,0.266496, &
            -4.718213,0.047549,-0.821716,-0.267292,-0.348246,-0.528635,0.018661,0.408569, &
            -6.310148,0.439838,-0.856600,-0.105631,-0.352181,-0.978929,0.458949,-0.611661, &
            -6.527920,0.153765,-0.733174,0.618469,-0.380689,-1.106882,0.584582,-0.347224, &
            -5.670093,-0.119230,-0.886869,-0.119567,0.060469,-0.638019,-0.141799,-0.317377, &
            -4.725928,0.505925,-0.934009,-0.184028,0.091146,-0.413548,-0.327920,0.107188, &
            -3.385786,0.263668,-1.359071,0.176033,0.127554,-0.278235,-0.484400,-0.068132, &
            -2.486220,0.400842,-0.853134,0.060958,-0.209038,0.272729,-0.694777,-0.185313, &
            -1.612603,-0.087047,-0.910055,0.666873,-0.422101,0.723760,-0.893255,2.079097, &
            -1.235055,0.063768,-1.067882,0.327844,-0.218896,0.400805,-0.715337,2.076437, &
            -1.957207,0.414156,-1.501985,0.082436,-0.148407,-0.916448,0.500936,0.955334, &
            0.180620,-0.350955,-1.788790,-1.341806,-0.806464,0.106973,-1.008943,-0.762555, &
            0.091925,-0.793579,-1.564956,-1.599655,-1.413178,-0.217088,-1.202841,-0.530707, &
            0.304049,-0.779980,-1.596116,-1.358675,-1.660699,0.082976,-1.237221,-0.652940, &
            0.041055,-0.607619,-1.968869,-0.842788,-1.226151,0.437404,-0.592075,-0.760137, &
            0.300103,-0.343292,-2.047624,-0.976202,-0.806047,0.838657,-0.183213,-1.230762, &
            0.236258,-0.194873,-1.743816,-0.446460,-0.593164,0.671814,-0.108107,-1.437011, &
            0.510783,-0.457502,-2.033230,-0.343373,-0.242510,0.717405,0.089853,-1.269573, &
            0.359466,-0.406904,-1.838806,-0.350074,-0.152022,1.096600,0.150721,-1.687256, &
            -0.272996,-0.184378,-2.283461,-0.826626,0.484244,0.690538,0.474344,-2.088342, &
            -1.619440,-1.194710,-1.404584,-0.540582,-0.006610,0.120948,0.498430,-0.399119, &
            -1.138027,-2.635117,-0.573411,0.065865,-0.599012,-0.451337,0.331052,2.718121, &
            -1.484856,-1.276046,-0.747359,0.134467,0.188739,0.026091,0.510076,1.577031, &
            -1.135303,-0.367431,-1.002628,0.352527,0.624025,0.190019,0.111199,0.539399, &
            -1.214543,-0.377471,-0.767201,0.124598,0.348799,-0.437785,-0.620690,0.140181, &
            -0.557856,-0.679432,-0.420490,-0.267357,0.670999,-0.433942,-0.097011,0.060039, &
            -0.780419,-0.966177,0.027990,0.011239,0.558643,-0.448971,0.452687,0.014694, &
            -0.979467,-0.579996,-0.130981,0.129896,0.229496,-0.523503,0.576568,0.487660, &
            -1.231677,-0.617033,-0.694103,0.970334,-0.515934,-0.773165,1.236188,1.234161, &
            0.054151,-0.379596,0.482708,-0.039798,0.221787,0.277309,-0.284333,0.165050, &
            -0.104514,0.009660,0.050093,-0.066007,0.193179,0.198784,-0.183383,0.121483, &
            0.055146,0.000863,0.007870,0.098475,-0.053023,-0.150387,-0.029056,0.014302, &
            -0.057432,-0.180789,0.132868,0.071962,0.097603,-0.057603,-0.015763,-0.106882, &
            0.076723,-0.097182,0.069753,0.124771,0.000471,-0.231985,-0.078586,-0.002614, &
            -0.109362,-0.120323,0.057909,-0.017019,0.251903,-0.023569,-0.039405,0.066266, &
            0.083700,0.140950,0.288150,-0.005072,0.000185,0.170720,-0.154959,-0.005322, &
            0.089375,-0.275732,0.389194,-0.072804,0.219393,0.180949,-0.346426,0.003862, &
            0.409882,-1.010703,1.605760,-0.632205,0.898961,0.298412,-0.636459,0.004551, &
            0.554755,-0.832054,1.732636,-0.302088,0.806847,0.036901,-0.475344,-0.271001, &
            0.255970,-0.072999,0.430799,-0.209279,0.686349,0.407929,-0.101979,-0.442482, &
            -0.003852,0.264950,0.432046,-0.077758,0.712932,0.252838,-0.152538,-0.425323, &
            -0.126390,0.541817,0.119167,0.147254,0.367440,0.056604,0.035744,-0.715376, &
            -0.587954,0.650365,0.414442,0.224973,0.317472,0.100807,-0.363343,0.104989, &
            -0.605104,1.048848,0.036715,-0.092137,0.074187,-0.016486,-0.301344,-0.064340, &
            -0.610455,0.957855,-0.322567,0.108705,-0.271221,-0.265352,-0.219759,-0.239063, &
            -0.474702,0.715324,0.193099,0.039050,0.128964,0.109307,-0.522004,0.315252, &
            -0.369314,0.736773,-0.325458,0.020725,-0.086865,-0.419426,-0.236093,0.163014, &
            -0.280019,0.182607,-0.253080,0.116760,-0.662653,0.539962,0.280684,0.152416, &
            -0.179503,-0.252842,-0.126892,0.009386,-0.361693,0.538154,0.290936,0.596168, &
            -0.201683,-0.407012,0.057389,0.187044,-0.313143,0.273575,0.225239,0.542246, &
            0.034238,-0.423316,0.038718,0.156865,-0.516340,0.469238,0.158695,0.618491, &
            0.114574,-0.332840,0.161798,0.209595,-0.469724,0.258017,0.150838,0.251821, &
            0.104028,-0.262915,0.039228,-0.043784,-0.247045,0.406797,0.019493,0.234864, &
            0.026164,-0.190540,0.091520,0.305677,-0.467282,0.498238,0.330256,0.315437, &
            0.159339,0.078748,0.200005,0.095789,-0.445290,0.425740,0.296018,0.729136, &
            0.545441,-0.363861,0.305925,-0.085040,-0.003570,-0.060693,0.045481,0.340171, &
            1.081487,-0.146013,0.291650,-0.190018,-0.057740,-0.173010,0.151174,0.348206, &
            0.553794,-0.266939,0.506397,-0.535820,-0.457857,-0.695793,-0.242369,-0.509193, &
            0.829888,-0.087509,-0.272100,-0.371153,-0.009279,-0.306079,0.382862,-0.151870, &
            0.474717,-0.055656,-0.217580,-0.413104,0.251449,-0.547875,0.186197,1.085918, &
            0.036964,0.251775,-0.438568,-0.627291,0.044600,-0.727205,0.356211,1.116974, &
            0.319675,-0.220020,-0.053695,-0.207484,0.376739,-0.515717,0.139863,0.534977, &
            -0.200363,-0.434645,0.069935,-0.109832,0.343429,-0.382732,0.130925,0.396625, &
            -0.068781,-0.331036,0.009144,-0.424876,0.260296,0.250442,-0.226573,0.444089, &
            0.032114,-0.420426,-0.008538,-0.676433,0.533663,0.300742,-0.232551,0.006928, &
            -0.042245,0.092167,0.140487,0.095991,-0.052000,0.013869,0.164104,-0.166106, &
            0.100604,0.232981,0.164418,-0.092137,-0.184268,0.110030,0.192668,-0.029698, &
            0.072264,0.057779,-0.039774,0.083174,-0.172609,0.124951,-0.053823,0.236327, &
            0.050441,0.163218,0.096108,-0.048637,-0.074144,0.106172,0.040589,0.211077, &
            -0.025223,-0.091612,-0.040815,0.046507,0.011460,0.065112,-0.080482,-0.163759, &
            0.034480,-0.002992,-0.057041,0.030292,-0.059050,-0.052443,-0.037057,-0.032477, &
            -0.005135,0.059450,0.084788,-0.008799,0.022313,0.081580,-0.046083,-0.014050, &
            0.042169,-0.020917,0.016577,0.027074,-0.054574,-0.022830,-0.009975,0.002180, &
            0.001223,-0.042307,-0.071546,-0.053973,0.018756,-0.181844,0.053481,0.100351, &
            -0.002715,-0.066577,-0.039051,-0.176903,0.153354,-0.027509,-0.065870,0.201598, &
            -0.080008,-0.219750,-0.214049,0.082905,0.019699,-0.298879,0.049768,0.006599, &
            -0.011271,-0.004181,0.071201,-0.182832,0.099833,-0.153977,0.062980,-0.357835, &
            -0.027285,0.152121,-0.201841,0.008305,-0.019727,-0.476550,0.124442,0.375482, &
            -0.013238,0.069618,-0.104164,0.202929,-0.006015,-0.287025,-0.160131,-0.178064, &
            0.043795,0.099989,-0.013970,-0.156412,0.020746,-0.066434,-0.040036,0.186042, &
            -0.052028,-0.124100,0.036421,-0.118675,0.190130,0.024624,-0.170226,-0.332830, &
            -0.109612,-0.214818,-0.025830,-0.126169,0.118540,0.066223,0.062731,-0.224484, &
            0.047112,0.117052,0.040946,-0.125215,-0.083909,-0.104197,0.204300,0.560398 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.068652,5.240653, &
            -0.723201,2.298697, &
            1.065653,-2.461304, &
            -1.566722,0.782373, &
            -0.789577,1.834672, &
            -1.775403,0.677921, &
            -0.565416,0.723417, &
            -0.906952,-1.702949 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.131525,1.444819/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.332483,0.723982,0.414269,0.628061,1.45584,0.347421,0.398047,-0.889318/)
real, dimension(2) :: bias2 = &
(/0.042147,-1.26056/)
real, dimension(1) :: bias3 = &
(/0.259727/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
