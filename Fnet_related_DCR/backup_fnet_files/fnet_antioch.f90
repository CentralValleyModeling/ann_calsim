module fnet_antioch

! a = 8.5267e-005
! b = 0.087541

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.196872,-0.075075,0.142725,-0.135518,-0.184467,0.032468,0.093882,0.014569 &
			,0.010892,-0.073352,0.007800,-0.043531,0.078699,0.012337,-0.039406,-0.027073 &
			,0.045856,-0.037263,0.094629,0.067187,0.024256,-0.035885,0.042379,0.003426 &
			,0.047873,-0.022809,-0.066264,0.063412,0.118975,0.031662,-0.087113,-0.032879 &
			,-0.022037,-0.016771,0.031116,0.247270,0.031038,0.118332,0.089926,-0.055922 &
			,-0.061900,-0.094393,0.164079,-0.019482,-0.021865,0.097573,0.105686,0.001063 &
			,0.036594,-0.025127,0.001881,-0.071735,0.167907,0.087918,0.066543,-0.041314 &
			,-0.040736,-0.076068,0.126176,0.135165,0.125453,0.042626,0.038834,-0.106395 &
			,-0.598984,0.120295,0.027125,-0.517334,-0.099597,0.130684,-0.201282,-0.145469 &
			,-0.379305,0.065714,0.093067,-0.940257,0.328331,-0.165566,-0.286770,-0.156050 &
			,-0.385291,0.015726,0.217123,-0.304950,-0.264907,-0.070828,-0.032911,-0.016367 &
			,-0.063576,-0.230688,0.453446,0.438667,-0.483326,0.172915,0.231925,0.323604 &
			,0.040276,0.045027,-0.108407,0.188077,-0.060674,0.116184,0.057900,0.067992 &
			,0.251923,0.289060,-0.342275,0.015674,0.317222,-0.185931,-0.048374,-0.000882 &
			,0.211820,0.165680,-0.022895,-0.152496,0.147634,-0.439468,-0.236280,0.069731 &
			,-0.051817,0.363003,0.047517,-0.555825,0.250814,-0.208479,-0.114292,0.258093 &
			,-0.440292,0.218779,0.280960,-0.840316,0.385429,0.469655,0.024175,0.431983 &
			,-0.024556,-0.165664,0.287644,-0.354573,0.040874,0.183984,-0.440388,0.483754 &
			,0.310626,-0.024443,0.286222,0.255225,-0.103455,-0.247516,0.614936,-0.114433 &
			,0.258823,-0.027631,0.551547,0.005962,0.019570,-0.119665,0.171254,0.177122 &
			,0.322854,0.130023,0.190662,0.211155,0.109345,-0.046250,0.279048,-0.035795 &
			,0.205898,0.258576,0.238198,0.519060,-0.160826,-0.176515,0.366570,-0.117456 &
			,-0.022747,0.160798,0.094156,0.386796,-0.386708,0.087892,0.309546,-0.162383 &
			,0.153390,-0.097456,0.102075,0.048949,-0.217726,-0.010635,0.004939,-0.193773 &
			,0.005839,-0.005735,0.100619,0.090515,-0.459372,-0.082776,-0.072624,-0.165677 &
			,0.164608,0.274306,-0.035884,-0.089223,-0.253414,-0.082608,0.003871,-0.142708 &
			,0.201074,0.089789,0.382547,0.568391,-1.015415,-0.098937,-0.180702,-0.423897 &
			,-0.047277,0.425976,0.145806,0.693279,-0.542979,0.340347,-0.137021,-0.184626 &
			,0.027745,0.672522,0.245646,1.207986,0.088178,0.183220,0.043109,0.096682 &
			,-0.025708,0.383596,0.065457,0.450778,-0.071422,-0.026942,-0.108012,-0.070923 &
			,-0.242563,0.206317,0.211357,-0.410080,0.057983,0.333660,0.247355,-0.025554 &
			,-0.020111,0.261535,0.031558,-0.715870,0.423963,0.286830,0.603193,-0.076841 &
			,0.053323,0.177324,-0.002500,0.354963,-0.016464,0.201736,0.176858,0.224845 &
			,0.062636,0.475370,-0.384388,0.805007,-0.500082,0.225832,0.054738,0.369875 &
			,0.010191,0.243318,-0.559744,0.101118,-0.077113,0.280897,0.009783,-0.004763 &
			,-0.408763,-0.035483,-0.347381,0.099480,-0.602349,0.386551,-0.316099,0.111300 &
			,-0.974707,-0.485617,-0.614233,-0.045945,-3.267302,0.800224,0.583131,1.141767 &
			,-1.633150,-0.882567,-0.720396,0.228688,-2.765470,0.342216,1.094474,1.768699 &
			,-2.220744,-0.932236,-0.886177,0.025578,-2.539290,0.369971,1.084506,1.892101 &
			,-2.541962,-1.290083,-1.150205,-0.275356,-2.678211,0.165105,1.116529,2.200041 &
			,-2.535830,-1.161740,-1.017363,-0.522807,-2.357398,0.070478,1.134839,2.358092 &
			,-2.671289,-1.187977,-1.174177,-0.800197,-2.347913,0.061997,1.266489,2.512483 &
			,-3.322721,-1.777735,-1.483641,-0.610858,-2.160850,-0.328448,1.632495,2.617624 &
			,-3.704429,-2.317666,-1.867759,-0.276166,-1.430451,-0.871306,2.191101,3.280302 &
			,-6.248279,-4.765389,-4.668975,3.273376,1.116121,-3.745145,4.717200,5.297517 &
			,-4.739434,-4.468458,-4.247055,2.654219,-0.872799,-3.992521,3.782597,4.536097 &
			,-2.148948,-4.010589,-3.335193,1.999789,-2.423533,-4.037315,2.455253,2.089914 &
			,-0.341673,-2.723675,-2.174930,0.515837,-2.921308,-2.846910,1.154574,0.294940 &
			,-0.100154,-2.329657,-1.345547,1.057869,-2.198726,-2.935424,0.857143,-0.614956 &
			,-0.187150,-2.071474,-0.160218,1.497080,-2.148455,-2.398829,0.862793,-1.036996 &
			,-0.122793,-0.874175,0.263111,1.462530,-1.687213,-1.622641,0.554344,-0.102333 &
			,-0.154465,-0.610238,0.737482,0.957002,-1.210012,-1.681506,0.366727,-0.190132 &
			,-0.127043,-0.490694,0.595514,0.797177,-1.162217,-1.550058,0.385177,-0.314398 &
			,-0.175036,-0.701134,-0.045585,0.329182,-1.413820,-1.501535,0.825641,-0.214592 &
			,0.039480,-0.150144,0.372853,0.823139,-0.181729,0.151962,0.245051,0.315926 &
			,-0.328820,-0.265371,0.137925,0.716563,0.138038,0.276365,0.161828,0.446633 &
			,-0.433195,-0.354961,-0.159662,0.359206,0.299869,0.200619,0.355747,0.892623 &
			,-0.350059,-0.390205,-0.316030,0.319337,0.251913,-0.158778,0.284525,0.625924 &
			,-0.632754,-0.545281,-0.136394,0.683380,0.617854,0.003708,0.581670,0.923868 &
			,-0.682797,-0.611790,-0.254392,0.654200,0.356649,-0.111010,0.301020,1.110791 &
			,-0.644888,-0.397585,-0.277410,0.372679,0.559530,-0.217978,0.681772,1.070363 &
			,-0.575849,-0.643743,-0.183356,0.507613,0.503733,-0.059511,0.396793,0.946617 &
			,-0.902340,-0.705487,-0.591284,0.429719,1.109537,-0.105824,0.817441,1.549887 &
			,-0.876653,-1.015959,-1.216884,0.721303,1.150494,-0.740046,1.099872,1.302779 &
			,-0.111045,-0.165760,-0.469769,-1.138247,0.075736,0.080503,-0.098927,0.118015 &
			,0.092184,-0.196685,-0.040838,-0.943219,-0.122486,-0.234854,0.095701,-0.078522 &
			,-0.075648,-0.342296,0.228059,-1.030844,-0.217905,-0.361150,0.228697,-0.310869 &
			,-0.061108,-0.390919,-0.150129,-0.519674,-0.387234,-0.576419,0.453345,-0.306957 &
			,-0.163957,-0.301271,-0.214539,-0.485632,-0.777136,-0.099314,0.007989,-0.304693 &
			,0.010703,-0.199256,-0.538050,-0.232060,0.087929,-0.578962,0.072737,0.156818 &
			,0.218364,-0.044060,-0.114044,-0.448652,-0.208719,-0.626349,-0.290540,-0.396510 &
			,-0.010385,0.221551,-0.130708,-0.320753,-0.195273,-0.778381,0.284868,-0.147040 &
			,-0.058715,-0.105121,0.056870,-0.572245,-0.304929,0.237287,-0.310897,0.158725 &
			,0.085801,-0.065828,0.053882,0.118859,-0.166618,0.205431,0.106550,0.117200 &
			,-0.027836,-0.096451,0.009858,-0.118886,-0.096618,-0.043605,-0.043460,-0.231214 &
			,0.026898,-0.043875,0.001865,-0.067462,0.155371,0.154106,0.261767,-0.130974 &
			,0.072503,0.012669,-0.162519,-0.042329,0.080204,0.178719,0.039190,0.010895 &
			,-0.054043,0.016340,-0.011468,0.167560,0.086443,0.046433,-0.032427,0.091521 &
			,-0.047319,-0.098912,-0.003575,-0.028053,-0.221096,0.106938,-0.069009,0.230177 &
			,0.013823,-0.291635,0.094918,-0.226876,-0.233830,-0.069698,-0.195055,0.367964 &
			,0.163179,-0.301353,0.275006,-0.521551,-0.246582,0.473857,-0.656113,0.501758 &
			,-0.113804,-0.533893,-0.135445,0.934898,-0.345554,0.009741,-0.278184,0.533182 &
			,0.020727,-0.017720,0.419214,0.481570,-0.482410,0.023917,-0.077791,-0.413785 &
			,-0.275384,-0.247888,0.590493,0.862797,-0.506565,-0.350106,0.045543,-0.381857 &
			,0.056401,-0.229159,0.491570,0.921956,-0.377205,-0.290710,-0.096411,-0.753644 &
			,-0.081170,-0.270884,0.251091,0.459805,0.099834,-0.002660,0.052657,-0.315350 &
			,0.034907,0.204502,0.494214,0.038076,0.250509,0.055346,0.040073,-0.656062 &
			,-0.357627,-0.195374,0.293113,0.031020,0.870036,-0.357281,0.305682,-0.477921 &
			,-0.292364,-0.233347,-0.255965,-0.387636,0.825316,0.231807,0.482435,0.127232 &
			,-0.112716,0.107098,-0.089108,-0.481344,0.482510,-0.117608,0.255747,0.078267 &
			,0.063150,-0.060499,-0.126723,0.457339,0.113712,-0.169390,-0.147225,0.051002 &
			,0.257327,-0.176428,-0.302756,-0.035527,0.065479,0.040852,-0.357433,-0.253033 &
			,0.062696,0.095117,-0.102916,0.183874,0.043914,-0.134179,-0.453315,0.044546 &
			,0.241297,-0.049387,-0.241988,0.097222,0.145023,-0.284392,-0.364781,-0.301689 &
			,0.128412,0.189263,-0.225702,0.263961,-0.043875,-0.341449,-0.430504,-0.025851 &
			,0.079758,0.184448,-0.091847,0.468069,0.273607,-0.126274,-0.284297,-0.001785 &
			,0.106182,0.080412,-0.151507,0.532677,0.211835,-0.282391,-0.501133,-0.144637 &
			,0.318902,0.070680,-0.021448,0.299208,0.218745,-0.170139,-0.239211,-0.139593 &
			,0.544585,0.401885,0.152846,-0.051253,0.024950,-0.109490,-0.844932,-0.345681 &
			,0.273302,0.567783,0.214381,-0.081670,0.980270,0.106394,-0.390943,-0.522502 &
			,-0.417465,0.127951,-0.023419,0.830229,1.092321,-0.014004,0.028466,-0.394939 &
			,-0.174502,0.652472,0.140091,0.327088,0.452456,0.153179,0.033974,-0.444227 &
			,0.023479,0.387831,0.147801,0.533597,0.649704,0.551498,0.275272,-0.025286 &
			,0.131756,0.095647,-0.060748,-0.072530,0.793931,0.178338,0.149640,0.114585 &
			,0.248890,0.217184,-0.294333,-0.178608,0.522631,0.161247,0.005296,-0.128758 &
			,0.279849,0.134046,-0.367801,-0.001264,0.368721,0.049592,-0.087977,0.120912 &
			,0.399906,0.103315,-0.186807,-0.585941,0.330925,0.214083,-0.328925,0.274211 &
			,0.333967,-0.107041,-0.381121,-0.533729,0.170099,0.262757,-0.370302,0.400202 &
			,-0.163300,0.148239,0.127162,0.034518,-0.069624,-0.063343,0.174478,-0.013589 &
			,-0.044027,0.076400,0.047526,-0.095065,-0.049869,0.017137,0.237648,-0.041368 &
			,-0.018606,0.022060,0.069458,0.017730,-0.069775,0.030319,0.252396,-0.058269 &
			,0.012231,0.154071,0.059183,-0.023972,-0.091213,-0.058729,0.273195,0.079872 &
			,0.033915,0.099068,-0.044534,0.133992,0.022825,-0.003409,0.059792,0.039162 &
			,0.100109,-0.085909,0.091624,0.188003,0.018078,0.002844,0.075042,0.021873 &
			,-0.004856,0.049444,0.085619,0.253642,-0.066377,0.033481,0.202743,0.032507 &
			,0.023682,-0.097675,0.091296,0.063970,0.027007,0.007110,0.022566,0.000098 &
			,0.073409,-0.094654,-0.053872,-0.193407,-0.030689,0.110980,0.064020,0.122149 &
			,0.068545,0.075791,0.090164,0.523727,-0.052000,-0.004161,-0.007308,0.180666 &
			,0.104398,0.175396,0.046727,0.043129,0.051486,-0.242423,0.135583,-0.006060 &
			,-0.055231,-0.265064,0.107305,0.134327,-0.010737,0.245929,-0.034730,-0.003799 &
			,0.003937,-0.036428,-0.376668,-0.538688,0.495389,0.083432,-0.501417,-0.117669 &
			,-0.273089,0.223030,-0.616360,-0.240754,-0.033939,0.090614,-0.697310,-0.035062 &
			,-0.020743,0.386728,-0.321095,-0.670539,-0.016622,-0.343329,-0.210132,0.110800 &
			,-0.045173,0.184140,0.166389,0.065976,0.076426,-0.422001,-0.121937,-0.189107 &
			,-0.039208,-0.008501,0.246071,-0.037579,-0.020553,-0.125421,0.164387,-0.152775 &
			,0.316391,-0.301017,0.285215,0.191070,0.238732,0.056644,0.323538,0.078893 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.030650,3.274294 &
			,-2.906807,2.039786 &
			,-3.240007,2.224982 &
			,-0.366582,-0.789038 &
			,-2.314781,-0.208450 &
			,-3.019516,2.586935 &
			,1.704675,-1.302700 &
			,0.969050,-1.691979 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.638177,2.36288/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.4563,1.185273,1.121962,-1.195051,-1.206576,1.285851,-1.478281,-0.988548/)
real, dimension(2) :: bias2 = &
(/0.643352,-0.094432/)
real, dimension(1) :: bias3 = &
(/-0.550367/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  !integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
