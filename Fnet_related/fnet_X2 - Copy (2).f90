module fnet_X2

! a = 0.015276
! b = -0.57708

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/0.339953,-1.038766,1.418209,0.732625,-1.372646,0.411363,-1.803599,-0.874690 &
			,-0.750833,-0.024832,0.568018,-0.124757,-2.537422,-0.954050,-0.802221,0.150207 &
			,-0.965380,0.365533,0.043359,-0.542809,-2.762528,-1.164567,0.023857,0.743764 &
			,-0.599768,0.314190,0.264355,-0.575261,-2.117346,-1.189215,-0.126034,0.789837 &
			,-0.953125,0.005550,0.671908,0.045616,-1.694628,-1.403030,-0.231117,0.521576 &
			,-0.994221,-0.010504,0.534693,-0.327507,-1.320999,-1.420832,-0.283801,0.043509 &
			,-1.407490,0.621962,0.090990,-0.316485,-0.936671,-1.824573,-0.028742,0.796895 &
			,-2.599529,1.328653,-1.010253,-1.079975,-1.194264,-3.233097,1.297867,0.978252 &
			,-5.861894,5.632473,-5.567539,-3.292250,-2.206607,-6.888419,6.318216,3.593147 &
			,-5.421801,4.662238,-6.528362,-0.788380,0.960614,-4.590779,5.726532,0.798557 &
			,-3.660164,3.172034,-6.445913,0.693374,0.160861,-1.500325,5.480252,-0.012172 &
			,-1.345889,0.823969,-5.518873,1.040105,-0.590483,0.007575,4.835756,-0.782426 &
			,-0.500416,0.471644,-5.207191,0.553204,-0.024868,0.552710,5.840909,0.000054 &
			,0.149058,-0.265819,-3.894142,0.332805,-0.257440,0.243357,6.014502,-0.115633 &
			,0.632821,-0.687988,-1.798108,-0.205316,-0.144400,-0.356808,5.712051,-0.073284 &
			,0.418242,-0.686097,-0.880792,-0.145115,-0.014913,-0.227072,6.074072,-0.259157 &
			,-0.164672,-0.085921,-1.053837,0.176766,-0.138796,0.229475,5.981584,0.433344 &
			,-0.133798,0.980291,-2.282989,-0.250699,0.558698,0.843636,7.270390,1.238819 &
			,0.346742,0.443115,0.184187,-0.106526,0.206870,-0.230088,0.247621,-0.175214 &
			,0.125271,0.272901,-0.054057,-0.035658,-0.032000,0.133478,0.175865,-0.220887 &
			,0.154841,-0.045782,-0.019477,-0.178218,-0.001910,-0.139316,-0.065528,-0.538152 &
			,0.249405,-0.060096,-0.359205,-0.047268,-0.058575,-0.126976,-0.178386,-0.447456 &
			,-0.070093,-0.301666,-0.510146,0.106762,-0.061466,-0.102058,-0.115591,-0.202097 &
			,0.075124,-0.419202,-0.195707,0.075015,-0.139291,-0.081213,-0.044454,-0.039448 &
			,-0.329504,0.217009,0.079566,-0.130558,0.152906,0.140350,0.027792,-0.143773 &
			,0.141659,-0.024332,0.050774,-0.177934,0.050950,0.021106,-0.018193,-0.040412 &
			,-0.163479,-0.057097,-0.088798,0.220984,-0.168559,-0.061321,-0.101806,-0.080877 &
			,0.059983,-0.112312,-0.069994,0.305793,-0.199226,-0.086970,-0.055729,0.151646 &
			,-0.170887,-0.156870,-0.038186,-0.251627,0.345670,-0.094764,0.309069,-0.007690 &
			,0.469571,-0.080897,0.106177,0.092849,-0.195665,-0.027567,0.589425,-0.096894 &
			,0.222087,-0.144154,0.094924,0.201570,-0.089761,-0.313181,0.129567,0.048912 &
			,-0.439506,0.224553,0.152119,-0.440197,0.354276,0.487612,0.035890,0.248517 &
			,0.368073,-0.014199,0.152761,-0.420378,0.070892,0.337480,0.136251,0.138856 &
			,0.405218,0.306884,-0.133885,0.033296,0.058904,-0.073422,-0.086909,0.142537 &
			,0.206096,0.102658,-0.260160,0.193971,0.067639,-0.205370,0.018640,0.192027 &
			,0.528690,-0.242121,-0.245197,0.123515,-0.124380,-0.274485,-0.239607,0.116293 &
			,-0.293760,0.331241,-0.030319,-0.311621,0.496762,0.281816,-0.361135,0.231216 &
			,-0.001345,0.163115,-0.280048,-0.059331,0.044939,0.179488,-0.021749,0.002564 &
			,-0.238973,0.214082,0.446903,-0.281144,0.289218,0.052599,0.010566,-0.092193 &
			,-0.015580,0.001989,0.067675,0.187550,-0.044590,-0.117451,-0.037599,0.023086 &
			,-0.111265,-0.361846,0.097996,0.115018,-0.287673,0.139475,0.080480,-0.040547 &
			,-0.268455,-0.260516,-0.149011,-0.079813,-0.047862,0.190406,0.060476,-0.136809 &
			,-0.330914,0.132614,-0.043106,-0.164449,0.190504,0.240949,-0.190303,0.235015 &
			,0.158869,0.158085,-0.115812,-0.443813,0.106248,0.368728,-0.554124,0.061503 &
			,-0.265523,0.278537,-0.030999,-0.110467,0.600685,0.782137,-0.999226,0.261735 &
			,-0.194813,0.383679,-0.357535,-0.380491,0.493273,0.307260,-1.379737,1.223547 &
			,-0.251955,0.601415,-0.363868,-0.070294,0.369636,0.676961,-0.526813,0.966625 &
			,-0.168923,0.557948,-0.286339,-0.087798,-0.279970,0.639765,-0.144981,1.183064 &
			,-0.129424,0.431225,-0.519728,-0.045059,0.489152,0.669490,0.376436,0.808893 &
			,-0.742973,0.709186,-0.123115,-0.323110,0.062115,0.426362,-0.055897,0.513449 &
			,-0.795347,-0.344939,-0.353859,0.027432,0.322781,0.470459,-0.287940,0.209156 &
			,0.095568,-0.186470,0.254518,-0.179521,0.116823,-0.071991,0.233521,0.350785 &
			,0.199392,-0.248534,0.714495,-0.421469,-0.011186,-0.129637,-0.285842,-0.057217 &
			,0.264124,-0.108316,0.562145,-0.443509,-0.250428,-0.231195,-0.027184,-0.016659 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.756085,1.454889 &
			,-1.119586,-0.751445 &
			,3.410870,2.335914 &
			,1.849736,0.759002 &
			,1.178847,-0.920074 &
			,1.715532,2.107418 &
			,-1.250019,0.234828 &
			,-0.985281,0.170338 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.051298,-0.783009/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.51554,-1.069288,1.675011,0.812545,1.277806,1.289886,-2.183033,-0.961235/)
real, dimension(2) :: bias2 = &
(/-0.094412,0.011426/)
real, dimension(1) :: bias3 = &
(/0.465746/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 54
  !  inarray2(i) = inarray(55-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
