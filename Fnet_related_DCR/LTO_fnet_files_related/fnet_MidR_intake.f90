module fnet_MidR_intake

! a = 0.00084822
! b = 0.0059421

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.037795,0.514849,0.712426,0.143192,-0.018907,0.310557,-0.082923,0.131206, &
            0.014042,0.027042,0.188806,-0.002142,-0.010047,0.095048,-0.026899,0.021366, &
            -0.001928,0.055834,0.122401,0.045386,-0.008114,0.049050,0.028832,0.000851, &
            0.019846,-0.131510,0.074945,-0.006491,-0.005765,0.064001,0.034213,-0.005230, &
            -0.001520,-0.151802,0.191624,0.035015,-0.003022,0.040904,0.017651,0.008169, &
            0.011411,-0.074229,0.165061,-0.000996,-0.022787,0.025633,0.058955,-0.061617, &
            0.001369,-0.148651,0.115324,0.023723,-0.031009,-0.010223,0.114841,-0.103905, &
            0.097593,-0.394183,0.054149,-0.072531,-0.067822,-0.021031,0.212137,-0.180502, &
            0.536052,-1.404324,1.076484,-0.494186,-0.423649,0.128004,0.629245,-0.586263, &
            0.086818,0.582202,0.937420,-0.091660,-0.190037,0.809653,0.194654,-0.052237, &
            -0.287071,1.405721,0.561528,0.311867,-0.041285,0.267277,-0.098301,0.175363, &
            -0.170918,1.175129,1.263134,0.173941,-0.026687,0.707979,-0.442152,0.316528, &
            0.083559,-0.329958,0.567066,-0.083422,-0.045573,0.663320,-0.154779,0.256069, &
            0.080970,0.384673,0.345939,-0.108616,0.032119,0.388099,-0.142558,0.279741, &
            0.051787,1.935426,1.386424,0.064152,0.085454,0.439949,-0.674571,0.460994, &
            0.111701,0.801077,1.633048,-0.095329,0.102319,0.403521,-0.793957,0.405563, &
            0.237784,0.193797,0.933748,-0.219111,0.138439,0.248725,-0.381390,0.302227, &
            0.736502,-0.376079,0.656287,-0.730705,0.210149,0.641627,-0.336305,0.533855, &
            -0.024320,0.111791,-0.355415,0.196290,-0.017104,-0.121380,0.093222,0.096927, &
            0.010051,0.127632,-0.513259,0.140593,-0.035065,-0.335345,0.023594,0.073282, &
            -0.141747,0.225213,-0.559339,-0.050952,-0.009659,-0.172657,0.049847,-0.085887, &
            0.018134,0.725668,-0.333955,-0.032177,-0.051131,-0.351881,0.026159,-0.046129, &
            -0.072254,0.943789,-0.178077,0.060242,-0.038795,-0.194557,-0.053973,0.042677, &
            -0.216637,0.796139,-0.312889,0.250656,-0.011519,-0.257926,0.081501,0.022522, &
            -0.263902,0.982540,-0.259658,0.311960,-0.003733,-0.320738,0.097352,-0.012199, &
            -0.441955,1.396797,-0.446269,0.412005,0.063118,-0.201943,0.216023,0.118479, &
            -1.073287,2.498943,-1.869331,0.837312,0.674830,-0.679910,-0.073848,0.733718, &
            -0.839177,0.034776,-1.552922,0.654034,0.960089,-1.270707,-0.236936,0.150662, &
            -0.240366,0.579697,-0.109142,0.188299,0.830241,-0.848184,0.358992,-0.321361, &
            -0.066713,1.059969,-0.683702,-0.092674,0.616262,-0.077160,0.218252,-0.076597, &
            0.053161,-0.077685,-0.773452,-0.247759,0.610306,0.106606,0.124287,0.011794, &
            0.308463,-4.180445,-0.386710,-0.171294,0.277956,-0.451426,0.011925,0.006813, &
            -0.103013,-3.195627,-0.261569,-0.297431,0.211974,0.175056,0.056443,-0.192940, &
            -0.429021,-1.097785,1.200799,0.277857,0.233288,-0.410878,-0.074199,-0.217024, &
            -0.520700,-0.326578,0.903741,0.745586,0.084324,-0.724451,-0.416362,-0.025321, &
            -0.999812,0.161405,0.598194,1.957651,-0.130353,-0.392719,0.051067,0.122599, &
            1.139397,1.132160,1.632814,-0.779025,-0.058578,0.703301,0.295356,0.343601, &
            0.845660,0.079014,1.691597,-0.323184,-0.157739,0.614270,0.494560,-0.072174, &
            0.798646,-0.894606,1.593492,-0.273299,-0.091481,0.850364,0.845900,-0.147860, &
            0.634055,-1.366901,1.227902,-0.525227,-0.070948,0.995990,0.501334,-0.156863, &
            0.503389,-1.405131,0.865304,-0.566819,-0.120639,0.977210,0.317352,-0.123799, &
            0.624957,-1.755688,0.779105,-0.582071,-0.222661,1.240554,0.508644,-0.061437, &
            0.448764,-1.910697,0.726293,-0.569210,-0.215803,1.403344,0.652721,-0.234501, &
            0.523435,-2.090889,0.820641,-0.469599,-0.547426,1.768087,0.962943,-0.517503, &
            0.431575,-1.950242,1.078171,0.006984,-4.588155,2.702055,2.093141,-0.402681, &
            0.147968,-0.154869,0.166114,-1.294049,-8.076224,2.170592,0.967896,-0.285618, &
            -0.264732,3.350630,-0.014762,-0.566843,-10.313568,1.594097,0.964129,-0.938537, &
            -0.476143,2.885116,0.129505,-0.187619,-9.701495,2.577633,0.621183,-0.471747, &
            -0.578896,4.287997,-0.458831,-0.105479,-7.716820,3.694934,0.552012,-0.340256, &
            -0.423568,4.873433,0.303616,-0.261105,-4.685044,3.574541,1.373243,-0.980015, &
            -0.739860,6.697526,0.389623,0.528479,-2.691672,2.346196,0.443835,-0.228234, &
            0.499358,3.880259,-1.390316,-0.459682,-1.959674,1.453808,0.285941,0.154490, &
            -0.348655,3.347568,-1.928618,-0.968850,-1.714181,2.099844,-0.054742,0.032114, &
            -0.016338,3.424939,-2.311052,-0.199058,-2.299108,1.717102,-0.858280,1.119599, &
            -0.909045,0.863290,-0.277655,1.728143,-0.081432,0.367489,-1.002519,0.730236, &
            -1.509268,1.286101,0.087799,1.914346,0.019847,0.251551,-0.578616,0.787507, &
            -1.337158,1.339901,-0.150640,1.716925,-0.311656,-0.152530,-0.390979,0.540169, &
            -1.025123,1.798414,-0.449857,1.879142,-0.153347,-0.128680,-0.584043,0.711568, &
            -0.686168,1.911801,-0.514853,2.112175,-0.462471,-0.309352,-0.404169,0.150186, &
            -0.463110,1.378210,-0.888581,2.282999,-0.600251,-0.434237,-0.188354,0.373204, &
            -0.174347,1.377439,-0.836501,2.954544,-0.537160,-0.844670,0.014095,0.247346, &
            0.406655,1.216637,-0.444995,3.658554,-0.439353,-0.547315,0.397589,0.373227, &
            1.162657,1.200786,-0.048659,7.207550,-0.654110,-0.191160,1.092785,-0.067943, &
            0.210550,-0.446115,0.412946,6.873228,-2.949291,1.203763,1.723751,-0.221417, &
            -0.841631,-1.040566,-0.601257,3.583862,-3.496190,2.076386,1.173473,-0.777482, &
            -1.813483,-1.256334,-0.143822,0.219586,-2.130637,1.380989,-0.125297,0.286348, &
            -1.192842,-2.537972,-0.211172,-0.143135,-1.720061,0.924727,-1.364291,0.932466, &
            -1.356731,-3.418693,-0.949199,-0.112264,-1.572835,0.115370,-0.975505,0.698473, &
            -0.512179,-2.498317,-0.862778,0.442560,-0.911195,-0.987210,-1.227638,0.588225, &
            0.447114,-2.877387,-0.964942,1.086330,-0.786738,-0.222070,-0.563023,0.752169, &
            1.699196,-3.929351,-1.033969,0.480237,-1.967734,1.421684,-0.046567,1.144720, &
            1.585179,-4.520139,-0.331751,-0.777051,-2.459584,4.373751,-0.540096,1.399131, &
            0.351935,-0.691542,0.608844,-0.124597,-0.021624,-0.077541,-0.162063,0.289989, &
            0.089088,-0.150348,-0.047106,0.095794,-0.023979,-0.058490,0.085708,0.037880, &
            -0.097640,0.016390,0.005386,-0.059585,0.037891,0.078325,-0.023607,0.031514, &
            0.077859,0.081274,0.204809,0.011602,-0.002543,-0.146246,0.028058,0.076191, &
            0.053339,0.093338,0.129699,-0.049313,-0.002598,-0.361377,0.044597,-0.047833, &
            0.091261,-0.178728,0.109638,-0.025565,0.054681,-0.058577,0.033678,0.148833, &
            0.081811,-0.259517,0.288371,-0.084851,0.009546,-0.025335,-0.090367,0.119873, &
            0.344369,-0.831246,0.355729,0.015610,-0.036153,0.032745,0.018387,0.265350, &
            1.322466,-0.509532,2.369610,-0.729331,0.363966,-0.981741,-0.191212,0.906707, &
            0.948673,-0.509511,1.443443,-0.699582,0.492357,-1.406275,-0.183885,0.614430, &
            0.283460,-0.094548,-0.256735,-0.691778,0.973496,-0.358025,-0.768452,-0.187110, &
            0.301446,0.955896,-0.098501,-0.838072,0.666928,-0.174626,-0.729451,-0.183865, &
            -0.380556,1.818031,-0.642219,-0.642748,0.654946,0.163166,-0.992381,-0.591516, &
            -0.025133,-0.048392,-0.207099,-0.748467,-0.151284,0.100406,-0.526419,-0.270731, &
            0.096419,1.202135,-0.153594,-0.673565,-0.328935,0.508539,-0.355788,-0.077936, &
            0.078783,0.924642,-0.590733,-0.816924,-0.647264,0.316846,0.291063,0.016892, &
            0.371145,0.319175,-0.453822,-0.555829,-0.398956,0.180134,0.264925,0.257808, &
            0.419520,0.861445,-0.134986,-0.705950,-0.284687,0.395937,0.339943,0.156072, &
            -0.153817,-0.557451,1.050272,0.123962,0.042144,0.163217,0.384498,0.032887, &
            -0.008417,-0.549576,0.572313,0.244772,-0.025445,0.177153,-0.003910,0.282630, &
            -0.109758,-0.731211,0.434691,0.180635,-0.011054,-0.011543,0.113285,0.064513, &
            -0.095274,-1.350107,0.437230,0.038205,-0.025927,0.165923,0.030151,-0.034567, &
            -0.182384,-1.284873,0.176814,0.017223,0.021471,0.136594,-0.072586,0.000072, &
            -0.140804,-1.289097,-0.027930,0.224149,-0.023891,0.044401,0.139579,0.040560, &
            -0.130174,-1.329195,-0.122100,0.030449,0.032851,0.254346,0.058291,0.050524, &
            -0.275734,-1.152757,-0.309019,-0.013966,-0.028358,-0.071499,0.325248,-0.264462, &
            -0.771985,-1.543008,-0.693658,-0.467015,0.793515,-0.391215,0.332132,-0.212810, &
            -0.921392,-2.037543,-0.764176,-0.461651,1.207768,-0.965655,0.459317,-0.606706, &
            -0.741961,-1.003392,-1.180216,0.042544,1.007674,-0.798535,0.548570,-0.376801, &
            -0.475460,0.115309,-1.572440,0.092031,0.793918,-0.785819,0.379353,-0.038484, &
            -1.126649,0.237870,-0.751209,0.411238,0.548426,-0.166595,0.012287,-0.075099, &
            -0.408991,-1.395436,-0.325652,0.361791,0.490538,-0.049470,-0.189017,0.008072, &
            -0.149825,-1.986446,-0.671222,-0.123639,0.441720,-0.380152,0.181775,-0.209716, &
            -0.125705,-2.611613,-0.018998,0.104844,0.057212,0.046574,0.135094,0.062974, &
            0.578860,-1.114270,-0.177232,-0.305417,0.108947,0.312718,0.306993,-0.023663, &
            0.693871,-0.836111,0.169735,-0.686723,0.102854,0.861049,0.525849,0.199927, &
            0.156145,-0.309971,0.210941,-0.140294,-0.041547,0.086954,-0.141860,0.075520, &
            0.018801,-0.103465,-0.129348,0.029583,-0.010312,-0.023439,-0.039244,0.069408, &
            -0.018954,-0.129000,0.053942,0.032147,-0.008163,0.034746,-0.044323,0.029671, &
            0.064283,-2.184654,-0.140608,-0.031010,-0.002453,-0.023621,-0.108488,0.104643, &
            0.003077,-5.699209,0.038042,0.021261,-0.003224,0.062294,-0.043205,0.053186, &
            -0.008202,-3.150322,-0.007993,0.008980,0.004323,0.009780,-0.048607,0.039958, &
            -0.023774,-0.185388,-0.078547,-0.001128,0.003326,-0.057739,0.092908,-0.073644, &
            -0.093262,-0.353152,-0.044646,0.112080,-0.005606,-0.061224,0.021029,-0.010734, &
            -0.079947,-0.742585,-0.237933,0.122509,0.039514,-0.058429,0.047825,0.056259, &
            0.009536,-0.087257,0.215998,0.074539,0.061187,-0.196099,-0.128733,0.135500, &
            -0.044060,-1.158297,-0.174971,-0.213802,0.001565,-0.069658,0.138197,-0.232996, &
            0.175797,1.775933,-0.123707,-0.128459,0.000214,0.297231,-0.032247,0.195666, &
            0.045735,0.156503,0.386488,-0.029832,-0.040193,0.054628,0.061997,-0.052503, &
            -0.082246,0.153775,-0.191834,0.042939,-0.033867,0.085782,0.056215,-0.045962, &
            -0.083211,-0.536153,-0.079458,0.229532,-0.001656,-0.148372,0.070161,-0.002166, &
            -0.029337,0.251720,-0.063836,0.104520,0.009139,-0.182810,-0.076239,0.036424, &
            0.201711,0.531527,-0.346952,-0.220426,-0.022265,0.165105,-0.080753,0.148500, &
            -0.194253,-0.447455,0.289751,0.113572,0.009724,0.000566,0.114757,-0.150335 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.793015,0.528569, &
            4.390441,5.542974, &
            -0.627242,-0.848230, &
            0.606717,-1.613208, &
            7.509619,-0.550957, &
            0.541905,-0.891222, &
            -1.699022,-2.207899, &
            -1.654645,-0.502689 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.543351,-1.839033/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.72133,1.72853,0.014092,-1.576146,0.371659,-1.180055,-2.267919,-1.44273/)
real, dimension(2) :: bias2 = &
(/-0.894811,0.624588/)
real, dimension(1) :: bias3 = &
(/0.014355/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
