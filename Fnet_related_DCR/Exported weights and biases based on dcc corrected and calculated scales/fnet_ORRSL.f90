module fnet_ORRSL

! a = 0.00057239
! b = 0.038113

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.048743,0.178917,0.243063,-0.288495,0.048795,0.117042,0.141115,0.008844, &
            -0.016814,-0.021324,-0.015596,-0.041377,0.038295,-0.022476,-0.001418,0.005047, &
            0.011601,0.052552,0.104933,0.025517,0.020315,0.006687,-0.008749,-0.022602, &
            -0.008074,0.016563,0.078467,-0.058224,-0.028600,-0.086505,-0.062427,-0.044018, &
            0.006450,0.086795,0.165411,-0.003234,-0.053685,-0.159158,-0.006126,-0.056298, &
            0.027106,0.013070,0.156965,-0.078012,-0.077233,-0.063422,-0.022212,-0.052855, &
            0.071048,0.033566,0.286702,-0.043642,-0.071481,0.042565,0.027600,-0.049095, &
            0.120579,0.078973,0.404516,-0.011749,-0.056240,0.171124,-0.013157,-0.070504, &
            0.308672,-0.354533,0.558240,-0.432849,-0.118648,0.580751,-0.248360,-0.193582, &
            -0.156428,-0.013497,-0.581206,-0.150250,0.316607,0.081656,-0.263357,-0.024516, &
            0.016464,0.381057,-0.062640,0.016845,0.506228,2.326348,0.085685,0.075586, &
            -0.535565,0.140674,-0.451597,-0.055089,0.437933,0.510634,0.181339,0.073764, &
            -0.711749,0.009795,-0.720101,-0.609264,0.495256,2.565463,-0.007069,0.082691, &
            -0.251764,-0.030800,-0.186028,0.106173,0.327893,3.974000,-0.168776,0.051712, &
            -0.427790,-0.039913,-0.315774,-0.025937,0.159291,1.936171,0.057896,0.033718, &
            0.269938,-0.067033,-0.000180,1.848655,-0.021134,0.879647,-0.104080,-0.020064, &
            -0.076372,-0.203848,-0.548717,1.558613,0.323818,1.903450,-0.080472,0.083866, &
            -0.010651,-0.223445,-1.238674,1.108691,0.282647,0.157402,-0.240597,0.142314, &
            0.082922,-0.127607,1.171061,-0.638727,-0.061305,0.299250,0.411838,0.036878, &
            0.203109,-0.179638,1.005590,-0.201654,0.079156,0.388378,0.400696,0.092566, &
            0.060559,0.102016,0.927502,-0.016821,0.128053,0.472656,0.647358,0.081514, &
            0.337062,0.004937,0.881133,-0.092294,-0.026454,0.531829,0.508345,0.076684, &
            0.127932,0.155450,0.769150,-0.037117,-0.040759,0.663408,0.683997,0.065792, &
            0.116775,0.303378,0.513395,-0.252947,0.145856,0.743733,0.748176,0.149214, &
            0.406519,0.295591,0.631767,-0.109960,0.172072,1.023875,0.839760,0.222160, &
            0.438131,0.273563,0.569815,-0.250377,0.219009,0.599737,0.733496,0.273679, &
            0.615817,-0.466349,0.400405,0.188089,-0.027247,-0.977406,0.337437,1.005973, &
            0.375373,-0.202058,0.986843,1.030252,0.143427,-1.812776,0.123786,0.964470, &
            -0.134725,0.335840,0.818736,1.382630,-0.232155,-3.305505,-0.121707,0.490168, &
            0.158185,-0.255901,-0.043298,0.884492,-0.339361,-0.284494,-0.117463,0.293650, &
            0.964961,0.447514,0.034815,-0.734967,0.015219,0.028701,-0.379973,0.315218, &
            1.219592,0.257906,0.158057,-0.032195,0.263171,0.831261,-0.679489,0.184340, &
            0.336012,-0.237851,0.232571,0.994819,0.130795,0.275039,0.055748,0.061589, &
            -0.037793,0.365022,-0.357399,0.221795,0.153366,0.363919,0.326629,0.110104, &
            0.640301,0.163368,-0.638503,-0.691666,0.171109,-0.093818,0.065209,0.251741, &
            1.353291,-0.208449,-0.592836,1.865194,0.211339,-0.735080,-1.193958,0.060562, &
            0.157519,0.018801,1.180986,0.215300,-0.301707,-0.343724,0.233565,-0.017086, &
            0.271098,-0.039394,0.758984,0.413311,-0.585164,-0.240974,0.364404,-0.116975, &
            0.186977,-0.154865,0.616903,-0.011621,-1.126438,-0.372987,0.409040,-0.429816, &
            0.003932,-0.072666,0.662155,0.026832,-1.551814,-0.389602,0.172397,-0.640650, &
            -0.089481,-0.012253,0.734017,-0.521813,-2.178468,0.030025,-0.166633,-1.014148, &
            -0.136582,-0.142235,1.162519,-0.147788,-2.853604,0.283923,-0.186311,-1.251666, &
            0.348422,-0.373086,1.563032,-0.394844,-3.366735,1.093400,-0.206362,-1.733342, &
            0.822106,-0.093746,1.688648,-1.022585,-3.657204,1.509287,0.117144,-2.174531, &
            2.732692,0.882836,0.181719,-2.718609,-1.058142,4.675547,1.980597,-8.038809, &
            1.642153,0.151458,1.196134,-1.616075,0.029780,7.477900,1.083852,-11.836870, &
            0.744093,0.518715,1.785735,1.824913,-0.927405,7.467227,0.626286,-9.919065, &
            0.260051,0.148654,1.590779,3.594790,-1.278293,3.009655,0.189798,-6.721524, &
            0.918675,0.240342,0.502516,3.214567,-1.720541,-0.913139,-0.228970,-4.528353, &
            0.895276,0.199574,0.093470,3.673555,-2.241052,-0.875713,-0.843528,-2.482650, &
            0.451021,-0.331853,0.629816,3.697234,-2.080969,-0.133013,-0.285211,-1.428489, &
            -0.423367,-0.699977,1.576227,3.042930,-1.986072,-1.667127,0.111656,-0.936635, &
            -0.460885,-1.653333,1.373383,1.504236,-1.732025,-1.054611,-0.182314,-0.806785, &
            -0.000441,-2.511842,0.320101,2.043665,-1.955931,-0.412621,-0.182531,-1.038646, &
            -0.202527,0.463315,-3.545056,-1.629450,-1.272804,3.113553,-0.051862,-0.703074, &
            -0.248305,0.291948,-3.290178,-1.690319,-1.312766,3.039989,-0.372943,-0.752915, &
            -0.549102,0.452126,-3.161104,-1.361552,-1.566911,2.908929,-0.395349,-0.734372, &
            -0.651724,0.529110,-2.725344,-1.716073,-1.582866,3.120267,-0.486280,-0.521052, &
            -0.829438,0.512379,-2.535824,-1.591535,-1.696289,3.333537,-0.621532,-0.916148, &
            -1.117316,0.141553,-2.349405,-1.275864,-1.675877,3.484560,-0.381724,-1.137745, &
            -1.322589,-0.039175,-2.030857,-1.200416,-1.407935,3.507344,-0.471890,-1.154019, &
            -1.308163,-0.179976,-1.717691,-1.399045,-1.577155,3.970316,-0.569830,-1.500006, &
            -1.322445,-0.138582,-1.774670,-1.145459,-0.616453,5.570707,-0.548062,-2.586175, &
            -1.840182,-0.525953,-1.694577,-0.361711,-0.132151,7.004225,-0.477432,-3.235071, &
            0.139545,-0.046888,-1.556700,0.007726,0.013037,6.297515,0.597596,-2.461369, &
            1.338058,-0.531635,-0.878760,0.728052,-0.480504,4.270319,0.359006,-1.477752, &
            1.194395,-0.391310,-1.334535,0.838601,-0.460558,1.841853,0.141535,-0.583270, &
            1.320151,-1.486013,-1.664382,0.337307,-0.446456,0.265572,0.747222,0.099372, &
            0.829204,-0.180345,0.391657,0.647598,-0.552676,-0.107551,-0.235754,-0.069090, &
            0.064925,0.567643,0.694287,0.578673,-0.370520,0.993393,-0.055671,-0.256118, &
            0.632262,0.225530,0.196643,-0.088460,-0.721198,1.924461,0.040591,-0.795883, &
            1.494800,0.187244,-0.445069,-0.660009,-1.115388,2.040526,-0.101423,-0.554589, &
            -0.009410,-0.254874,0.286849,-0.007522,0.206348,-0.595200,-0.009994,0.083941, &
            0.089284,0.114267,0.188988,0.259255,0.007129,0.098560,0.135825,0.000230, &
            0.048919,0.038815,-0.060130,0.165352,-0.018382,-0.106849,0.047382,0.034551, &
            -0.056839,-0.184834,-0.084542,-0.154264,-0.117926,-0.118002,-0.076872,0.011278, &
            -0.015761,-0.004075,-0.057859,0.042085,0.127086,0.023095,-0.002171,0.087962, &
            -0.023980,0.055993,0.105826,-0.080882,0.041241,0.144622,0.072391,0.055571, &
            -0.138430,0.061088,-0.048969,0.187758,0.078468,-0.206506,-0.050916,0.005119, &
            -0.041381,-0.117424,0.366231,0.026048,0.204367,-0.246685,-0.152884,0.076592, &
            -0.503765,-0.646968,1.973707,0.143874,0.281858,-1.362267,-0.376607,0.307406, &
            -0.243636,-1.124470,1.192416,-0.068295,0.079470,0.208516,-0.107086,0.430779, &
            0.006079,-0.823751,-0.096726,-0.061332,-0.137599,0.858430,0.347213,0.325226, &
            -0.121446,-0.683652,-0.115638,-0.192460,0.067187,0.678910,0.524968,0.210212, &
            -0.101978,-0.527880,-1.194958,-0.080909,-0.338425,2.803330,0.596342,0.104802, &
            -0.342039,-0.510322,-1.192424,0.517667,0.012055,0.941216,0.455525,-0.203396, &
            -0.477340,-0.490418,-0.635215,-0.021928,-0.179734,-0.205520,0.141741,-0.297554, &
            -0.455831,-0.405985,-0.228658,0.133156,0.068165,-1.629473,0.065782,-0.322306, &
            0.111021,-0.231733,0.071819,0.626239,0.073123,-1.936233,0.177211,-0.094315, &
            0.048505,0.041981,-0.088798,0.148241,0.264601,-2.877170,-0.260058,-0.189802, &
            0.223702,-0.215628,0.935045,0.221891,-0.735988,-0.450232,0.452745,-0.212903, &
            0.170168,-0.147076,0.642963,0.076734,-0.578307,-0.211840,0.398800,-0.118629, &
            0.097913,-0.272037,0.532399,0.062118,-0.399781,-0.226398,0.185360,-0.122719, &
            -0.018342,-0.334425,0.169028,0.064736,-0.226115,0.249696,0.200646,-0.011495, &
            0.172397,-0.224547,0.041185,0.180559,-0.243136,0.301725,0.013996,-0.011501, &
            0.000515,-0.225787,0.012215,0.316161,0.063641,0.417603,0.118582,0.071851, &
            0.000945,-0.530816,-0.049718,0.347809,0.095382,0.758943,0.042022,0.060304, &
            -0.083335,-0.622913,-0.341235,0.592611,0.254713,0.397419,0.309117,0.123976, &
            0.174464,-1.013855,-0.719853,0.302458,0.956916,-0.418206,0.194234,0.925885, &
            0.214800,-0.663002,-1.235061,-0.869526,1.111776,-0.619920,0.287593,1.280463, &
            -0.504011,-0.014175,-1.320646,-1.267869,1.334436,-0.446272,0.327146,0.816872, &
            -0.146673,0.272283,-0.815251,-1.172899,1.040575,-0.744341,0.160477,0.692666, &
            -0.243431,0.206490,-0.464681,-1.017560,0.875998,-0.769975,0.236564,0.581079, &
            -0.014662,0.134765,0.135833,-0.674334,0.536040,-0.028161,0.040034,0.362684, &
            0.353811,0.566523,0.167243,-0.816658,0.474667,0.192266,0.159187,0.357824, &
            0.834084,-0.535058,0.331289,-0.630660,0.286957,0.561952,-0.030760,0.325563, &
            0.421282,-0.619600,0.369339,-0.519515,0.430804,0.955119,0.160414,0.253681, &
            0.323845,-0.067171,0.964305,-0.380134,0.768362,0.343553,-0.082237,0.232816, &
            0.214423,-0.205274,0.402931,0.585655,-0.151563,-1.752482,-0.024540,-0.034916, &
            0.052679,-0.031965,-0.188242,0.108680,0.002316,-1.600050,-0.098155,0.005949, &
            -0.039425,-0.009759,-0.140407,0.080894,0.092309,-1.183392,-0.083158,0.012038, &
            0.055911,0.027215,0.022235,0.134646,-0.023189,-0.635711,-0.005680,-0.007597, &
            0.009712,-0.003248,-0.017932,0.113970,0.059061,-0.415485,-0.028429,0.009375, &
            0.031207,0.032641,0.068634,0.052256,-0.024777,-0.135756,0.027509,-0.008687, &
            0.019964,0.010472,0.061481,0.159105,-0.021774,-0.250042,-0.019282,-0.014403, &
            -0.008256,-0.065036,0.100319,0.169655,0.098326,0.061056,-0.022640,0.012428, &
            0.004704,-0.158586,-0.138350,0.643931,0.342111,-0.281108,-0.054655,0.099092, &
            -0.443507,0.030256,0.086114,-0.371203,0.168908,-0.028624,0.211853,-0.001100, &
            -0.059471,0.118600,0.525561,-0.140275,0.181033,-0.381347,0.054801,-0.047412, &
            0.096756,0.109645,0.168170,0.072375,0.074468,0.000959,-0.008818,-0.002516, &
            0.053841,0.101626,0.376560,0.611176,-0.161118,-0.354517,0.120356,-0.077796, &
            0.174352,0.083914,0.371386,0.393327,-0.207063,-0.031837,0.122176,-0.052231, &
            -0.284601,-0.101266,-0.332573,0.038411,0.298898,0.108865,0.016002,0.091567, &
            0.234251,0.062072,0.233794,0.118874,0.083427,-0.081117,-0.183028,-0.020677, &
            0.358010,-0.185502,0.027033,0.046858,-0.050359,-0.073914,-0.263892,0.017790, &
            -0.453157,-0.006868,0.273377,-0.630199,-0.013583,0.039252,0.255322,-0.033287 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.989104,-1.073014, &
            -6.483804,2.255654, &
            -0.961312,-0.912198, &
            -0.269899,-1.401126, &
            1.910061,1.656166, &
            -0.269519,-2.214523, &
            2.354021,0.752942, &
            -8.604970,0.073575 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.846369,-1.762036/),(/1,2/))
real, dimension(8) :: bias1 = &
(/-2.097777,2.47755,1.716002,0.828307,-0.959515,-2.770216,-1.994644,1.574028/)
real, dimension(2) :: bias2 = &
(/0.524875,-0.05956/)
real, dimension(1) :: bias3 = &
(/1.940425/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
