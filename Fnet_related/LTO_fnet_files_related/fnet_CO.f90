module fnet_CO

! a = 5.569e-005
! b = 0.090701

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.191408,0.237787,-0.071266,-0.059869,-0.357079,0.049266,-0.073037,-0.193672, &
            -0.009081,0.021384,-0.071896,-0.063281,0.027487,0.059824,-0.030519,-0.115144, &
            -0.010430,-0.046307,-0.029550,0.040724,0.068372,0.083592,-0.127157,-0.159878, &
            0.033829,-0.008996,0.055852,0.044802,0.084134,-0.025329,0.073921,0.050619, &
            -0.054906,-0.024009,0.029047,-0.028047,-0.090757,-0.059199,0.029271,0.042921, &
            0.089935,0.052764,0.012751,-0.075788,0.026152,0.102869,-0.162471,-0.023414, &
            0.010815,-0.010581,0.020668,-0.035387,-0.098543,-0.003800,-0.035162,0.053221, &
            0.043598,-0.029676,0.028258,0.021320,0.125933,0.009237,-0.117874,-0.112933, &
            0.023939,0.304674,0.241004,0.666041,-0.519567,0.047971,0.091481,-0.420022, &
            0.332599,0.395819,-0.263867,0.003178,-0.699564,0.336196,-0.319222,-0.354096, &
            -0.047756,0.556649,-0.075125,-0.587049,-1.050266,-0.086581,0.162666,-0.029173, &
            -0.191627,0.194416,0.170576,-0.477162,-0.051335,-0.301849,0.549345,0.572891, &
            -0.064553,0.013479,0.038512,-0.222702,0.529352,0.059257,0.059986,0.143909, &
            0.123474,-0.541893,0.035226,0.095962,0.809552,0.043659,-0.566086,-0.117333, &
            -0.062833,-0.133583,-0.202203,-0.054336,0.484275,0.274810,-0.211138,-0.190456, &
            -0.126556,0.042663,0.171982,0.453336,0.443178,0.467079,-0.313701,-0.472823, &
            -0.750969,0.336607,0.758102,0.051312,-0.225025,0.225496,-0.138306,-0.375655, &
            -1.149864,-0.207689,0.623367,0.265274,-0.175463,0.082355,0.135637,0.177159, &
            -0.034468,-0.083294,-0.613274,-0.332708,-0.661121,0.107480,-0.002361,0.305141, &
            -0.223180,-0.207406,-0.214832,-0.518956,-0.476866,0.223010,-0.078690,-0.052849, &
            -0.125937,-0.110326,-0.186398,-0.253959,-0.295939,0.116176,0.091724,-0.038286, &
            0.043257,-0.141255,-0.299381,-0.492377,-0.212450,0.049942,-0.206892,-0.329103, &
            0.107043,-0.238774,0.033085,-0.279402,-0.087890,-0.237420,0.062762,-0.153056, &
            0.047390,-0.126345,0.001856,-0.268321,0.025239,-0.103531,0.118204,-0.164357, &
            0.252178,-0.252900,-0.052753,-0.173489,-0.040223,-0.041072,-0.076629,-0.048688, &
            0.269959,-0.355854,0.027637,-0.204613,-0.075331,0.026374,-0.178984,-0.033176, &
            0.390049,-0.357200,-0.316572,-0.683756,0.186041,0.179438,0.130086,-0.727978, &
            -0.001637,-0.438476,0.487904,-0.064859,-0.066401,0.387969,-0.129874,-0.282740, &
            -0.038910,-0.429543,-0.122119,0.691529,-1.219509,0.518477,-0.483385,-1.247102, &
            0.231325,-0.205894,0.190763,0.727391,-1.011317,0.175203,-0.219602,-0.453144, &
            0.049338,0.069763,0.337366,-0.271878,-1.037699,0.070949,-0.006346,0.109901, &
            0.152722,0.365300,0.129690,-0.652522,-0.303551,0.059659,-0.120552,0.079821, &
            -0.027016,-0.071665,-0.040330,0.141663,-0.587313,0.273504,-0.316255,0.045130, &
            -0.371566,-0.185650,0.114653,0.355152,-0.825154,-0.303213,0.136259,-0.398768, &
            -0.147882,-0.259682,0.643881,0.948506,-0.556585,-0.583296,0.781995,0.239161, &
            -0.228592,0.445877,0.300073,0.420815,0.188225,-0.296027,1.000330,0.546717, &
            -1.477167,2.213745,-0.787593,2.614587,0.940834,-0.945495,2.303930,2.082913, &
            -2.155425,3.427892,-1.865802,2.991036,1.728715,-1.317950,1.739374,2.416276, &
            -2.461923,3.706318,-1.955700,3.229271,1.188214,-1.137019,1.968328,2.596755, &
            -2.565471,3.843043,-1.520172,3.013833,0.857338,-1.029541,2.191686,2.152949, &
            -2.904390,4.235654,-1.422877,3.147946,0.384976,-0.587710,2.301727,2.290142, &
            -3.231516,4.505014,-1.064323,3.297770,0.145887,-0.582482,2.419731,2.728515, &
            -3.375297,5.055548,-1.405130,3.539549,0.068387,-0.486063,2.516097,3.056774, &
            -4.061474,5.536871,-1.974339,4.560631,0.620211,-0.867933,2.197141,3.731582, &
            -7.470877,8.709856,-5.216160,7.985775,4.330144,-4.827953,-0.466561,7.119191, &
            -5.039867,6.473290,-6.053837,7.210839,5.334784,-5.253017,2.380925,5.266298, &
            -2.094635,2.703457,-7.765221,5.575320,7.581311,-5.811279,3.563213,2.730075, &
            -1.041546,0.561250,-5.324067,2.916671,5.683160,-4.046475,3.156094,1.118280, &
            0.018670,0.140268,-4.764037,1.562757,5.344864,-3.915704,1.804143,0.350639, &
            -0.144260,0.243605,-3.486260,-0.204804,3.752045,-2.661745,1.096945,-0.030995, &
            -0.775839,-0.259545,-1.550623,-1.355508,1.538634,-1.097469,0.262246,0.386629, &
            -0.370628,-0.186786,-1.379771,-0.714914,1.251535,-0.843705,0.303498,-0.270411, &
            -0.246546,0.009979,-1.084621,-0.605908,1.363920,-0.309766,0.163933,-0.053595, &
            -1.168913,0.071197,-0.975056,-0.201122,2.479067,-0.091343,0.553350,-0.305237, &
            -0.451759,0.877447,-0.598712,-0.347792,0.738303,0.033442,0.616569,0.740050, &
            -0.465804,0.988170,-0.437113,-0.001170,0.862096,0.039839,0.480350,0.589161, &
            -0.619693,0.800021,-0.214569,-0.154890,1.018736,0.005723,0.352329,0.921904, &
            -0.825350,0.909564,-0.352506,-0.037976,0.850281,-0.266982,0.436076,0.647466, &
            -0.923749,0.984415,-0.333155,-0.093060,0.658476,-0.283886,0.039886,0.958237, &
            -1.089831,1.291426,-0.505802,-0.034694,0.601374,-0.153639,0.009465,1.106644, &
            -1.042677,1.265240,-0.333122,0.265418,0.833126,-0.141312,0.277387,0.940640, &
            -1.107402,1.115621,-0.036508,0.191385,0.514842,-0.207659,0.238160,1.060940, &
            -1.886567,1.494949,0.061280,0.306350,0.787916,-0.129156,-0.058222,1.953923, &
            -0.933479,1.831997,-0.859592,0.972418,2.076184,-1.403958,0.366356,0.752128, &
            -0.198142,1.357173,0.792990,0.141314,1.118957,-0.401458,0.719394,-0.090360, &
            -0.172899,1.003043,0.360782,-0.302312,1.423426,-0.748927,0.308791,-0.251472, &
            -0.057284,0.473402,0.341000,0.144668,1.856336,-0.789708,0.064280,-0.428250, &
            0.797804,0.037918,-0.027039,-0.098342,1.558456,-0.346025,0.324648,-0.080777, &
            0.708084,-0.209956,0.545948,0.427574,1.584490,0.245442,0.097913,0.349832, &
            -0.176286,0.029302,0.370028,0.124171,2.281352,0.349172,-0.107697,0.612277, &
            -0.221507,-0.383241,0.028526,0.192743,2.600040,0.355566,-0.199642,0.218916, &
            -0.574419,-0.098241,-0.664104,-0.184710,3.689523,0.360259,0.098739,-0.512761, &
            0.099629,0.048596,0.420656,0.027480,-0.517809,-0.093037,0.571852,0.130283, &
            0.067912,0.050209,0.168855,-0.107182,-0.087041,-0.152874,0.202668,0.032075, &
            -0.091836,0.023228,0.115425,0.132550,-0.276888,-0.097467,0.089515,-0.272505, &
            -0.005880,-0.061282,-0.104025,0.218751,0.112568,0.106005,0.103212,0.174057, &
            0.001980,-0.064502,0.066974,0.103475,-0.213038,0.051864,-0.128825,0.000063, &
            -0.173035,-0.061162,0.092906,-0.097047,0.008932,-0.110513,-0.089526,-0.002230, &
            0.042834,0.155111,0.231506,0.106200,-0.108165,-0.079013,0.153752,0.175182, &
            -0.272278,0.044577,0.020006,-0.225423,-0.117913,-0.205364,0.274432,0.572098, &
            -0.161342,-0.251665,0.890000,-0.317424,-1.172491,-0.189741,0.076795,0.626613, &
            -0.402313,0.150340,-0.312833,0.229960,-0.675097,-0.767412,-0.141330,0.830390, &
            0.588939,0.102672,-0.549935,-0.700611,-0.579706,0.016518,0.382629,-0.753198, &
            0.825236,0.349997,-0.946894,-0.616860,-0.317654,-0.338367,-0.050674,-0.622022, &
            0.773967,-0.162369,-1.101530,-0.541217,-0.714970,-0.057167,0.365449,-0.958234, &
            0.317382,-0.022572,-0.493262,-0.728547,-0.832244,-0.341354,-0.379296,0.297794, &
            0.689186,-0.331711,-0.427080,-0.735203,-1.107781,0.750134,-0.262251,-0.486546, &
            0.333431,0.181109,-0.817026,-0.216729,-0.348495,0.418682,-1.023960,0.031076, &
            -0.133193,0.236135,-0.091435,-0.634443,-0.835014,0.022786,-0.973041,0.744175, &
            -0.201240,0.020149,0.073076,-0.263663,-0.182620,0.035157,-0.929328,0.435963, &
            0.285315,0.148443,-0.123678,0.124095,0.350773,-0.161603,0.093039,0.092953, &
            0.144237,-0.214553,0.122600,-0.067235,0.323981,-0.031035,0.068653,-0.009363, &
            0.162150,-0.152732,0.115433,-0.201345,0.115558,-0.328956,0.315360,-0.127148, &
            0.294729,-0.151553,0.139385,0.041563,0.374176,0.021439,-0.041519,0.087552, &
            0.148081,-0.248475,0.177495,-0.247724,0.175556,-0.125272,-0.199936,0.045168, &
            0.313456,-0.359284,-0.028259,0.076924,0.373292,-0.133126,-0.025417,0.124913, &
            0.080454,-0.326780,0.198211,-0.339911,0.475011,-0.065385,-0.391776,-0.118328, &
            0.257725,-0.499206,0.024730,-0.070893,0.179787,-0.049088,-0.371252,-0.049333, &
            0.610115,-0.873324,0.640554,-0.094117,0.346364,0.315911,-0.437182,-0.679183, &
            0.440344,-0.724484,0.521739,-0.086406,-0.351634,0.307644,-1.055443,-0.794845, &
            0.667738,-0.171929,-0.231102,-0.156560,-0.734154,0.135665,-1.429047,-0.557469, &
            0.689605,-0.266569,0.393666,-0.113862,-1.116192,0.195153,-0.955539,-0.286875, &
            0.157525,-0.375228,0.458524,-0.150490,-1.179195,0.158209,-0.607742,0.080556, &
            0.049409,-0.277586,0.128069,0.342355,-0.881539,0.044397,-0.645122,0.133331, &
            0.189490,-0.295192,0.001039,-0.100410,-0.301946,0.086189,-0.067468,0.169777, &
            -0.232066,-0.125643,-0.088381,0.065745,0.380589,-0.007367,-0.039367,0.198725, &
            -0.225510,-0.327591,0.344762,0.212141,0.301191,0.252981,0.170926,0.113318, &
            0.040654,-0.188637,0.968719,0.278702,0.685160,-0.241912,0.034020,0.310198, &
            -0.064713,0.188268,-0.304647,-0.657279,0.351989,0.169173,-0.189236,-0.220015, &
            -0.109307,0.077589,-0.145391,-0.397156,0.308460,0.027005,-0.019487,-0.052764, &
            -0.083330,0.029788,-0.045169,-0.582270,0.164530,-0.182985,0.014662,-0.011970, &
            -0.147522,0.059088,-0.045273,-0.343486,0.099736,-0.062444,0.029213,-0.106198, &
            -0.159095,0.008539,-0.063601,-0.026307,0.085667,0.059994,0.004800,-0.055611, &
            -0.171283,-0.111182,-0.112595,0.023091,-0.094687,-0.015011,-0.098727,-0.200284, &
            -0.094361,-0.081534,-0.087594,-0.007578,0.030403,0.016391,-0.029385,-0.023928, &
            -0.183911,-0.026631,-0.128336,0.049866,-0.116357,0.034972,-0.084617,-0.278833, &
            -0.392741,-0.118945,0.079471,0.179151,0.569022,-0.010855,-0.047305,-0.665537, &
            -0.116785,0.052500,0.142964,-0.567239,0.621509,-0.199294,-0.006583,-0.513789, &
            0.073981,0.047969,0.296452,0.029578,0.309573,-0.131919,-0.031989,-0.241952, &
            0.187863,0.096115,-0.007776,-0.167353,0.186438,-0.034490,-0.084121,-0.271438, &
            0.283342,0.120971,0.367324,0.791903,0.696228,0.170761,-0.029712,-0.439334, &
            -0.070201,0.188424,0.502734,1.095689,0.250788,0.063324,0.497384,-0.143800, &
            -0.125714,-0.046365,0.070806,0.164043,-0.398757,-0.209247,0.338550,0.347850, &
            -0.003868,-0.059688,-0.027296,-0.572900,0.152937,-0.094465,-0.106541,0.143899, &
            0.245744,0.024729,-0.090209,0.009453,0.165090,0.182678,-0.204825,0.122736, &
            0.020126,-0.211316,-0.425357,-0.657704,0.358154,0.229916,-0.490694,0.118751 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.391807,0.595605, &
            -2.936824,-1.376035, &
            -1.464705,3.629630, &
            0.489532,-2.099493, &
            0.375620,-1.369169, &
            0.923939,5.545871, &
            1.142788,1.292671, &
            -0.656183,-0.840799 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.125147,0.960023/),(/1,2/))
real, dimension(8) :: bias1 = &
(/1.757778,-2.399045,2.694131,-2.048179,-2.376081,1.969953,1.649481,-0.882842/)
real, dimension(2) :: bias2 = &
(/0.060524,0.601996/)
real, dimension(1) :: bias3 = &
(/-0.119699/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
