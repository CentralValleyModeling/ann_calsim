module fnet_MidR_intake

! a = 0.00084822
! b = 0.0059421

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.129604,-0.472200,-0.244167,0.383951,0.576247,0.275476,0.240189,-0.185564, &
            -0.120727,-0.372887,-0.209810,0.377632,0.171634,0.042053,0.013447,-0.247895, &
            -0.175041,-0.481763,-0.100449,0.233157,0.142211,0.081011,-0.067365,-0.218420, &
            0.052833,-0.450774,-0.003868,0.238933,0.088630,-0.098449,-0.114898,-0.262128, &
            -0.119905,-0.302922,0.061292,0.148549,-0.047454,0.097461,-0.084862,-0.205445, &
            0.031307,-0.451007,-0.059863,0.061842,0.145481,-0.047776,-0.106582,-0.154527, &
            -0.091609,-0.227145,-0.148907,0.141174,0.149534,0.088225,-0.030048,-0.105028, &
            -0.132571,-0.162260,-0.232032,-0.151906,0.215532,0.119954,-0.071407,0.003984, &
            -0.063010,0.130578,-1.075794,-0.993460,0.893529,-0.151558,-0.308315,-0.232567, &
            -0.067647,-0.010319,-0.381860,-0.958513,0.186841,-0.509614,-0.435023,0.058842, &
            -0.063501,-0.744475,-0.128756,-0.531712,-0.123632,-0.261429,0.661568,-0.309679, &
            0.066995,-1.449766,0.091482,0.427202,-0.062814,0.220304,1.004190,-0.706896, &
            0.397387,-0.880544,0.796810,-0.591808,-0.048303,0.441493,0.243739,-0.938828, &
            0.490460,-0.684656,0.988597,-0.013826,-0.060467,0.172266,-0.089448,-0.887010, &
            0.163104,-0.331821,0.759528,0.285234,-0.220594,0.323378,0.432510,-0.331688, &
            0.092721,0.021371,0.718762,-0.417514,0.074163,0.638711,-0.156413,0.076618, &
            0.144433,0.501523,0.957629,0.648064,0.226336,0.475302,-0.149904,0.309741, &
            0.067614,0.630522,0.940368,-0.298210,-0.247331,0.072732,-0.343660,0.862184, &
            -0.021377,0.003019,0.218627,-0.166584,0.264952,0.560302,0.511779,0.162033, &
            0.020196,0.056466,0.231213,0.184291,0.057011,0.366289,0.759985,0.107111, &
            0.012104,0.027639,-0.007677,0.178878,-0.023727,0.036838,0.596074,0.022077, &
            -0.120509,0.102912,0.093416,0.357094,-0.011764,0.084859,0.373179,0.156942, &
            -0.136083,0.361267,-0.184968,0.319325,0.103252,-0.115735,0.261668,0.313217, &
            -0.032651,0.244642,-0.246037,0.041724,-0.138218,-0.341335,0.394903,0.052913, &
            -0.122528,0.176605,-0.126848,0.016496,-0.158913,-0.343686,0.341892,0.307072, &
            0.006496,0.467069,0.009909,0.099289,-0.273331,-0.502660,0.631867,0.311264, &
            0.137021,0.345267,0.212248,0.410320,-1.158639,-0.578423,2.243360,0.071721, &
            -0.060711,-0.668176,-0.313460,0.645448,-1.362650,-0.400836,1.655148,0.036073, &
            -0.429167,-0.590302,-0.439249,0.677668,-1.390984,-0.462040,0.151814,-0.256426, &
            -0.098896,-0.142525,-0.228176,0.632654,-0.961708,-0.117380,-0.000537,-0.247144, &
            0.072677,-0.418818,0.305863,0.524852,-0.770589,-0.380322,-0.050842,-0.091232, &
            0.380120,-0.204853,0.109643,0.037943,-0.193188,-0.456086,0.002057,0.043610, &
            0.238408,-0.240005,-0.045910,-0.240951,-0.078039,-0.001429,-0.127344,-0.151853, &
            0.185602,-0.065764,0.073203,1.113103,-0.103872,-0.182234,0.201528,-0.070564, &
            0.255193,0.090765,-0.107007,-0.002036,-0.066169,-0.556137,0.072410,0.303583, &
            0.915135,-0.344313,-0.475710,-2.542666,0.228805,-0.604706,-0.079913,-0.177534, &
            0.295250,0.425661,0.781122,-0.274517,0.116119,0.507213,0.367724,-0.198692, &
            0.274779,0.777520,0.782242,-0.205327,0.158389,0.405305,0.039145,0.065168, &
            0.084551,1.092172,0.653610,-0.052889,-0.131044,0.275139,-0.136047,-0.122836, &
            0.140718,1.513134,0.382048,-0.116582,0.105270,0.173280,-0.212900,-0.267345, &
            0.023460,1.638714,0.038102,-0.377039,0.311150,0.046336,-0.279180,-0.001884, &
            -0.011305,2.354023,0.126282,-0.353677,0.214553,-0.048017,-0.479483,-0.235555, &
            0.113021,2.660420,0.201482,-0.371712,0.514051,-0.201859,-0.445860,-0.306682, &
            0.284527,2.864867,0.285140,-0.478420,0.719793,-0.398632,-0.412285,-0.421014, &
            0.140318,4.844889,0.604322,-0.591031,5.242127,-1.043018,-0.668130,-0.568573, &
            0.011577,6.217107,0.824155,-0.069545,10.674758,-0.647487,-0.716224,-0.341919, &
            0.180199,4.984217,1.533272,1.570093,12.226316,0.165018,-1.258782,-0.181537, &
            -0.101980,3.213376,1.085684,-0.204728,9.981196,-1.405660,-1.670154,0.839274, &
            0.453718,1.830200,1.944519,-0.590164,7.645852,-2.211495,-1.803106,0.371908, &
            0.684360,0.574200,1.518147,0.614206,5.337500,-1.367402,-1.819006,-0.214409, &
            -0.406617,0.572084,1.013216,0.275460,4.893915,-1.192010,-1.721973,0.738070, &
            -1.615666,-0.496919,1.048213,0.023235,4.669291,-1.289330,-2.328737,0.820648, &
            -1.643681,-0.676543,1.243648,-0.145732,3.180688,-0.008365,-1.800511,1.236311, &
            -0.546939,0.469174,1.295554,-0.587498,2.169050,1.558444,-0.586462,1.037012, &
            -0.044253,-1.063314,-0.291827,0.401709,0.399684,0.320571,-0.948257,-2.094449, &
            -0.333722,-1.071400,0.010567,0.065170,0.404490,0.090711,-0.616322,-1.788354, &
            -0.344322,-1.290084,-0.250798,0.365098,0.015042,-0.006824,-0.597801,-1.403168, &
            -0.212546,-1.065663,-0.298406,0.291591,-0.136155,0.316892,-0.422471,-1.192875, &
            -0.158266,-1.051836,-0.229218,0.154365,-0.753056,-0.009327,-0.365418,-1.142761, &
            -0.161333,-0.966655,-0.201202,0.295336,-0.891991,0.276921,-0.372491,-0.907586, &
            -0.220934,-1.057445,-0.328020,0.226319,-0.846238,0.137939,-0.329911,-0.724194, &
            -0.179320,-0.871411,-0.310126,0.078422,-1.161283,0.380618,-0.016757,-0.743651, &
            0.182455,-0.446395,-0.208547,0.117687,-0.926504,1.449385,0.212946,-0.477192, &
            0.563264,-0.017602,0.220355,-0.469627,0.921730,1.868735,0.081156,-0.593886, &
            -0.038206,-0.889121,0.464377,-1.722564,2.073491,1.476685,0.312657,-0.631694, &
            -0.595742,-0.569638,-0.086484,-2.156241,2.894642,0.312999,0.688402,0.461118, &
            -0.214492,-0.989513,0.039397,-0.873280,2.661457,0.236073,0.594930,-0.261169, &
            -0.104485,-0.757048,0.088465,0.483239,2.011238,0.562232,0.609075,-1.192026, &
            0.714771,0.181469,-0.252826,0.394197,1.376684,0.837308,1.010661,-0.621647, &
            0.733016,0.875206,0.231235,0.006643,1.642527,0.740547,0.624058,-0.332941, &
            0.875627,1.090808,0.057438,1.016368,2.630420,-0.138292,-0.084895,0.565642, &
            0.125344,0.820731,0.857251,0.775222,3.557065,-0.813241,-0.435558,1.265497, &
            -0.063956,0.519933,-0.055236,-0.627943,-0.034592,0.233019,0.075640,0.374313, &
            -0.177164,0.340316,-0.069542,-0.104869,0.091233,0.220452,-0.089660,0.254340, &
            -0.108541,0.111613,-0.015721,-0.042895,-0.080716,0.063596,-0.061704,0.110929, &
            -0.013571,-0.090222,-0.051325,-0.247088,-0.130827,0.070598,0.156171,-0.099160, &
            -0.057026,-0.020817,-0.058048,-0.107866,-0.036454,0.040555,0.013058,0.067927, &
            -0.077828,0.051589,-0.027636,-0.253599,-0.125665,-0.026765,0.068225,0.184380, &
            0.091372,0.243032,-0.008356,-0.381510,0.148201,0.276748,0.128700,0.139260, &
            -0.273927,0.490967,-0.083810,-0.632762,-0.293590,0.420484,0.070161,0.350459, &
            -0.441675,0.650057,-0.336128,-2.230585,-0.784098,1.106088,0.608773,1.148575, &
            -0.002035,0.821027,0.084851,-2.033067,-0.979645,1.214299,0.664035,1.228204, &
            0.141009,0.381748,-0.065719,-0.818491,-0.476617,0.179030,-0.189602,0.886179, &
            0.011208,1.139975,-0.289465,-1.253529,-0.446893,0.212447,0.279746,1.144222, &
            0.329307,0.772091,0.178108,-0.404759,-0.259508,-0.123905,0.058435,0.841050, &
            -0.109199,1.124264,0.080943,-0.129113,0.578856,-0.654892,-0.907030,0.837963, &
            -0.228393,0.971466,-0.134290,0.268571,0.678350,-1.091385,-0.796182,0.760329, &
            -0.478620,0.477073,-0.154899,1.323384,0.728837,-1.120247,-0.617935,0.375021, &
            -0.884611,0.839316,-0.279967,0.507579,0.577858,-0.558738,-0.951000,0.880226, &
            -0.721867,0.201346,-0.324937,1.093209,0.405652,-0.909304,-0.692650,0.286319, &
            -0.167247,-0.105374,0.080107,-0.512568,0.031993,-0.477743,-0.133015,-0.269894, &
            -0.049555,-0.138026,0.096450,-0.422285,-0.083497,-0.053556,0.008873,-0.300829, &
            -0.097696,-0.250964,-0.116435,-0.704201,-0.043311,-0.119927,0.035655,-0.326098, &
            -0.108552,-0.058365,-0.234044,-0.538370,-0.035241,-0.179647,-0.075220,-0.215806, &
            0.007049,-0.313025,-0.051373,-0.371999,-0.117938,-0.313115,-0.061192,-0.173108, &
            -0.255498,-0.432819,-0.207275,-0.347632,-0.050169,0.010765,0.056814,-0.411743, &
            -0.105321,-0.289495,-0.283289,-0.554273,-0.153523,-0.237641,0.207299,-0.287511, &
            -0.147184,-0.168161,-0.489808,-0.691491,-0.108030,-0.367767,0.377922,-0.452316, &
            -0.639236,-0.240117,-0.634878,-1.762487,-0.886546,-0.504243,0.933978,-0.481585, &
            -0.241543,-0.284385,-0.871106,-1.036527,-1.445223,-0.946745,0.855703,0.155048, &
            -0.326295,-0.028833,-0.706215,-0.417817,-1.582318,-0.863733,0.994851,0.527793, &
            -0.085283,-0.160277,-0.361634,0.459687,-1.324525,-0.265444,0.994700,0.400243, &
            -0.250229,0.230435,-0.126243,-0.111551,-0.771498,-0.189433,0.735815,0.115908, &
            -0.142450,0.355730,-0.560848,-0.498890,-0.825506,-0.209746,0.323108,-0.312970, &
            0.046881,0.042963,-0.692187,0.103534,-0.412914,0.453413,0.401141,-0.110129, &
            -0.216935,0.426057,-0.052087,-0.033806,-0.422303,0.274941,-0.024761,-0.260568, &
            -0.337426,0.236932,-0.120263,0.286868,-0.430039,0.407679,-0.361547,0.003471, &
            -0.565987,0.177971,0.464175,0.209429,-0.264920,0.628568,-0.221112,0.260187, &
            0.064743,0.166089,0.073088,-0.170368,0.127499,0.159492,0.040497,0.105324, &
            0.040292,0.217675,0.119996,-0.085672,0.054734,0.095925,0.038356,0.181866, &
            -0.032332,0.146095,-0.084911,0.126912,-0.061527,-0.120235,0.051073,0.086032, &
            -0.124387,0.069224,-0.063331,0.087876,0.001419,0.087582,0.025449,0.062540, &
            -0.016613,-0.076380,-0.124075,-0.010051,-0.002116,-0.050706,0.050258,-0.059191, &
            0.069454,-0.241925,0.121018,-0.013973,-0.013870,0.029474,0.055736,-0.201150, &
            0.043761,-0.084573,0.028814,-0.023192,0.009071,-0.017598,-0.011164,-0.062649, &
            -0.075926,-0.223788,-0.138617,-0.019754,-0.038458,-0.055251,-0.035397,-0.169341, &
            -0.031962,-0.270426,-0.236070,-0.202112,-0.073017,-0.038533,0.095743,-0.238436, &
            0.083065,-0.186945,0.320238,0.205331,0.044141,0.236091,0.103958,-0.188177, &
            0.034053,0.114279,0.030706,-0.101026,0.132634,0.102293,0.243625,0.180983, &
            -0.060621,0.040708,-0.076097,0.236481,0.026606,0.156243,0.090613,-0.062493, &
            -0.043458,-0.231530,0.140984,0.471889,0.003356,-0.041865,-0.080162,-0.188223, &
            0.038302,-0.016087,-0.012119,0.171748,-0.113019,-0.155212,0.103509,-0.075878, &
            -0.042475,-0.049704,0.050706,-0.035641,-0.019250,0.020197,-0.105312,0.032097, &
            -0.050219,-0.014642,-0.024222,-0.132020,0.104168,0.002234,-0.058093,0.045024, &
            0.089333,0.144107,-0.130832,0.276667,-0.091394,-0.266450,0.247439,0.197517, &
            0.014557,0.107969,0.220658,-0.570267,0.045408,0.182047,-0.287703,0.021169 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.047290,-1.804736, &
            -0.942112,1.307405, &
            -0.966365,-0.039989, &
            4.455934,-1.777548, &
            -2.109708,1.085203, &
            1.436564,-0.605348, &
            -0.912668,0.146033, &
            1.530080,-0.851165 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.831588,-0.334534/),(/1,2/))
real, dimension(8) :: bias1 = &
(/0.976589,-0.158959,-0.895848,1.874966,-0.019061,0.476767,-1.476176,2.365753/)
real, dimension(2) :: bias2 = &
(/0.330157,-0.471002/)
real, dimension(1) :: bias3 = &
(/0.146993/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
