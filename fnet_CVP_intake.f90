module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.133378,-0.607051,0.143336,0.308017,-0.132269,0.522382,0.652901,1.498752, &
            -0.338329,0.109217,-0.280647,0.786713,0.091867,0.846285,-0.020742,0.388859, &
            0.226846,0.095105,0.374346,0.394602,0.256867,-0.150249,-0.066463,-3.522486, &
            4.727008,-0.977255,0.134461,-11.098602,2.085023,2.783316,8.176539,5.829455, &
            0.207806,0.045338,-0.580105,0.007849,-0.897686,-0.044285,0.279644,-0.750743, &
            -0.055113,-0.512975,0.513551,-0.283410,0.715454,-0.116997,0.344977,-2.544994, &
            0.051533,-0.084201,-0.031924,0.264469,-0.376153,-0.000123,0.387175,0.546690, &
            -0.082895,-0.174274,0.003923,0.329632,0.032248,0.591429,0.420130,1.843765, &
            -0.784634,-0.683533,-0.079722,0.524469,0.099255,0.180695,0.274666,-1.578615, &
            0.185048,0.339919,0.040916,0.118671,1.528467,1.451939,-0.407090,-5.057157, &
            2.792128,-5.321116,-2.534108,-10.668009,4.123271,-0.505268,7.190693,4.334519, &
            0.098505,0.000504,-0.096070,-0.058772,-0.277138,-0.054538,0.097194,-0.023271, &
            0.064529,-0.542049,0.508091,-0.655074,0.440173,-2.016183,0.676471,-0.721077, &
            -0.110513,-0.081913,0.188930,-0.017798,0.212513,-0.194068,-0.058959,0.265717, &
            -0.099594,-0.407085,0.020264,0.157640,-0.097125,0.134077,0.682588,5.044266, &
            -0.379296,-0.172628,-0.229445,0.254906,-0.063477,-0.250077,0.146436,-1.640577, &
            0.598560,-0.182784,0.389027,-0.093608,0.794776,0.877911,-0.234436,-4.047856, &
            1.652518,-5.794977,-2.896897,-9.409810,2.511633,-0.895199,8.195659,3.198764, &
            0.010070,0.017136,-0.138007,0.042875,-0.160056,-0.110387,0.010730,-0.066220, &
            -0.055173,-0.367330,-0.069464,-0.810601,0.518225,-1.586388,0.205730,-1.623560, &
            -0.015968,-0.094021,0.011687,0.010661,-0.021613,0.011640,0.163968,-0.529383, &
            -0.110428,-0.356796,-0.011036,0.141255,-0.144808,0.079361,0.446340,4.178361, &
            0.256791,0.524084,-0.116653,0.277664,-0.436217,0.030566,-0.270514,-0.053309, &
            -0.084752,0.372542,-0.013865,0.016307,0.415867,0.360811,-0.892280,-3.184255, &
            2.084696,-3.894578,-0.813272,-6.809452,-0.334022,-0.238334,8.804317,2.440981, &
            0.060487,0.019693,-0.148426,-0.214512,-0.086095,-0.176474,0.093740,0.209885, &
            -0.163362,-0.429603,-0.109860,-0.453327,0.531502,-0.097406,0.636529,-2.134603, &
            0.024496,0.095204,-0.110987,0.016040,-0.037144,0.172258,-0.084586,-0.362848, &
            -0.035569,-0.284419,-0.079847,0.035238,-0.265075,0.032783,0.348753,4.004120, &
            0.411277,0.752776,-0.139823,-0.005451,-0.531111,-0.195912,-0.815017,0.550626, &
            0.185798,0.424021,-0.216995,-0.475638,0.155301,-0.003758,-0.981681,-2.079567, &
            2.474378,-2.648910,-0.103996,-3.806859,-1.618139,0.375149,7.819769,1.873829, &
            0.091705,0.104219,-0.200938,-0.005761,-0.196434,-0.002338,0.183819,-0.481408, &
            0.030474,-0.346439,0.027674,-0.100366,0.163970,0.047226,0.786746,-1.640121, &
            0.006737,0.097759,-0.113321,-0.110589,0.040276,0.046742,-0.161948,-0.375961, &
            0.010248,-0.092275,-0.009420,0.034134,-0.109693,-0.018716,0.106698,1.191848, &
            0.085935,0.493088,-0.080090,0.023969,-0.261631,-0.279728,-0.821168,0.515420, &
            0.252220,0.602665,-0.195175,-0.072515,0.301454,-0.046790,-0.999646,-1.653844, &
            3.156200,-2.274009,-0.033249,-2.039370,-1.760753,0.309050,6.330401,1.089816, &
            0.047732,0.055200,-0.112675,-0.049987,-0.034493,0.055220,0.193130,-0.532841, &
            0.105988,-0.121009,-0.097627,-0.042339,0.080279,-0.005868,0.461592,-1.245862, &
            0.006988,0.075882,-0.085570,-0.100333,0.004246,-0.002009,-0.167861,-0.190058, &
            0.022184,-0.035494,0.034500,-0.005479,0.027276,-0.027317,0.051986,0.696614, &
            -0.000412,0.422960,-0.170378,0.110602,-0.304672,-0.312198,-0.786896,0.474084, &
            0.234623,0.291282,-0.008236,0.019598,0.012081,-0.168493,-0.768734,-0.782177, &
            3.175513,-1.878825,-0.100690,-1.141518,-0.971901,0.169845,5.166290,0.640600, &
            0.120832,-0.050677,-0.247991,-0.233308,-0.304452,0.084143,0.215884,-0.214711, &
            -0.054096,-0.186053,0.001732,0.146209,-0.047606,-0.142977,0.382718,-0.613509, &
            -0.006216,0.019622,-0.004259,-0.013875,-0.008855,-0.044540,-0.056352,-0.046674, &
            0.071596,-0.088572,0.030572,-0.081513,0.019869,0.058575,0.197700,0.134569, &
            -0.111152,0.290127,-0.158822,0.247461,-0.263692,-0.290165,-0.704432,0.487759, &
            0.444043,0.552461,0.043177,0.057528,0.121424,-0.129148,-0.918075,-0.730174, &
            3.191244,-1.328154,-0.665892,-0.949586,-0.324868,-0.023752,4.906560,0.410435, &
            0.068873,0.000893,-0.505766,-0.093561,-0.890548,-0.325306,0.193230,-0.253770, &
            -0.025698,-0.126121,0.246230,0.330249,0.282979,-0.046934,0.186421,-0.304073, &
            0.009686,0.005233,-0.078326,-0.064427,-0.051091,0.047154,-0.037579,0.034756, &
            0.123762,-0.136836,0.128912,0.461795,0.143021,0.850527,0.142647,0.089074, &
            -1.411229,0.253644,-0.351742,0.458005,0.113758,-0.938471,-0.477350,0.142685, &
            9.715417,0.146994,0.215353,-0.407801,0.635535,0.309078,-1.315117,-0.383182, &
            4.720804,0.089816,-0.182776,-4.007214,-0.199517,-0.465249,4.155261,-0.780635, &
            0.310737,0.225407,-2.301798,-0.253134,-2.527035,-0.343120,1.722755,-1.512926, &
            -0.683287,-0.097467,-0.036336,0.130779,0.284078,-0.700450,-0.005320,0.044463, &
            -0.099932,0.022170,0.103707,0.044184,0.464005,0.340311,-0.137895,0.330988, &
            0.168273,0.298643,0.182265,0.390137,0.158479,-0.035089,-0.492728,0.300479, &
            -2.557223,-0.026722,-0.140940,0.624258,0.516358,-0.291210,-0.074063,1.598599, &
            26.236565,-0.394086,0.702496,-0.187569,1.255364,1.386822,-0.778895,-1.194806, &
            10.402140,1.143256,-0.669770,-1.164607,-1.319927,-0.853265,0.090678,-5.023335, &
            0.388425,0.482770,-1.976694,0.004761,-2.356072,-0.978288,1.258244,-0.935746, &
            -0.938308,0.020727,-0.005523,-0.336883,1.159938,-0.214320,-0.381783,0.745880, &
            0.027404,-0.111482,-0.121240,0.182471,-0.476192,0.147553,0.189050,-0.489813, &
            0.180485,-0.011218,-0.171566,-0.372066,0.195040,-0.079975,0.211064,-0.260109, &
            -1.668520,0.063865,0.550605,0.545229,-0.020960,0.151818,-0.748618,2.531791, &
            23.518648,-2.517290,0.740479,-3.822919,2.403372,2.380781,0.778976,0.699300, &
            4.824639,-0.918540,-1.958471,-0.185749,-1.130031,-6.225092,-1.832038,-0.625319, &
            0.141588,0.406104,-0.528904,0.380434,-1.819300,-0.713602,-0.500128,0.088288, &
            -1.067867,-0.738071,-0.588352,-0.998232,1.483249,0.865960,0.172070,-0.025022, &
            0.176751,0.004374,-0.169293,0.304130,-0.674806,0.399327,0.130064,0.765950, &
            -0.000195,0.116065,0.078433,0.026091,0.288946,0.328465,-0.385878,0.230159, &
            -0.800024,0.035698,-0.161172,-0.219013,-0.159127,-0.532527,0.396823,-1.919432, &
            13.956213,0.473140,-0.152208,-0.339210,0.326759,0.437931,-0.608268,1.311708, &
            4.390110,0.976623,0.427256,0.545289,-0.075008,0.378333,-1.193902,-0.042975, &
            0.471993,0.458968,-0.354732,0.361555,-2.215125,-0.010515,-1.033861,-0.396868, &
            -0.797870,0.142901,0.592895,0.191575,0.814231,-0.547257,0.091112,0.340895, &
            0.025191,0.047360,-0.127786,-0.058648,0.139961,0.279944,-0.051492,-0.251698, &
            -0.110659,0.053711,0.020634,0.366921,-0.071661,0.479642,-0.284312,-0.761393, &
            -0.790918,0.002843,-0.557720,-0.192451,-0.463503,-1.256787,0.011529,0.229973, &
            9.865665,-0.093866,0.724047,2.362938,0.408805,-1.216877,-1.106389,5.637747, &
            2.230074,-0.400755,0.725145,-2.013161,0.641766,5.395136,-3.655852,-7.592116, &
            -0.308361,0.161758,0.436774,0.250219,-1.663781,-1.235419,-1.891032,0.187438, &
            -0.690857,-0.115226,0.079349,-0.117416,1.201882,-0.705091,-0.521093,2.405391, &
            -0.027656,-0.060934,0.077425,0.089572,-0.037594,-0.120779,-0.003840,0.203984, &
            0.030002,0.479030,-0.392776,-0.202203,0.227945,0.561490,-1.035417,0.505390, &
            -0.388043,-0.012987,0.002255,-0.078727,-0.693181,-0.700846,-0.754196,2.434090, &
            1.470346,0.966151,0.582071,0.934250,2.893384,-0.316238,-1.460504,8.041533, &
            0.359201,-0.530699,0.068097,-2.469829,1.544117,4.768365,-5.278988,-10.481837, &
            0.205465,0.301131,0.250090,0.698468,-1.518574,-0.367027,-2.012637,-0.065673, &
            -0.284026,0.392366,-0.435074,-0.824476,0.933904,-0.691182,-0.291231,3.649716, &
            0.062737,-0.243420,-0.039080,-0.142139,-0.245912,-0.377139,0.496892,1.164215, &
            -0.074565,-0.018343,0.225447,0.064184,0.244512,0.193766,-0.166468,0.455861, &
            -0.171282,-0.069887,0.197847,-0.037057,0.529067,-0.482722,0.410582,1.055055, &
            1.759287,-0.475888,-0.264372,-0.515821,-0.367761,0.073998,0.210669,2.530599, &
            -0.312600,-0.245723,0.442630,-0.862552,0.530311,2.230278,-1.289655,-4.842042, &
            -0.091703,-0.023899,0.575332,0.724822,-0.447005,-0.163837,-1.178975,-0.458884, &
            -0.261153,-0.048915,0.028391,-0.459815,0.636448,-0.229453,0.588584,1.198566, &
            0.065700,0.054006,-0.079542,-0.007259,0.033653,0.528683,-0.101291,-0.514493, &
            -0.109094,0.015076,-0.105098,-0.066258,-0.292065,-0.176916,-0.239707,0.788996, &
            -0.080357,-1.225624,0.116756,0.281585,0.388252,1.035194,2.283057,5.032287, &
            1.595075,-1.664700,0.267141,-0.828695,-0.539411,-0.636069,5.220046,0.552067, &
            2.485539,1.342877,0.554800,-2.501648,1.257280,-5.035735,1.297273,-5.212740, &
            0.002741,0.296794,0.780737,0.883276,0.942635,0.114409,-0.974110,0.234417, &
            0.685148,-0.135009,0.341938,0.435270,0.334402,-0.904459,0.112130,0.742526, &
            0.113842,-0.217733,-0.025933,-0.253822,-0.479575,-0.700371,0.337807,-1.328841, &
            0.227691,0.279262,-0.352930,-0.614665,-0.258698,0.242865,-1.002181,1.384356, &
            -0.121916,-0.422078,0.517210,-0.101348,0.180925,0.526414,0.266264,2.059777, &
            1.422240,-0.048330,-0.296653,-0.517332,0.038257,-6.392342,2.567858,1.285631, &
            1.029594,0.779444,-0.755984,-1.403961,-0.514486,-2.294313,0.665661,0.998378, &
            0.339773,0.412075,-0.020331,0.321836,-0.013719,-0.147626,-0.470227,-1.495013, &
            -0.392670,-0.047855,-0.236356,-0.357388,0.560326,-0.359883,0.277912,2.181511, &
            -0.014732,-0.176795,0.072963,0.100930,-0.024991,0.163238,0.347400,0.779186, &
            0.062056,-0.059278,-0.170543,-0.266694,-0.462476,0.327283,-0.358727,-0.521871, &
            0.073294,-0.073109,-0.630467,-0.372928,-0.089937,-0.397451,0.803778,1.675615, &
            0.911231,-0.179270,0.019888,-0.101381,-0.138865,-2.728750,-1.124905,9.968336, &
            1.139986,-1.199226,0.577247,-2.147480,-1.188699,-4.495300,-0.218128,8.586920, &
            0.453024,0.263106,0.045770,0.590189,0.443095,1.151361,-0.054170,-0.988316, &
            0.262407,0.026102,-0.276858,0.009031,-0.006737,0.178255,0.607273,2.422719, &
            0.098396,0.008742,-0.193864,-0.213856,-0.326961,-0.014734,-0.216541,-0.355533 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.696673,0.968626, &
            1.733310,-0.714137, &
            0.931791,-2.810986, &
            -1.885379,-1.999796, &
            -1.205311,-0.535711, &
            4.520893,3.562854, &
            0.714101,-0.771028, &
            0.290991,-0.648793 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.769503,-1.647688/),(/1,2/))
real, dimension(8) :: bias1 = &
(/3.02607,1.623521,1.748736,1.56475,-1.628929,1.6637,-1.039113,1.216366/)
real, dimension(2) :: bias2 = &
(/0.042904,-0.540528/)
real, dimension(1) :: bias3 = &
(/0.121629/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  !do i = 1, 126
  !  inarray2(i) = inarray(127-i)
  !end do
  layer1 = MatMul(input,inarray)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
